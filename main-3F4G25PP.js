var i2=Object.create;var s0=Object.defineProperty,o2=Object.defineProperties,s2=Object.getOwnPropertyDescriptor,a2=Object.getOwnPropertyDescriptors,l2=Object.getOwnPropertyNames,qc=Object.getOwnPropertySymbols,c2=Object.getPrototypeOf,a0=Object.prototype.hasOwnProperty,e_=Object.prototype.propertyIsEnumerable;var J1=(n,e,t)=>e in n?s0(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Me=(n,e)=>{for(var t in e||={})a0.call(e,t)&&J1(n,t,e[t]);if(qc)for(var t of qc(e))e_.call(e,t)&&J1(n,t,e[t]);return n},tt=(n,e)=>o2(n,a2(e));var t_=(n,e)=>{var t={};for(var r in n)a0.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&qc)for(var r of qc(n))e.indexOf(r)<0&&e_.call(n,r)&&(t[r]=n[r]);return t};var pt=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var u2=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of l2(e))!a0.call(n,i)&&i!==t&&s0(n,i,{get:()=>e[i],enumerable:!(r=s2(e,i))||r.enumerable});return n};var f2=(n,e,t)=>(t=n!=null?i2(c2(n)):{},u2(e||!n||!n.__esModule?s0(t,"default",{value:n,enumerable:!0}):t,n));var zD=pt((gie,WD)=>{"use strict";WD.exports=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}});var Co=pt(_s=>{"use strict";var Xv,f7=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];_s.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return e*4+17};_s.getSymbolTotalCodewords=function(e){return f7[e]};_s.getBCHDigit=function(n){let e=0;for(;n!==0;)e++,n>>>=1;return e};_s.setToSJISFunction=function(e){if(typeof e!="function")throw new Error('"toSJISFunc" is not a valid function.');Xv=e};_s.isKanjiModeEnabled=function(){return typeof Xv<"u"};_s.toSJIS=function(e){return Xv(e)}});var Dh=pt(Ir=>{"use strict";Ir.L={bit:1};Ir.M={bit:0};Ir.Q={bit:3};Ir.H={bit:2};function d7(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return Ir.L;case"m":case"medium":return Ir.M;case"q":case"quartile":return Ir.Q;case"h":case"high":return Ir.H;default:throw new Error("Unknown EC Level: "+n)}}Ir.isValid=function(e){return e&&typeof e.bit<"u"&&e.bit>=0&&e.bit<4};Ir.from=function(e,t){if(Ir.isValid(e))return e;try{return d7(e)}catch{return t}}});var YD=pt((yie,KD)=>{"use strict";function qD(){this.buffer=[],this.length=0}qD.prototype={get:function(n){let e=Math.floor(n/8);return(this.buffer[e]>>>7-n%8&1)===1},put:function(n,e){for(let t=0;t<e;t++)this.putBit((n>>>e-t-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(n){let e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),n&&(this.buffer[e]|=128>>>this.length%8),this.length++}};KD.exports=qD});var ZD=pt((xie,XD)=>{"use strict";function Fc(n){if(!n||n<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=n,this.data=new Uint8Array(n*n),this.reservedBit=new Uint8Array(n*n)}Fc.prototype.set=function(n,e,t,r){let i=n*this.size+e;this.data[i]=t,r&&(this.reservedBit[i]=!0)};Fc.prototype.get=function(n,e){return this.data[n*this.size+e]};Fc.prototype.xor=function(n,e,t){this.data[n*this.size+e]^=t};Fc.prototype.isReserved=function(n,e){return this.reservedBit[n*this.size+e]};XD.exports=Fc});var QD=pt(Sh=>{"use strict";var h7=Co().getSymbolSize;Sh.getRowColCoords=function(e){if(e===1)return[];let t=Math.floor(e/7)+2,r=h7(e),i=r===145?26:Math.ceil((r-13)/(2*t-2))*2,o=[r-7];for(let s=1;s<t-1;s++)o[s]=o[s-1]-i;return o.push(6),o.reverse()};Sh.getPositions=function(e){let t=[],r=Sh.getRowColCoords(e),i=r.length;for(let o=0;o<i;o++)for(let s=0;s<i;s++)o===0&&s===0||o===0&&s===i-1||o===i-1&&s===0||t.push([r[o],r[s]]);return t}});var tS=pt(eS=>{"use strict";var p7=Co().getSymbolSize,JD=7;eS.getPositions=function(e){let t=p7(e);return[[0,0],[t-JD,0],[0,t-JD]]}});var nS=pt(Et=>{"use strict";Et.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var ys={N1:3,N2:3,N3:40,N4:10};Et.isValid=function(e){return e!=null&&e!==""&&!isNaN(e)&&e>=0&&e<=7};Et.from=function(e){return Et.isValid(e)?parseInt(e,10):void 0};Et.getPenaltyN1=function(e){let t=e.size,r=0,i=0,o=0,s=null,a=null;for(let l=0;l<t;l++){i=o=0,s=a=null;for(let c=0;c<t;c++){let u=e.get(l,c);u===s?i++:(i>=5&&(r+=ys.N1+(i-5)),s=u,i=1),u=e.get(c,l),u===a?o++:(o>=5&&(r+=ys.N1+(o-5)),a=u,o=1)}i>=5&&(r+=ys.N1+(i-5)),o>=5&&(r+=ys.N1+(o-5))}return r};Et.getPenaltyN2=function(e){let t=e.size,r=0;for(let i=0;i<t-1;i++)for(let o=0;o<t-1;o++){let s=e.get(i,o)+e.get(i,o+1)+e.get(i+1,o)+e.get(i+1,o+1);(s===4||s===0)&&r++}return r*ys.N2};Et.getPenaltyN3=function(e){let t=e.size,r=0,i=0,o=0;for(let s=0;s<t;s++){i=o=0;for(let a=0;a<t;a++)i=i<<1&2047|e.get(s,a),a>=10&&(i===1488||i===93)&&r++,o=o<<1&2047|e.get(a,s),a>=10&&(o===1488||o===93)&&r++}return r*ys.N3};Et.getPenaltyN4=function(e){let t=0,r=e.data.length;for(let o=0;o<r;o++)t+=e.data[o];return Math.abs(Math.ceil(t*100/r/5)-10)*ys.N4};function m7(n,e,t){switch(n){case Et.Patterns.PATTERN000:return(e+t)%2===0;case Et.Patterns.PATTERN001:return e%2===0;case Et.Patterns.PATTERN010:return t%3===0;case Et.Patterns.PATTERN011:return(e+t)%3===0;case Et.Patterns.PATTERN100:return(Math.floor(e/2)+Math.floor(t/3))%2===0;case Et.Patterns.PATTERN101:return e*t%2+e*t%3===0;case Et.Patterns.PATTERN110:return(e*t%2+e*t%3)%2===0;case Et.Patterns.PATTERN111:return(e*t%3+(e+t)%2)%2===0;default:throw new Error("bad maskPattern:"+n)}}Et.applyMask=function(e,t){let r=t.size;for(let i=0;i<r;i++)for(let o=0;o<r;o++)t.isReserved(o,i)||t.xor(o,i,m7(e,o,i))};Et.getBestMask=function(e,t){let r=Object.keys(Et.Patterns).length,i=0,o=1/0;for(let s=0;s<r;s++){t(s),Et.applyMask(s,e);let a=Et.getPenaltyN1(e)+Et.getPenaltyN2(e)+Et.getPenaltyN3(e)+Et.getPenaltyN4(e);Et.applyMask(s,e),a<o&&(o=a,i=s)}return i}});var Qv=pt(Zv=>{"use strict";var Do=Dh(),bh=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],Ih=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];Zv.getBlocksCount=function(e,t){switch(t){case Do.L:return bh[(e-1)*4+0];case Do.M:return bh[(e-1)*4+1];case Do.Q:return bh[(e-1)*4+2];case Do.H:return bh[(e-1)*4+3];default:return}};Zv.getTotalCodewordsCount=function(e,t){switch(t){case Do.L:return Ih[(e-1)*4+0];case Do.M:return Ih[(e-1)*4+1];case Do.Q:return Ih[(e-1)*4+2];case Do.H:return Ih[(e-1)*4+3];default:return}}});var rS=pt(Fh=>{"use strict";var kc=new Uint8Array(512),Ah=new Uint8Array(256);(function(){let e=1;for(let t=0;t<255;t++)kc[t]=e,Ah[e]=t,e<<=1,e&256&&(e^=285);for(let t=255;t<512;t++)kc[t]=kc[t-255]})();Fh.log=function(e){if(e<1)throw new Error("log("+e+")");return Ah[e]};Fh.exp=function(e){return kc[e]};Fh.mul=function(e,t){return e===0||t===0?0:kc[Ah[e]+Ah[t]]}});var iS=pt(Nc=>{"use strict";var Jv=rS();Nc.mul=function(e,t){let r=new Uint8Array(e.length+t.length-1);for(let i=0;i<e.length;i++)for(let o=0;o<t.length;o++)r[i+o]^=Jv.mul(e[i],t[o]);return r};Nc.mod=function(e,t){let r=new Uint8Array(e);for(;r.length-t.length>=0;){let i=r[0];for(let s=0;s<t.length;s++)r[s]^=Jv.mul(t[s],i);let o=0;for(;o<r.length&&r[o]===0;)o++;r=r.slice(o)}return r};Nc.generateECPolynomial=function(e){let t=new Uint8Array([1]);for(let r=0;r<e;r++)t=Nc.mul(t,new Uint8Array([1,Jv.exp(r)]));return t}});var aS=pt((bie,sS)=>{"use strict";var oS=iS();function e1(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}e1.prototype.initialize=function(e){this.degree=e,this.genPoly=oS.generateECPolynomial(this.degree)};e1.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");let t=new Uint8Array(e.length+this.degree);t.set(e);let r=oS.mod(t,this.genPoly),i=this.degree-r.length;if(i>0){let o=new Uint8Array(this.degree);return o.set(r,i),o}return r};sS.exports=e1});var t1=pt(lS=>{"use strict";lS.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40}});var n1=pt(Hi=>{"use strict";var cS="[0-9]+",g7="[A-Z $%*+\\-./:]+",Mc="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";Mc=Mc.replace(/u/g,"\\u");var v7="(?:(?![A-Z0-9 $%*+\\-./:]|"+Mc+`)(?:.|[\r
]))+`;Hi.KANJI=new RegExp(Mc,"g");Hi.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");Hi.BYTE=new RegExp(v7,"g");Hi.NUMERIC=new RegExp(cS,"g");Hi.ALPHANUMERIC=new RegExp(g7,"g");var _7=new RegExp("^"+Mc+"$"),y7=new RegExp("^"+cS+"$"),x7=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");Hi.testKanji=function(e){return _7.test(e)};Hi.testNumeric=function(e){return y7.test(e)};Hi.testAlphanumeric=function(e){return x7.test(e)}});var So=pt(Yt=>{"use strict";var E7=t1(),r1=n1();Yt.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]};Yt.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]};Yt.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]};Yt.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]};Yt.MIXED={bit:-1};Yt.getCharCountIndicator=function(e,t){if(!e.ccBits)throw new Error("Invalid mode: "+e);if(!E7.isValid(t))throw new Error("Invalid version: "+t);return t>=1&&t<10?e.ccBits[0]:t<27?e.ccBits[1]:e.ccBits[2]};Yt.getBestModeForData=function(e){return r1.testNumeric(e)?Yt.NUMERIC:r1.testAlphanumeric(e)?Yt.ALPHANUMERIC:r1.testKanji(e)?Yt.KANJI:Yt.BYTE};Yt.toString=function(e){if(e&&e.id)return e.id;throw new Error("Invalid mode")};Yt.isValid=function(e){return e&&e.bit&&e.ccBits};function T7(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"numeric":return Yt.NUMERIC;case"alphanumeric":return Yt.ALPHANUMERIC;case"kanji":return Yt.KANJI;case"byte":return Yt.BYTE;default:throw new Error("Unknown mode: "+n)}}Yt.from=function(e,t){if(Yt.isValid(e))return e;try{return T7(e)}catch{return t}}});var pS=pt(xs=>{"use strict";var kh=Co(),w7=Qv(),uS=Dh(),bo=So(),i1=t1(),dS=7973,fS=kh.getBCHDigit(dS);function C7(n,e,t){for(let r=1;r<=40;r++)if(e<=xs.getCapacity(r,t,n))return r}function hS(n,e){return bo.getCharCountIndicator(n,e)+4}function D7(n,e){let t=0;return n.forEach(function(r){let i=hS(r.mode,e);t+=i+r.getBitsLength()}),t}function S7(n,e){for(let t=1;t<=40;t++)if(D7(n,t)<=xs.getCapacity(t,e,bo.MIXED))return t}xs.from=function(e,t){return i1.isValid(e)?parseInt(e,10):t};xs.getCapacity=function(e,t,r){if(!i1.isValid(e))throw new Error("Invalid QR Code version");typeof r>"u"&&(r=bo.BYTE);let i=kh.getSymbolTotalCodewords(e),o=w7.getTotalCodewordsCount(e,t),s=(i-o)*8;if(r===bo.MIXED)return s;let a=s-hS(r,e);switch(r){case bo.NUMERIC:return Math.floor(a/10*3);case bo.ALPHANUMERIC:return Math.floor(a/11*2);case bo.KANJI:return Math.floor(a/13);case bo.BYTE:default:return Math.floor(a/8)}};xs.getBestVersionForData=function(e,t){let r,i=uS.from(t,uS.M);if(Array.isArray(e)){if(e.length>1)return S7(e,i);if(e.length===0)return 1;r=e[0]}else r=e;return C7(r.mode,r.getLength(),i)};xs.getEncodedBits=function(e){if(!i1.isValid(e)||e<7)throw new Error("Invalid QR Code version");let t=e<<12;for(;kh.getBCHDigit(t)-fS>=0;)t^=dS<<kh.getBCHDigit(t)-fS;return e<<12|t}});var _S=pt(vS=>{"use strict";var o1=Co(),gS=1335,b7=21522,mS=o1.getBCHDigit(gS);vS.getEncodedBits=function(e,t){let r=e.bit<<3|t,i=r<<10;for(;o1.getBCHDigit(i)-mS>=0;)i^=gS<<o1.getBCHDigit(i)-mS;return(r<<10|i)^b7}});var xS=pt((Mie,yS)=>{"use strict";var I7=So();function Oa(n){this.mode=I7.NUMERIC,this.data=n.toString()}Oa.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)};Oa.prototype.getLength=function(){return this.data.length};Oa.prototype.getBitsLength=function(){return Oa.getBitsLength(this.data.length)};Oa.prototype.write=function(e){let t,r,i;for(t=0;t+3<=this.data.length;t+=3)r=this.data.substr(t,3),i=parseInt(r,10),e.put(i,10);let o=this.data.length-t;o>0&&(r=this.data.substr(t),i=parseInt(r,10),e.put(i,o*3+1))};yS.exports=Oa});var TS=pt((Oie,ES)=>{"use strict";var A7=So(),s1=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function Ra(n){this.mode=A7.ALPHANUMERIC,this.data=n}Ra.getBitsLength=function(e){return 11*Math.floor(e/2)+6*(e%2)};Ra.prototype.getLength=function(){return this.data.length};Ra.prototype.getBitsLength=function(){return Ra.getBitsLength(this.data.length)};Ra.prototype.write=function(e){let t;for(t=0;t+2<=this.data.length;t+=2){let r=s1.indexOf(this.data[t])*45;r+=s1.indexOf(this.data[t+1]),e.put(r,11)}this.data.length%2&&e.put(s1.indexOf(this.data[t]),6)};ES.exports=Ra});var CS=pt((Rie,wS)=>{"use strict";var F7=So();function Pa(n){this.mode=F7.BYTE,typeof n=="string"?this.data=new TextEncoder().encode(n):this.data=new Uint8Array(n)}Pa.getBitsLength=function(e){return e*8};Pa.prototype.getLength=function(){return this.data.length};Pa.prototype.getBitsLength=function(){return Pa.getBitsLength(this.data.length)};Pa.prototype.write=function(n){for(let e=0,t=this.data.length;e<t;e++)n.put(this.data[e],8)};wS.exports=Pa});var SS=pt((Pie,DS)=>{"use strict";var k7=So(),N7=Co();function La(n){this.mode=k7.KANJI,this.data=n}La.getBitsLength=function(e){return e*13};La.prototype.getLength=function(){return this.data.length};La.prototype.getBitsLength=function(){return La.getBitsLength(this.data.length)};La.prototype.write=function(n){let e;for(e=0;e<this.data.length;e++){let t=N7.toSJIS(this.data[e]);if(t>=33088&&t<=40956)t-=33088;else if(t>=57408&&t<=60351)t-=49472;else throw new Error("Invalid SJIS character: "+this.data[e]+`
Make sure your charset is UTF-8`);t=(t>>>8&255)*192+(t&255),n.put(t,13)}};DS.exports=La});var bS=pt((Lie,a1)=>{"use strict";var Oc={single_source_shortest_paths:function(n,e,t){var r={},i={};i[e]=0;var o=Oc.PriorityQueue.make();o.push(e,0);for(var s,a,l,c,u,f,h,d,m;!o.empty();){s=o.pop(),a=s.value,c=s.cost,u=n[a]||{};for(l in u)u.hasOwnProperty(l)&&(f=u[l],h=c+f,d=i[l],m=typeof i[l]>"u",(m||d>h)&&(i[l]=h,o.push(l,h),r[l]=a))}if(typeof t<"u"&&typeof i[t]>"u"){var p=["Could not find a path from ",e," to ",t,"."].join("");throw new Error(p)}return r},extract_shortest_path_from_predecessor_list:function(n,e){for(var t=[],r=e,i;r;)t.push(r),i=n[r],r=n[r];return t.reverse(),t},find_path:function(n,e,t){var r=Oc.single_source_shortest_paths(n,e,t);return Oc.extract_shortest_path_from_predecessor_list(r,t)},PriorityQueue:{make:function(n){var e=Oc.PriorityQueue,t={},r;n=n||{};for(r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t.queue=[],t.sorter=n.sorter||e.default_sorter,t},default_sorter:function(n,e){return n.cost-e.cost},push:function(n,e){var t={value:n,cost:e};this.queue.push(t),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};typeof a1<"u"&&(a1.exports=Oc)});var RS=pt(Ba=>{"use strict";var lt=So(),FS=xS(),kS=TS(),NS=CS(),MS=SS(),Rc=n1(),Nh=Co(),M7=bS();function IS(n){return unescape(encodeURIComponent(n)).length}function Pc(n,e,t){let r=[],i;for(;(i=n.exec(t))!==null;)r.push({data:i[0],index:i.index,mode:e,length:i[0].length});return r}function OS(n){let e=Pc(Rc.NUMERIC,lt.NUMERIC,n),t=Pc(Rc.ALPHANUMERIC,lt.ALPHANUMERIC,n),r,i;return Nh.isKanjiModeEnabled()?(r=Pc(Rc.BYTE,lt.BYTE,n),i=Pc(Rc.KANJI,lt.KANJI,n)):(r=Pc(Rc.BYTE_KANJI,lt.BYTE,n),i=[]),e.concat(t,r,i).sort(function(s,a){return s.index-a.index}).map(function(s){return{data:s.data,mode:s.mode,length:s.length}})}function l1(n,e){switch(e){case lt.NUMERIC:return FS.getBitsLength(n);case lt.ALPHANUMERIC:return kS.getBitsLength(n);case lt.KANJI:return MS.getBitsLength(n);case lt.BYTE:return NS.getBitsLength(n)}}function O7(n){return n.reduce(function(e,t){let r=e.length-1>=0?e[e.length-1]:null;return r&&r.mode===t.mode?(e[e.length-1].data+=t.data,e):(e.push(t),e)},[])}function R7(n){let e=[];for(let t=0;t<n.length;t++){let r=n[t];switch(r.mode){case lt.NUMERIC:e.push([r,{data:r.data,mode:lt.ALPHANUMERIC,length:r.length},{data:r.data,mode:lt.BYTE,length:r.length}]);break;case lt.ALPHANUMERIC:e.push([r,{data:r.data,mode:lt.BYTE,length:r.length}]);break;case lt.KANJI:e.push([r,{data:r.data,mode:lt.BYTE,length:IS(r.data)}]);break;case lt.BYTE:e.push([{data:r.data,mode:lt.BYTE,length:IS(r.data)}])}}return e}function P7(n,e){let t={},r={start:{}},i=["start"];for(let o=0;o<n.length;o++){let s=n[o],a=[];for(let l=0;l<s.length;l++){let c=s[l],u=""+o+l;a.push(u),t[u]={node:c,lastCount:0},r[u]={};for(let f=0;f<i.length;f++){let h=i[f];t[h]&&t[h].node.mode===c.mode?(r[h][u]=l1(t[h].lastCount+c.length,c.mode)-l1(t[h].lastCount,c.mode),t[h].lastCount+=c.length):(t[h]&&(t[h].lastCount=c.length),r[h][u]=l1(c.length,c.mode)+4+lt.getCharCountIndicator(c.mode,e))}}i=a}for(let o=0;o<i.length;o++)r[i[o]].end=0;return{map:r,table:t}}function AS(n,e){let t,r=lt.getBestModeForData(n);if(t=lt.from(e,r),t!==lt.BYTE&&t.bit<r.bit)throw new Error('"'+n+'" cannot be encoded with mode '+lt.toString(t)+`.
 Suggested mode is: `+lt.toString(r));switch(t===lt.KANJI&&!Nh.isKanjiModeEnabled()&&(t=lt.BYTE),t){case lt.NUMERIC:return new FS(n);case lt.ALPHANUMERIC:return new kS(n);case lt.KANJI:return new MS(n);case lt.BYTE:return new NS(n)}}Ba.fromArray=function(e){return e.reduce(function(t,r){return typeof r=="string"?t.push(AS(r,null)):r.data&&t.push(AS(r.data,r.mode)),t},[])};Ba.fromString=function(e,t){let r=OS(e,Nh.isKanjiModeEnabled()),i=R7(r),o=P7(i,t),s=M7.find_path(o.map,"start","end"),a=[];for(let l=1;l<s.length-1;l++)a.push(o.table[s[l]].node);return Ba.fromArray(O7(a))};Ba.rawSplit=function(e){return Ba.fromArray(OS(e,Nh.isKanjiModeEnabled()))}});var LS=pt(PS=>{"use strict";var Oh=Co(),c1=Dh(),L7=YD(),B7=ZD(),V7=QD(),U7=tS(),d1=nS(),h1=Qv(),j7=aS(),Mh=pS(),H7=_S(),G7=So(),u1=RS();function $7(n,e){let t=n.size,r=U7.getPositions(e);for(let i=0;i<r.length;i++){let o=r[i][0],s=r[i][1];for(let a=-1;a<=7;a++)if(!(o+a<=-1||t<=o+a))for(let l=-1;l<=7;l++)s+l<=-1||t<=s+l||(a>=0&&a<=6&&(l===0||l===6)||l>=0&&l<=6&&(a===0||a===6)||a>=2&&a<=4&&l>=2&&l<=4?n.set(o+a,s+l,!0,!0):n.set(o+a,s+l,!1,!0))}}function W7(n){let e=n.size;for(let t=8;t<e-8;t++){let r=t%2===0;n.set(t,6,r,!0),n.set(6,t,r,!0)}}function z7(n,e){let t=V7.getPositions(e);for(let r=0;r<t.length;r++){let i=t[r][0],o=t[r][1];for(let s=-2;s<=2;s++)for(let a=-2;a<=2;a++)s===-2||s===2||a===-2||a===2||s===0&&a===0?n.set(i+s,o+a,!0,!0):n.set(i+s,o+a,!1,!0)}}function q7(n,e){let t=n.size,r=Mh.getEncodedBits(e),i,o,s;for(let a=0;a<18;a++)i=Math.floor(a/3),o=a%3+t-8-3,s=(r>>a&1)===1,n.set(i,o,s,!0),n.set(o,i,s,!0)}function f1(n,e,t){let r=n.size,i=H7.getEncodedBits(e,t),o,s;for(o=0;o<15;o++)s=(i>>o&1)===1,o<6?n.set(o,8,s,!0):o<8?n.set(o+1,8,s,!0):n.set(r-15+o,8,s,!0),o<8?n.set(8,r-o-1,s,!0):o<9?n.set(8,15-o-1+1,s,!0):n.set(8,15-o-1,s,!0);n.set(r-8,8,1,!0)}function K7(n,e){let t=n.size,r=-1,i=t-1,o=7,s=0;for(let a=t-1;a>0;a-=2)for(a===6&&a--;;){for(let l=0;l<2;l++)if(!n.isReserved(i,a-l)){let c=!1;s<e.length&&(c=(e[s]>>>o&1)===1),n.set(i,a-l,c),o--,o===-1&&(s++,o=7)}if(i+=r,i<0||t<=i){i-=r,r=-r;break}}}function Y7(n,e,t){let r=new L7;t.forEach(function(l){r.put(l.mode.bit,4),r.put(l.getLength(),G7.getCharCountIndicator(l.mode,n)),l.write(r)});let i=Oh.getSymbolTotalCodewords(n),o=h1.getTotalCodewordsCount(n,e),s=(i-o)*8;for(r.getLengthInBits()+4<=s&&r.put(0,4);r.getLengthInBits()%8!==0;)r.putBit(0);let a=(s-r.getLengthInBits())/8;for(let l=0;l<a;l++)r.put(l%2?17:236,8);return X7(r,n,e)}function X7(n,e,t){let r=Oh.getSymbolTotalCodewords(e),i=h1.getTotalCodewordsCount(e,t),o=r-i,s=h1.getBlocksCount(e,t),a=r%s,l=s-a,c=Math.floor(r/s),u=Math.floor(o/s),f=u+1,h=c-u,d=new j7(h),m=0,p=new Array(s),g=new Array(s),w=0,y=new Uint8Array(n.buffer);for(let O=0;O<s;O++){let L=O<l?u:f;p[O]=y.slice(m,m+L),g[O]=d.encode(p[O]),m+=L,w=Math.max(w,L)}let S=new Uint8Array(r),B=0,Z,ce;for(Z=0;Z<w;Z++)for(ce=0;ce<s;ce++)Z<p[ce].length&&(S[B++]=p[ce][Z]);for(Z=0;Z<h;Z++)for(ce=0;ce<s;ce++)S[B++]=g[ce][Z];return S}function Z7(n,e,t,r){let i;if(Array.isArray(n))i=u1.fromArray(n);else if(typeof n=="string"){let c=e;if(!c){let u=u1.rawSplit(n);c=Mh.getBestVersionForData(u,t)}i=u1.fromString(n,c||40)}else throw new Error("Invalid data");let o=Mh.getBestVersionForData(i,t);if(!o)throw new Error("The amount of data is too big to be stored in a QR Code");if(!e)e=o;else if(e<o)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+o+`.
`);let s=Y7(e,t,i),a=Oh.getSymbolSize(e),l=new B7(a);return $7(l,e),W7(l),z7(l,e),f1(l,t,0),e>=7&&q7(l,e),K7(l,s),isNaN(r)&&(r=d1.getBestMask(l,f1.bind(null,l,t))),d1.applyMask(r,l),f1(l,t,r),{modules:l,version:e,errorCorrectionLevel:t,maskPattern:r,segments:i}}PS.create=function(e,t){if(typeof e>"u"||e==="")throw new Error("No input text");let r=c1.M,i,o;return typeof t<"u"&&(r=c1.from(t.errorCorrectionLevel,c1.M),i=Mh.from(t.version),o=d1.from(t.maskPattern),t.toSJISFunc&&Oh.setToSJISFunction(t.toSJISFunc)),Z7(e,i,r,o)}});var p1=pt(Es=>{"use strict";function BS(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let e=n.slice().replace("#","").split("");if(e.length<3||e.length===5||e.length>8)throw new Error("Invalid hex color: "+n);(e.length===3||e.length===4)&&(e=Array.prototype.concat.apply([],e.map(function(r){return[r,r]}))),e.length===6&&e.push("F","F");let t=parseInt(e.join(""),16);return{r:t>>24&255,g:t>>16&255,b:t>>8&255,a:t&255,hex:"#"+e.slice(0,6).join("")}}Es.getOptions=function(e){e||(e={}),e.color||(e.color={});let t=typeof e.margin>"u"||e.margin===null||e.margin<0?4:e.margin,r=e.width&&e.width>=21?e.width:void 0,i=e.scale||4;return{width:r,scale:r?4:i,margin:t,color:{dark:BS(e.color.dark||"#000000ff"),light:BS(e.color.light||"#ffffffff")},type:e.type,rendererOpts:e.rendererOpts||{}}};Es.getScale=function(e,t){return t.width&&t.width>=e+t.margin*2?t.width/(e+t.margin*2):t.scale};Es.getImageWidth=function(e,t){let r=Es.getScale(e,t);return Math.floor((e+t.margin*2)*r)};Es.qrToImageData=function(e,t,r){let i=t.modules.size,o=t.modules.data,s=Es.getScale(i,r),a=Math.floor((i+r.margin*2)*s),l=r.margin*s,c=[r.color.light,r.color.dark];for(let u=0;u<a;u++)for(let f=0;f<a;f++){let h=(u*a+f)*4,d=r.color.light;if(u>=l&&f>=l&&u<a-l&&f<a-l){let m=Math.floor((u-l)/s),p=Math.floor((f-l)/s);d=c[o[m*i+p]?1:0]}e[h++]=d.r,e[h++]=d.g,e[h++]=d.b,e[h]=d.a}}});var VS=pt(Rh=>{"use strict";var m1=p1();function Q7(n,e,t){n.clearRect(0,0,e.width,e.height),e.style||(e.style={}),e.height=t,e.width=t,e.style.height=t+"px",e.style.width=t+"px"}function J7(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}Rh.render=function(e,t,r){let i=r,o=t;typeof i>"u"&&(!t||!t.getContext)&&(i=t,t=void 0),t||(o=J7()),i=m1.getOptions(i);let s=m1.getImageWidth(e.modules.size,i),a=o.getContext("2d"),l=a.createImageData(s,s);return m1.qrToImageData(l.data,e,i),Q7(a,o,s),a.putImageData(l,0,0),o};Rh.renderToDataURL=function(e,t,r){let i=r;typeof i>"u"&&(!t||!t.getContext)&&(i=t,t=void 0),i||(i={});let o=Rh.render(e,t,i),s=i.type||"image/png",a=i.rendererOpts||{};return o.toDataURL(s,a.quality)}});var HS=pt(jS=>{"use strict";var e9=p1();function US(n,e){let t=n.a/255,r=e+'="'+n.hex+'"';return t<1?r+" "+e+'-opacity="'+t.toFixed(2).slice(1)+'"':r}function g1(n,e,t){let r=n+e;return typeof t<"u"&&(r+=" "+t),r}function t9(n,e,t){let r="",i=0,o=!1,s=0;for(let a=0;a<n.length;a++){let l=Math.floor(a%e),c=Math.floor(a/e);!l&&!o&&(o=!0),n[a]?(s++,a>0&&l>0&&n[a-1]||(r+=o?g1("M",l+t,.5+c+t):g1("m",i,0),i=0,o=!1),l+1<e&&n[a+1]||(r+=g1("h",s),s=0)):i++}return r}jS.render=function(e,t,r){let i=e9.getOptions(t),o=e.modules.size,s=e.modules.data,a=o+i.margin*2,l=i.color.light.a?"<path "+US(i.color.light,"fill")+' d="M0 0h'+a+"v"+a+'H0z"/>':"",c="<path "+US(i.color.dark,"stroke")+' d="'+t9(s,o,i.margin)+'"/>',u='viewBox="0 0 '+a+" "+a+'"',h='<svg xmlns="http://www.w3.org/2000/svg" '+(i.width?'width="'+i.width+'" height="'+i.width+'" ':"")+u+' shape-rendering="crispEdges">'+l+c+`</svg>
`;return typeof r=="function"&&r(null,h),h}});var $S=pt(Lc=>{"use strict";var n9=zD(),v1=LS(),GS=VS(),r9=HS();function _1(n,e,t,r,i){let o=[].slice.call(arguments,1),s=o.length,a=typeof o[s-1]=="function";if(!a&&!n9())throw new Error("Callback required as last argument");if(a){if(s<2)throw new Error("Too few arguments provided");s===2?(i=t,t=e,e=r=void 0):s===3&&(e.getContext&&typeof i>"u"?(i=r,r=void 0):(i=r,r=t,t=e,e=void 0))}else{if(s<1)throw new Error("Too few arguments provided");return s===1?(t=e,e=r=void 0):s===2&&!e.getContext&&(r=t,t=e,e=void 0),new Promise(function(l,c){try{let u=v1.create(t,r);l(n(u,e,r))}catch(u){c(u)}})}try{let l=v1.create(t,r);i(null,n(l,e,r))}catch(l){i(l)}}Lc.create=v1.create;Lc.toCanvas=_1.bind(null,GS.render);Lc.toDataURL=_1.bind(null,GS.renderToDataURL);Lc.toString=_1.bind(null,function(n,e,t){return r9.render(n,t)})});var Yr=globalThis;function hr(n){return(Yr.__Zone_symbol_prefix||"__zone_symbol__")+n}function d2(){let n=Yr.performance;function e(ie){n&&n.mark&&n.mark(ie)}function t(ie,ee){n&&n.measure&&n.measure(ie,ee)}e("Zone");let r=(()=>{class ie{static __symbol__=hr;static assertZonePatched(){if(Yr.Promise!==V.ZoneAwarePromise)throw new Error("Zone.js has detected that ZoneAwarePromise `(window|global).Promise` has been overwritten.\nMost likely cause is that a Promise polyfill has been loaded after Zone.js (Polyfilling Promise api is not necessary when zone.js is loaded. If you must load one, do so before loading zone.js.)")}static get root(){let k=ie.current;for(;k.parent;)k=k.parent;return k}static get current(){return W.zone}static get currentTask(){return ue}static __load_patch(k,R,pe=!1){if(V.hasOwnProperty(k)){let De=Yr[hr("forceDuplicateZoneCheck")]===!0;if(!pe&&De)throw Error("Already loaded patch: "+k)}else if(!Yr["__Zone_disable_"+k]){let De="Zone:"+k;e(De),V[k]=R(Yr,ie,K),t(De,De)}}get parent(){return this._parent}get name(){return this._name}_parent;_name;_properties;_zoneDelegate;constructor(k,R){this._parent=k,this._name=R?R.name||"unnamed":"<root>",this._properties=R&&R.properties||{},this._zoneDelegate=new o(this,this._parent&&this._parent._zoneDelegate,R)}get(k){let R=this.getZoneWith(k);if(R)return R._properties[k]}getZoneWith(k){let R=this;for(;R;){if(R._properties.hasOwnProperty(k))return R;R=R._parent}return null}fork(k){if(!k)throw new Error("ZoneSpec required!");return this._zoneDelegate.fork(this,k)}wrap(k,R){if(typeof k!="function")throw new Error("Expecting function got: "+k);let pe=this._zoneDelegate.intercept(this,k,R),De=this;return function(){return De.runGuarded(pe,this,arguments,R)}}run(k,R,pe,De){W={parent:W,zone:this};try{return this._zoneDelegate.invoke(this,k,R,pe,De)}finally{W=W.parent}}runGuarded(k,R=null,pe,De){W={parent:W,zone:this};try{try{return this._zoneDelegate.invoke(this,k,R,pe,De)}catch(F){if(this._zoneDelegate.handleError(this,F))throw F}}finally{W=W.parent}}runTask(k,R,pe){if(k.zone!=this)throw new Error("A task can only be run in the zone of creation! (Creation: "+(k.zone||g).name+"; Execution: "+this.name+")");let De=k,{type:F,data:{isPeriodic:U=!1,isRefreshable:M=!1}={}}=k;if(k.state===w&&(F===G||F===L))return;let P=k.state!=B;P&&De._transitionTo(B,S);let se=ue;ue=De,W={parent:W,zone:this};try{F==L&&k.data&&!U&&!M&&(k.cancelFn=void 0);try{return this._zoneDelegate.invokeTask(this,De,R,pe)}catch(he){if(this._zoneDelegate.handleError(this,he))throw he}}finally{let he=k.state;if(he!==w&&he!==ce)if(F==G||U||M&&he===y)P&&De._transitionTo(S,B,y);else{let Q=De._zoneDelegates;this._updateTaskCount(De,-1),P&&De._transitionTo(w,B,w),M&&(De._zoneDelegates=Q)}W=W.parent,ue=se}}scheduleTask(k){if(k.zone&&k.zone!==this){let pe=this;for(;pe;){if(pe===k.zone)throw Error(`can not reschedule task to ${this.name} which is descendants of the original zone ${k.zone.name}`);pe=pe.parent}}k._transitionTo(y,w);let R=[];k._zoneDelegates=R,k._zone=this;try{k=this._zoneDelegate.scheduleTask(this,k)}catch(pe){throw k._transitionTo(ce,y,w),this._zoneDelegate.handleError(this,pe),pe}return k._zoneDelegates===R&&this._updateTaskCount(k,1),k.state==y&&k._transitionTo(S,y),k}scheduleMicroTask(k,R,pe,De){return this.scheduleTask(new s(O,k,R,pe,De,void 0))}scheduleMacroTask(k,R,pe,De,F){return this.scheduleTask(new s(L,k,R,pe,De,F))}scheduleEventTask(k,R,pe,De,F){return this.scheduleTask(new s(G,k,R,pe,De,F))}cancelTask(k){if(k.zone!=this)throw new Error("A task can only be cancelled in the zone of creation! (Creation: "+(k.zone||g).name+"; Execution: "+this.name+")");if(!(k.state!==S&&k.state!==B)){k._transitionTo(Z,S,B);try{this._zoneDelegate.cancelTask(this,k)}catch(R){throw k._transitionTo(ce,Z),this._zoneDelegate.handleError(this,R),R}return this._updateTaskCount(k,-1),k._transitionTo(w,Z),k.runCount=-1,k}}_updateTaskCount(k,R){let pe=k._zoneDelegates;R==-1&&(k._zoneDelegates=null);for(let De=0;De<pe.length;De++)pe[De]._updateTaskCount(k.type,R)}}return ie})(),i={name:"",onHasTask:(ie,ee,k,R)=>ie.hasTask(k,R),onScheduleTask:(ie,ee,k,R)=>ie.scheduleTask(k,R),onInvokeTask:(ie,ee,k,R,pe,De)=>ie.invokeTask(k,R,pe,De),onCancelTask:(ie,ee,k,R)=>ie.cancelTask(k,R)};class o{get zone(){return this._zone}_zone;_taskCounts={microTask:0,macroTask:0,eventTask:0};_parentDelegate;_forkDlgt;_forkZS;_forkCurrZone;_interceptDlgt;_interceptZS;_interceptCurrZone;_invokeDlgt;_invokeZS;_invokeCurrZone;_handleErrorDlgt;_handleErrorZS;_handleErrorCurrZone;_scheduleTaskDlgt;_scheduleTaskZS;_scheduleTaskCurrZone;_invokeTaskDlgt;_invokeTaskZS;_invokeTaskCurrZone;_cancelTaskDlgt;_cancelTaskZS;_cancelTaskCurrZone;_hasTaskDlgt;_hasTaskDlgtOwner;_hasTaskZS;_hasTaskCurrZone;constructor(ee,k,R){this._zone=ee,this._parentDelegate=k,this._forkZS=R&&(R&&R.onFork?R:k._forkZS),this._forkDlgt=R&&(R.onFork?k:k._forkDlgt),this._forkCurrZone=R&&(R.onFork?this._zone:k._forkCurrZone),this._interceptZS=R&&(R.onIntercept?R:k._interceptZS),this._interceptDlgt=R&&(R.onIntercept?k:k._interceptDlgt),this._interceptCurrZone=R&&(R.onIntercept?this._zone:k._interceptCurrZone),this._invokeZS=R&&(R.onInvoke?R:k._invokeZS),this._invokeDlgt=R&&(R.onInvoke?k:k._invokeDlgt),this._invokeCurrZone=R&&(R.onInvoke?this._zone:k._invokeCurrZone),this._handleErrorZS=R&&(R.onHandleError?R:k._handleErrorZS),this._handleErrorDlgt=R&&(R.onHandleError?k:k._handleErrorDlgt),this._handleErrorCurrZone=R&&(R.onHandleError?this._zone:k._handleErrorCurrZone),this._scheduleTaskZS=R&&(R.onScheduleTask?R:k._scheduleTaskZS),this._scheduleTaskDlgt=R&&(R.onScheduleTask?k:k._scheduleTaskDlgt),this._scheduleTaskCurrZone=R&&(R.onScheduleTask?this._zone:k._scheduleTaskCurrZone),this._invokeTaskZS=R&&(R.onInvokeTask?R:k._invokeTaskZS),this._invokeTaskDlgt=R&&(R.onInvokeTask?k:k._invokeTaskDlgt),this._invokeTaskCurrZone=R&&(R.onInvokeTask?this._zone:k._invokeTaskCurrZone),this._cancelTaskZS=R&&(R.onCancelTask?R:k._cancelTaskZS),this._cancelTaskDlgt=R&&(R.onCancelTask?k:k._cancelTaskDlgt),this._cancelTaskCurrZone=R&&(R.onCancelTask?this._zone:k._cancelTaskCurrZone),this._hasTaskZS=null,this._hasTaskDlgt=null,this._hasTaskDlgtOwner=null,this._hasTaskCurrZone=null;let pe=R&&R.onHasTask,De=k&&k._hasTaskZS;(pe||De)&&(this._hasTaskZS=pe?R:i,this._hasTaskDlgt=k,this._hasTaskDlgtOwner=this,this._hasTaskCurrZone=this._zone,R.onScheduleTask||(this._scheduleTaskZS=i,this._scheduleTaskDlgt=k,this._scheduleTaskCurrZone=this._zone),R.onInvokeTask||(this._invokeTaskZS=i,this._invokeTaskDlgt=k,this._invokeTaskCurrZone=this._zone),R.onCancelTask||(this._cancelTaskZS=i,this._cancelTaskDlgt=k,this._cancelTaskCurrZone=this._zone))}fork(ee,k){return this._forkZS?this._forkZS.onFork(this._forkDlgt,this.zone,ee,k):new r(ee,k)}intercept(ee,k,R){return this._interceptZS?this._interceptZS.onIntercept(this._interceptDlgt,this._interceptCurrZone,ee,k,R):k}invoke(ee,k,R,pe,De){return this._invokeZS?this._invokeZS.onInvoke(this._invokeDlgt,this._invokeCurrZone,ee,k,R,pe,De):k.apply(R,pe)}handleError(ee,k){return this._handleErrorZS?this._handleErrorZS.onHandleError(this._handleErrorDlgt,this._handleErrorCurrZone,ee,k):!0}scheduleTask(ee,k){let R=k;if(this._scheduleTaskZS)this._hasTaskZS&&R._zoneDelegates.push(this._hasTaskDlgtOwner),R=this._scheduleTaskZS.onScheduleTask(this._scheduleTaskDlgt,this._scheduleTaskCurrZone,ee,k),R||(R=k);else if(k.scheduleFn)k.scheduleFn(k);else if(k.type==O)m(k);else throw new Error("Task is missing scheduleFn.");return R}invokeTask(ee,k,R,pe){return this._invokeTaskZS?this._invokeTaskZS.onInvokeTask(this._invokeTaskDlgt,this._invokeTaskCurrZone,ee,k,R,pe):k.callback.apply(R,pe)}cancelTask(ee,k){let R;if(this._cancelTaskZS)R=this._cancelTaskZS.onCancelTask(this._cancelTaskDlgt,this._cancelTaskCurrZone,ee,k);else{if(!k.cancelFn)throw Error("Task is not cancelable");R=k.cancelFn(k)}return R}hasTask(ee,k){try{this._hasTaskZS&&this._hasTaskZS.onHasTask(this._hasTaskDlgt,this._hasTaskCurrZone,ee,k)}catch(R){this.handleError(ee,R)}}_updateTaskCount(ee,k){let R=this._taskCounts,pe=R[ee],De=R[ee]=pe+k;if(De<0)throw new Error("More tasks executed then were scheduled.");if(pe==0||De==0){let F={microTask:R.microTask>0,macroTask:R.macroTask>0,eventTask:R.eventTask>0,change:ee};this.hasTask(this._zone,F)}}}class s{type;source;invoke;callback;data;scheduleFn;cancelFn;_zone=null;runCount=0;_zoneDelegates=null;_state="notScheduled";constructor(ee,k,R,pe,De,F){if(this.type=ee,this.source=k,this.data=pe,this.scheduleFn=De,this.cancelFn=F,!R)throw new Error("callback is not defined");this.callback=R;let U=this;ee===G&&pe&&pe.useG?this.invoke=s.invokeTask:this.invoke=function(){return s.invokeTask.call(Yr,U,this,arguments)}}static invokeTask(ee,k,R){ee||(ee=this),Oe++;try{return ee.runCount++,ee.zone.runTask(ee,k,R)}finally{Oe==1&&p(),Oe--}}get zone(){return this._zone}get state(){return this._state}cancelScheduleRequest(){this._transitionTo(w,y)}_transitionTo(ee,k,R){if(this._state===k||this._state===R)this._state=ee,ee==w&&(this._zoneDelegates=null);else throw new Error(`${this.type} '${this.source}': can not transition to '${ee}', expecting state '${k}'${R?" or '"+R+"'":""}, was '${this._state}'.`)}toString(){return this.data&&typeof this.data.handleId<"u"?this.data.handleId.toString():Object.prototype.toString.call(this)}toJSON(){return{type:this.type,state:this.state,source:this.source,zone:this.zone.name,runCount:this.runCount}}}let a=hr("setTimeout"),l=hr("Promise"),c=hr("then"),u=[],f=!1,h;function d(ie){if(h||Yr[l]&&(h=Yr[l].resolve(0)),h){let ee=h[c];ee||(ee=h.then),ee.call(h,ie)}else Yr[a](ie,0)}function m(ie){Oe===0&&u.length===0&&d(p),ie&&u.push(ie)}function p(){if(!f){for(f=!0;u.length;){let ie=u;u=[];for(let ee=0;ee<ie.length;ee++){let k=ie[ee];try{k.zone.runTask(k,null,null)}catch(R){K.onUnhandledError(R)}}}K.microtaskDrainDone(),f=!1}}let g={name:"NO ZONE"},w="notScheduled",y="scheduling",S="scheduled",B="running",Z="canceling",ce="unknown",O="microTask",L="macroTask",G="eventTask",V={},K={symbol:hr,currentZoneFrame:()=>W,onUnhandledError:Te,microtaskDrainDone:Te,scheduleMicroTask:m,showUncaughtError:()=>!r[hr("ignoreConsoleErrorUncaughtError")],patchEventTarget:()=>[],patchOnProperties:Te,patchMethod:()=>Te,bindArguments:()=>[],patchThen:()=>Te,patchMacroTask:()=>Te,patchEventPrototype:()=>Te,isIEOrEdge:()=>!1,getGlobalObjects:()=>{},ObjectDefineProperty:()=>Te,ObjectGetOwnPropertyDescriptor:()=>{},ObjectCreate:()=>{},ArraySlice:()=>[],patchClass:()=>Te,wrapWithCurrentZone:()=>Te,filterProperties:()=>[],attachOriginToPatched:()=>Te,_redefineProperty:()=>Te,patchCallbacks:()=>Te,nativeScheduleMicroTask:d},W={parent:null,zone:new r(null,null)},ue=null,Oe=0;function Te(){}return t("Zone","Zone"),r}function h2(){let n=globalThis,e=n[hr("forceDuplicateZoneCheck")]===!0;if(n.Zone&&(e||typeof n.Zone.__symbol__!="function"))throw new Error("Zone already loaded.");return n.Zone??=d2(),n.Zone}var Ka=Object.getOwnPropertyDescriptor,d0=Object.defineProperty,h0=Object.getPrototypeOf,p2=Object.create,m2=Array.prototype.slice,p0="addEventListener",m0="removeEventListener",l0=hr(p0),c0=hr(m0),yi="true",xi="false",Ya=hr("");function g0(n,e){return Zone.current.wrap(n,e)}function v0(n,e,t,r,i){return Zone.current.scheduleMacroTask(n,e,t,r,i)}var at=hr,Xc=typeof window<"u",Xa=Xc?window:void 0,Xt=Xc&&Xa||globalThis,g2="removeAttribute";function _0(n,e){for(let t=n.length-1;t>=0;t--)typeof n[t]=="function"&&(n[t]=g0(n[t],e+"_"+t));return n}function v2(n,e){let t=n.constructor.name;for(let r=0;r<e.length;r++){let i=e[r],o=n[i];if(o){let s=Ka(n,i);if(!l_(s))continue;n[i]=(a=>{let l=function(){return a.apply(this,_0(arguments,t+"."+i))};return Ti(l,a),l})(o)}}}function l_(n){return n?n.writable===!1?!1:!(typeof n.get=="function"&&typeof n.set>"u"):!0}var c_=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,Zc=!("nw"in Xt)&&typeof Xt.process<"u"&&Xt.process.toString()==="[object process]",y0=!Zc&&!c_&&!!(Xc&&Xa.HTMLElement),u_=typeof Xt.process<"u"&&Xt.process.toString()==="[object process]"&&!c_&&!!(Xc&&Xa.HTMLElement),Yc={},_2=at("enable_beforeunload"),n_=function(n){if(n=n||Xt.event,!n)return;let e=Yc[n.type];e||(e=Yc[n.type]=at("ON_PROPERTY"+n.type));let t=this||n.target||Xt,r=t[e],i;if(y0&&t===Xa&&n.type==="error"){let o=n;i=r&&r.call(this,o.message,o.filename,o.lineno,o.colno,o.error),i===!0&&n.preventDefault()}else i=r&&r.apply(this,arguments),n.type==="beforeunload"&&Xt[_2]&&typeof i=="string"?n.returnValue=i:i!=null&&!i&&n.preventDefault();return i};function r_(n,e,t){let r=Ka(n,e);if(!r&&t&&Ka(t,e)&&(r={enumerable:!0,configurable:!0}),!r||!r.configurable)return;let i=at("on"+e+"patched");if(n.hasOwnProperty(i)&&n[i])return;delete r.writable,delete r.value;let o=r.get,s=r.set,a=e.slice(2),l=Yc[a];l||(l=Yc[a]=at("ON_PROPERTY"+a)),r.set=function(c){let u=this;if(!u&&n===Xt&&(u=Xt),!u)return;typeof u[l]=="function"&&u.removeEventListener(a,n_),s?.call(u,null),u[l]=c,typeof c=="function"&&u.addEventListener(a,n_,!1)},r.get=function(){let c=this;if(!c&&n===Xt&&(c=Xt),!c)return null;let u=c[l];if(u)return u;if(o){let f=o.call(this);if(f)return r.set.call(this,f),typeof c[g2]=="function"&&c.removeAttribute(e),f}return null},d0(n,e,r),n[i]=!0}function f_(n,e,t){if(e)for(let r=0;r<e.length;r++)r_(n,"on"+e[r],t);else{let r=[];for(let i in n)i.slice(0,2)=="on"&&r.push(i);for(let i=0;i<r.length;i++)r_(n,r[i],t)}}var Fr=at("originalInstance");function qa(n){let e=Xt[n];if(!e)return;Xt[at(n)]=e,Xt[n]=function(){let i=_0(arguments,n);switch(i.length){case 0:this[Fr]=new e;break;case 1:this[Fr]=new e(i[0]);break;case 2:this[Fr]=new e(i[0],i[1]);break;case 3:this[Fr]=new e(i[0],i[1],i[2]);break;case 4:this[Fr]=new e(i[0],i[1],i[2],i[3]);break;default:throw new Error("Arg list too long.")}},Ti(Xt[n],e);let t=new e(function(){}),r;for(r in t)n==="XMLHttpRequest"&&r==="responseBlob"||function(i){typeof t[i]=="function"?Xt[n].prototype[i]=function(){return this[Fr][i].apply(this[Fr],arguments)}:d0(Xt[n].prototype,i,{set:function(o){typeof o=="function"?(this[Fr][i]=g0(o,n+"."+i),Ti(this[Fr][i],o)):this[Fr][i]=o},get:function(){return this[Fr][i]}})}(r);for(r in e)r!=="prototype"&&e.hasOwnProperty(r)&&(Xt[n][r]=e[r])}function Ei(n,e,t){let r=n;for(;r&&!r.hasOwnProperty(e);)r=h0(r);!r&&n[e]&&(r=n);let i=at(e),o=null;if(r&&(!(o=r[i])||!r.hasOwnProperty(i))){o=r[i]=r[e];let s=r&&Ka(r,e);if(l_(s)){let a=t(o,i,e);r[e]=function(){return a(this,arguments)},Ti(r[e],o)}}return o}function y2(n,e,t){let r=null;function i(o){let s=o.data;return s.args[s.cbIdx]=function(){o.invoke.apply(this,arguments)},r.apply(s.target,s.args),o}r=Ei(n,e,o=>function(s,a){let l=t(s,a);return l.cbIdx>=0&&typeof a[l.cbIdx]=="function"?v0(l.name,a[l.cbIdx],l,i):o.apply(s,a)})}function Ti(n,e){n[at("OriginalDelegate")]=e}var i_=!1,u0=!1;function x2(){if(i_)return u0;i_=!0;try{let n=Xa.navigator.userAgent;(n.indexOf("MSIE ")!==-1||n.indexOf("Trident/")!==-1||n.indexOf("Edge/")!==-1)&&(u0=!0)}catch{}return u0}function o_(n){return typeof n=="function"}function s_(n){return typeof n=="number"}var E2={useG:!0},pr={},d_={},h_=new RegExp("^"+Ya+"(\\w+)(true|false)$"),p_=at("propagationStopped");function m_(n,e){let t=(e?e(n):n)+xi,r=(e?e(n):n)+yi,i=Ya+t,o=Ya+r;pr[n]={},pr[n][xi]=i,pr[n][yi]=o}function T2(n,e,t,r){let i=r&&r.add||p0,o=r&&r.rm||m0,s=r&&r.listeners||"eventListeners",a=r&&r.rmAll||"removeAllListeners",l=at(i),c="."+i+":",u="prependListener",f="."+u+":",h=function(y,S,B){if(y.isRemoved)return;let Z=y.callback;typeof Z=="object"&&Z.handleEvent&&(y.callback=L=>Z.handleEvent(L),y.originalDelegate=Z);let ce;try{y.invoke(y,S,[B])}catch(L){ce=L}let O=y.options;if(O&&typeof O=="object"&&O.once){let L=y.originalDelegate?y.originalDelegate:y.callback;S[o].call(S,B.type,L,O)}return ce};function d(y,S,B){if(S=S||n.event,!S)return;let Z=y||S.target||n,ce=Z[pr[S.type][B?yi:xi]];if(ce){let O=[];if(ce.length===1){let L=h(ce[0],Z,S);L&&O.push(L)}else{let L=ce.slice();for(let G=0;G<L.length&&!(S&&S[p_]===!0);G++){let V=h(L[G],Z,S);V&&O.push(V)}}if(O.length===1)throw O[0];for(let L=0;L<O.length;L++){let G=O[L];e.nativeScheduleMicroTask(()=>{throw G})}}}let m=function(y){return d(this,y,!1)},p=function(y){return d(this,y,!0)};function g(y,S){if(!y)return!1;let B=!0;S&&S.useG!==void 0&&(B=S.useG);let Z=S&&S.vh,ce=!0;S&&S.chkDup!==void 0&&(ce=S.chkDup);let O=!1;S&&S.rt!==void 0&&(O=S.rt);let L=y;for(;L&&!L.hasOwnProperty(i);)L=h0(L);if(!L&&y[i]&&(L=y),!L||L[l])return!1;let G=S&&S.eventNameToString,V={},K=L[l]=L[i],W=L[at(o)]=L[o],ue=L[at(s)]=L[s],Oe=L[at(a)]=L[a],Te;S&&S.prepend&&(Te=L[at(S.prepend)]=L[S.prepend]);function ie(N,oe){return oe?typeof N=="boolean"?{capture:N,passive:!0}:N?typeof N=="object"&&N.passive!==!1?tt(Me({},N),{passive:!0}):N:{passive:!0}:N}let ee=function(N){if(!V.isExisting)return K.call(V.target,V.eventName,V.capture?p:m,V.options)},k=function(N){if(!N.isRemoved){let oe=pr[N.eventName],ge;oe&&(ge=oe[N.capture?yi:xi]);let Fe=ge&&N.target[ge];if(Fe){for(let me=0;me<Fe.length;me++)if(Fe[me]===N){Fe.splice(me,1),N.isRemoved=!0,N.removeAbortListener&&(N.removeAbortListener(),N.removeAbortListener=null),Fe.length===0&&(N.allRemoved=!0,N.target[ge]=null);break}}}if(N.allRemoved)return W.call(N.target,N.eventName,N.capture?p:m,N.options)},R=function(N){return K.call(V.target,V.eventName,N.invoke,V.options)},pe=function(N){return Te.call(V.target,V.eventName,N.invoke,V.options)},De=function(N){return W.call(N.target,N.eventName,N.invoke,N.options)},F=B?ee:R,U=B?k:De,M=function(N,oe){let ge=typeof oe;return ge==="function"&&N.callback===oe||ge==="object"&&N.originalDelegate===oe},P=S?.diff||M,se=Zone[at("UNPATCHED_EVENTS")],he=n[at("PASSIVE_EVENTS")];function Q(N){if(typeof N=="object"&&N!==null){let oe=Me({},N);return N.signal&&(oe.signal=N.signal),oe}return N}let j=function(N,oe,ge,Fe,me=!1,Ne=!1){return function(){let ke=this||n,fe=arguments[0];S&&S.transferEventName&&(fe=S.transferEventName(fe));let Xe=arguments[1];if(!Xe)return N.apply(this,arguments);if(Zc&&fe==="uncaughtException")return N.apply(this,arguments);let et=!1;if(typeof Xe!="function"){if(!Xe.handleEvent)return N.apply(this,arguments);et=!0}if(Z&&!Z(N,Xe,ke,arguments))return;let En=!!he&&he.indexOf(fe)!==-1,hn=Q(ie(arguments[2],En)),vi=hn?.signal;if(vi?.aborted)return;if(se){for(let Zn=0;Zn<se.length;Zn++)if(fe===se[Zn])return En?N.call(ke,fe,Xe,hn):N.apply(this,arguments)}let Ao=hn?typeof hn=="boolean"?!0:hn.capture:!1,Xn=hn&&typeof hn=="object"?hn.once:!1,Ss=Zone.current,Fo=pr[fe];Fo||(m_(fe,G),Fo=pr[fe]);let bs=Fo[Ao?yi:xi],Vn=ke[bs],Wc=!1;if(Vn){if(Wc=!0,ce){for(let Zn=0;Zn<Vn.length;Zn++)if(P(Vn[Zn],Xe))return}}else Vn=ke[bs]=[];let ko,Ga=ke.constructor.name,$a=d_[Ga];$a&&(ko=$a[fe]),ko||(ko=Ga+oe+(G?G(fe):fe)),V.options=hn,Xn&&(V.options.once=!1),V.target=ke,V.capture=Ao,V.eventName=fe,V.isExisting=Wc;let $i=B?E2:void 0;$i&&($i.taskData=V),vi&&(V.options.signal=void 0);let Un=Ss.scheduleEventTask(ko,Xe,$i,ge,Fe);if(vi){V.options.signal=vi;let Zn=()=>Un.zone.cancelTask(Un);N.call(vi,"abort",Zn,{once:!0}),Un.removeAbortListener=()=>vi.removeEventListener("abort",Zn)}if(V.target=null,$i&&($i.taskData=null),Xn&&(V.options.once=!0),typeof Un.options!="boolean"&&(Un.options=hn),Un.target=ke,Un.capture=Ao,Un.eventName=fe,et&&(Un.originalDelegate=Xe),Ne?Vn.unshift(Un):Vn.push(Un),me)return ke}};return L[i]=j(K,c,F,U,O),Te&&(L[u]=j(Te,f,pe,U,O,!0)),L[o]=function(){let N=this||n,oe=arguments[0];S&&S.transferEventName&&(oe=S.transferEventName(oe));let ge=arguments[2],Fe=ge?typeof ge=="boolean"?!0:ge.capture:!1,me=arguments[1];if(!me)return W.apply(this,arguments);if(Z&&!Z(W,me,N,arguments))return;let Ne=pr[oe],ke;Ne&&(ke=Ne[Fe?yi:xi]);let fe=ke&&N[ke];if(fe)for(let Xe=0;Xe<fe.length;Xe++){let et=fe[Xe];if(P(et,me)){if(fe.splice(Xe,1),et.isRemoved=!0,fe.length===0&&(et.allRemoved=!0,N[ke]=null,!Fe&&typeof oe=="string")){let En=Ya+"ON_PROPERTY"+oe;N[En]=null}return et.zone.cancelTask(et),O?N:void 0}}return W.apply(this,arguments)},L[s]=function(){let N=this||n,oe=arguments[0];S&&S.transferEventName&&(oe=S.transferEventName(oe));let ge=[],Fe=g_(N,G?G(oe):oe);for(let me=0;me<Fe.length;me++){let Ne=Fe[me],ke=Ne.originalDelegate?Ne.originalDelegate:Ne.callback;ge.push(ke)}return ge},L[a]=function(){let N=this||n,oe=arguments[0];if(oe){S&&S.transferEventName&&(oe=S.transferEventName(oe));let ge=pr[oe];if(ge){let Fe=ge[xi],me=ge[yi],Ne=N[Fe],ke=N[me];if(Ne){let fe=Ne.slice();for(let Xe=0;Xe<fe.length;Xe++){let et=fe[Xe],En=et.originalDelegate?et.originalDelegate:et.callback;this[o].call(this,oe,En,et.options)}}if(ke){let fe=ke.slice();for(let Xe=0;Xe<fe.length;Xe++){let et=fe[Xe],En=et.originalDelegate?et.originalDelegate:et.callback;this[o].call(this,oe,En,et.options)}}}}else{let ge=Object.keys(N);for(let Fe=0;Fe<ge.length;Fe++){let me=ge[Fe],Ne=h_.exec(me),ke=Ne&&Ne[1];ke&&ke!=="removeListener"&&this[a].call(this,ke)}this[a].call(this,"removeListener")}if(O)return this},Ti(L[i],K),Ti(L[o],W),Oe&&Ti(L[a],Oe),ue&&Ti(L[s],ue),!0}let w=[];for(let y=0;y<t.length;y++)w[y]=g(t[y],r);return w}function g_(n,e){if(!e){let o=[];for(let s in n){let a=h_.exec(s),l=a&&a[1];if(l&&(!e||l===e)){let c=n[s];if(c)for(let u=0;u<c.length;u++)o.push(c[u])}}return o}let t=pr[e];t||(m_(e),t=pr[e]);let r=n[t[xi]],i=n[t[yi]];return r?i?r.concat(i):r.slice():i?i.slice():[]}function w2(n,e){let t=n.Event;t&&t.prototype&&e.patchMethod(t.prototype,"stopImmediatePropagation",r=>function(i,o){i[p_]=!0,r&&r.apply(i,o)})}function C2(n,e){e.patchMethod(n,"queueMicrotask",t=>function(r,i){Zone.current.scheduleMicroTask("queueMicrotask",i[0])})}var Kc=at("zoneTask");function Is(n,e,t,r){let i=null,o=null;e+=r,t+=r;let s={};function a(c){let u=c.data;u.args[0]=function(){return c.invoke.apply(this,arguments)};let f=i.apply(n,u.args);return s_(f)?u.handleId=f:(u.handle=f,u.isRefreshable=o_(f.refresh)),c}function l(c){let{handle:u,handleId:f}=c.data;return o.call(n,u??f)}i=Ei(n,e,c=>function(u,f){if(o_(f[0])){let h={isRefreshable:!1,isPeriodic:r==="Interval",delay:r==="Timeout"||r==="Interval"?f[1]||0:void 0,args:f},d=f[0];f[0]=function(){try{return d.apply(this,arguments)}finally{let{handle:B,handleId:Z,isPeriodic:ce,isRefreshable:O}=h;!ce&&!O&&(Z?delete s[Z]:B&&(B[Kc]=null))}};let m=v0(e,f[0],h,a,l);if(!m)return m;let{handleId:p,handle:g,isRefreshable:w,isPeriodic:y}=m.data;if(p)s[p]=m;else if(g&&(g[Kc]=m,w&&!y)){let S=g.refresh;g.refresh=function(){let{zone:B,state:Z}=m;return Z==="notScheduled"?(m._state="scheduled",B._updateTaskCount(m,1)):Z==="running"&&(m._state="scheduling"),S.call(this)}}return g??p??m}else return c.apply(n,f)}),o=Ei(n,t,c=>function(u,f){let h=f[0],d;s_(h)?(d=s[h],delete s[h]):(d=h?.[Kc],d?h[Kc]=null:d=h),d?.type?d.cancelFn&&d.zone.cancelTask(d):c.apply(n,f)})}function D2(n,e){let{isBrowser:t,isMix:r}=e.getGlobalObjects();if(!t&&!r||!n.customElements||!("customElements"in n))return;let i=["connectedCallback","disconnectedCallback","adoptedCallback","attributeChangedCallback","formAssociatedCallback","formDisabledCallback","formResetCallback","formStateRestoreCallback"];e.patchCallbacks(e,n.customElements,"customElements","define",i)}function S2(n,e){if(Zone[e.symbol("patchEventTarget")])return;let{eventNames:t,zoneSymbolEventNames:r,TRUE_STR:i,FALSE_STR:o,ZONE_SYMBOL_PREFIX:s}=e.getGlobalObjects();for(let l=0;l<t.length;l++){let c=t[l],u=c+o,f=c+i,h=s+u,d=s+f;r[c]={},r[c][o]=h,r[c][i]=d}let a=n.EventTarget;if(!(!a||!a.prototype))return e.patchEventTarget(n,e,[a&&a.prototype]),!0}function b2(n,e){e.patchEventPrototype(n,e)}function v_(n,e,t){if(!t||t.length===0)return e;let r=t.filter(o=>o.target===n);if(r.length===0)return e;let i=r[0].ignoreProperties;return e.filter(o=>i.indexOf(o)===-1)}function a_(n,e,t,r){if(!n)return;let i=v_(n,e,t);f_(n,i,r)}function f0(n){return Object.getOwnPropertyNames(n).filter(e=>e.startsWith("on")&&e.length>2).map(e=>e.substring(2))}function I2(n,e){if(Zc&&!u_||Zone[n.symbol("patchEvents")])return;let t=e.__Zone_ignore_on_properties,r=[];if(y0){let i=window;r=r.concat(["Document","SVGElement","Element","HTMLElement","HTMLBodyElement","HTMLMediaElement","HTMLFrameSetElement","HTMLFrameElement","HTMLIFrameElement","HTMLMarqueeElement","Worker"]);let o=[];a_(i,f0(i),t&&t.concat(o),h0(i))}r=r.concat(["XMLHttpRequest","XMLHttpRequestEventTarget","IDBIndex","IDBRequest","IDBOpenDBRequest","IDBDatabase","IDBTransaction","IDBCursor","WebSocket"]);for(let i=0;i<r.length;i++){let o=e[r[i]];o?.prototype&&a_(o.prototype,f0(o.prototype),t)}}function A2(n){n.__load_patch("legacy",e=>{let t=e[n.__symbol__("legacyPatch")];t&&t()}),n.__load_patch("timers",e=>{let t="set",r="clear";Is(e,t,r,"Timeout"),Is(e,t,r,"Interval"),Is(e,t,r,"Immediate")}),n.__load_patch("requestAnimationFrame",e=>{Is(e,"request","cancel","AnimationFrame"),Is(e,"mozRequest","mozCancel","AnimationFrame"),Is(e,"webkitRequest","webkitCancel","AnimationFrame")}),n.__load_patch("blocking",(e,t)=>{let r=["alert","prompt","confirm"];for(let i=0;i<r.length;i++){let o=r[i];Ei(e,o,(s,a,l)=>function(c,u){return t.current.run(s,e,u,l)})}}),n.__load_patch("EventTarget",(e,t,r)=>{b2(e,r),S2(e,r);let i=e.XMLHttpRequestEventTarget;i&&i.prototype&&r.patchEventTarget(e,r,[i.prototype])}),n.__load_patch("MutationObserver",(e,t,r)=>{qa("MutationObserver"),qa("WebKitMutationObserver")}),n.__load_patch("IntersectionObserver",(e,t,r)=>{qa("IntersectionObserver")}),n.__load_patch("FileReader",(e,t,r)=>{qa("FileReader")}),n.__load_patch("on_property",(e,t,r)=>{I2(r,e)}),n.__load_patch("customElements",(e,t,r)=>{D2(e,r)}),n.__load_patch("XHR",(e,t)=>{c(e);let r=at("xhrTask"),i=at("xhrSync"),o=at("xhrListener"),s=at("xhrScheduled"),a=at("xhrURL"),l=at("xhrErrorBeforeScheduled");function c(u){let f=u.XMLHttpRequest;if(!f)return;let h=f.prototype;function d(K){return K[r]}let m=h[l0],p=h[c0];if(!m){let K=u.XMLHttpRequestEventTarget;if(K){let W=K.prototype;m=W[l0],p=W[c0]}}let g="readystatechange",w="scheduled";function y(K){let W=K.data,ue=W.target;ue[s]=!1,ue[l]=!1;let Oe=ue[o];m||(m=ue[l0],p=ue[c0]),Oe&&p.call(ue,g,Oe);let Te=ue[o]=()=>{if(ue.readyState===ue.DONE)if(!W.aborted&&ue[s]&&K.state===w){let ee=ue[t.__symbol__("loadfalse")];if(ue.status!==0&&ee&&ee.length>0){let k=K.invoke;K.invoke=function(){let R=ue[t.__symbol__("loadfalse")];for(let pe=0;pe<R.length;pe++)R[pe]===K&&R.splice(pe,1);!W.aborted&&K.state===w&&k.call(K)},ee.push(K)}else K.invoke()}else!W.aborted&&ue[s]===!1&&(ue[l]=!0)};return m.call(ue,g,Te),ue[r]||(ue[r]=K),G.apply(ue,W.args),ue[s]=!0,K}function S(){}function B(K){let W=K.data;return W.aborted=!0,V.apply(W.target,W.args)}let Z=Ei(h,"open",()=>function(K,W){return K[i]=W[2]==!1,K[a]=W[1],Z.apply(K,W)}),ce="XMLHttpRequest.send",O=at("fetchTaskAborting"),L=at("fetchTaskScheduling"),G=Ei(h,"send",()=>function(K,W){if(t.current[L]===!0||K[i])return G.apply(K,W);{let ue={target:K,url:K[a],isPeriodic:!1,args:W,aborted:!1},Oe=v0(ce,S,ue,y,B);K&&K[l]===!0&&!ue.aborted&&Oe.state===w&&Oe.invoke()}}),V=Ei(h,"abort",()=>function(K,W){let ue=d(K);if(ue&&typeof ue.type=="string"){if(ue.cancelFn==null||ue.data&&ue.data.aborted)return;ue.zone.cancelTask(ue)}else if(t.current[O]===!0)return V.apply(K,W)})}}),n.__load_patch("geolocation",e=>{e.navigator&&e.navigator.geolocation&&v2(e.navigator.geolocation,["getCurrentPosition","watchPosition"])}),n.__load_patch("PromiseRejectionEvent",(e,t)=>{function r(i){return function(o){g_(e,i).forEach(a=>{let l=e.PromiseRejectionEvent;if(l){let c=new l(i,{promise:o.promise,reason:o.rejection});a.invoke(c)}})}}e.PromiseRejectionEvent&&(t[at("unhandledPromiseRejectionHandler")]=r("unhandledrejection"),t[at("rejectionHandledHandler")]=r("rejectionhandled"))}),n.__load_patch("queueMicrotask",(e,t,r)=>{C2(e,r)})}function F2(n){n.__load_patch("ZoneAwarePromise",(e,t,r)=>{let i=Object.getOwnPropertyDescriptor,o=Object.defineProperty;function s(Q){if(Q&&Q.toString===Object.prototype.toString){let j=Q.constructor&&Q.constructor.name;return(j||"")+": "+JSON.stringify(Q)}return Q?Q.toString():Object.prototype.toString.call(Q)}let a=r.symbol,l=[],c=e[a("DISABLE_WRAPPING_UNCAUGHT_PROMISE_REJECTION")]!==!1,u=a("Promise"),f=a("then"),h="__creationTrace__";r.onUnhandledError=Q=>{if(r.showUncaughtError()){let j=Q&&Q.rejection;j?console.error("Unhandled Promise rejection:",j instanceof Error?j.message:j,"; Zone:",Q.zone.name,"; Task:",Q.task&&Q.task.source,"; Value:",j,j instanceof Error?j.stack:void 0):console.error(Q)}},r.microtaskDrainDone=()=>{for(;l.length;){let Q=l.shift();try{Q.zone.runGuarded(()=>{throw Q.throwOriginal?Q.rejection:Q})}catch(j){m(j)}}};let d=a("unhandledPromiseRejectionHandler");function m(Q){r.onUnhandledError(Q);try{let j=t[d];typeof j=="function"&&j.call(this,Q)}catch{}}function p(Q){return Q&&typeof Q.then=="function"}function g(Q){return Q}function w(Q){return U.reject(Q)}let y=a("state"),S=a("value"),B=a("finally"),Z=a("parentPromiseValue"),ce=a("parentPromiseState"),O="Promise.then",L=null,G=!0,V=!1,K=0;function W(Q,j){return N=>{try{ie(Q,j,N)}catch(oe){ie(Q,!1,oe)}}}let ue=function(){let Q=!1;return function(N){return function(){Q||(Q=!0,N.apply(null,arguments))}}},Oe="Promise resolved with itself",Te=a("currentTaskTrace");function ie(Q,j,N){let oe=ue();if(Q===N)throw new TypeError(Oe);if(Q[y]===L){let ge=null;try{(typeof N=="object"||typeof N=="function")&&(ge=N&&N.then)}catch(Fe){return oe(()=>{ie(Q,!1,Fe)})(),Q}if(j!==V&&N instanceof U&&N.hasOwnProperty(y)&&N.hasOwnProperty(S)&&N[y]!==L)k(N),ie(Q,N[y],N[S]);else if(j!==V&&typeof ge=="function")try{ge.call(N,oe(W(Q,j)),oe(W(Q,!1)))}catch(Fe){oe(()=>{ie(Q,!1,Fe)})()}else{Q[y]=j;let Fe=Q[S];if(Q[S]=N,Q[B]===B&&j===G&&(Q[y]=Q[ce],Q[S]=Q[Z]),j===V&&N instanceof Error){let me=t.currentTask&&t.currentTask.data&&t.currentTask.data[h];me&&o(N,Te,{configurable:!0,enumerable:!1,writable:!0,value:me})}for(let me=0;me<Fe.length;)R(Q,Fe[me++],Fe[me++],Fe[me++],Fe[me++]);if(Fe.length==0&&j==V){Q[y]=K;let me=N;try{throw new Error("Uncaught (in promise): "+s(N)+(N&&N.stack?`
`+N.stack:""))}catch(Ne){me=Ne}c&&(me.throwOriginal=!0),me.rejection=N,me.promise=Q,me.zone=t.current,me.task=t.currentTask,l.push(me),r.scheduleMicroTask()}}}return Q}let ee=a("rejectionHandledHandler");function k(Q){if(Q[y]===K){try{let j=t[ee];j&&typeof j=="function"&&j.call(this,{rejection:Q[S],promise:Q})}catch{}Q[y]=V;for(let j=0;j<l.length;j++)Q===l[j].promise&&l.splice(j,1)}}function R(Q,j,N,oe,ge){k(Q);let Fe=Q[y],me=Fe?typeof oe=="function"?oe:g:typeof ge=="function"?ge:w;j.scheduleMicroTask(O,()=>{try{let Ne=Q[S],ke=!!N&&B===N[B];ke&&(N[Z]=Ne,N[ce]=Fe);let fe=j.run(me,void 0,ke&&me!==w&&me!==g?[]:[Ne]);ie(N,!0,fe)}catch(Ne){ie(N,!1,Ne)}},N)}let pe="function ZoneAwarePromise() { [native code] }",De=function(){},F=e.AggregateError;class U{static toString(){return pe}static resolve(j){return j instanceof U?j:ie(new this(null),G,j)}static reject(j){return ie(new this(null),V,j)}static withResolvers(){let j={};return j.promise=new U((N,oe)=>{j.resolve=N,j.reject=oe}),j}static any(j){if(!j||typeof j[Symbol.iterator]!="function")return Promise.reject(new F([],"All promises were rejected"));let N=[],oe=0;try{for(let me of j)oe++,N.push(U.resolve(me))}catch{return Promise.reject(new F([],"All promises were rejected"))}if(oe===0)return Promise.reject(new F([],"All promises were rejected"));let ge=!1,Fe=[];return new U((me,Ne)=>{for(let ke=0;ke<N.length;ke++)N[ke].then(fe=>{ge||(ge=!0,me(fe))},fe=>{Fe.push(fe),oe--,oe===0&&(ge=!0,Ne(new F(Fe,"All promises were rejected")))})})}static race(j){let N,oe,ge=new this((Ne,ke)=>{N=Ne,oe=ke});function Fe(Ne){N(Ne)}function me(Ne){oe(Ne)}for(let Ne of j)p(Ne)||(Ne=this.resolve(Ne)),Ne.then(Fe,me);return ge}static all(j){return U.allWithCallback(j)}static allSettled(j){return(this&&this.prototype instanceof U?this:U).allWithCallback(j,{thenCallback:oe=>({status:"fulfilled",value:oe}),errorCallback:oe=>({status:"rejected",reason:oe})})}static allWithCallback(j,N){let oe,ge,Fe=new this((fe,Xe)=>{oe=fe,ge=Xe}),me=2,Ne=0,ke=[];for(let fe of j){p(fe)||(fe=this.resolve(fe));let Xe=Ne;try{fe.then(et=>{ke[Xe]=N?N.thenCallback(et):et,me--,me===0&&oe(ke)},et=>{N?(ke[Xe]=N.errorCallback(et),me--,me===0&&oe(ke)):ge(et)})}catch(et){ge(et)}me++,Ne++}return me-=2,me===0&&oe(ke),Fe}constructor(j){let N=this;if(!(N instanceof U))throw new Error("Must be an instanceof Promise.");N[y]=L,N[S]=[];try{let oe=ue();j&&j(oe(W(N,G)),oe(W(N,V)))}catch(oe){ie(N,!1,oe)}}get[Symbol.toStringTag](){return"Promise"}get[Symbol.species](){return U}then(j,N){let oe=this.constructor?.[Symbol.species];(!oe||typeof oe!="function")&&(oe=this.constructor||U);let ge=new oe(De),Fe=t.current;return this[y]==L?this[S].push(Fe,ge,j,N):R(this,Fe,ge,j,N),ge}catch(j){return this.then(null,j)}finally(j){let N=this.constructor?.[Symbol.species];(!N||typeof N!="function")&&(N=U);let oe=new N(De);oe[B]=B;let ge=t.current;return this[y]==L?this[S].push(ge,oe,j,j):R(this,ge,oe,j,j),oe}}U.resolve=U.resolve,U.reject=U.reject,U.race=U.race,U.all=U.all;let M=e[u]=e.Promise;e.Promise=U;let P=a("thenPatched");function se(Q){let j=Q.prototype,N=i(j,"then");if(N&&(N.writable===!1||!N.configurable))return;let oe=j.then;j[f]=oe,Q.prototype.then=function(ge,Fe){return new U((Ne,ke)=>{oe.call(this,Ne,ke)}).then(ge,Fe)},Q[P]=!0}r.patchThen=se;function he(Q){return function(j,N){let oe=Q.apply(j,N);if(oe instanceof U)return oe;let ge=oe.constructor;return ge[P]||se(ge),oe}}return M&&(se(M),Ei(e,"fetch",Q=>he(Q))),Promise[t.__symbol__("uncaughtPromiseErrors")]=l,U})}function k2(n){n.__load_patch("toString",e=>{let t=Function.prototype.toString,r=at("OriginalDelegate"),i=at("Promise"),o=at("Error"),s=function(){if(typeof this=="function"){let u=this[r];if(u)return typeof u=="function"?t.call(u):Object.prototype.toString.call(u);if(this===Promise){let f=e[i];if(f)return t.call(f)}if(this===Error){let f=e[o];if(f)return t.call(f)}}return t.call(this)};s[r]=t,Function.prototype.toString=s;let a=Object.prototype.toString,l="[object Promise]";Object.prototype.toString=function(){return typeof Promise=="function"&&this instanceof Promise?l:a.call(this)}})}function N2(n,e,t,r,i){let o=Zone.__symbol__(r);if(e[o])return;let s=e[o]=e[r];e[r]=function(a,l,c){return l&&l.prototype&&i.forEach(function(u){let f=`${t}.${r}::`+u,h=l.prototype;try{if(h.hasOwnProperty(u)){let d=n.ObjectGetOwnPropertyDescriptor(h,u);d&&d.value?(d.value=n.wrapWithCurrentZone(d.value,f),n._redefineProperty(l.prototype,u,d)):h[u]&&(h[u]=n.wrapWithCurrentZone(h[u],f))}else h[u]&&(h[u]=n.wrapWithCurrentZone(h[u],f))}catch{}}),s.call(e,a,l,c)},n.attachOriginToPatched(e[r],s)}function M2(n){n.__load_patch("util",(e,t,r)=>{let i=f0(e);r.patchOnProperties=f_,r.patchMethod=Ei,r.bindArguments=_0,r.patchMacroTask=y2;let o=t.__symbol__("BLACK_LISTED_EVENTS"),s=t.__symbol__("UNPATCHED_EVENTS");e[s]&&(e[o]=e[s]),e[o]&&(t[o]=t[s]=e[o]),r.patchEventPrototype=w2,r.patchEventTarget=T2,r.isIEOrEdge=x2,r.ObjectDefineProperty=d0,r.ObjectGetOwnPropertyDescriptor=Ka,r.ObjectCreate=p2,r.ArraySlice=m2,r.patchClass=qa,r.wrapWithCurrentZone=g0,r.filterProperties=v_,r.attachOriginToPatched=Ti,r._redefineProperty=Object.defineProperty,r.patchCallbacks=N2,r.getGlobalObjects=()=>({globalSources:d_,zoneSymbolEventNames:pr,eventNames:i,isBrowser:y0,isMix:u_,isNode:Zc,TRUE_STR:yi,FALSE_STR:xi,ZONE_SYMBOL_PREFIX:Ya,ADD_EVENT_LISTENER_STR:p0,REMOVE_EVENT_LISTENER_STR:m0})})}function O2(n){F2(n),k2(n),M2(n)}var __=h2();O2(__);A2(__);var x0;function E0(){return x0}function wi(n){let e=x0;return x0=n,e}var R2=Symbol("NotFound"),Qc=class extends Error{name="\u0275NotFound";constructor(e){super(e)}};function As(n){return n===R2||n?.name==="\u0275NotFound"}function ru(n,e){return Object.is(n,e)}var Zt=null,Jc=!1,T0=1,P2=null,Nn=Symbol("SIGNAL");function Le(n){let e=Zt;return Zt=n,e}function iu(){return Zt}var Mo={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Fs(n){if(Jc)throw new Error("");if(Zt===null)return;Zt.consumerOnSignalRead(n);let e=Zt.nextProducerIndex++;if(lu(Zt),e<Zt.producerNode.length&&Zt.producerNode[e]!==n&&Qa(Zt)){let t=Zt.producerNode[e];au(t,Zt.producerIndexOfThis[e])}Zt.producerNode[e]!==n&&(Zt.producerNode[e]=n,Zt.producerIndexOfThis[e]=Qa(Zt)?x_(n,Zt,e):0),Zt.producerLastReadVersion[e]=n.version}function y_(){T0++}function ou(n){if(!(Qa(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===T0)){if(!n.producerMustRecompute(n)&&!Ja(n)){nu(n);return}n.producerRecomputeValue(n),nu(n)}}function w0(n){if(n.liveConsumerNode===void 0)return;let e=Jc;Jc=!0;try{for(let t of n.liveConsumerNode)t.dirty||L2(t)}finally{Jc=e}}function C0(){return Zt?.consumerAllowSignalWrites!==!1}function L2(n){n.dirty=!0,w0(n),n.consumerMarkedDirty?.(n)}function nu(n){n.dirty=!1,n.lastCleanEpoch=T0}function Oo(n){return n&&(n.nextProducerIndex=0),Le(n)}function ks(n,e){if(Le(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(Qa(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)au(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function Ja(n){lu(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(ou(t),r!==t.version))return!0}return!1}function su(n){if(lu(n),Qa(n))for(let e=0;e<n.producerNode.length;e++)au(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function x_(n,e,t){if(E_(n),n.liveConsumerNode.length===0&&T_(n))for(let r=0;r<n.producerNode.length;r++)n.producerIndexOfThis[r]=x_(n.producerNode[r],n,r);return n.liveConsumerIndexOfThis.push(t),n.liveConsumerNode.push(e)-1}function au(n,e){if(E_(n),n.liveConsumerNode.length===1&&T_(n))for(let r=0;r<n.producerNode.length;r++)au(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];lu(i),i.producerIndexOfThis[r]=e}}function Qa(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function lu(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function E_(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function T_(n){return n.producerNode!==void 0}function cu(n){P2?.(n)}function uu(n,e){let t=Object.create(B2);t.computation=n,e!==void 0&&(t.equal=e);let r=()=>{if(ou(t),Fs(t),t.value===Za)throw t.error;return t.value};return r[Nn]=t,cu(t),r}var eu=Symbol("UNSET"),tu=Symbol("COMPUTING"),Za=Symbol("ERRORED"),B2=tt(Me({},Mo),{value:eu,dirty:!0,error:null,equal:ru,kind:"computed",producerMustRecompute(n){return n.value===eu||n.value===tu},producerRecomputeValue(n){if(n.value===tu)throw new Error("");let e=n.value;n.value=tu;let t=Oo(n),r,i=!1;try{r=n.computation(),Le(null),i=e!==eu&&e!==Za&&r!==Za&&n.equal(e,r)}catch(o){r=Za,n.error=o}finally{ks(n,t)}if(i){n.value=e;return}n.value=r,n.version++}});function V2(){throw new Error}var w_=V2;function C_(n){w_(n)}function D0(n){w_=n}var U2=null;function S0(n,e){let t=Object.create(fu);t.value=n,e!==void 0&&(t.equal=e);let r=()=>D_(t);return r[Nn]=t,cu(t),[r,s=>Ns(t,s),s=>b0(t,s)]}function D_(n){return Fs(n),n.value}function Ns(n,e){C0()||C_(n),n.equal(n.value,e)||(n.value=e,j2(n))}function b0(n,e){C0()||C_(n),Ns(n,e(n.value))}var fu=tt(Me({},Mo),{equal:ru,value:void 0,kind:"signal"});function j2(n){n.version++,y_(),w0(n),U2?.(n)}function je(n){return typeof n=="function"}function du(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var hu=du(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Ro(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var Qt=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(je(r))try{r()}catch(o){e=o instanceof hu?o.errors:[o]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let o of i)try{S_(o)}catch(s){e=e??[],s instanceof hu?e=[...e,...s.errors]:e.push(s)}}if(e)throw new hu(e)}}add(e){var t;if(e&&e!==this)if(this.closed)S_(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Ro(t,e)}remove(e){let{_finalizers:t}=this;t&&Ro(t,e),e instanceof n&&e._removeParent(this)}};Qt.EMPTY=(()=>{let n=new Qt;return n.closed=!0,n})();var I0=Qt.EMPTY;function pu(n){return n instanceof Qt||n&&"closed"in n&&je(n.remove)&&je(n.add)&&je(n.unsubscribe)}function S_(n){je(n)?n():n.unsubscribe()}var kr={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Ms={setTimeout(n,e,...t){let{delegate:r}=Ms;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Ms;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function mu(n){Ms.setTimeout(()=>{let{onUnhandledError:e}=kr;if(e)e(n);else throw n})}function el(){}var b_=A0("C",void 0,void 0);function I_(n){return A0("E",void 0,n)}function A_(n){return A0("N",n,void 0)}function A0(n,e,t){return{kind:n,value:e,error:t}}var Po=null;function Os(n){if(kr.useDeprecatedSynchronousErrorHandling){let e=!Po;if(e&&(Po={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=Po;if(Po=null,t)throw r}}else n()}function F_(n){kr.useDeprecatedSynchronousErrorHandling&&Po&&(Po.errorThrown=!0,Po.error=n)}var Lo=class extends Qt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,pu(e)&&e.add(this)):this.destination=$2}static create(e,t,r){return new Rs(e,t,r)}next(e){this.isStopped?k0(A_(e),this):this._next(e)}error(e){this.isStopped?k0(I_(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?k0(b_,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},H2=Function.prototype.bind;function F0(n,e){return H2.call(n,e)}var N0=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){gu(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){gu(r)}else gu(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){gu(t)}}},Rs=class extends Lo{constructor(e,t,r){super();let i;if(je(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let o;this&&kr.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&F0(e.next,o),error:e.error&&F0(e.error,o),complete:e.complete&&F0(e.complete,o)}):i=e}this.destination=new N0(i)}};function gu(n){kr.useDeprecatedSynchronousErrorHandling?F_(n):mu(n)}function G2(n){throw n}function k0(n,e){let{onStoppedNotification:t}=kr;t&&Ms.setTimeout(()=>t(n,e))}var $2={closed:!0,next:el,error:G2,complete:el};var Ps=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Ci(n){return n}function k_(n){return n.length===0?Ci:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var ct=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let o=z2(t)?t:new Rs(t,r,i);return Os(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=N_(r),new r((i,o)=>{let s=new Rs({next:a=>{try{t(a)}catch(l){o(l),s.unsubscribe()}},error:o,complete:i});this.subscribe(s)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[Ps](){return this}pipe(...t){return k_(t)(this)}toPromise(t){return t=N_(t),new t((r,i)=>{let o;this.subscribe(s=>o=s,s=>i(s),()=>r(o))})}}return n.create=e=>new n(e),n})();function N_(n){var e;return(e=n??kr.Promise)!==null&&e!==void 0?e:Promise}function W2(n){return n&&je(n.next)&&je(n.error)&&je(n.complete)}function z2(n){return n&&n instanceof Lo||W2(n)&&pu(n)}function q2(n){return je(n?.lift)}function Ut(n){return e=>{if(q2(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Ft(n,e,t,r,i){return new M0(n,e,t,r,i)}var M0=class extends Lo{constructor(e,t,r,i,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=i?function(a){try{i(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};var Ls={schedule(n){let e=requestAnimationFrame,t=cancelAnimationFrame,{delegate:r}=Ls;r&&(e=r.requestAnimationFrame,t=r.cancelAnimationFrame);let i=e(o=>{t=void 0,n(o)});return new Qt(()=>t?.(i))},requestAnimationFrame(...n){let{delegate:e}=Ls;return(e?.requestAnimationFrame||requestAnimationFrame)(...n)},cancelAnimationFrame(...n){let{delegate:e}=Ls;return(e?.cancelAnimationFrame||cancelAnimationFrame)(...n)},delegate:void 0};var M_=du(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var St=(()=>{class n extends ct{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new vu(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new M_}next(t){Os(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){Os(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){Os(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:o}=this;return r||i?I0:(this.currentObservers=null,o.push(t),new Qt(()=>{this.currentObservers=null,Ro(o,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:o}=this;r?t.error(i):o&&t.complete()}asObservable(){let t=new ct;return t.source=this,t}}return n.create=(e,t)=>new vu(e,t),n})(),vu=class extends St{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:I0}};var tl=class extends St{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var O0={now(){return(O0.delegate||Date).now()},delegate:void 0};var _u=class extends Qt{constructor(e,t){super()}schedule(e,t=0){return this}};var nl={setInterval(n,e,...t){let{delegate:r}=nl;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=nl;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var Wi=class extends _u{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;let i=this.id,o=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(o,i,t)),this.pending=!0,this.delay=t,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,r=0){return nl.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return t;t!=null&&nl.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,t);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r=!1,i;try{this.work(e)}catch(o){r=!0,i=o||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Ro(r,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var K2=1,R0,P0={};function O_(n){return n in P0?(delete P0[n],!0):!1}var R_={setImmediate(n){let e=K2++;return P0[e]=!0,R0||(R0=Promise.resolve()),R0.then(()=>O_(e)&&n()),e},clearImmediate(n){O_(n)}};var{setImmediate:Y2,clearImmediate:X2}=R_,rl={setImmediate(...n){let{delegate:e}=rl;return(e?.setImmediate||Y2)(...n)},clearImmediate(n){let{delegate:e}=rl;return(e?.clearImmediate||X2)(n)},delegate:void 0};var yu=class extends Wi{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,r=0){return r!==null&&r>0?super.requestAsyncId(e,t,r):(e.actions.push(this),e._scheduled||(e._scheduled=rl.setImmediate(e.flush.bind(e,void 0))))}recycleAsyncId(e,t,r=0){var i;if(r!=null?r>0:this.delay>0)return super.recycleAsyncId(e,t,r);let{actions:o}=e;t!=null&&((i=o[o.length-1])===null||i===void 0?void 0:i.id)!==t&&(rl.clearImmediate(t),e._scheduled===t&&(e._scheduled=void 0))}};var Bs=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}};Bs.now=O0.now;var zi=class extends Bs{constructor(e,t=Bs.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}};var xu=class extends zi{flush(e){this._active=!0;let t=this._scheduled;this._scheduled=void 0;let{actions:r}=this,i;e=e||r.shift();do if(i=e.execute(e.state,e.delay))break;while((e=r[0])&&e.id===t&&r.shift());if(this._active=!1,i){for(;(e=r[0])&&e.id===t&&r.shift();)e.unsubscribe();throw i}}};var L0=new xu(yu);var il=new zi(Wi),P_=il;var Eu=class extends Wi{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,r=0){return r!==null&&r>0?super.requestAsyncId(e,t,r):(e.actions.push(this),e._scheduled||(e._scheduled=Ls.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,t,r=0){var i;if(r!=null?r>0:this.delay>0)return super.recycleAsyncId(e,t,r);let{actions:o}=e;t!=null&&t===e._scheduled&&((i=o[o.length-1])===null||i===void 0?void 0:i.id)!==t&&(Ls.cancelAnimationFrame(t),e._scheduled=void 0)}};var Tu=class extends zi{flush(e){this._active=!0;let t;e?t=e.id:(t=this._scheduled,this._scheduled=void 0);let{actions:r}=this,i;e=e||r.shift();do if(i=e.execute(e.state,e.delay))break;while((e=r[0])&&e.id===t&&r.shift());if(this._active=!1,i){for(;(e=r[0])&&e.id===t&&r.shift();)e.unsubscribe();throw i}}};var B0=new Tu(Eu);var L_=new ct(n=>n.complete());function wu(n){return n&&je(n.schedule)}function V0(n){return n[n.length-1]}function Cu(n){return je(V0(n))?n.pop():void 0}function qi(n){return wu(V0(n))?n.pop():void 0}function B_(n,e){return typeof V0(n)=="number"?n.pop():e}function U_(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(f){s(f)}}function l(u){try{c(r.throw(u))}catch(f){s(f)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(n,e||[])).next())})}function V_(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Bo(n){return this instanceof Bo?(this.v=n,this):new Bo(n)}function j_(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),i[Symbol.asyncIterator]=function(){return this},i;function s(d){return function(m){return Promise.resolve(m).then(d,f)}}function a(d,m){r[d]&&(i[d]=function(p){return new Promise(function(g,w){o.push([d,p,g,w])>1||l(d,p)})},m&&(i[d]=m(i[d])))}function l(d,m){try{c(r[d](m))}catch(p){h(o[0][3],p)}}function c(d){d.value instanceof Bo?Promise.resolve(d.value.v).then(u,f):h(o[0][2],d)}function u(d){l("next",d)}function f(d){l("throw",d)}function h(d,m){d(m),o.shift(),o.length&&l(o[0][0],o[0][1])}}function H_(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof V_=="function"?V_(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(s){return new Promise(function(a,l){s=n[o](s),i(a,l,s.done,s.value)})}}function i(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}}var Vs=n=>n&&typeof n.length=="number"&&typeof n!="function";function Du(n){return je(n?.then)}function Su(n){return je(n[Ps])}function bu(n){return Symbol.asyncIterator&&je(n?.[Symbol.asyncIterator])}function Iu(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function Z2(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Au=Z2();function Fu(n){return je(n?.[Au])}function ku(n){return j_(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield Bo(t.read());if(i)return yield Bo(void 0);yield yield Bo(r)}}finally{t.releaseLock()}})}function Nu(n){return je(n?.getReader)}function jt(n){if(n instanceof ct)return n;if(n!=null){if(Su(n))return Q2(n);if(Vs(n))return J2(n);if(Du(n))return eI(n);if(bu(n))return G_(n);if(Fu(n))return tI(n);if(Nu(n))return nI(n)}throw Iu(n)}function Q2(n){return new ct(e=>{let t=n[Ps]();if(je(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function J2(n){return new ct(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function eI(n){return new ct(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,mu)})}function tI(n){return new ct(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function G_(n){return new ct(e=>{rI(n,e).catch(t=>e.error(t))})}function nI(n){return G_(ku(n))}function rI(n,e){var t,r,i,o;return U_(this,void 0,void 0,function*(){try{for(t=H_(n);r=yield t.next(),!r.done;){let s=r.value;if(e.next(s),e.closed)return}}catch(s){i={error:s}}finally{try{r&&!r.done&&(o=t.return)&&(yield o.call(t))}finally{if(i)throw i.error}}e.complete()})}function Hn(n,e,t,r=0,i=!1){let o=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(o),!i)return o}function Mu(n,e=0){return Ut((t,r)=>{t.subscribe(Ft(r,i=>Hn(r,n,()=>r.next(i),e),()=>Hn(r,n,()=>r.complete(),e),i=>Hn(r,n,()=>r.error(i),e)))})}function Ou(n,e=0){return Ut((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function $_(n,e){return jt(n).pipe(Ou(e),Mu(e))}function W_(n,e){return jt(n).pipe(Ou(e),Mu(e))}function z_(n,e){return new ct(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function q_(n,e){return new ct(t=>{let r;return Hn(t,e,()=>{r=n[Au](),Hn(t,e,()=>{let i,o;try{({value:i,done:o}=r.next())}catch(s){t.error(s);return}o?t.complete():t.next(i)},0,!0)}),()=>je(r?.return)&&r.return()})}function Ru(n,e){if(!n)throw new Error("Iterable cannot be null");return new ct(t=>{Hn(t,e,()=>{let r=n[Symbol.asyncIterator]();Hn(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function K_(n,e){return Ru(ku(n),e)}function Y_(n,e){if(n!=null){if(Su(n))return $_(n,e);if(Vs(n))return z_(n,e);if(Du(n))return W_(n,e);if(bu(n))return Ru(n,e);if(Fu(n))return q_(n,e);if(Nu(n))return K_(n,e)}throw Iu(n)}function Xr(n,e){return e?Y_(n,e):jt(n)}function X_(n){return n instanceof Date&&!isNaN(n)}function Nr(n,e){return Ut((t,r)=>{let i=0;t.subscribe(Ft(r,o=>{r.next(n.call(e,o,i++))}))})}var{isArray:iI}=Array;function oI(n,e){return iI(e)?n(...e):n(e)}function Us(n){return Nr(e=>oI(n,e))}var{isArray:sI}=Array,{getPrototypeOf:aI,prototype:lI,keys:cI}=Object;function Pu(n){if(n.length===1){let e=n[0];if(sI(e))return{args:e,keys:null};if(uI(e)){let t=cI(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function uI(n){return n&&typeof n=="object"&&aI(n)===lI}function Lu(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function ol(...n){let e=qi(n),t=Cu(n),{args:r,keys:i}=Pu(n);if(r.length===0)return Xr([],e);let o=new ct(fI(r,e,i?s=>Lu(i,s):Ci));return t?o.pipe(Us(t)):o}function fI(n,e,t=Ci){return r=>{Z_(e,()=>{let{length:i}=n,o=new Array(i),s=i,a=i;for(let l=0;l<i;l++)Z_(e,()=>{let c=Xr(n[l],e),u=!1;c.subscribe(Ft(r,f=>{o[l]=f,u||(u=!0,a--),a||r.next(t(o.slice()))},()=>{--s||r.complete()}))},r)},r)}}function Z_(n,e,t){n?Hn(t,n,e):e()}function Q_(n,e,t,r,i,o,s,a){let l=[],c=0,u=0,f=!1,h=()=>{f&&!l.length&&!c&&e.complete()},d=p=>c<r?m(p):l.push(p),m=p=>{o&&e.next(p),c++;let g=!1;jt(t(p,u++)).subscribe(Ft(e,w=>{i?.(w),o?d(w):e.next(w)},()=>{g=!0},void 0,()=>{if(g)try{for(c--;l.length&&c<r;){let w=l.shift();s?Hn(e,s,()=>m(w)):m(w)}h()}catch(w){e.error(w)}}))};return n.subscribe(Ft(e,d,()=>{f=!0,h()})),()=>{a?.()}}function sl(n,e,t=1/0){return je(e)?sl((r,i)=>Nr((o,s)=>e(r,o,i,s))(jt(n(r,i))),t):(typeof e=="number"&&(t=e),Ut((r,i)=>Q_(r,i,n,t)))}function Bu(n=1/0){return sl(Ci,n)}function J_(){return Bu(1)}function U0(...n){return J_()(Xr(n,qi(n)))}function j0(...n){let e=Cu(n),{args:t,keys:r}=Pu(n),i=new ct(o=>{let{length:s}=t;if(!s){o.complete();return}let a=new Array(s),l=s,c=s;for(let u=0;u<s;u++){let f=!1;jt(t[u]).subscribe(Ft(o,h=>{f||(f=!0,c--),a[u]=h},()=>l--,void 0,()=>{(!l||!f)&&(c||o.next(r?Lu(r,a):a),o.complete())}))}});return e?i.pipe(Us(e)):i}var dI=["addListener","removeListener"],hI=["addEventListener","removeEventListener"],pI=["on","off"];function Ki(n,e,t,r){if(je(t)&&(r=t,t=void 0),r)return Ki(n,e,t).pipe(Us(r));let[i,o]=vI(n)?hI.map(s=>a=>n[s](e,a,t)):mI(n)?dI.map(ey(n,e)):gI(n)?pI.map(ey(n,e)):[];if(!i&&Vs(n))return sl(s=>Ki(s,e,t))(jt(n));if(!i)throw new TypeError("Invalid event target");return new ct(s=>{let a=(...l)=>s.next(1<l.length?l:l[0]);return i(a),()=>o(a)})}function ey(n,e){return t=>r=>n[t](e,r)}function mI(n){return je(n.addListener)&&je(n.removeListener)}function gI(n){return je(n.on)&&je(n.off)}function vI(n){return je(n.addEventListener)&&je(n.removeEventListener)}function ty(n=0,e,t=P_){let r=-1;return e!=null&&(wu(e)?t=e:r=e),new ct(i=>{let o=X_(n)?+n-t.now():n;o<0&&(o=0);let s=0;return t.schedule(function(){i.closed||(i.next(s++),0<=r?this.schedule(void 0,r):i.complete())},o)})}function al(...n){let e=qi(n),t=B_(n,1/0),r=n;return r.length?r.length===1?jt(r[0]):Bu(t)(Xr(r,e)):L_}function H0(n,e){return Ut((t,r)=>{let i=0;t.subscribe(Ft(r,o=>n.call(e,o,i++)&&r.next(o)))})}function ny(n){return Ut((e,t)=>{let r=!1,i=null,o=null,s=!1,a=()=>{if(o?.unsubscribe(),o=null,r){r=!1;let c=i;i=null,t.next(c)}s&&t.complete()},l=()=>{o=null,s&&t.complete()};e.subscribe(Ft(t,c=>{r=!0,i=c,o||jt(n(c)).subscribe(o=Ft(t,a,l))},()=>{s=!0,(!r||!o||o.closed)&&t.complete()}))})}function G0(n,e=il){return ny(()=>ty(n,e))}function $0(n,e=il){return Ut((t,r)=>{let i=null,o=null,s=null,a=()=>{if(i){i.unsubscribe(),i=null;let c=o;o=null,r.next(c)}};function l(){let c=s+n,u=e.now();if(u<c){i=this.schedule(void 0,c-u),r.add(i);return}a()}t.subscribe(Ft(r,c=>{o=c,s=e.now(),i||(i=e.schedule(l,n),r.add(i))},()=>{a(),r.complete()},void 0,()=>{o=i=null}))})}function W0(...n){let e=qi(n);return Ut((t,r)=>{(e?U0(n,t,e):U0(n,t)).subscribe(r)})}function Yi(n){return Ut((e,t)=>{jt(n).subscribe(Ft(t,()=>t.complete(),el)),!t.closed&&e.subscribe(t)})}function z0(n,e,t){let r=je(n)||e||t?{next:n,error:e,complete:t}:n;return r?Ut((i,o)=>{var s;(s=r.subscribe)===null||s===void 0||s.call(r);let a=!0;i.subscribe(Ft(o,l=>{var c;(c=r.next)===null||c===void 0||c.call(r,l),o.next(l)},()=>{var l;a=!1,(l=r.complete)===null||l===void 0||l.call(r),o.complete()},l=>{var c;a=!1,(c=r.error)===null||c===void 0||c.call(r,l),o.error(l)},()=>{var l,c;a&&((l=r.unsubscribe)===null||l===void 0||l.call(r)),(c=r.finalize)===null||c===void 0||c.call(r)}))}):Ci}function ry(n){let e=Le(null);try{return n()}finally{Le(e)}}var Gu="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",Ee=class extends Error{code;constructor(e,t){super(fl(e,t)),this.code=e}};function _I(n){return`NG0${Math.abs(n)}`}function fl(n,e){return`${_I(n)}${e?": "+e:""}`}var Zi=globalThis;function kt(n){for(let e in n)if(n[e]===kt)return e;throw Error("")}function ay(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function er(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(er).join(", ")}]`;if(n==null)return""+n;let e=n.overriddenName||n.name;if(e)return`${e}`;let t=n.toString();if(t==null)return""+t;let r=t.indexOf(`
`);return r>=0?t.slice(0,r):t}function $u(n,e){return n?e?`${n} ${e}`:n:e||""}var yI=kt({__forward_ref__:kt});function Tn(n){return n.__forward_ref__=Tn,n.toString=function(){return er(this())},n}function pn(n){return op(n)?n():n}function op(n){return typeof n=="function"&&n.hasOwnProperty(yI)&&n.__forward_ref__===Tn}function ly(n,e,t,r){throw new Error(`ASSERTION ERROR: ${n}`+(r==null?"":` [Expected=> ${t} ${r} ${e} <=Actual]`))}function Ge(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Gn(n){return{providers:n.providers||[],imports:n.imports||[]}}function Wu(n){return xI(n,zu)}function xI(n,e){return n.hasOwnProperty(e)&&n[e]||null}function EI(n){let e=n?.[zu]??null;return e||null}function K0(n){return n&&n.hasOwnProperty(Uu)?n[Uu]:null}var zu=kt({\u0275prov:kt}),Uu=kt({\u0275inj:kt}),Re=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=Ge({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function sp(n){return n&&!!n.\u0275providers}var ap=kt({\u0275cmp:kt}),lp=kt({\u0275dir:kt}),cp=kt({\u0275pipe:kt});var cl=kt({\u0275fac:kt}),Wo=kt({__NG_ELEMENT_ID__:kt}),iy=kt({__NG_ENV_ID__:kt});function Hs(n){return typeof n=="string"?n:n==null?"":String(n)}function cy(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():Hs(n)}function up(n,e){throw new Ee(-200,n)}function qu(n,e){throw new Ee(-201,!1)}var Y0;function uy(){return Y0}function Jn(n){let e=Y0;return Y0=n,e}function fp(n,e,t){let r=Wu(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&8)return null;if(e!==void 0)return e;qu(n,"Injector")}var TI={},Vo=TI,X0="__NG_DI_FLAG__",Z0=class{injector;constructor(e){this.injector=e}retrieve(e,t){let r=Uo(t)||0;try{return this.injector.get(e,r&8?null:Vo,r)}catch(i){if(As(i))return i;throw i}}},ju="ngTempTokenPath",wI="ngTokenPath",CI=/\n/gm,DI="\u0275",oy="__source";function SI(n,e=0){let t=E0();if(t===void 0)throw new Ee(-203,!1);if(t===null)return fp(n,void 0,e);{let r=bI(e),i=t.retrieve(n,r);if(As(i)){if(r.optional)return null;throw i}return i}}function We(n,e=0){return(uy()||SI)(pn(n),e)}function Pe(n,e){return We(n,Uo(e))}function Uo(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function bI(n){return{optional:!!(n&8),host:!!(n&1),self:!!(n&2),skipSelf:!!(n&4)}}function Q0(n){let e=[];for(let t=0;t<n.length;t++){let r=pn(n[t]);if(Array.isArray(r)){if(r.length===0)throw new Ee(900,!1);let i,o=0;for(let s=0;s<r.length;s++){let a=r[s],l=II(a);typeof l=="number"?l===-1?i=a.token:o|=l:i=a}e.push(We(i,o))}else e.push(We(r))}return e}function dp(n,e){return n[X0]=e,n.prototype[X0]=e,n}function II(n){return n[X0]}function AI(n,e,t,r){let i=n[ju];throw e[oy]&&i.unshift(e[oy]),n.message=FI(`
`+n.message,i,t,r),n[wI]=i,n[ju]=null,n}function FI(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==DI?n.slice(2):n;let i=er(e);if(Array.isArray(e))i=e.map(er).join(" -> ");else if(typeof e=="object"){let o=[];for(let s in e)if(e.hasOwnProperty(s)){let a=e[s];o.push(s+":"+(typeof a=="string"?JSON.stringify(a):er(a)))}i=`{${o.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(CI,`
  `)}`}function jo(n,e){let t=n.hasOwnProperty(cl);return t?n[cl]:null}function fy(n,e,t){if(n.length!==e.length)return!1;for(let r=0;r<n.length;r++){let i=n[r],o=e[r];if(t&&(i=t(i),o=t(o)),o!==i)return!1}return!0}function dy(n){return n.flat(Number.POSITIVE_INFINITY)}function Ku(n,e){n.forEach(t=>Array.isArray(t)?Ku(t,e):e(t))}function hp(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function dl(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function hy(n,e){let t=[];for(let r=0;r<n;r++)t.push(e);return t}function py(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(i===1)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;){let o=i-2;n[i]=n[o],i--}n[e]=t,n[e+1]=r}}function Yu(n,e,t){let r=Gs(n,e);return r>=0?n[r|1]=t:(r=~r,py(n,r,e,t)),r}function Xu(n,e){let t=Gs(n,e);if(t>=0)return n[t|1]}function Gs(n,e){return kI(n,e,1)}function kI(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){let o=r+(i-r>>1),s=n[o<<t];if(e===s)return o<<t;s>e?i=o:r=o+1}return~(i<<t)}var Qi={},Mn=[],Ji=new Re(""),pp=new Re("",-1),mp=new Re(""),ul=class{get(e,t=Vo){if(t===Vo)throw new Qc(`NullInjectorError: No provider for ${er(e)}!`);return t}};function zo(n){return n[ap]||null}function gp(n){return n[lp]||null}function my(n){return n[cp]||null}function hl(n){return{\u0275providers:n}}function gy(...n){return{\u0275providers:vp(!0,n),\u0275fromNgModule:!0}}function vp(n,...e){let t=[],r=new Set,i,o=s=>{t.push(s)};return Ku(e,s=>{let a=s;Hu(a,o,[],r)&&(i||=[],i.push(a))}),i!==void 0&&vy(i,o),t}function vy(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];_p(i,o=>{e(o,r)})}}function Hu(n,e,t,r){if(n=pn(n),!n)return!1;let i=null,o=K0(n),s=!o&&zo(n);if(!o&&!s){let l=n.ngModule;if(o=K0(l),o)i=l;else return!1}else{if(s&&!s.standalone)return!1;i=n}let a=r.has(i);if(s){if(a)return!1;if(r.add(i),s.dependencies){let l=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let c of l)Hu(c,e,t,r)}}else if(o){if(o.imports!=null&&!a){r.add(i);let c;try{Ku(o.imports,u=>{Hu(u,e,t,r)&&(c||=[],c.push(u))})}finally{}c!==void 0&&vy(c,e)}if(!a){let c=jo(i)||(()=>new i);e({provide:i,useFactory:c,deps:Mn},i),e({provide:mp,useValue:i,multi:!0},i),e({provide:Ji,useValue:()=>We(i),multi:!0},i)}let l=o.providers;if(l!=null&&!a){let c=n;_p(l,u=>{e(u,c)})}}else return!1;return i!==n&&n.providers!==void 0}function _p(n,e){for(let t of n)sp(t)&&(t=t.\u0275providers),Array.isArray(t)?_p(t,e):e(t)}var NI=kt({provide:String,useValue:kt});function _y(n){return n!==null&&typeof n=="object"&&NI in n}function MI(n){return!!(n&&n.useExisting)}function OI(n){return!!(n&&n.useFactory)}function Ho(n){return typeof n=="function"}function yy(n){return!!n.useClass}var pl=new Re(""),Vu={},sy={},q0;function ml(){return q0===void 0&&(q0=new ul),q0}var mr=class{},Go=class extends mr{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,ep(e,s=>this.processProvider(s)),this.records.set(pp,js(void 0,this)),i.has("environment")&&this.records.set(mr,js(void 0,this));let o=this.records.get(pl);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(mp,Mn,{self:!0}))}retrieve(e,t){let r=Uo(t)||0;try{return this.get(e,Vo,r)}catch(i){if(As(i))return i;throw i}}destroy(){ll(this),this._destroyed=!0;let e=Le(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Le(e)}}onDestroy(e){return ll(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){ll(this);let t=wi(this),r=Jn(void 0),i;try{return e()}finally{wi(t),Jn(r)}}get(e,t=Vo,r){if(ll(this),e.hasOwnProperty(iy))return e[iy](this);let i=Uo(r),o,s=wi(this),a=Jn(void 0);try{if(!(i&4)){let c=this.records.get(e);if(c===void 0){let u=VI(e)&&Wu(e);u&&this.injectableDefInScope(u)?c=js(J0(e),Vu):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let l=i&2?ml():this.parent;return t=i&8&&t===Vo?null:t,l.get(e,t)}catch(l){if(As(l)){if((l[ju]=l[ju]||[]).unshift(er(e)),s)throw l;return AI(l,e,"R3InjectorError",this.source)}else throw l}finally{Jn(a),wi(s)}}resolveInjectorInitializers(){let e=Le(null),t=wi(this),r=Jn(void 0),i;try{let o=this.get(Ji,Mn,{self:!0});for(let s of o)s()}finally{wi(t),Jn(r),Le(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(er(r));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=pn(e);let t=Ho(e)?e:pn(e&&e.provide),r=PI(e);if(!Ho(e)&&e.multi===!0){let i=this.records.get(t);i||(i=js(void 0,Vu,!0),i.factory=()=>Q0(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=Le(null);try{return t.value===sy?up(er(e)):t.value===Vu&&(t.value=sy,t.value=t.factory()),typeof t.value=="object"&&t.value&&BI(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Le(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=pn(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function J0(n){let e=Wu(n),t=e!==null?e.factory:jo(n);if(t!==null)return t;if(n instanceof Re)throw new Ee(204,!1);if(n instanceof Function)return RI(n);throw new Ee(204,!1)}function RI(n){if(n.length>0)throw new Ee(204,!1);let t=EI(n);return t!==null?()=>t.factory(n):()=>new n}function PI(n){if(_y(n))return js(void 0,n.useValue);{let e=yp(n);return js(e,Vu)}}function yp(n,e,t){let r;if(Ho(n)){let i=pn(n);return jo(i)||J0(i)}else if(_y(n))r=()=>pn(n.useValue);else if(OI(n))r=()=>n.useFactory(...Q0(n.deps||[]));else if(MI(n))r=()=>We(pn(n.useExisting));else{let i=pn(n&&(n.useClass||n.provide));if(LI(n))r=()=>new i(...Q0(n.deps));else return jo(i)||J0(i)}return r}function ll(n){if(n.destroyed)throw new Ee(205,!1)}function js(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function LI(n){return!!n.deps}function BI(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function VI(n){return typeof n=="function"||typeof n=="object"&&n.ngMetadataName==="InjectionToken"}function ep(n,e){for(let t of n)Array.isArray(t)?ep(t,e):t&&sp(t)?ep(t.\u0275providers,e):e(t)}function Zu(n,e){let t;n instanceof Go?(ll(n),t=n):t=new Z0(n);let r,i=wi(t),o=Jn(void 0);try{return e()}finally{wi(i),Jn(o)}}function xy(){return uy()!==void 0||E0()!=null}var gr=0,Be=1,He=2,Jt=3,vr=4,Rn=5,qo=6,$s=7,Nt=8,Ko=9,Qr=10,Ct=11,Ws=12,xp=13,Yo=14,wn=15,eo=16,Xo=17,Jr=18,gl=19,Ep=20,Di=21,Qu=22,vl=23,tr=24,Ju=25,nn=26,Tp=1,wp=6,to=7,_l=8,Zo=9,rn=10;function ei(n){return Array.isArray(n)&&typeof n[Tp]=="object"}function Mr(n){return Array.isArray(n)&&n[Tp]===!0}function ef(n){return(n.flags&4)!==0}function no(n){return n.componentOffset>-1}function yl(n){return(n.flags&1)===1}function Or(n){return!!n.template}function zs(n){return(n[He]&512)!==0}function Qo(n){return(n[He]&256)===256}var Ey="svg",Ty="math";function _r(n){for(;Array.isArray(n);)n=n[gr];return n}function Cp(n){for(;Array.isArray(n);){if(typeof n[Tp]=="object")return n;n=n[gr]}return null}function Dp(n,e){return _r(e[n])}function Rr(n,e){return _r(e[n.index])}function xl(n,e){return n.data[e]}function wy(n,e){return n[e]}function yr(n,e){let t=e[n];return ei(t)?t:t[gr]}function Cy(n){return(n[He]&4)===4}function tf(n){return(n[He]&128)===128}function Dy(n){return Mr(n[Jt])}function Pr(n,e){return e==null?null:n[e]}function Sp(n){n[Xo]=0}function bp(n){n[He]&1024||(n[He]|=1024,tf(n)&&Tl(n))}function Sy(n,e){for(;n>0;)e=e[Yo],n--;return e}function El(n){return!!(n[He]&9216||n[tr]?.dirty)}function nf(n){n[Qr].changeDetectionScheduler?.notify(8),n[He]&64&&(n[He]|=1024),El(n)&&Tl(n)}function Tl(n){n[Qr].changeDetectionScheduler?.notify(0);let e=Xi(n);for(;e!==null&&!(e[He]&8192||(e[He]|=8192,!tf(e)));)e=Xi(e)}function Ip(n,e){if(Qo(n))throw new Ee(911,!1);n[Di]===null&&(n[Di]=[]),n[Di].push(e)}function by(n,e){if(n[Di]===null)return;let t=n[Di].indexOf(e);t!==-1&&n[Di].splice(t,1)}function Xi(n){let e=n[Jt];return Mr(e)?e[Jt]:e}function Ap(n){return n[$s]??=[]}function Fp(n){return n.cleanup??=[]}function Iy(n,e,t,r){let i=Ap(e);i.push(t),n.firstCreatePass&&Fp(n).push(r,i.length-1)}var Ze={lFrame:jy(null),bindingsEnabled:!0,skipHydrationRootTNode:null},wl=function(n){return n[n.Off=0]="Off",n[n.Exhaustive=1]="Exhaustive",n[n.OnlyDirtyViews=2]="OnlyDirtyViews",n}(wl||{}),UI=0,tp=!1;function Ay(){return Ze.lFrame.elementDepthCount}function Fy(){Ze.lFrame.elementDepthCount++}function ky(){Ze.lFrame.elementDepthCount--}function rf(){return Ze.bindingsEnabled}function kp(){return Ze.skipHydrationRootTNode!==null}function Ny(n){return Ze.skipHydrationRootTNode===n}function My(){Ze.skipHydrationRootTNode=null}function Ve(){return Ze.lFrame.lView}function bt(){return Ze.lFrame.tView}function qe(n){return Ze.lFrame.contextLView=n,n[Nt]}function Ke(n){return Ze.lFrame.contextLView=null,n}function Cn(){let n=Np();for(;n!==null&&n.type===64;)n=n.parent;return n}function Np(){return Ze.lFrame.currentTNode}function Oy(){let n=Ze.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function ro(n,e){let t=Ze.lFrame;t.currentTNode=n,t.isParent=e}function of(){return Ze.lFrame.isParent}function sf(){Ze.lFrame.isParent=!1}function Ry(){return Ze.lFrame.contextLView}function Mp(n){ly("Must never be called in production mode"),UI=n}function Op(){return tp}function Rp(n){let e=tp;return tp=n,e}function Cl(){let n=Ze.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function Py(n){return Ze.lFrame.bindingIndex=n}function io(){return Ze.lFrame.bindingIndex++}function Pp(n){let e=Ze.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function Ly(){return Ze.lFrame.inI18n}function By(n,e){let t=Ze.lFrame;t.bindingIndex=t.bindingRootIndex=n,af(e)}function Vy(){return Ze.lFrame.currentDirectiveIndex}function af(n){Ze.lFrame.currentDirectiveIndex=n}function Lp(n){let e=Ze.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function Bp(){return Ze.lFrame.currentQueryIndex}function lf(n){Ze.lFrame.currentQueryIndex=n}function jI(n){let e=n[Be];return e.type===2?e.declTNode:e.type===1?n[Rn]:null}function Vp(n,e,t){if(t&4){let i=e,o=n;for(;i=i.parent,i===null&&!(t&1);)if(i=jI(o),i===null||(o=o[Yo],i.type&10))break;if(i===null)return!1;e=i,n=o}let r=Ze.lFrame=Uy();return r.currentTNode=e,r.lView=n,!0}function cf(n){let e=Uy(),t=n[Be];Ze.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function Uy(){let n=Ze.lFrame,e=n===null?null:n.child;return e===null?jy(n):e}function jy(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function Hy(){let n=Ze.lFrame;return Ze.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var Up=Hy;function uf(){let n=Hy();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Gy(n){return(Ze.lFrame.contextLView=Sy(n,Ze.lFrame.contextLView))[Nt]}function Si(){return Ze.lFrame.selectedIndex}function oo(n){Ze.lFrame.selectedIndex=n}function ff(){let n=Ze.lFrame;return xl(n.tView,n.selectedIndex)}function $y(){return Ze.lFrame.currentNamespace}var Wy=!0;function Dl(){return Wy}function Sl(n){Wy=n}function np(n,e=null,t=null,r){let i=zy(n,e,t,r);return i.resolveInjectorInitializers(),i}function zy(n,e=null,t=null,r,i=new Set){let o=[t||Mn,gy(n)];return r=r||(typeof n=="object"?void 0:er(n)),new Go(o,e||ml(),r||null,i)}var On=class n{static THROW_IF_NOT_FOUND=Vo;static NULL=new ul;static create(e,t){if(Array.isArray(e))return np({name:""},t,e,"");{let r=e.name??"";return np({name:r},e.parent,e.providers,r)}}static \u0275prov=Ge({token:n,providedIn:"any",factory:()=>We(pp)});static __NG_ELEMENT_ID__=-1},Mt=new Re(""),df=(()=>{class n{static __NG_ELEMENT_ID__=HI;static __NG_ENV_ID__=t=>t}return n})(),rp=class extends df{_lView;constructor(e){super(),this._lView=e}get destroyed(){return Qo(this._lView)}onDestroy(e){let t=this._lView;return Ip(t,e),()=>by(t,e)}};function HI(){return new rp(Ve())}var Zr=class{_console=console;handleError(e){this._console.error("ERROR",e)}},bi=new Re("",{providedIn:"root",factory:()=>{let n=Pe(mr),e;return t=>{e??=n.get(Zr),e.handleError(t)}}}),qy={provide:Ji,useValue:()=>void Pe(Zr),multi:!0};function $n(n,e){let[t,r,i]=S0(n,e?.equal),o=t,s=o[Nn];return o.set=r,o.update=i,o.asReadonly=Ky.bind(o),o}function Ky(){let n=this[Nn];if(n.readonlyFn===void 0){let e=()=>this();e[Nn]=n,n.readonlyFn=e}return n.readonlyFn}var $o=class{},bl=new Re("",{providedIn:"root",factory:()=>!1});var jp=new Re(""),Hp=new Re("");var qs=(()=>{class n{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new tl(!1);get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new ct(t=>{t.next(!1),t.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=Ge({token:n,providedIn:"root",factory:()=>new n})}return n})();function Il(...n){}var Gp=(()=>{class n{static \u0275prov=Ge({token:n,providedIn:"root",factory:()=>new ip})}return n})(),ip=class{dirtyEffectCount=0;queues=new Map;add(e){this.enqueue(e),this.schedule(e)}schedule(e){e.dirty&&this.dirtyEffectCount++}remove(e){let t=e.zone,r=this.queues.get(t);r.has(e)&&(r.delete(e),e.dirty&&this.dirtyEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let r=this.queues.get(t);r.has(e)||r.add(e)}flush(){for(;this.dirtyEffectCount>0;){let e=!1;for(let[t,r]of this.queues)t===null?e||=this.flushQueue(r):e||=t.run(()=>this.flushQueue(r));e||(this.dirtyEffectCount=0)}}flushQueue(e){let t=!1;for(let r of e)r.dirty&&(this.dirtyEffectCount--,t=!0,r.run());return t}};function ea(n){return{toString:n}.toString()}var hf="__parameters__";function nA(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function bx(n,e,t){return ea(()=>{let r=nA(e);function i(...o){if(this instanceof i)return r.apply(this,o),this;let s=new i(...o);return a.annotation=s,a;function a(l,c,u){let f=l.hasOwnProperty(hf)?l[hf]:Object.defineProperty(l,hf,{value:[]})[hf];for(;f.length<=u;)f.push(null);return(f[u]=f[u]||[]).push(s),l}}return i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var jm=dp(bx("Optional"),8);var Ix=dp(bx("SkipSelf"),4);function rA(n){return typeof n=="function"}var Tf=class{previousValue;currentValue;firstChange;constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function Ax(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}var Vr=(()=>{let n=()=>Fx;return n.ngInherit=!0,n})();function Fx(n){return n.type.prototype.ngOnChanges&&(n.setInput=oA),iA}function iA(){let n=Nx(this),e=n?.current;if(e){let t=n.previous;if(t===Qi)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function oA(n,e,t,r,i){let o=this.declaredInputs[r],s=Nx(n)||sA(n,{previous:Qi,current:null}),a=s.current||(s.current={}),l=s.previous,c=l[o];a[o]=new Tf(c&&c.currentValue,t,l===Qi),Ax(n,e,i,t)}var kx="__ngSimpleChanges__";function Nx(n){return n[kx]||null}function sA(n,e){return n[kx]=e}var Yy=[];var vt=function(n,e=null,t){for(let r=0;r<Yy.length;r++){let i=Yy[r];i(n,e,t)}};function aA(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(r){let s=Fx(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}i&&(t.preOrderHooks??=[]).push(0-n,i),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function Hm(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=o;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),l&&(n.viewHooks??=[]).push(-t,l),c&&((n.viewHooks??=[]).push(t,c),(n.viewCheckHooks??=[]).push(t,c)),u!=null&&(n.destroyHooks??=[]).push(t,u)}}function _f(n,e,t){Mx(n,e,3,t)}function yf(n,e,t,r){(n[He]&3)===t&&Mx(n,e,t,r)}function $p(n,e){let t=n[He];(t&3)===e&&(t&=16383,t+=1,n[He]=t)}function Mx(n,e,t,r){let i=r!==void 0?n[Xo]&65535:0,o=r??-1,s=e.length-1,a=0;for(let l=i;l<s;l++)if(typeof e[l+1]=="number"){if(a=e[l],r!=null&&a>=r)break}else e[l]<0&&(n[Xo]+=65536),(a<o||o==-1)&&(lA(n,t,e,l),n[Xo]=(n[Xo]&4294901760)+l+2),l++}function Xy(n,e){vt(4,n,e);let t=Le(null);try{e.call(n)}finally{Le(t),vt(5,n,e)}}function lA(n,e,t,r){let i=t[r]<0,o=t[r+1],s=i?-t[r]:t[r],a=n[s];i?n[He]>>14<n[Xo]>>16&&(n[He]&3)===e&&(n[He]+=16384,Xy(a,o)):Xy(a,o)}var Ys=-1,es=class{factory;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,r){this.factory=e,this.canSeeViewProviders=t,this.injectImpl=r}};function cA(n){return(n.flags&8)!==0}function uA(n){return(n.flags&16)!==0}function fA(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let o=t[r++],s=t[r++],a=t[r++];n.setAttribute(e,s,a,o)}else{let o=i,s=t[++r];dA(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),r++}}return r}function Ox(n){return n===3||n===4||n===6}function dA(n){return n.charCodeAt(0)===64}function Xs(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?Zy(n,t,i,null,e[++r]):Zy(n,t,i,null,null))}}return n}function Zy(n,e,t,r,i){let o=0,s=n.length;if(e===-1)s=-1;else for(;o<n.length;){let a=n[o++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=o-1;break}}}for(;o<n.length;){let a=n[o];if(typeof a=="number")break;if(a===t){i!==null&&(n[o+1]=i);return}o++,i!==null&&o++}s!==-1&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),i!==null&&n.splice(o++,0,i)}function Rx(n){return n!==Ys}function wf(n){return n&32767}function hA(n){return n>>16}function Cf(n,e){let t=hA(n),r=e;for(;t>0;)r=r[Yo],t--;return r}var tm=!0;function Qy(n){let e=tm;return tm=n,e}var pA=256,Px=pA-1,Lx=5,mA=0,ti={};function gA(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(Wo)&&(r=t[Wo]),r==null&&(r=t[Wo]=mA++);let i=r&Px,o=1<<i;e.data[n+(i>>Lx)]|=o}function Df(n,e){let t=Bx(n,e);if(t!==-1)return t;let r=e[Be];r.firstCreatePass&&(n.injectorIndex=e.length,Wp(r.data,n),Wp(e,null),Wp(r.blueprint,null));let i=Gm(n,e),o=n.injectorIndex;if(Rx(i)){let s=wf(i),a=Cf(i,e),l=a[Be].data;for(let c=0;c<8;c++)e[o+c]=a[s+c]|l[s+c]}return e[o+8]=i,o}function Wp(n,e){n.push(0,0,0,0,0,0,0,0,e)}function Bx(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function Gm(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=Gx(i),r===null)return Ys;if(t++,i=i[Yo],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return Ys}function nm(n,e,t){gA(n,e,t)}function vA(n,e){if(e==="class")return n.classes;if(e==="style")return n.styles;let t=n.attrs;if(t){let r=t.length,i=0;for(;i<r;){let o=t[i];if(Ox(o))break;if(o===0)i=i+2;else if(typeof o=="number")for(i++;i<r&&typeof t[i]=="string";)i++;else{if(o===e)return t[i+1];i=i+2}}}return null}function Vx(n,e,t){if(t&8||n!==void 0)return n;qu(e,"NodeInjector")}function Ux(n,e,t,r){if(t&8&&r===void 0&&(r=null),(t&3)===0){let i=n[Ko],o=Jn(void 0);try{return i?i.get(e,r,t&8):fp(e,r,t&8)}finally{Jn(o)}}return Vx(r,e,t)}function jx(n,e,t,r=0,i){if(n!==null){if(e[He]&2048&&!(r&2)){let s=EA(n,e,t,r,ti);if(s!==ti)return s}let o=Hx(n,e,t,r,ti);if(o!==ti)return o}return Ux(e,t,r,i)}function Hx(n,e,t,r,i){let o=yA(t);if(typeof o=="function"){if(!Vp(e,n,r))return r&1?Vx(i,t,r):Ux(e,t,r,i);try{let s;if(s=o(r),s==null&&!(r&8))qu(t);else return s}finally{Up()}}else if(typeof o=="number"){let s=null,a=Bx(n,e),l=Ys,c=r&1?e[wn][Rn]:null;for((a===-1||r&4)&&(l=a===-1?Gm(n,e):e[a+8],l===Ys||!ex(r,!1)?a=-1:(s=e[Be],a=wf(l),e=Cf(l,e)));a!==-1;){let u=e[Be];if(Jy(o,a,u.data)){let f=_A(a,e,t,s,r,c);if(f!==ti)return f}l=e[a+8],l!==Ys&&ex(r,e[Be].data[a+8]===c)&&Jy(o,a,e)?(s=u,a=wf(l),e=Cf(l,e)):a=-1}}return i}function _A(n,e,t,r,i,o){let s=e[Be],a=s.data[n+8],l=r==null?no(a)&&tm:r!=s&&(a.type&3)!==0,c=i&1&&o===a,u=xf(a,s,t,l,c);return u!==null?kl(e,s,u,a):ti}function xf(n,e,t,r,i){let o=n.providerIndexes,s=e.data,a=o&1048575,l=n.directiveStart,c=n.directiveEnd,u=o>>20,f=r?a:a+u,h=i?a+u:c;for(let d=f;d<h;d++){let m=s[d];if(d<l&&t===m||d>=l&&m.type===t)return d}if(i){let d=s[l];if(d&&Or(d)&&d.type===t)return l}return null}function kl(n,e,t,r){let i=n[t],o=e.data;if(i instanceof es){let s=i;s.resolving&&up(cy(o[t]));let a=Qy(s.canSeeViewProviders);s.resolving=!0;let l=o[t].type||o[t],c,u=s.injectImpl?Jn(s.injectImpl):null,f=Vp(n,r,0);try{i=n[t]=s.factory(void 0,o,n,r),e.firstCreatePass&&t>=r.directiveStart&&aA(t,o[t],e)}finally{u!==null&&Jn(u),Qy(a),s.resolving=!1,Up()}}return i}function yA(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(Wo)?n[Wo]:void 0;return typeof e=="number"?e>=0?e&Px:xA:e}function Jy(n,e,t){let r=1<<n;return!!(t[e+(n>>Lx)]&r)}function ex(n,e){return!(n&2)&&!(n&1&&e)}var Jo=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return jx(this._tNode,this._lView,e,Uo(r),t)}};function xA(){return new Jo(Cn(),Ve())}function ns(n){return ea(()=>{let e=n.prototype.constructor,t=e[cl]||rm(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let o=i[cl]||rm(i);if(o&&o!==t)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function rm(n){return op(n)?()=>{let e=rm(pn(n));return e&&e()}:jo(n)}function EA(n,e,t,r,i){let o=n,s=e;for(;o!==null&&s!==null&&s[He]&2048&&!zs(s);){let a=Hx(o,s,t,r|2,ti);if(a!==ti)return a;let l=o.parent;if(!l){let c=s[Ep];if(c){let u=c.get(t,ti,r);if(u!==ti)return u}l=Gx(s),s=s[Yo]}o=l}return i}function Gx(n){let e=n[Be],t=e.type;return t===2?e.declTNode:t===1?n[Rn]:null}function Bl(n){return vA(Cn(),n)}function TA(){return ta(Cn(),Ve())}function ta(n,e){return new It(Rr(n,e))}var It=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=TA}return n})();function wA(n){return n instanceof It?n.nativeElement:n}function CA(){return this._results[Symbol.iterator]()}var Sf=class{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new St}constructor(e=!1){this._emitDistinctChangesOnly=e}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;let r=dy(e);(this._changesDetected=!fy(this._results,r,t))&&(this._results=r,this.length=r.length,this.last=r[this.length-1],this.first=r[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=CA};function $x(n){return(n.flags&128)===128}var $m=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}($m||{}),Wx=new Map,DA=0;function SA(){return DA++}function bA(n){Wx.set(n[gl],n)}function im(n){Wx.delete(n[gl])}var tx="__ngContext__";function na(n,e){ei(e)?(n[tx]=e[gl],bA(e)):n[tx]=e}function zx(n){return Kx(n[Ws])}function qx(n){return Kx(n[vr])}function Kx(n){for(;n!==null&&!Mr(n);)n=n[vr];return n}var om;function Wm(n){om=n}function zm(){if(om!==void 0)return om;if(typeof document<"u")return document;throw new Ee(210,!1)}var Lf=new Re("",{providedIn:"root",factory:()=>IA}),IA="ng",Bf=new Re(""),ra=new Re("",{providedIn:"platform",factory:()=>"unknown"});var Vf=new Re(""),Uf=new Re("",{providedIn:"root",factory:()=>zm().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var AA="h",FA="b";var Yx="r";var Xx="di";var Zx=!1,Qx=new Re("",{providedIn:"root",factory:()=>Zx});var kA=(n,e,t,r)=>{};function NA(n,e,t,r){kA(n,e,t,r)}var MA=()=>null;function Jx(n,e,t=!1){return MA(n,e,t)}function eE(n,e){let t=n.contentQueries;if(t!==null){let r=Le(null);try{for(let i=0;i<t.length;i+=2){let o=t[i],s=t[i+1];if(s!==-1){let a=n.data[s];lf(o),a.contentQueries(2,e[s],s)}}}finally{Le(r)}}}function sm(n,e,t){lf(0);let r=Le(null);try{e(n,t)}finally{Le(r)}}function qm(n,e,t){if(ef(e)){let r=Le(null);try{let i=e.directiveStart,o=e.directiveEnd;for(let s=i;s<o;s++){let a=n.data[s];if(a.contentQueries){let l=t[s];a.contentQueries(1,l,s)}}}finally{Le(r)}}}var Ii=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Ii||{}),pf;function OA(){if(pf===void 0&&(pf=null,Zi.trustedTypes))try{pf=Zi.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return pf}function jf(n){return OA()?.createHTML(n)||n}var mf;function RA(){if(mf===void 0&&(mf=null,Zi.trustedTypes))try{mf=Zi.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return mf}function nx(n){return RA()?.createHTML(n)||n}var Ai=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Gu})`}},am=class extends Ai{getTypeName(){return"HTML"}},lm=class extends Ai{getTypeName(){return"Style"}},cm=class extends Ai{getTypeName(){return"Script"}},um=class extends Ai{getTypeName(){return"URL"}},fm=class extends Ai{getTypeName(){return"ResourceURL"}};function ri(n){return n instanceof Ai?n.changingThisBreaksApplicationSecurity:n}function ao(n,e){let t=tE(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${Gu})`)}return t===e}function tE(n){return n instanceof Ai&&n.getTypeName()||null}function Km(n){return new am(n)}function Ym(n){return new lm(n)}function Xm(n){return new cm(n)}function Zm(n){return new um(n)}function Qm(n){return new fm(n)}function PA(n){let e=new hm(n);return LA()?new dm(e):e}var dm=class{inertDocumentHelper;constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{let t=new window.DOMParser().parseFromString(jf(e),"text/html").body;return t===null?this.inertDocumentHelper.getInertBodyElement(e):(t.firstChild?.remove(),t)}catch{return null}}},hm=class{defaultDoc;inertDocument;constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){let t=this.inertDocument.createElement("template");return t.innerHTML=jf(e),t}};function LA(){try{return!!new window.DOMParser().parseFromString(jf(""),"text/html")}catch{return!1}}var BA=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Hf(n){return n=String(n),n.match(BA)?n:"unsafe:"+n}function ki(n){let e={};for(let t of n.split(","))e[t]=!0;return e}function Vl(...n){let e={};for(let t of n)for(let r in t)t.hasOwnProperty(r)&&(e[r]=!0);return e}var nE=ki("area,br,col,hr,img,wbr"),rE=ki("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),iE=ki("rp,rt"),VA=Vl(iE,rE),UA=Vl(rE,ki("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),jA=Vl(iE,ki("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),rx=Vl(nE,UA,jA,VA),oE=ki("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),HA=ki("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),GA=ki("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext"),$A=Vl(oE,HA,GA),WA=ki("script,style,template"),pm=class{sanitizedSomething=!1;buf=[];sanitizeChildren(e){let t=e.firstChild,r=!0,i=[];for(;t;){if(t.nodeType===Node.ELEMENT_NODE?r=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,r&&t.firstChild){i.push(t),t=KA(t);continue}for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let o=qA(t);if(o){t=o;break}t=i.pop()}}return this.buf.join("")}startElement(e){let t=ix(e).toLowerCase();if(!rx.hasOwnProperty(t))return this.sanitizedSomething=!0,!WA.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);let r=e.attributes;for(let i=0;i<r.length;i++){let o=r.item(i),s=o.name,a=s.toLowerCase();if(!$A.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let l=o.value;oE[a]&&(l=Hf(l)),this.buf.push(" ",s,'="',ox(l),'"')}return this.buf.push(">"),!0}endElement(e){let t=ix(e).toLowerCase();rx.hasOwnProperty(t)&&!nE.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(ox(e))}};function zA(n,e){return(n.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)!==Node.DOCUMENT_POSITION_CONTAINED_BY}function qA(n){let e=n.nextSibling;if(e&&n!==e.previousSibling)throw sE(e);return e}function KA(n){let e=n.firstChild;if(e&&zA(n,e))throw sE(e);return e}function ix(n){let e=n.nodeName;return typeof e=="string"?e:"FORM"}function sE(n){return new Error(`Failed to sanitize html because the element is clobbered: ${n.outerHTML}`)}var YA=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,XA=/([^\#-~ |!])/g;function ox(n){return n.replace(/&/g,"&amp;").replace(YA,function(e){let t=e.charCodeAt(0),r=e.charCodeAt(1);return"&#"+((t-55296)*1024+(r-56320)+65536)+";"}).replace(XA,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}var gf;function Gf(n,e){let t=null;try{gf=gf||PA(n);let r=e?String(e):"";t=gf.getInertBodyElement(r);let i=5,o=r;do{if(i===0)throw new Error("Failed to sanitize html because the input is unstable");i--,r=o,o=t.innerHTML,t=gf.getInertBodyElement(r)}while(r!==o);let a=new pm().sanitizeChildren(sx(t)||t);return jf(a)}finally{if(t){let r=sx(t)||t;for(;r.firstChild;)r.firstChild.remove()}}}function sx(n){return"content"in n&&ZA(n)?n.content:null}function ZA(n){return n.nodeType===Node.ELEMENT_NODE&&n.nodeName==="TEMPLATE"}var xr=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(xr||{});function $f(n){let e=QA();return e?nx(e.sanitize(xr.HTML,n)||""):ao(n,"HTML")?nx(ri(n)):Gf(zm(),Hs(n))}function QA(){let n=Ve();return n&&n[Qr].sanitizer}var JA=/^>|^->|<!--|-->|--!>|<!-$/g,eF=/(<|>)/g,tF="\u200B$1\u200B";function nF(n){return n.replace(JA,e=>e.replace(eF,tF))}function rF(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let o=e.length;if(i+o===r||n.charCodeAt(i+o)<=32)return i}t=i+1}}var aE="ng-template";function iF(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&rF(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(Jm(n))return!1;if(i=e.indexOf(1,i),i>-1){let o;for(;++i<e.length&&typeof(o=e[i])=="string";)if(o.toLowerCase()===t)return!0}return!1}function Jm(n){return n.type===4&&n.value!==aE}function oF(n,e,t){let r=n.type===4&&!t?aE:n.value;return e===r}function sF(n,e,t){let r=4,i=n.attrs,o=i!==null?cF(i):0,s=!1;for(let a=0;a<e.length;a++){let l=e[a];if(typeof l=="number"){if(!s&&!Lr(r)&&!Lr(l))return!1;if(s&&Lr(l))continue;s=!1,r=l|r&1;continue}if(!s)if(r&4){if(r=2|r&1,l!==""&&!oF(n,l,t)||l===""&&e.length===1){if(Lr(r))return!1;s=!0}}else if(r&8){if(i===null||!iF(n,i,l,t)){if(Lr(r))return!1;s=!0}}else{let c=e[++a],u=aF(l,i,Jm(n),t);if(u===-1){if(Lr(r))return!1;s=!0;continue}if(c!==""){let f;if(u>o?f="":f=i[u+1].toLowerCase(),r&2&&c!==f){if(Lr(r))return!1;s=!0}}}}return Lr(r)||s}function Lr(n){return(n&1)===0}function aF(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let o=!1;for(;i<e.length;){let s=e[i];if(s===n)return i;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(s===4)break;if(s===0){i+=4;continue}}i+=o?1:2}return-1}else return uF(e,n)}function lE(n,e,t=!1){for(let r=0;r<e.length;r++)if(sF(n,e[r],t))return!0;return!1}function lF(n){let e=n.attrs;if(e!=null){let t=e.indexOf(5);if((t&1)===0)return e[t+1]}return null}function cF(n){for(let e=0;e<n.length;e++){let t=n[e];if(Ox(t))return e}return n.length}function uF(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function fF(n,e){e:for(let t=0;t<e.length;t++){let r=e[t];if(n.length===r.length){for(let i=0;i<n.length;i++)if(n[i]!==r[i])continue e;return!0}}return!1}function ax(n,e){return n?":not("+e.trim()+")":e}function dF(n){let e=n[0],t=1,r=2,i="",o=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(r&2){let a=n[++t];i+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+s:r&4&&(i+=" "+s);else i!==""&&!Lr(s)&&(e+=ax(o,i),i=""),r=s,o=o||!Lr(r);t++}return i!==""&&(e+=ax(o,i)),e}function hF(n){return n.map(dF).join(",")}function pF(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let o=n[r];if(typeof o=="string")i===2?o!==""&&e.push(o,n[++r]):i===8&&t.push(o);else{if(!Lr(i))break;i=o}r++}return t.length&&e.push(1,...t),e}var rr={};function mF(n,e){return n.createText(e)}function gF(n,e,t){n.setValue(e,t)}function vF(n,e){return n.createComment(nF(e))}function cE(n,e,t){return n.createElement(e,t)}function bf(n,e,t,r,i){n.insertBefore(e,t,r,i)}function uE(n,e,t){n.appendChild(e,t)}function lx(n,e,t,r,i){r!==null?bf(n,e,t,r,i):uE(n,e,t)}function fE(n,e,t){n.removeChild(null,e,t)}function _F(n,e,t){n.setAttribute(e,"style",t)}function yF(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function dE(n,e,t){let{mergedAttrs:r,classes:i,styles:o}=t;r!==null&&fA(n,e,r),i!==null&&yF(n,e,i),o!==null&&_F(n,e,o)}function eg(n,e,t,r,i,o,s,a,l,c,u){let f=nn+r,h=f+i,d=xF(f,h),m=typeof c=="function"?c():c;return d[Be]={type:n,blueprint:d,template:t,queries:null,viewQuery:a,declTNode:e,data:d.slice().fill(null,f),bindingStartIndex:f,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:l,consts:m,incompleteFirstPass:!1,ssrId:u}}function xF(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:rr);return t}function EF(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=eg(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function tg(n,e,t,r,i,o,s,a,l,c,u){let f=e.blueprint.slice();return f[gr]=i,f[He]=r|4|128|8|64|1024,(c!==null||n&&n[He]&2048)&&(f[He]|=2048),Sp(f),f[Jt]=f[Yo]=n,f[Nt]=t,f[Qr]=s||n&&n[Qr],f[Ct]=a||n&&n[Ct],f[Ko]=l||n&&n[Ko]||null,f[Rn]=o,f[gl]=SA(),f[qo]=u,f[Ep]=c,f[wn]=e.type==2?n[wn]:f,f}function TF(n,e,t){let r=Rr(e,n),i=EF(t),o=n[Qr].rendererFactory,s=ng(n,tg(n,i,null,hE(t),r,e,null,o.createRenderer(r,t),null,null,null));return n[e.index]=s}function hE(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function pE(n,e,t,r){if(t===0)return-1;let i=e.length;for(let o=0;o<t;o++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function ng(n,e){return n[Ws]?n[xp][vr]=e:n[Ws]=e,n[xp]=e,e}function A(n=1){mE(bt(),Ve(),Si()+n,!1)}function mE(n,e,t,r){if(!r)if((e[He]&3)===3){let o=n.preOrderCheckHooks;o!==null&&_f(e,o,t)}else{let o=n.preOrderHooks;o!==null&&yf(e,o,0,t)}oo(t)}var Wf=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(Wf||{});function mm(n,e,t,r){let i=Le(null);try{let[o,s,a]=n.inputs[t],l=null;(s&Wf.SignalBased)!==0&&(l=e[o][Nn]),l!==null&&l.transformFn!==void 0?r=l.transformFn(r):a!==null&&(r=a.call(e,r)),n.setInput!==null?n.setInput(e,l,r,t,o):Ax(e,l,o,r)}finally{Le(i)}}function gE(n,e,t,r,i){let o=Si(),s=r&2;try{oo(-1),s&&e.length>nn&&mE(n,e,nn,!1),vt(s?2:0,i,t),t(r,i)}finally{oo(o),vt(s?3:1,i,t)}}function zf(n,e,t){AF(n,e,t),(t.flags&64)===64&&FF(n,e,t)}function rg(n,e,t=Rr){let r=e.localNames;if(r!==null){let i=e.index+1;for(let o=0;o<r.length;o+=2){let s=r[o+1],a=s===-1?t(e,n):n[s];n[i++]=a}}}function wF(n,e,t,r){let o=r.get(Qx,Zx)||t===Ii.ShadowDom,s=n.selectRootElement(e,o);return CF(s),s}function CF(n){DF(n)}var DF=()=>null;function SF(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function bF(n,e,t,r,i,o){let s=e[Be];if(og(n,s,e,t,r)){no(n)&&IF(e,n.index);return}vE(n,e,t,r,i,o)}function vE(n,e,t,r,i,o){if(n.type&3){let s=Rr(n,e);t=SF(t),r=o!=null?o(r,n.value||"",t):r,i.setProperty(s,t,r)}else n.type&12}function IF(n,e){let t=yr(e,n);t[He]&16||(t[He]|=64)}function AF(n,e,t){let r=t.directiveStart,i=t.directiveEnd;no(t)&&TF(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||Df(t,e);let o=t.initialInputs;for(let s=r;s<i;s++){let a=n.data[s],l=kl(e,n,s,t);if(na(l,e),o!==null&&OF(e,s-r,l,a,t,o),Or(a)){let c=yr(t.index,e);c[Nt]=kl(e,n,s,t)}}}function FF(n,e,t){let r=t.directiveStart,i=t.directiveEnd,o=t.index,s=Vy();try{oo(o);for(let a=r;a<i;a++){let l=n.data[a],c=e[a];af(a),(l.hostBindings!==null||l.hostVars!==0||l.hostAttrs!==null)&&kF(l,c)}}finally{oo(-1),af(s)}}function kF(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function ig(n,e){let t=n.directiveRegistry,r=null;if(t)for(let i=0;i<t.length;i++){let o=t[i];lE(e,o.selectors,!1)&&(r??=[],Or(o)?r.unshift(o):r.push(o))}return r}function NF(n,e,t,r,i,o){let s=Rr(n,e);MF(e[Ct],s,o,n.value,t,r,i)}function MF(n,e,t,r,i,o,s){if(o==null)n.removeAttribute(e,i,t);else{let a=s==null?Hs(o):s(o,r||"",i);n.setAttribute(e,i,a,t)}}function OF(n,e,t,r,i,o){let s=o[e];if(s!==null)for(let a=0;a<s.length;a+=2){let l=s[a],c=s[a+1];mm(r,t,l,c)}}function RF(n,e,t){return(n===null||Or(n))&&(t=Cp(t[e.index])),t[Ct]}function PF(n,e){let t=n[Ko];if(!t)return;t.get(bi,null)?.(e)}function og(n,e,t,r,i){let o=n.inputs?.[r],s=n.hostDirectiveInputs?.[r],a=!1;if(s)for(let l=0;l<s.length;l+=2){let c=s[l],u=s[l+1],f=e.data[c];mm(f,t[c],u,i),a=!0}if(o)for(let l of o){let c=t[l],u=e.data[l];mm(u,c,r,i),a=!0}return a}function LF(n,e){let t=yr(e,n),r=t[Be];BF(r,t);let i=t[gr];i!==null&&t[qo]===null&&(t[qo]=Jx(i,t[Ko])),vt(18),sg(r,t,t[Nt]),vt(19,t[Nt])}function BF(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function sg(n,e,t){cf(e);try{let r=n.viewQuery;r!==null&&sm(1,r,t);let i=n.template;i!==null&&gE(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[Jr]?.finishViewCreation(n),n.staticContentQueries&&eE(n,e),n.staticViewQueries&&sm(2,n.viewQuery,t);let o=n.components;o!==null&&VF(e,o)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[He]&=-5,uf()}}function VF(n,e){for(let t=0;t<e.length;t++)LF(n,e[t])}function Ul(n,e,t,r){let i=Le(null);try{let o=e.tView,a=n[He]&4096?4096:16,l=tg(n,o,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),c=n[e.index];l[eo]=c;let u=n[Jr];return u!==null&&(l[Jr]=u.createEmbeddedView(o)),sg(o,l,t),l}finally{Le(i)}}function Zs(n,e){return!e||e.firstChild===null||$x(n)}var cx=!1,UF=new Re(""),jF;function ag(n,e){return jF(n,e)}var ni=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(ni||{});function qf(n){return(n.flags&32)===32}function Ks(n,e,t,r,i){if(r!=null){let o,s=!1;Mr(r)?o=r:ei(r)&&(s=!0,r=r[gr]);let a=_r(r);n===0&&t!==null?i==null?uE(e,t,a):bf(e,t,a,i||null,!0):n===1&&t!==null?bf(e,t,a,i||null,!0):n===2?fE(e,a,s):n===3&&e.destroyNode(a),o!=null&&ZF(e,n,o,t,i)}}function HF(n,e){_E(n,e),e[gr]=null,e[Rn]=null}function GF(n,e,t,r,i,o){r[gr]=i,r[Rn]=e,Xf(n,r,t,1,i,o)}function _E(n,e){e[Qr].changeDetectionScheduler?.notify(9),Xf(n,e,e[Ct],2,null,null)}function $F(n){let e=n[Ws];if(!e)return zp(n[Be],n);for(;e;){let t=null;if(ei(e))t=e[Ws];else{let r=e[rn];r&&(t=r)}if(!t){for(;e&&!e[vr]&&e!==n;)ei(e)&&zp(e[Be],e),e=e[Jt];e===null&&(e=n),ei(e)&&zp(e[Be],e),t=e&&e[vr]}e=t}}function lg(n,e){let t=n[Zo],r=t.indexOf(e);t.splice(r,1)}function Kf(n,e){if(Qo(e))return;let t=e[Ct];t.destroyNode&&Xf(n,e,t,3,null,null),$F(e)}function zp(n,e){if(Qo(e))return;let t=Le(null);try{e[He]&=-129,e[He]|=256,e[tr]&&su(e[tr]),zF(n,e),WF(n,e),e[Be].type===1&&e[Ct].destroy();let r=e[eo];if(r!==null&&Mr(e[Jt])){r!==e[Jt]&&lg(r,e);let i=e[Jr];i!==null&&i.detachView(n)}im(e)}finally{Le(t)}}function WF(n,e){let t=n.cleanup,r=e[$s];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let a=t[s+3];a>=0?r[a]():r[-a].unsubscribe(),s+=2}else{let a=r[t[s+1]];t[s].call(a)}r!==null&&(e[$s]=null);let i=e[Di];if(i!==null){e[Di]=null;for(let s=0;s<i.length;s++){let a=i[s];a()}}let o=e[vl];if(o!==null){e[vl]=null;for(let s of o)s.destroy()}}function zF(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof es)){let o=t[r+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=i[o[s]],l=o[s+1];vt(4,a,l);try{l.call(a)}finally{vt(5,a,l)}}else{vt(4,i,o);try{o.call(i)}finally{vt(5,i,o)}}}}}function yE(n,e,t){return qF(n,e.parent,t)}function qF(n,e,t){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return t[gr];if(no(r)){let{encapsulation:i}=n.data[r.directiveStart+r.componentOffset];if(i===Ii.None||i===Ii.Emulated)return null}return Rr(r,t)}function xE(n,e,t){return YF(n,e,t)}function KF(n,e,t){return n.type&40?Rr(n,t):null}var YF=KF,ux;function Yf(n,e,t,r){let i=yE(n,r,e),o=e[Ct],s=r.parent||e[Rn],a=xE(s,r,e);if(i!=null)if(Array.isArray(t))for(let l=0;l<t.length;l++)lx(o,i,t[l],a,!1);else lx(o,i,t,a,!1);ux!==void 0&&ux(o,r,e,t,i)}function Al(n,e){if(e!==null){let t=e.type;if(t&3)return Rr(e,n);if(t&4)return gm(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return Al(n,r);{let i=n[e.index];return Mr(i)?gm(-1,i):_r(i)}}else{if(t&128)return Al(n,e.next);if(t&32)return ag(e,n)()||_r(n[e.index]);{let r=EE(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Xi(n[wn]);return Al(i,r)}else return Al(n,e.next)}}}return null}function EE(n,e){if(e!==null){let r=n[wn][Rn],i=e.projection;return r.projection[i]}return null}function gm(n,e){let t=rn+n+1;if(t<e.length){let r=e[t],i=r[Be].firstChild;if(i!==null)return Al(r,i)}return e[to]}function cg(n,e,t,r,i,o,s){for(;t!=null;){if(t.type===128){t=t.next;continue}let a=r[t.index],l=t.type;if(s&&e===0&&(a&&na(_r(a),r),t.flags|=2),!qf(t))if(l&8)cg(n,e,t.child,r,i,o,!1),Ks(e,n,i,a,o);else if(l&32){let c=ag(t,r),u;for(;u=c();)Ks(e,n,i,u,o);Ks(e,n,i,a,o)}else l&16?TE(n,e,r,t,i,o):Ks(e,n,i,a,o);t=s?t.projectionNext:t.next}}function Xf(n,e,t,r,i,o){cg(t,r,n.firstChild,e,i,o,!1)}function XF(n,e,t){let r=e[Ct],i=yE(n,t,e),o=t.parent||e[Rn],s=xE(o,t,e);TE(r,0,e,t,i,s)}function TE(n,e,t,r,i,o){let s=t[wn],l=s[Rn].projection[r.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++){let u=l[c];Ks(e,n,i,u,o)}else{let c=l,u=s[Jt];$x(r)&&(c.flags|=128),cg(n,e,c,u,i,o,!0)}}function ZF(n,e,t,r,i){let o=t[to],s=_r(t);o!==s&&Ks(e,n,r,o,i);for(let a=rn;a<t.length;a++){let l=t[a];Xf(l[Be],l,n,e,r,o)}}function QF(n,e,t,r,i){if(e)i?n.addClass(t,r):n.removeClass(t,r);else{let o=r.indexOf("-")===-1?void 0:ni.DashCase;i==null?n.removeStyle(t,r,o):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),o|=ni.Important),n.setStyle(t,r,i,o))}}function Nl(n,e,t,r,i=!1){for(;t!==null;){if(t.type===128){t=i?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&r.push(_r(o)),Mr(o)&&wE(o,r);let s=t.type;if(s&8)Nl(n,e,t.child,r);else if(s&32){let a=ag(t,e),l;for(;l=a();)r.push(l)}else if(s&16){let a=EE(e,t);if(Array.isArray(a))r.push(...a);else{let l=Xi(e[wn]);Nl(l[Be],l,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function wE(n,e){for(let t=rn;t<n.length;t++){let r=n[t],i=r[Be].firstChild;i!==null&&Nl(r[Be],r,i,e)}n[to]!==n[gr]&&e.push(n[to])}function CE(n){if(n[Ju]!==null){for(let e of n[Ju])e.impl.addSequence(e);n[Ju].length=0}}var DE=[];function JF(n){return n[tr]??ek(n)}function ek(n){let e=DE.pop()??Object.create(nk);return e.lView=n,e}function tk(n){n.lView[tr]!==n&&(n.lView=null,DE.push(n))}var nk=tt(Me({},Mo),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{Tl(n.lView)},consumerOnSignalRead(){this.lView[tr]=this}});function rk(n){let e=n[tr]??Object.create(ik);return e.lView=n,e}var ik=tt(Me({},Mo),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=Xi(n.lView);for(;e&&!SE(e[Be]);)e=Xi(e);e&&bp(e)},consumerOnSignalRead(){this.lView[tr]=this}});function SE(n){return n.type!==2}function bE(n){if(n[vl]===null)return;let e=!0;for(;e;){let t=!1;for(let r of n[vl])r.dirty&&(t=!0,r.zone===null||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));e=t&&!!(n[He]&8192)}}var ok=100;function ug(n,e=0){let r=n[Qr].rendererFactory,i=!1;i||r.begin?.();try{sk(n,e)}finally{i||r.end?.()}}function sk(n,e){let t=Op();try{Rp(!0),vm(n,e);let r=0;for(;El(n);){if(r===ok)throw new Ee(103,!1);r++,vm(n,1)}}finally{Rp(t)}}function IE(n,e){Mp(e?wl.Exhaustive:wl.OnlyDirtyViews);try{ug(n)}finally{Mp(wl.Off)}}function ak(n,e,t,r){if(Qo(e))return;let i=e[He],o=!1,s=!1;cf(e);let a=!0,l=null,c=null;o||(SE(n)?(c=JF(e),l=Oo(c)):iu()===null?(a=!1,c=rk(e),l=Oo(c)):e[tr]&&(su(e[tr]),e[tr]=null));try{Sp(e),Py(n.bindingStartIndex),t!==null&&gE(n,e,t,2,r);let u=(i&3)===3;if(!o)if(u){let d=n.preOrderCheckHooks;d!==null&&_f(e,d,null)}else{let d=n.preOrderHooks;d!==null&&yf(e,d,0,null),$p(e,0)}if(s||lk(e),bE(e),AE(e,0),n.contentQueries!==null&&eE(n,e),!o)if(u){let d=n.contentCheckHooks;d!==null&&_f(e,d)}else{let d=n.contentHooks;d!==null&&yf(e,d,1),$p(e,1)}uk(n,e);let f=n.components;f!==null&&kE(e,f,0);let h=n.viewQuery;if(h!==null&&sm(2,h,r),!o)if(u){let d=n.viewCheckHooks;d!==null&&_f(e,d)}else{let d=n.viewHooks;d!==null&&yf(e,d,2),$p(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[Qu]){for(let d of e[Qu])d();e[Qu]=null}o||(CE(e),e[He]&=-73)}catch(u){throw o||Tl(e),u}finally{c!==null&&(ks(c,l),a&&tk(c)),uf()}}function AE(n,e){for(let t=zx(n);t!==null;t=qx(t))for(let r=rn;r<t.length;r++){let i=t[r];FE(i,e)}}function lk(n){for(let e=zx(n);e!==null;e=qx(e)){if(!(e[He]&2))continue;let t=e[Zo];for(let r=0;r<t.length;r++){let i=t[r];bp(i)}}}function ck(n,e,t){vt(18);let r=yr(e,n);FE(r,t),vt(19,r[Nt])}function FE(n,e){tf(n)&&vm(n,e)}function vm(n,e){let r=n[Be],i=n[He],o=n[tr],s=!!(e===0&&i&16);if(s||=!!(i&64&&e===0),s||=!!(i&1024),s||=!!(o?.dirty&&Ja(o)),s||=!1,o&&(o.dirty=!1),n[He]&=-9217,s)ak(r,n,r.template,n[Nt]);else if(i&8192){let a=Le(null);try{bE(n),AE(n,1);let l=r.components;l!==null&&kE(n,l,1),CE(n)}finally{Le(a)}}}function kE(n,e,t){for(let r=0;r<e.length;r++)ck(n,e[r],t)}function uk(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)oo(~i);else{let o=i,s=t[++r],a=t[++r];By(s,o);let l=e[o];vt(24,l),a(2,l),vt(25,l)}}}finally{oo(-1)}}function fg(n,e){let t=Op()?64:1088;for(n[Qr].changeDetectionScheduler?.notify(e);n;){n[He]|=t;let r=Xi(n);if(zs(n)&&!r)return n;n=r}return null}function NE(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function ME(n,e){let t=rn+e;if(t<n.length)return n[t]}function jl(n,e,t,r=!0){let i=e[Be];if(fk(i,e,n,t),r){let s=gm(t,n),a=e[Ct],l=a.parentNode(n[to]);l!==null&&GF(i,n[Rn],a,e,l,s)}let o=e[qo];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function OE(n,e){let t=Ml(n,e);return t!==void 0&&Kf(t[Be],t),t}function Ml(n,e){if(n.length<=rn)return;let t=rn+e,r=n[t];if(r){let i=r[eo];i!==null&&i!==n&&lg(i,r),e>0&&(n[t-1][vr]=r[vr]);let o=dl(n,rn+e);HF(r[Be],r);let s=o[Jr];s!==null&&s.detachView(o[Be]),r[Jt]=null,r[vr]=null,r[He]&=-129}return r}function fk(n,e,t,r){let i=rn+r,o=t.length;r>0&&(t[i-1][vr]=e),r<o-rn?(e[vr]=t[i],hp(t,rn+r,e)):(t.push(e),e[vr]=null),e[Jt]=t;let s=e[eo];s!==null&&t!==s&&RE(s,e);let a=e[Jr];a!==null&&a.insertView(n),nf(e),e[He]|=128}function RE(n,e){let t=n[Zo],r=e[Jt];if(ei(r))n[He]|=2;else{let i=r[Jt][wn];e[wn]!==i&&(n[He]|=2)}t===null?n[Zo]=[e]:t.push(e)}var so=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let e=this._lView,t=e[Be];return Nl(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t}get context(){return this._lView[Nt]}set context(e){this._lView[Nt]=e}get destroyed(){return Qo(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Jt];if(Mr(e)){let t=e[_l],r=t?t.indexOf(this):-1;r>-1&&(Ml(e,r),dl(t,r))}this._attachedToViewContainer=!1}Kf(this._lView[Be],this._lView)}onDestroy(e){Ip(this._lView,e)}markForCheck(){fg(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[He]&=-129}reattach(){nf(this._lView),this._lView[He]|=128}detectChanges(){this._lView[He]|=1024,ug(this._lView)}checkNoChanges(){return;try{this.exhaustive??=this._lView[Ko].get(UF,cx)}catch{this.exhaustive=cx}}attachToViewContainerRef(){if(this._appRef)throw new Ee(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=zs(this._lView),t=this._lView[eo];t!==null&&!e&&lg(t,this._lView),_E(this._lView[Be],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Ee(902,!1);this._appRef=e;let t=zs(this._lView),r=this._lView[eo];r!==null&&!t&&RE(r,this._lView),nf(this._lView)}};var Qe=(()=>{class n{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=dk;constructor(t,r,i){this._declarationLView=t,this._declarationTContainer=r,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,r){return this.createEmbeddedViewImpl(t,r)}createEmbeddedViewImpl(t,r,i){let o=Ul(this._declarationLView,this._declarationTContainer,t,{embeddedViewInjector:r,dehydratedView:i});return new so(o)}}return n})();function dk(){return Zf(Cn(),Ve())}function Zf(n,e){return n.type&4?new Qe(e,n,ta(n,e)):null}function Hl(n,e,t,r,i){let o=n.data[e];if(o===null)o=hk(n,e,t,r,i),Ly()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=r,o.attrs=i;let s=Oy();o.injectorIndex=s===null?-1:s.injectorIndex}return ro(o,!0),o}function hk(n,e,t,r,i){let o=Np(),s=of(),a=s?o:o&&o.parent,l=n.data[e]=mk(n,a,t,e,r,i);return pk(n,l,o,s),l}function pk(n,e,t,r){n.firstChild===null&&(n.firstChild=e),t!==null&&(r?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function mk(n,e,t,r,i,o){let s=e?e.injectorIndex:-1,a=0;return kp()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var yq=new RegExp(`^(\\d+)*(${FA}|${AA})*(.*)`);function gk(n){let e=n[wp]??[],r=n[Jt][Ct],i=[];for(let o of e)o.data[Xx]!==void 0?i.push(o):vk(o,r);n[wp]=i}function vk(n,e){let t=0,r=n.firstChild;if(r){let i=n.data[Yx];for(;t<i;){let o=r.nextSibling;fE(e,r,!1),r=o,t++}}}var _k=()=>null,yk=()=>null;function If(n,e){return _k(n,e)}function PE(n,e,t){return yk(n,e,t)}var LE=class{},Qf=class{},_m=class{resolveComponentFactory(e){throw new Ee(917,!1)}},ia=class{static NULL=new _m},Fi=class{},Ur=(()=>{class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>xk()}return n})();function xk(){let n=Ve(),e=Cn(),t=yr(e.index,n);return(ei(t)?t:n)[Ct]}var BE=(()=>{class n{static \u0275prov=Ge({token:n,providedIn:"root",factory:()=>null})}return n})();var Ef={},ym=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){let i=this.injector.get(e,Ef,r);return i!==Ef||t===Ef?i:this.parentInjector.get(e,t,r)}};function xm(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")o=a;else if(o==1)i=$u(i,a);else if(o==2){let l=a,c=e[++s];r=$u(r,l+": "+c+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}function ae(n,e=0){let t=Ve();if(t===null)return We(n,e);let r=Cn();return jx(r,t,pn(n),e)}function dg(n,e,t,r,i){let o=r===null?null:{"":-1},s=i(n,t);if(s!==null){let a=s,l=null,c=null;for(let u of s)if(u.resolveHostDirectives!==null){[a,l,c]=u.resolveHostDirectives(s);break}wk(n,e,t,a,o,l,c)}o!==null&&r!==null&&Ek(t,r,o)}function Ek(n,e,t){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let o=t[e[i+1]];if(o==null)throw new Ee(-301,!1);r.push(e[i],o)}}function Tk(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function wk(n,e,t,r,i,o,s){let a=r.length,l=!1;for(let h=0;h<a;h++){let d=r[h];!l&&Or(d)&&(l=!0,Tk(n,t,h)),nm(Df(t,e),n,d.type)}Ak(t,n.data.length,a);for(let h=0;h<a;h++){let d=r[h];d.providersResolver&&d.providersResolver(d)}let c=!1,u=!1,f=pE(n,e,a,null);a>0&&(t.directiveToIndex=new Map);for(let h=0;h<a;h++){let d=r[h];if(t.mergedAttrs=Xs(t.mergedAttrs,d.hostAttrs),Dk(n,t,e,f,d),Ik(f,d,i),s!==null&&s.has(d)){let[p,g]=s.get(d);t.directiveToIndex.set(d.type,[f,p+t.directiveStart,g+t.directiveStart])}else(o===null||!o.has(d))&&t.directiveToIndex.set(d.type,f);d.contentQueries!==null&&(t.flags|=4),(d.hostBindings!==null||d.hostAttrs!==null||d.hostVars!==0)&&(t.flags|=64);let m=d.type.prototype;!c&&(m.ngOnChanges||m.ngOnInit||m.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),c=!0),!u&&(m.ngOnChanges||m.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),u=!0),f++}Ck(n,t,o)}function Ck(n,e,t){for(let r=e.directiveStart;r<e.directiveEnd;r++){let i=n.data[r];if(t===null||!t.has(i))fx(0,e,i,r),fx(1,e,i,r),hx(e,r,!1);else{let o=t.get(i);dx(0,e,o,r),dx(1,e,o,r),hx(e,r,!0)}}}function fx(n,e,t,r){let i=n===0?t.inputs:t.outputs;for(let o in i)if(i.hasOwnProperty(o)){let s;n===0?s=e.inputs??={}:s=e.outputs??={},s[o]??=[],s[o].push(r),VE(e,o)}}function dx(n,e,t,r){let i=n===0?t.inputs:t.outputs;for(let o in i)if(i.hasOwnProperty(o)){let s=i[o],a;n===0?a=e.hostDirectiveInputs??={}:a=e.hostDirectiveOutputs??={},a[s]??=[],a[s].push(r,o),VE(e,s)}}function VE(n,e){e==="class"?n.flags|=8:e==="style"&&(n.flags|=16)}function hx(n,e,t){let{attrs:r,inputs:i,hostDirectiveInputs:o}=n;if(r===null||!t&&i===null||t&&o===null||Jm(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let s=null,a=0;for(;a<r.length;){let l=r[a];if(l===0){a+=4;continue}else if(l===5){a+=2;continue}else if(typeof l=="number")break;if(!t&&i.hasOwnProperty(l)){let c=i[l];for(let u of c)if(u===e){s??=[],s.push(l,r[a+1]);break}}else if(t&&o.hasOwnProperty(l)){let c=o[l];for(let u=0;u<c.length;u+=2)if(c[u]===e){s??=[],s.push(c[u+1],r[a+1]);break}}a+=2}n.initialInputs??=[],n.initialInputs.push(s)}function Dk(n,e,t,r,i){n.data[r]=i;let o=i.factory||(i.factory=jo(i.type,!0)),s=new es(o,Or(i),ae);n.blueprint[r]=s,t[r]=s,Sk(n,e,r,pE(n,t,i.hostVars,rr),i)}function Sk(n,e,t,r,i){let o=i.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let a=~e.index;bk(s)!=a&&s.push(a),s.push(t,r,o)}}function bk(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function Ik(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;Or(e)&&(t[""]=n)}}function Ak(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function UE(n,e,t,r,i,o,s,a){let l=e.consts,c=Pr(l,s),u=Hl(e,n,2,r,c);return o&&dg(e,t,u,Pr(l,a),i),u.mergedAttrs=Xs(u.mergedAttrs,u.attrs),u.attrs!==null&&xm(u,u.attrs,!1),u.mergedAttrs!==null&&xm(u,u.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,u),u}function jE(n,e){Hm(n,e),ef(e)&&n.queries.elementEnd(e)}function hg(n){return GE(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function HE(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function GE(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function Jf(n,e,t){return n[e]=t}function nr(n,e,t){if(t===rr)return!1;let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function Af(n,e,t,r){let i=nr(n,e,t);return nr(n,e+1,r)||i}function Fk(n,e,t,r,i){let o=Af(n,e,t,r);return nr(n,e+2,i)||o}function kk(n,e,t,r,i,o){let s=Af(n,e,t,r);return Af(n,e+2,i,o)||s}function qp(n,e,t){return function r(i){let o=no(n)?yr(n.index,e):e;fg(o,5);let s=e[Nt],a=px(e,s,t,i),l=r.__ngNextListenerFn__;for(;l;)a=px(e,s,l,i)&&a,l=l.__ngNextListenerFn__;return a}}function px(n,e,t,r){let i=Le(null);try{return vt(6,e,t),t(r)!==!1}catch(o){return PF(n,o),!1}finally{vt(7,e,t),Le(i)}}function Nk(n,e,t,r,i,o,s,a){let l=yl(n),c=!1,u=null;if(!r&&l&&(u=Mk(e,t,o,n.index)),u!==null){let f=u.__ngLastListenerFn__||u;f.__ngNextListenerFn__=s,u.__ngLastListenerFn__=s,c=!0}else{let f=Rr(n,t),h=r?r(f):f;NA(t,h,o,a);let d=i.listen(h,o,a),m=r?p=>r(_r(p[n.index])):n.index;$E(m,e,t,o,a,d,!1)}return c}function Mk(n,e,t,r){let i=n.cleanup;if(i!=null)for(let o=0;o<i.length-1;o+=2){let s=i[o];if(s===t&&i[o+1]===r){let a=e[$s],l=i[o+2];return a&&a.length>l?a[l]:null}typeof s=="string"&&(o+=2)}return null}function $E(n,e,t,r,i,o,s){let a=e.firstCreatePass?Fp(e):null,l=Ap(t),c=l.length;l.push(i,o),a&&a.push(r,n,c,(c+1)*(s?-1:1))}function mx(n,e,t,r,i,o){let s=e[t],a=e[Be],c=a.data[t].outputs[r],f=s[c].subscribe(o);$E(n.index,a,e,i,o,f,!0)}var Em=Symbol("BINDING");var Tm=class extends ia{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=zo(e);return new Ol(t,this.ngModule)}};function Ok(n){return Object.keys(n).map(e=>{let[t,r,i]=n[e],o={propName:t,templateName:e,isSignal:(r&Wf.SignalBased)!==0};return i&&(o.transform=i),o})}function Rk(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}function Pk(n,e,t){let r=e instanceof mr?e:e?.injector;return r&&n.getStandaloneInjector!==null&&(r=n.getStandaloneInjector(r)||r),r?new ym(t,r):t}function Lk(n){let e=n.get(Fi,null);if(e===null)throw new Ee(407,!1);let t=n.get(BE,null),r=n.get($o,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:r,ngReflect:!1}}function Bk(n,e){let t=(n.selectors[0][0]||"div").toLowerCase();return cE(e,t,t==="svg"?Ey:t==="math"?Ty:null)}var Ol=class extends Qf{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=Ok(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=Rk(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=hF(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,r,i,o,s){vt(22);let a=Le(null);try{let l=this.componentDef,c=Vk(r,l,s,o),u=Pk(l,i||this.ngModule,e),f=Lk(u),h=f.rendererFactory.createRenderer(null,l),d=r?wF(h,r,l.encapsulation,u):Bk(l,h),m=s?.some(gx)||o?.some(w=>typeof w!="function"&&w.bindings.some(gx)),p=tg(null,c,null,512|hE(l),null,null,f,h,u,null,Jx(d,u,!0));p[nn]=d,cf(p);let g=null;try{let w=UE(nn,c,p,"#host",()=>c.directiveRegistry,!0,0);d&&(dE(h,d,w),na(d,p)),zf(c,p,w),qm(c,w,p),jE(c,w),t!==void 0&&jk(w,this.ngContentSelectors,t),g=yr(w.index,p),p[Nt]=g[Nt],sg(c,p,null)}catch(w){throw g!==null&&im(g),im(p),w}finally{vt(23),uf()}return new Ff(this.componentType,p,!!m)}finally{Le(a)}}};function Vk(n,e,t,r){let i=n?["ng-version","20.0.4"]:pF(e.selectors[0]),o=null,s=null,a=0;if(t)for(let u of t)a+=u[Em].requiredVars,u.create&&(u.targetIdx=0,(o??=[]).push(u)),u.update&&(u.targetIdx=0,(s??=[]).push(u));if(r)for(let u=0;u<r.length;u++){let f=r[u];if(typeof f!="function")for(let h of f.bindings){a+=h[Em].requiredVars;let d=u+1;h.create&&(h.targetIdx=d,(o??=[]).push(h)),h.update&&(h.targetIdx=d,(s??=[]).push(h))}}let l=[e];if(r)for(let u of r){let f=typeof u=="function"?u:u.type,h=gp(f);l.push(h)}return eg(0,null,Uk(o,s),1,a,l,null,null,null,[i],null)}function Uk(n,e){return!n&&!e?null:t=>{if(t&1&&n)for(let r of n)r.create();if(t&2&&e)for(let r of e)r.update()}}function gx(n){let e=n[Em].kind;return e==="input"||e==="twoWay"}var Ff=class extends LE{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t,r){super(),this._rootLView=t,this._hasInputBindings=r,this._tNode=xl(t[Be],nn),this.location=ta(this._tNode,t),this.instance=yr(this._tNode.index,t)[Nt],this.hostView=this.changeDetectorRef=new so(t,void 0),this.componentType=e}setInput(e,t){this._hasInputBindings;let r=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let i=this._rootLView,o=og(r,i[Be],i,e,t);this.previousInputValues.set(e,t);let s=yr(r.index,i);fg(s,1)}get injector(){return new Jo(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function jk(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let o=t[i];r.push(o!=null&&o.length?Array.from(o):null)}}var Ni=(()=>{class n{static __NG_ELEMENT_ID__=Hk}return n})();function Hk(){let n=Cn();return zE(n,Ve())}var Gk=Ni,WE=class extends Gk{_lContainer;_hostTNode;_hostLView;constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return ta(this._hostTNode,this._hostLView)}get injector(){return new Jo(this._hostTNode,this._hostLView)}get parentInjector(){let e=Gm(this._hostTNode,this._hostLView);if(Rx(e)){let t=Cf(e,this._hostLView),r=wf(e),i=t[Be].data[r+8];return new Jo(i,t)}else return new Jo(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=vx(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-rn}createEmbeddedView(e,t,r){let i,o;typeof r=="number"?i=r:r!=null&&(i=r.index,o=r.injector);let s=If(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(a,i,Zs(this._hostTNode,s)),a}createComponent(e,t,r,i,o,s,a){let l=e&&!rA(e),c;if(l)c=t;else{let g=t||{};c=g.index,r=g.injector,i=g.projectableNodes,o=g.environmentInjector||g.ngModuleRef,s=g.directives,a=g.bindings}let u=l?e:new Ol(zo(e)),f=r||this.parentInjector;if(!o&&u.ngModule==null){let w=(l?f:this.parentInjector).get(mr,null);w&&(o=w)}let h=zo(u.componentType??{}),d=If(this._lContainer,h?.id??null),m=d?.firstChild??null,p=u.create(f,i,m,o,s,a);return this.insertImpl(p.hostView,c,Zs(this._hostTNode,d)),p}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(Dy(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let l=i[Jt],c=new WE(l,l[Rn],l[Jt]);c.detach(c.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return jl(s,i,o,r),e.attachToViewContainerRef(),hp(Kp(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=vx(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=Ml(this._lContainer,t);r&&(dl(Kp(this._lContainer),t),Kf(r[Be],r))}detach(e){let t=this._adjustIndex(e,-1),r=Ml(this._lContainer,t);return r&&dl(Kp(this._lContainer),t)!=null?new so(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function vx(n){return n[_l]}function Kp(n){return n[_l]||(n[_l]=[])}function zE(n,e){let t,r=e[n.index];return Mr(r)?t=r:(t=NE(r,e,null,n),e[n.index]=t,ng(e,t)),Wk(t,e,n,r),new WE(t,n,e)}function $k(n,e){let t=n[Ct],r=t.createComment(""),i=Rr(e,n),o=t.parentNode(i);return bf(t,o,r,t.nextSibling(i),!1),r}var Wk=Kk,zk=()=>!1;function qk(n,e,t){return zk(n,e,t)}function Kk(n,e,t,r){if(n[to])return;let i;t.type&8?i=_r(r):i=$k(e,t),n[to]=i}var wm=class n{queryList;matches=null;constructor(e){this.queryList=e}clone(){return new n(this.queryList)}setDirty(){this.queryList.setDirty()}},Cm=class n{queries;constructor(e=[]){this.queries=e}createEmbeddedView(e){let t=e.queries;if(t!==null){let r=e.contentQueries!==null?e.contentQueries[0]:t.length,i=[];for(let o=0;o<r;o++){let s=t.getByIndex(o),a=this.queries[s.indexInDeclarationView];i.push(a.clone())}return new n(i)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)pg(e,t).matches!==null&&this.queries[t].setDirty()}},kf=class{flags;read;predicate;constructor(e,t,r=null){this.flags=t,this.read=r,typeof e=="string"?this.predicate=nN(e):this.predicate=e}},Dm=class n{queries;constructor(e=[]){this.queries=e}elementStart(e,t){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let r=0;r<this.length;r++){let i=t!==null?t.length:0,o=this.getByIndex(r).embeddedTView(e,i);o&&(o.indexInDeclarationView=r,t!==null?t.push(o):t=[o])}return t!==null?new n(t):null}template(e,t){for(let r=0;r<this.queries.length;r++)this.queries[r].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},Sm=class n{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(e,t=-1){this.metadata=e,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new n(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,r=e.parent;for(;r!==null&&r.type&8&&r.index!==t;)r=r.parent;return t===(r!==null?r.index:-1)}return this._appliesToNextNode}matchTNode(e,t){let r=this.metadata.predicate;if(Array.isArray(r))for(let i=0;i<r.length;i++){let o=r[i];this.matchTNodeWithReadOption(e,t,Yk(t,o)),this.matchTNodeWithReadOption(e,t,xf(t,e,o,!1,!1))}else r===Qe?t.type&4&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,xf(t,e,r,!1,!1))}matchTNodeWithReadOption(e,t,r){if(r!==null){let i=this.metadata.read;if(i!==null)if(i===It||i===Ni||i===Qe&&t.type&4)this.addMatch(t.index,-2);else{let o=xf(t,e,i,!1,!1);o!==null&&this.addMatch(t.index,o)}else this.addMatch(t.index,r)}}addMatch(e,t){this.matches===null?this.matches=[e,t]:this.matches.push(e,t)}};function Yk(n,e){let t=n.localNames;if(t!==null){for(let r=0;r<t.length;r+=2)if(t[r]===e)return t[r+1]}return null}function Xk(n,e){return n.type&11?ta(n,e):n.type&4?Zf(n,e):null}function Zk(n,e,t,r){return t===-1?Xk(e,n):t===-2?Qk(n,e,r):kl(n,n[Be],t,e)}function Qk(n,e,t){if(t===It)return ta(e,n);if(t===Qe)return Zf(e,n);if(t===Ni)return zE(e,n)}function qE(n,e,t,r){let i=e[Jr].queries[r];if(i.matches===null){let o=n.data,s=t.matches,a=[];for(let l=0;s!==null&&l<s.length;l+=2){let c=s[l];if(c<0)a.push(null);else{let u=o[c];a.push(Zk(e,u,s[l+1],t.metadata.read))}}i.matches=a}return i.matches}function bm(n,e,t,r){let i=n.queries.getByIndex(t),o=i.matches;if(o!==null){let s=qE(n,e,i,t);for(let a=0;a<o.length;a+=2){let l=o[a];if(l>0)r.push(s[a/2]);else{let c=o[a+1],u=e[-l];for(let f=rn;f<u.length;f++){let h=u[f];h[eo]===h[Jt]&&bm(h[Be],h,c,r)}if(u[Zo]!==null){let f=u[Zo];for(let h=0;h<f.length;h++){let d=f[h];bm(d[Be],d,c,r)}}}}}return r}function Jk(n,e){return n[Jr].queries[e].queryList}function KE(n,e,t){let r=new Sf((t&4)===4);return Iy(n,e,r,r.destroy),(e[Jr]??=new Cm).queries.push(new wm(r))-1}function eN(n,e,t){let r=bt();return r.firstCreatePass&&(YE(r,new kf(n,e,t),-1),(e&2)===2&&(r.staticViewQueries=!0)),KE(r,Ve(),e)}function tN(n,e,t,r){let i=bt();if(i.firstCreatePass){let o=Cn();YE(i,new kf(e,t,r),o.index),rN(i,n),(t&2)===2&&(i.staticContentQueries=!0)}return KE(i,Ve(),t)}function nN(n){return n.split(",").map(e=>e.trim())}function YE(n,e,t){n.queries===null&&(n.queries=new Dm),n.queries.track(new Sm(e,t))}function rN(n,e){let t=n.contentQueries||(n.contentQueries=[]),r=t.length?t[t.length-1]:-1;e!==r&&t.push(n.queries.length-1,e)}function pg(n,e){return n.queries.getByIndex(e)}function iN(n,e){let t=n[Be],r=pg(t,e);return r.crossesNgTemplate?bm(t,n,e,[]):qE(t,n,r,e)}var _x=new Set;function lo(n){_x.has(n)||(_x.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var Rl=class{};var Pl=class extends Rl{injector;componentFactoryResolver=new Tm(this);instance=null;constructor(e){super();let t=new Go([...e.providers,{provide:Rl,useValue:this},{provide:ia,useValue:this.componentFactoryResolver}],e.parent||ml(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function XE(n,e,t=null){return new Pl({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var oN=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=vp(!1,t.type),i=r.length>0?XE([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=Ge({token:n,providedIn:"environment",factory:()=>new n(We(mr))})}return n})();function nt(n){return ea(()=>{let e=ZE(n),t=tt(Me({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===$m.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?i=>i.get(oN).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Ii.Emulated,styles:n.styles||Mn,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&lo("NgStandalone"),QE(t);let r=n.dependencies;return t.directiveDefs=yx(r,!1),t.pipeDefs=yx(r,!0),t.id=uN(t),t})}function sN(n){return zo(n)||gp(n)}function aN(n){return n!==null}function ir(n){return ea(()=>({type:n.type,bootstrap:n.bootstrap||Mn,declarations:n.declarations||Mn,imports:n.imports||Mn,exports:n.exports||Mn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function lN(n,e){if(n==null)return Qi;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],o,s,a,l;Array.isArray(i)?(a=i[0],o=i[1],s=i[2]??o,l=i[3]||null):(o=i,s=i,a=Wf.None,l=null),t[o]=[r,a,l],e[o]=s}return t}function cN(n){if(n==null)return Qi;let e={};for(let t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function ze(n){return ea(()=>{let e=ZE(n);return QE(e),e})}function ZE(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||Qi,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||Mn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:lN(n.inputs,e),outputs:cN(n.outputs),debugInfo:null}}function QE(n){n.features?.forEach(e=>e(n))}function yx(n,e){if(!n)return null;let t=e?my:sN;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(aN)}function uN(n){let e=0,t=typeof n.consts=="function"?"":n.consts,r=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let o of r.join("|"))e=Math.imul(31,e)+o.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function fN(n){return Object.getPrototypeOf(n.prototype).constructor}function Dn(n){let e=fN(n.type),t=!0,r=[n];for(;e;){let i;if(Or(n))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Ee(903,!1);i=e.\u0275dir}if(i){if(t){r.push(i);let s=n;s.inputs=Yp(n.inputs),s.declaredInputs=Yp(n.declaredInputs),s.outputs=Yp(n.outputs);let a=i.hostBindings;a&&gN(n,a);let l=i.viewQuery,c=i.contentQueries;if(l&&pN(n,l),c&&mN(n,c),dN(n,i),ay(n.outputs,i.outputs),Or(i)&&i.data.animation){let u=n.data;u.animation=(u.animation||[]).concat(i.data.animation)}}let o=i.features;if(o)for(let s=0;s<o.length;s++){let a=o[s];a&&a.ngInherit&&a(n),a===Dn&&(t=!1)}}e=Object.getPrototypeOf(e)}hN(r)}function dN(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let r=e.inputs[t];r!==void 0&&(n.inputs[t]=r,n.declaredInputs[t]=e.declaredInputs[t])}}function hN(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){let i=n[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Xs(i.hostAttrs,t=Xs(t,i.hostAttrs))}}function Yp(n){return n===Qi?{}:n===Mn?[]:n}function pN(n,e){let t=n.viewQuery;t?n.viewQuery=(r,i)=>{e(r,i),t(r,i)}:n.viewQuery=e}function mN(n,e){let t=n.contentQueries;t?n.contentQueries=(r,i,o)=>{e(r,i,o),t(r,i,o)}:n.contentQueries=e}function gN(n,e){let t=n.hostBindings;t?n.hostBindings=(r,i)=>{e(r,i),t(r,i)}:n.hostBindings=e}function vN(n,e,t,r,i,o,s,a,l){let c=e.consts,u=Hl(e,n,4,s||null,a||null);rf()&&dg(e,t,u,Pr(c,l),ig),u.mergedAttrs=Xs(u.mergedAttrs,u.attrs),Hm(e,u);let f=u.tView=eg(2,u,r,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c,null);return e.queries!==null&&(e.queries.template(e,u),f.queries=e.queries.embeddedTView(u)),u}function Qs(n,e,t,r,i,o,s,a,l,c,u){let f=t+nn,h=e.firstCreatePass?vN(f,e,n,r,i,o,s,a,c):e.data[f];l&&(h.flags|=l),ro(h,!1);let d=_N(e,n,h,t);Dl()&&Yf(e,n,d,h),na(d,n);let m=NE(d,n,d,h);return n[f]=m,ng(n,m),qk(m,h,n),yl(h)&&zf(e,n,h),c!=null&&rg(n,h,u),h}function be(n,e,t,r,i,o,s,a){let l=Ve(),c=bt(),u=Pr(c.consts,o);return Qs(l,c,n,e,t,r,i,u,void 0,s,a),be}var _N=yN;function yN(n,e,t,r){return Sl(!0),e[Ct].createComment("")}var mg=function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n}(mg||{}),Gl=new Re(""),JE=!1,Im=class extends St{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,xy()&&(this.destroyRef=Pe(df,{optional:!0})??void 0,this.pendingTasks=Pe(qs,{optional:!0})??void 0)}emit(e){let t=Le(null);try{super.next(e)}finally{Le(t)}}subscribe(e,t,r){let i=e,o=t||(()=>null),s=r;if(e&&typeof e=="object"){let l=e;i=l.next?.bind(l),o=l.error?.bind(l),s=l.complete?.bind(l)}this.__isAsync&&(o=this.wrapInTimeout(o),i&&(i=this.wrapInTimeout(i)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:i,error:o,complete:s});return e instanceof Qt&&e.add(a),a}wrapInTimeout(e){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{r!==void 0&&this.pendingTasks?.remove(r)}})}}},ot=Im;function eT(n){let e,t;function r(){n=Il;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),r()})),()=>r()}function xx(n){return queueMicrotask(()=>n()),()=>{n=Il}}var gg="isAngularZone",Nf=gg+"_ID",xN=0,xt=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new ot(!1);onMicrotaskEmpty=new ot(!1);onStable=new ot(!1);onError=new ot(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:o=JE}=e;if(typeof Zone>"u")throw new Ee(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!i&&r,s.shouldCoalesceRunChangeDetection=i,s.callbackScheduled=!1,s.scheduleInRootZone=o,wN(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(gg)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new Ee(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new Ee(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+i,e,EN,Il,Il);try{return o.runTask(s,t,r)}finally{o.cancelTask(s)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},EN={};function vg(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function TN(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){eT(()=>{n.callbackScheduled=!1,Am(n),n.isCheckStableRunning=!0,vg(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),Am(n)}function wN(n){let e=()=>{TN(n)},t=xN++;n._inner=n._inner.fork({name:"angular",properties:{[gg]:!0,[Nf]:t,[Nf+t]:!0},onInvokeTask:(r,i,o,s,a,l)=>{if(CN(l))return r.invokeTask(o,s,a,l);try{return Ex(n),r.invokeTask(o,s,a,l)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),Tx(n)}},onInvoke:(r,i,o,s,a,l,c)=>{try{return Ex(n),r.invoke(o,s,a,l,c)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!DN(l)&&e(),Tx(n)}},onHasTask:(r,i,o,s)=>{r.hasTask(o,s),i===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,Am(n),vg(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(r,i,o,s)=>(r.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function Am(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function Ex(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function Tx(n){n._nesting--,vg(n)}var Mf=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new ot;onMicrotaskEmpty=new ot;onStable=new ot;onError=new ot;run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function CN(n){return tT(n,"__ignore_ng_zone__")}function DN(n){return tT(n,"__scheduler_tick__")}function tT(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var nT=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=Ge({token:n,providedIn:"root",factory:()=>new n})}return n})();var _g=new Re("");function oa(n){return!!n&&typeof n.then=="function"}function yg(n){return!!n&&typeof n.subscribe=="function"}var rT=new Re("");var xg=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r});appInits=Pe(rT,{optional:!0})??[];injector=Pe(On);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let o=Zu(this.injector,i);if(oa(o))t.push(o);else if(yg(o)){let s=new Promise((a,l)=>{o.subscribe({complete:a,error:l})});t.push(s)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),iT=new Re("");function oT(){D0(()=>{let n="";throw new Ee(600,n)})}function sT(n){return n.isBoundToModule}var SN=10;var ii=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=Pe(bi);afterRenderManager=Pe(nT);zonelessEnabled=Pe(bl);rootEffectScheduler=Pe(Gp);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new St;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=Pe(qs);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(Nr(t=>!t))}constructor(){Pe(Gl,{optional:!0})}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{t.unsubscribe()})}_injector=Pe(mr);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,r){return this.bootstrapImpl(t,r)}bootstrapImpl(t,r,i=On.NULL){return this._injector.get(xt).run(()=>{vt(10);let s=t instanceof Qf;if(!this._injector.get(xg).done){let m="";throw new Ee(405,m)}let l;s?l=t:l=this._injector.get(ia).resolveComponentFactory(t),this.componentTypes.push(l.componentType);let c=sT(l)?void 0:this._injector.get(Rl),u=r||l.selector,f=l.create(i,[],u,c),h=f.location.nativeElement,d=f.injector.get(_g,null);return d?.registerApplication(h),f.onDestroy(()=>{this.detachView(f.hostView),Fl(this.components,f),d?.unregisterApplication(h)}),this._loadComponent(f),vt(11,f),f})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){vt(12),this.tracingSnapshot!==null?this.tracingSnapshot.run(mg.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new Ee(101,!1);let t=Le(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,Le(t),this.afterTick.next(),vt(13)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Fi,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<SN;)vt(14),this.synchronizeOnce(),vt(15)}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let t=!1;if(this.dirtyFlags&7){let r=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:i}of this.allViews){if(!r&&!El(i))continue;let o=r&&!this.zonelessEnabled?0:1;ug(i,o),t=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}t||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>El(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;Fl(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView);try{this.tick()}catch(i){this.internalErrorHandler(i)}this.components.push(t),this._injector.get(iT,[]).forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Fl(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new Ee(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Fl(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function or(n,e,t,r){let i=Ve(),o=io();if(nr(i,o,e)){let s=bt(),a=ff();NF(a,i,n,e,t,r)}return or}function ed(){return Ve()[wn][Nt]}var Fm=class{destroy(e){}updateValue(e,t){}swap(e,t){let r=Math.min(e,t),i=Math.max(e,t),o=this.detach(i);if(i-r>1){let s=this.detach(r);this.attach(r,o),this.attach(i,s)}else this.attach(r,o)}move(e,t){this.attach(t,this.detach(e))}};function Xp(n,e,t,r,i){return n===t&&Object.is(e,r)?1:Object.is(i(n,e),i(t,r))?-1:0}function bN(n,e,t){let r,i,o=0,s=n.length-1,a=void 0;if(Array.isArray(e)){let l=e.length-1;for(;o<=s&&o<=l;){let c=n.at(o),u=e[o],f=Xp(o,c,o,u,t);if(f!==0){f<0&&n.updateValue(o,u),o++;continue}let h=n.at(s),d=e[l],m=Xp(s,h,l,d,t);if(m!==0){m<0&&n.updateValue(s,d),s--,l--;continue}let p=t(o,c),g=t(s,h),w=t(o,u);if(Object.is(w,g)){let y=t(l,d);Object.is(y,p)?(n.swap(o,s),n.updateValue(s,d),l--,s--):n.move(s,o),n.updateValue(o,u),o++;continue}if(r??=new Of,i??=Cx(n,o,s,t),km(n,r,o,w))n.updateValue(o,u),o++,s++;else if(i.has(w))r.set(p,n.detach(o)),s--;else{let y=n.create(o,e[o]);n.attach(o,y),o++,s++}}for(;o<=l;)wx(n,r,t,o,e[o]),o++}else if(e!=null){let l=e[Symbol.iterator](),c=l.next();for(;!c.done&&o<=s;){let u=n.at(o),f=c.value,h=Xp(o,u,o,f,t);if(h!==0)h<0&&n.updateValue(o,f),o++,c=l.next();else{r??=new Of,i??=Cx(n,o,s,t);let d=t(o,f);if(km(n,r,o,d))n.updateValue(o,f),o++,s++,c=l.next();else if(!i.has(d))n.attach(o,n.create(o,f)),o++,s++,c=l.next();else{let m=t(o,u);r.set(m,n.detach(o)),s--}}}for(;!c.done;)wx(n,r,t,n.length,c.value),c=l.next()}for(;o<=s;)n.destroy(n.detach(s--));r?.forEach(l=>{n.destroy(l)})}function km(n,e,t,r){return e!==void 0&&e.has(r)?(n.attach(t,e.get(r)),e.delete(r),!0):!1}function wx(n,e,t,r,i){if(km(n,e,r,t(r,i)))n.updateValue(r,i);else{let o=n.create(r,i);n.attach(r,o)}}function Cx(n,e,t,r){let i=new Set;for(let o=e;o<=t;o++)i.add(r(o,n.at(o)));return i}var Of=class{kvMap=new Map;_vMap=void 0;has(e){return this.kvMap.has(e)}delete(e){if(!this.has(e))return!1;let t=this.kvMap.get(e);return this._vMap!==void 0&&this._vMap.has(t)?(this.kvMap.set(e,this._vMap.get(t)),this._vMap.delete(t)):this.kvMap.delete(e),!0}get(e){return this.kvMap.get(e)}set(e,t){if(this.kvMap.has(e)){let r=this.kvMap.get(e);this._vMap===void 0&&(this._vMap=new Map);let i=this._vMap;for(;i.has(r);)r=i.get(r);i.set(r,t)}else this.kvMap.set(e,t)}forEach(e){for(let[t,r]of this.kvMap)if(e(r,t),this._vMap!==void 0){let i=this._vMap;for(;i.has(r);)r=i.get(r),e(r,t)}}};function Sn(n,e,t,r,i,o,s,a){lo("NgControlFlow");let l=Ve(),c=bt(),u=Pr(c.consts,o);return Qs(l,c,n,e,t,r,i,u,256,s,a),Eg}function Eg(n,e,t,r,i,o,s,a){lo("NgControlFlow");let l=Ve(),c=bt(),u=Pr(c.consts,o);return Qs(l,c,n,e,t,r,i,u,512,s,a),Eg}function bn(n,e){lo("NgControlFlow");let t=Ve(),r=io(),i=t[r]!==rr?t[r]:-1,o=i!==-1?Rf(t,nn+i):void 0,s=0;if(nr(t,r,n)){let a=Le(null);try{if(o!==void 0&&OE(o,s),n!==-1){let l=nn+n,c=Rf(t,l),u=Rm(t[Be],l),f=PE(c,u,t),h=Ul(t,u,e,{dehydratedView:f});jl(c,h,s,Zs(u,f))}}finally{Le(a)}}else if(o!==void 0){let a=ME(o,s);a!==void 0&&(a[Nt]=e)}}var Nm=class{lContainer;$implicit;$index;constructor(e,t,r){this.lContainer=e,this.$implicit=t,this.$index=r}get $count(){return this.lContainer.length-rn}};var Mm=class{hasEmptyBlock;trackByFn;liveCollection;constructor(e,t,r){this.hasEmptyBlock=e,this.trackByFn=t,this.liveCollection=r}};function td(n,e,t,r,i,o,s,a,l,c,u,f,h){lo("NgControlFlow");let d=Ve(),m=bt(),p=l!==void 0,g=Ve(),w=a?s.bind(g[wn][Nt]):s,y=new Mm(p,w);g[nn+n]=y,Qs(d,m,n+1,e,t,r,i,Pr(m.consts,o),256),p&&Qs(d,m,n+2,l,c,u,f,Pr(m.consts,h),512)}var Om=class extends Fm{lContainer;hostLView;templateTNode;operationsCounter=void 0;needsIndexUpdate=!1;constructor(e,t,r){super(),this.lContainer=e,this.hostLView=t,this.templateTNode=r}get length(){return this.lContainer.length-rn}at(e){return this.getLView(e)[Nt].$implicit}attach(e,t){let r=t[qo];this.needsIndexUpdate||=e!==this.length,jl(this.lContainer,t,e,Zs(this.templateTNode,r))}detach(e){return this.needsIndexUpdate||=e!==this.length-1,IN(this.lContainer,e)}create(e,t){let r=If(this.lContainer,this.templateTNode.tView.ssrId),i=Ul(this.hostLView,this.templateTNode,new Nm(this.lContainer,t,e),{dehydratedView:r});return this.operationsCounter?.recordCreate(),i}destroy(e){Kf(e[Be],e),this.operationsCounter?.recordDestroy()}updateValue(e,t){this.getLView(e)[Nt].$implicit=t}reset(){this.needsIndexUpdate=!1,this.operationsCounter?.reset()}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[Nt].$index=e}getLView(e){return AN(this.lContainer,e)}};function nd(n){let e=Le(null),t=Si();try{let r=Ve(),i=r[Be],o=r[t],s=t+1,a=Rf(r,s);if(o.liveCollection===void 0){let c=Rm(i,s);o.liveCollection=new Om(a,r,c)}else o.liveCollection.reset();let l=o.liveCollection;if(bN(l,n,o.trackByFn),l.updateIndexes(),o.hasEmptyBlock){let c=io(),u=l.length===0;if(nr(r,c,u)){let f=t+2,h=Rf(r,f);if(u){let d=Rm(i,f),m=PE(h,d,r),p=Ul(r,d,void 0,{dehydratedView:m});jl(h,p,0,Zs(d,m))}else i.firstUpdatePass&&gk(h),OE(h,0)}}}finally{Le(e)}}function Rf(n,e){return n[e]}function IN(n,e){return Ml(n,e)}function AN(n,e){return ME(n,e)}function Rm(n,e){return xl(n,e)}function H(n,e,t){let r=Ve(),i=io();if(nr(r,i,e)){let o=bt(),s=ff();bF(s,r,n,e,r[Ct],t)}return H}function Pm(n,e,t,r,i){og(e,n,t,i?"class":"style",r)}function E(n,e,t,r){let i=Ve(),o=bt(),s=nn+n,a=i[Ct],l=o.firstCreatePass?UE(s,o,i,e,ig,rf(),t,r):o.data[s],c=FN(o,i,l,a,e,n);i[s]=c;let u=yl(l);return ro(l,!0),dE(a,c,l),!qf(l)&&Dl()&&Yf(o,i,c,l),(Ay()===0||u)&&na(c,i),Fy(),u&&(zf(o,i,l),qm(o,l,i)),r!==null&&rg(i,l),E}function _(){let n=Cn();of()?sf():(n=n.parent,ro(n,!1));let e=n;Ny(e)&&My(),ky();let t=bt();return t.firstCreatePass&&jE(t,e),e.classesWithoutHost!=null&&cA(e)&&Pm(t,e,Ve(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&uA(e)&&Pm(t,e,Ve(),e.stylesWithoutHost,!1),_}function J(n,e,t,r){return E(n,e,t,r),_(),J}var FN=(n,e,t,r,i,o)=>(Sl(!0),cE(r,i,$y()));function kN(n,e,t,r,i){let o=e.consts,s=Pr(o,r),a=Hl(e,n,8,"ng-container",s);s!==null&&xm(a,s,!0);let l=Pr(o,i);return rf()&&dg(e,t,a,l,ig),a.mergedAttrs=Xs(a.mergedAttrs,a.attrs),e.queries!==null&&e.queries.elementStart(e,a),a}function oi(n,e,t){let r=Ve(),i=bt(),o=n+nn,s=i.firstCreatePass?kN(o,i,r,e,t):i.data[o];ro(s,!0);let a=NN(i,r,s,n);return r[o]=a,Dl()&&Yf(i,r,a,s),na(a,r),yl(s)&&(zf(i,r,s),qm(i,s,r)),t!=null&&rg(r,s),oi}function si(){let n=Cn(),e=bt();return of()?sf():(n=n.parent,ro(n,!1)),e.firstCreatePass&&(Hm(e,n),ef(n)&&e.queries.elementEnd(n)),si}function sa(n,e,t){return oi(n,e,t),si(),sa}var NN=(n,e,t,r)=>(Sl(!0),vF(e[Ct],""));function _t(){return Ve()}function rd(n,e,t){let r=Ve(),i=io();if(nr(r,i,e)){let o=bt(),s=ff(),a=Lp(o.data),l=RF(a,s,r);vE(s,r,n,e,l,t)}return rd}var $l="en-US";var MN=$l;function aT(n){typeof n=="string"&&(MN=n.toLowerCase().replace(/_/g,"-"))}function Ce(n,e,t){let r=Ve(),i=bt(),o=Cn();return ON(i,r,r[Ct],o,n,e,t),Ce}function ON(n,e,t,r,i,o,s){let a=!0,l=null;if((r.type&3||s)&&(l??=qp(r,e,o),Nk(r,n,e,s,t,i,o,l)&&(a=!1)),a){let c=r.outputs?.[i],u=r.hostDirectiveOutputs?.[i];if(u&&u.length)for(let f=0;f<u.length;f+=2){let h=u[f],d=u[f+1];l??=qp(r,e,o),mx(r,e,h,d,i,l)}if(c&&c.length)for(let f of c)l??=qp(r,e,o),mx(r,e,f,i,i,l)}}function re(n=1){return Gy(n)}function RN(n,e){let t=null,r=lF(n);for(let i=0;i<e.length;i++){let o=e[i];if(o==="*"){t=i;continue}if(r===null?lE(n,o,!0):fF(r,o))return i}return t}function id(n){let e=Ve()[wn][Rn];if(!e.projection){let t=n?n.length:1,r=e.projection=hy(t,null),i=r.slice(),o=e.child;for(;o!==null;){if(o.type!==128){let s=n?RN(o,n):0;s!==null&&(i[s]?i[s].projectionNext=o:r[s]=o,i[s]=o)}o=o.next}}}function od(n,e=0,t,r,i,o){let s=Ve(),a=bt(),l=r?n+1:null;l!==null&&Qs(s,a,l,r,i,o,null,t);let c=Hl(a,nn+n,16,null,t||null);c.projection===null&&(c.projection=e),sf();let f=!s[qo]||kp();s[wn][Rn].projection[c.projection]===null&&l!==null?PN(s,a,l):f&&!qf(c)&&XF(a,s,c)}function PN(n,e,t){let r=nn+t,i=e.data[r],o=n[r],s=If(o,i.tView.ssrId),a=Ul(n,i,void 0,{dehydratedView:s});jl(o,a,0,Zs(i,s))}function In(n,e,t,r){tN(n,e,t,r)}function co(n,e,t){eN(n,e,t)}function Ot(n){let e=Ve(),t=bt(),r=Bp();lf(r+1);let i=pg(t,r);if(n.dirty&&Cy(e)===((i.metadata.flags&2)===2)){if(i.matches===null)n.reset([]);else{let o=iN(e,r);n.reset(o,wA),n.notifyOnChanges()}return!0}return!1}function Rt(){return Jk(Ve(),Bp())}function Er(n){let e=Ry();return wy(e,nn+n)}function vf(n,e){return n<<17|e<<2}function ts(n){return n>>17&32767}function LN(n){return(n&2)==2}function BN(n,e){return n&131071|e<<17}function Lm(n){return n|2}function Js(n){return(n&131068)>>2}function Zp(n,e){return n&-131069|e<<2}function VN(n){return(n&1)===1}function Bm(n){return n|1}function UN(n,e,t,r,i,o){let s=o?e.classBindings:e.styleBindings,a=ts(s),l=Js(s);n[r]=t;let c=!1,u;if(Array.isArray(t)){let f=t;u=f[1],(u===null||Gs(f,u)>0)&&(c=!0)}else u=t;if(i)if(l!==0){let h=ts(n[a+1]);n[r+1]=vf(h,a),h!==0&&(n[h+1]=Zp(n[h+1],r)),n[a+1]=BN(n[a+1],r)}else n[r+1]=vf(a,0),a!==0&&(n[a+1]=Zp(n[a+1],r)),a=r;else n[r+1]=vf(l,0),a===0?a=r:n[l+1]=Zp(n[l+1],r),l=r;c&&(n[r+1]=Lm(n[r+1])),Dx(n,u,r,!0),Dx(n,u,r,!1),jN(e,u,n,r,o),s=vf(a,l),o?e.classBindings=s:e.styleBindings=s}function jN(n,e,t,r,i){let o=i?n.residualClasses:n.residualStyles;o!=null&&typeof e=="string"&&Gs(o,e)>=0&&(t[r+1]=Bm(t[r+1]))}function Dx(n,e,t,r){let i=n[t+1],o=e===null,s=r?ts(i):Js(i),a=!1;for(;s!==0&&(a===!1||o);){let l=n[s],c=n[s+1];HN(l,e)&&(a=!0,n[s+1]=r?Bm(c):Lm(c)),s=r?ts(c):Js(c)}a&&(n[t+1]=r?Lm(i):Bm(i))}function HN(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?Gs(n,e)>=0:!1}var Br={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function GN(n){return n.substring(Br.key,Br.keyEnd)}function $N(n){return WN(n),lT(n,cT(n,0,Br.textEnd))}function lT(n,e){let t=Br.textEnd;return t===e?-1:(e=Br.keyEnd=zN(n,Br.key=e,t),cT(n,e,t))}function WN(n){Br.key=0,Br.keyEnd=0,Br.value=0,Br.valueEnd=0,Br.textEnd=n.length}function cT(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function zN(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}function rs(n,e,t){return uT(n,e,t,!1),rs}function Ie(n,e){return uT(n,e,null,!0),Ie}function ai(n){KN(eM,qN,n,!0)}function qN(n,e){for(let t=$N(e);t>=0;t=lT(e,t))Yu(n,GN(e),!0)}function uT(n,e,t,r){let i=Ve(),o=bt(),s=Pp(2);if(o.firstUpdatePass&&dT(o,n,s,r),e!==rr&&nr(i,s,e)){let a=o.data[Si()];hT(o,a,i,i[Ct],n,i[s+1]=nM(e,t),r,s)}}function KN(n,e,t,r){let i=bt(),o=Pp(2);i.firstUpdatePass&&dT(i,null,o,r);let s=Ve();if(t!==rr&&nr(s,o,t)){let a=i.data[Si()];if(pT(a,r)&&!fT(i,o)){let l=r?a.classesWithoutHost:a.stylesWithoutHost;l!==null&&(t=$u(l,t||"")),Pm(i,a,s,t,r)}else tM(i,a,s,s[Ct],s[o+1],s[o+1]=JN(n,e,t),r,o)}}function fT(n,e){return e>=n.expandoStartIndex}function dT(n,e,t,r){let i=n.data;if(i[t+1]===null){let o=i[Si()],s=fT(n,t);pT(o,r)&&e===null&&!s&&(e=!1),e=YN(i,o,e,r),UN(i,o,e,t,s,r)}}function YN(n,e,t,r){let i=Lp(n),o=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(t=Qp(null,n,e,t,r),t=Ll(t,e.attrs,r),o=null);else{let s=e.directiveStylingLast;if(s===-1||n[s]!==i)if(t=Qp(i,n,e,t,r),o===null){let l=XN(n,e,r);l!==void 0&&Array.isArray(l)&&(l=Qp(null,n,e,l[1],r),l=Ll(l,e.attrs,r),ZN(n,e,r,l))}else o=QN(n,e,r)}return o!==void 0&&(r?e.residualClasses=o:e.residualStyles=o),t}function XN(n,e,t){let r=t?e.classBindings:e.styleBindings;if(Js(r)!==0)return n[ts(r)]}function ZN(n,e,t,r){let i=t?e.classBindings:e.styleBindings;n[ts(i)]=r}function QN(n,e,t){let r,i=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<i;o++){let s=n[o].hostAttrs;r=Ll(r,s,t)}return Ll(r,e.attrs,t)}function Qp(n,e,t,r,i){let o=null,s=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<s&&(o=e[a],r=Ll(r,o.hostAttrs,i),o!==n);)a++;return n!==null&&(t.directiveStylingLast=a),r}function Ll(n,e,t){let r=t?1:2,i=-1;if(e!==null)for(let o=0;o<e.length;o++){let s=e[o];typeof s=="number"?i=s:i===r&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),Yu(n,s,t?!0:e[++o]))}return n===void 0?null:n}function JN(n,e,t){if(t==null||t==="")return Mn;let r=[],i=ri(t);if(Array.isArray(i))for(let o=0;o<i.length;o++)n(r,i[o],!0);else if(typeof i=="object")for(let o in i)i.hasOwnProperty(o)&&n(r,o,i[o]);else typeof i=="string"&&e(r,i);return r}function eM(n,e,t){let r=String(e);r!==""&&!r.includes(" ")&&Yu(n,r,t)}function tM(n,e,t,r,i,o,s,a){i===rr&&(i=Mn);let l=0,c=0,u=0<i.length?i[0]:null,f=0<o.length?o[0]:null;for(;u!==null||f!==null;){let h=l<i.length?i[l+1]:void 0,d=c<o.length?o[c+1]:void 0,m=null,p;u===f?(l+=2,c+=2,h!==d&&(m=f,p=d)):f===null||u!==null&&u<f?(l+=2,m=u):(c+=2,m=f,p=d),m!==null&&hT(n,e,t,r,m,p,s,a),u=l<i.length?i[l]:null,f=c<o.length?o[c]:null}}function hT(n,e,t,r,i,o,s,a){if(!(e.type&3))return;let l=n.data,c=l[a+1],u=VN(c)?Sx(l,e,t,i,Js(c),s):void 0;if(!Pf(u)){Pf(o)||LN(c)&&(o=Sx(l,null,t,i,a,s));let f=Dp(Si(),t);QF(r,s,f,i,o)}}function Sx(n,e,t,r,i,o){let s=e===null,a;for(;i>0;){let l=n[i],c=Array.isArray(l),u=c?l[1]:l,f=u===null,h=t[i+1];h===rr&&(h=f?Mn:void 0);let d=f?Xu(h,r):u===r?h:void 0;if(c&&!Pf(d)&&(d=Xu(l,r)),Pf(d)&&(a=d,s))return a;let m=n[i+1];i=s?ts(m):Js(m)}if(e!==null){let l=o?e.residualClasses:e.residualStyles;l!=null&&(a=Xu(l,r))}return a}function Pf(n){return n!==void 0}function nM(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=er(ri(n)))),n}function pT(n,e){return(n.flags&(e?8:16))!==0}function C(n,e=""){let t=Ve(),r=bt(),i=n+nn,o=r.firstCreatePass?Hl(r,i,1,e,null):r.data[i],s=rM(r,t,o,e,n);t[i]=s,Dl()&&Yf(r,t,s,o),ro(o,!1)}var rM=(n,e,t,r,i)=>(Sl(!0),mF(e[Ct],r));function iM(n,e,t,r=""){return nr(n,io(),t)?e+Hs(t)+r:rr}function Je(n){return rt("",n),Je}function rt(n,e,t){let r=Ve(),i=iM(r,n,e,t);return i!==rr&&oM(r,Si(),i),rt}function oM(n,e,t){let r=Dp(e,n);gF(n[Ct],r,t)}function Tg(n){return nr(Ve(),io(),n)?Hs(n):rr}function sM(n,e,t){let r=bt();if(r.firstCreatePass){let i=Or(n);Vm(t,r.data,r.blueprint,i,!0),Vm(e,r.data,r.blueprint,i,!1)}}function Vm(n,e,t,r,i){if(n=pn(n),Array.isArray(n))for(let o=0;o<n.length;o++)Vm(n[o],e,t,r,i);else{let o=bt(),s=Ve(),a=Cn(),l=Ho(n)?n:pn(n.provide),c=yp(n),u=a.providerIndexes&1048575,f=a.directiveStart,h=a.providerIndexes>>20;if(Ho(n)||!n.multi){let d=new es(c,i,ae),m=em(l,e,i?u:u+h,f);m===-1?(nm(Df(a,s),o,l),Jp(o,n,e.length),e.push(l),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(d),s.push(d)):(t[m]=d,s[m]=d)}else{let d=em(l,e,u+h,f),m=em(l,e,u,u+h),p=d>=0&&t[d],g=m>=0&&t[m];if(i&&!g||!i&&!p){nm(Df(a,s),o,l);let w=cM(i?lM:aM,t.length,i,r,c);!i&&g&&(t[m].providerFactory=w),Jp(o,n,e.length,0),e.push(l),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(w),s.push(w)}else{let w=mT(t[i?m:d],c,!i&&r);Jp(o,n,d>-1?d:m,w)}!i&&r&&g&&t[m].componentProviders++}}}function Jp(n,e,t,r){let i=Ho(e),o=yy(e);if(i||o){let l=(o?pn(e.useClass):e).prototype.ngOnDestroy;if(l){let c=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){let u=c.indexOf(t);u===-1?c.push(t,[r,l]):c[u+1].push(r,l)}else c.push(t,l)}}}function mT(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function em(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function aM(n,e,t,r){return Um(this.multi,[])}function lM(n,e,t,r){let i=this.multi,o;if(this.providerFactory){let s=this.providerFactory.componentProviders,a=kl(t,t[Be],this.providerFactory.index,r);o=a.slice(0,s),Um(i,o);for(let l=s;l<a.length;l++)o.push(a[l])}else o=[],Um(i,o);return o}function Um(n,e){for(let t=0;t<n.length;t++){let r=n[t];e.push(r())}return e}function cM(n,e,t,r,i){let o=new es(n,t,ae);return o.multi=[],o.index=e,o.componentProviders=0,mT(o,i,r&&!t),o}function sr(n,e=[]){return t=>{t.providersResolver=(r,i)=>sM(r,i?i(n):n,e)}}function is(n,e,t,r){return uM(Ve(),Cl(),n,e,t,r)}function wg(n,e,t,r,i){return fM(Ve(),Cl(),n,e,t,r,i)}function Cg(n,e,t,r,i,o){return dM(Ve(),Cl(),n,e,t,r,i,o)}function Dg(n,e,t,r,i,o,s){return hM(Ve(),Cl(),n,e,t,r,i,o,s)}function sd(n,e){let t=n[e];return t===rr?void 0:t}function uM(n,e,t,r,i,o){let s=e+t;return nr(n,s,i)?Jf(n,s+1,o?r.call(o,i):r(i)):sd(n,s+1)}function fM(n,e,t,r,i,o,s){let a=e+t;return Af(n,a,i,o)?Jf(n,a+2,s?r.call(s,i,o):r(i,o)):sd(n,a+2)}function dM(n,e,t,r,i,o,s,a){let l=e+t;return Fk(n,l,i,o,s)?Jf(n,l+3,a?r.call(a,i,o,s):r(i,o,s)):sd(n,l+3)}function hM(n,e,t,r,i,o,s,a,l){let c=e+t;return kk(n,c,i,o,s,a)?Jf(n,c+4,l?r.call(l,i,o,s,a):r(i,o,s,a)):sd(n,c+4)}function li(n,e){return Zf(n,e)}var pM=(()=>{class n{zone=Pe(xt);changeDetectionScheduler=Pe($o);applicationRef=Pe(ii);applicationErrorHandler=Pe(bi);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{try{this.applicationRef.dirtyFlags|=1,this.applicationRef._tick()}catch(t){this.applicationErrorHandler(t)}})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function gT({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new xt(tt(Me({},vT()),{scheduleInRootZone:t})),[{provide:xt,useFactory:n},{provide:Ji,multi:!0,useFactory:()=>{let r=Pe(pM,{optional:!0});return()=>r.initialize()}},{provide:Ji,multi:!0,useFactory:()=>{let r=Pe(mM);return()=>{r.initialize()}}},e===!0?{provide:jp,useValue:!0}:[],{provide:Hp,useValue:t??JE},{provide:bi,useFactory:()=>{let r=Pe(xt),i=Pe(mr),o;return s=>{o??=i.get(Zr),r.runOutsideAngular(()=>o.handleError(s))}}}]}function vT(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var mM=(()=>{class n{subscription=new Qt;initialized=!1;zone=Pe(xt);pendingTasks=Pe(qs);initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{xt.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{xt.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var _T=(()=>{class n{applicationErrorHandler=Pe(bi);appRef=Pe(ii);taskService=Pe(qs);ngZone=Pe(xt);zonelessEnabled=Pe(bl);tracing=Pe(Gl,{optional:!0});disableScheduling=Pe(jp,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new Qt;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Nf):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(Pe(Hp,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof Mf||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;let r=!1;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2,r=!0;break}case 12:{this.appRef.dirtyFlags|=16,r=!0;break}case 13:{this.appRef.dirtyFlags|=2,r=!0;break}case 11:{r=!0;break}case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(r))return;let i=this.useMicrotaskScheduler?xx:eT;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>i(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>i(()=>this.tick()))}shouldScheduleTick(t){return!(this.disableScheduling&&!t||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Nf+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){this.taskService.remove(t),this.applicationErrorHandler(r)}finally{this.cleanup()}this.useMicrotaskScheduler=!0,xx(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function gM(){return typeof $localize<"u"&&$localize.locale||$l}var ad=new Re("",{providedIn:"root",factory:()=>Pe(ad,{optional:!0,skipSelf:!0})||gM()});function ci(n){return ry(n)}function aa(n,e){return uu(n,e?.equal)}var yT=class{[Nn];constructor(e){this[Nn]=e}destroy(){this[Nn].destroy()}};var wT=Symbol("InputSignalNode#UNSET"),FM=tt(Me({},fu),{transformFn:void 0,applyValueToInputSignal(n,e){Ns(n,e)}});function CT(n,e){let t=Object.create(FM);t.value=n,t.transformFn=e?.transform;function r(){if(Fs(t),t.value===wT){let i=null;throw new Ee(-950,i)}return t.value}return r[Nn]=t,r}var kM=new Re("");kM.__NG_ELEMENT_ID__=n=>{let e=Cn();if(e===null)throw new Ee(204,!1);if(e.type&2)return e.value;if(n&8)return null;throw new Ee(204,!1)};function xT(n,e){return CT(n,e)}function NM(n){return CT(wT,n)}var kg=(xT.required=NM,xT);var Sg=new Re(""),MM=new Re("");function Wl(n){return!n.moduleRef}function OM(n){let e=Wl(n)?n.r3Injector:n.moduleRef.injector,t=e.get(xt);return t.run(()=>{Wl(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let r=e.get(bi),i;if(t.runOutsideAngular(()=>{i=t.onError.subscribe({next:r})}),Wl(n)){let o=()=>e.destroy(),s=n.platformInjector.get(Sg);s.add(o),e.onDestroy(()=>{i.unsubscribe(),s.delete(o)})}else{let o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(Sg);s.add(o),n.moduleRef.onDestroy(()=>{Fl(n.allPlatformModules,n.moduleRef),i.unsubscribe(),s.delete(o)})}return PM(r,t,()=>{let o=e.get(xg);return o.runInitializers(),o.donePromise.then(()=>{let s=e.get(ad,$l);if(aT(s||$l),!e.get(MM,!0))return Wl(n)?e.get(ii):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(Wl(n)){let l=e.get(ii);return n.rootComponent!==void 0&&l.bootstrap(n.rootComponent),l}else return RM?.(n.moduleRef,n.allPlatformModules),n.moduleRef})})})}var RM;function PM(n,e,t){try{let r=t();return oa(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n(r)),r}}var ld=null;function LM(n=[],e){return On.create({name:e,providers:[{provide:pl,useValue:"platform"},{provide:Sg,useValue:new Set([()=>ld=null])},...n]})}function BM(n=[]){if(ld)return ld;let e=LM(n);return ld=e,oT(),VM(e),e}function VM(n){let e=n.get(Bf,null);Zu(n,()=>{e?.forEach(t=>t())})}var ud=(()=>{class n{static __NG_ELEMENT_ID__=UM}return n})();function UM(n){return jM(Cn(),Ve(),(n&16)===16)}function jM(n,e,t){if(no(n)&&!t){let r=yr(n.index,e);return new so(r,r)}else if(n.type&175){let r=e[wn];return new so(r,e)}return null}var bg=class{constructor(){}supports(e){return hg(e)}create(e){return new Ig(e)}},HM=(n,e)=>e,Ig=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||HM}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,o=null;for(;t||r;){let s=!r||t&&t.currentIndex<ET(r,i,o)?t:r,a=ET(s,i,o),l=s.currentIndex;if(s===r)i--,r=r._nextRemoved;else if(t=t._next,s.previousIndex==null)i++;else{o||(o=[]);let c=a-i,u=l-i;if(c!=u){for(let h=0;h<c;h++){let d=h<o.length?o[h]:o[h]=0,m=d+h;u<=m&&m<c&&(o[h]=d+1)}let f=s.previousIndex;o[f]=u-c}}a!==l&&e(s,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!hg(e))throw new Ee(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,o,s;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,o,s,a),r=!0):(r&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)),t=t._next}else i=0,HE(e,a=>{s=this._trackByFn(i,a),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,a,s,i),r=!0):(r&&(t=this._verifyReinsertion(t,a,s,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,i)):e=this._addAfter(new Ag(t,r),o,i)),e}_verifyReinsertion(e,t,r,i){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return o!==null?e=this._reinsertAfter(o,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,o=e._nextRemoved;return i===null?this._removalsHead=o:i._nextRemoved=o,o===null?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new cd),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new cd),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},Ag=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}},Fg=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},cd=class{map=new Map;put(e){let t=e.trackById,r=this.map.get(t);r||(r=new Fg,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function ET(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}function TT(){return new Ng([new bg])}var Ng=(()=>{class n{factories;static \u0275prov=Ge({token:n,providedIn:"root",factory:TT});constructor(t){this.factories=t}static create(t,r){if(r!=null){let i=r.factories.slice();t=t.concat(i)}return new n(t)}static extend(t){return{provide:n,useFactory:r=>n.create(t,r||TT()),deps:[[n,new Ix,new jm]]}}find(t){let r=this.factories.find(i=>i.supports(t));if(r!=null)return r;throw new Ee(901,!1)}}return n})();function DT(n){vt(8);try{let{rootComponent:e,appProviders:t,platformProviders:r}=n,i=BM(r),o=[gT({}),{provide:$o,useExisting:_T},qy,...t||[]],s=new Pl({providers:o,parent:i,debugName:"",runEnvironmentInitializers:!1});return OM({r3Injector:s.injector,platformInjector:i,rootComponent:e})}catch(e){return Promise.reject(e)}finally{vt(9)}}function Ht(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}function zl(n,e=NaN){return!isNaN(parseFloat(n))&&!isNaN(Number(n))?Number(n):e}var ST=null;function Mi(){return ST}function Mg(n){ST??=n}var ql=class{};var Og=/\s+/,bT=[],os=(()=>{class n{_ngEl;_renderer;initialClasses=bT;rawClass;stateMap=new Map;constructor(t,r){this._ngEl=t,this._renderer=r}set klass(t){this.initialClasses=t!=null?t.trim().split(Og):bT}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split(Og):t}ngDoCheck(){for(let r of this.initialClasses)this._updateState(r,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let r of t)this._updateState(r,!0);else if(t!=null)for(let r of Object.keys(t))this._updateState(r,!!t[r]);this._applyStateDiff()}_updateState(t,r){let i=this.stateMap.get(t);i!==void 0?(i.enabled!==r&&(i.changed=!0,i.enabled=r),i.touched=!0):this.stateMap.set(t,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let r=t[0],i=t[1];i.changed?(this._toggleClass(r,i.enabled),i.changed=!1):i.touched||(i.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),i.touched=!1}}_toggleClass(t,r){t=t.trim(),t.length>0&&t.split(Og).forEach(i=>{r?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}static \u0275fac=function(r){return new(r||n)(ae(It),ae(Ur))};static \u0275dir=ze({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return n})();var fd=class{$implicit;ngForOf;index;count;constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},uo=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let r=this._viewContainer;t.forEachOperation((i,o,s)=>{if(i.previousIndex==null)r.createEmbeddedView(this._template,new fd(i.item,this._ngForOf,-1,-1),s===null?void 0:s);else if(s==null)r.remove(o===null?void 0:o);else if(o!==null){let a=r.get(o);r.move(a,s),IT(a,i)}});for(let i=0,o=r.length;i<o;i++){let a=r.get(i).context;a.index=i,a.count=o,a.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{let o=r.get(i.currentIndex);IT(o,i)})}static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(ae(Ni),ae(Qe),ae(Ng))};static \u0275dir=ze({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function IT(n,e){n.context.$implicit=e.item}var Pt=(()=>{class n{_viewContainer;_context=new dd;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,r){this._viewContainer=t,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){AT(t,!1),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){AT(t,!1),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(ae(Ni),ae(Qe))};static \u0275dir=ze({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),dd=class{$implicit=null;ngIf=null};function AT(n,e){if(n&&!n.createEmbeddedView)throw new Ee(2020,!1)}var Rg=class{_viewContainerRef;_templateRef;_created=!1;constructor(e,t){this._viewContainerRef=e,this._templateRef=t}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(e){e&&!this._created?this.create():!e&&this._created&&this.destroy()}},hd=(()=>{class n{_defaultViews=[];_defaultUsed=!1;_caseCount=0;_lastCaseCheckIndex=0;_lastCasesMatched=!1;_ngSwitch;set ngSwitch(t){this._ngSwitch=t,this._caseCount===0&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(t){this._defaultViews.push(t)}_matchCase(t){let r=t===this._ngSwitch;return this._lastCasesMatched||=r,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),r}_updateDefaultCases(t){if(this._defaultViews.length>0&&t!==this._defaultUsed){this._defaultUsed=t;for(let r of this._defaultViews)r.enforceState(t)}}static \u0275fac=function(r){return new(r||n)};static \u0275dir=ze({type:n,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}})}return n})(),Pg=(()=>{class n{ngSwitch;_view;ngSwitchCase;constructor(t,r,i){this.ngSwitch=i,i._addCase(),this._view=new Rg(t,r)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}static \u0275fac=function(r){return new(r||n)(ae(Ni),ae(Qe),ae(hd,9))};static \u0275dir=ze({type:n,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}})}return n})();var pd=(()=>{class n{_viewContainerRef;_viewRef=null;ngTemplateOutletContext=null;ngTemplateOutlet=null;ngTemplateOutletInjector=null;constructor(t){this._viewContainerRef=t}ngOnChanges(t){if(this._shouldRecreateView(t)){let r=this._viewContainerRef;if(this._viewRef&&r.remove(r.indexOf(this._viewRef)),!this.ngTemplateOutlet){this._viewRef=null;return}let i=this._createContextForwardProxy();this._viewRef=r.createEmbeddedView(this.ngTemplateOutlet,i,{injector:this.ngTemplateOutletInjector??void 0})}}_shouldRecreateView(t){return!!t.ngTemplateOutlet||!!t.ngTemplateOutletInjector}_createContextForwardProxy(){return new Proxy({},{set:(t,r,i)=>this.ngTemplateOutletContext?Reflect.set(this.ngTemplateOutletContext,r,i):!1,get:(t,r,i)=>{if(this.ngTemplateOutletContext)return Reflect.get(this.ngTemplateOutletContext,r,i)}})}static \u0275fac=function(r){return new(r||n)(ae(Ni))};static \u0275dir=ze({type:n,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},features:[Vr]})}return n})();var mt=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=ir({type:n});static \u0275inj=Gn({})}return n})();function Lg(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,o]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(o)}return null}var Kl=class{};var FT="browser",GM="server";function kT(n){return n===GM}var vd=new Re(""),jg=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,r){this._zone=r,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i,o){return this._findPluginFor(r).addEventListener(t,r,i,o)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(o=>o.supports(t)),!r)throw new Ee(5101,!1);return this._eventNameToPlugin.set(t,r),r}static \u0275fac=function(r){return new(r||n)(We(vd),We(xt))};static \u0275prov=Ge({token:n,factory:n.\u0275fac})}return n})(),Yl=class{_doc;constructor(e){this._doc=e}manager},md="ng-app-id";function NT(n){for(let e of n)e.remove()}function MT(n,e){let t=e.createElement("style");return t.textContent=n,t}function $M(n,e,t,r){let i=n.head?.querySelectorAll(`style[${md}="${e}"],link[${md}="${e}"]`);if(i)for(let o of i)o.removeAttribute(md),o instanceof HTMLLinkElement?r.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&t.set(o.textContent,{usage:0,elements:[o]})}function Vg(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var Hg=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(t,r,i,o={}){this.doc=t,this.appId=r,this.nonce=i,this.isServer=kT(o),$M(t,r,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,r){for(let i of t)this.addUsage(i,this.inline,MT);r?.forEach(i=>this.addUsage(i,this.external,Vg))}removeStyles(t,r){for(let i of t)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(t,r,i){let o=r.get(t);o?o.usage++:r.set(t,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,i(t,this.doc)))})}removeUsage(t,r){let i=r.get(t);i&&(i.usage--,i.usage<=0&&(NT(i.elements),r.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])NT(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[r,{elements:i}]of this.inline)i.push(this.addElement(t,MT(r,this.doc)));for(let[r,{elements:i}]of this.external)i.push(this.addElement(t,Vg(r,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,r){return this.nonce&&r.setAttribute("nonce",this.nonce),this.isServer&&r.setAttribute(md,this.appId),t.appendChild(r)}static \u0275fac=function(r){return new(r||n)(We(Mt),We(Lf),We(Uf,8),We(ra))};static \u0275prov=Ge({token:n,factory:n.\u0275fac})}return n})(),Bg={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Gg=/%COMP%/g;var RT="%COMP%",WM=`_nghost-${RT}`,zM=`_ngcontent-${RT}`,qM=!0,KM=new Re("",{providedIn:"root",factory:()=>qM});function YM(n){return zM.replace(Gg,n)}function XM(n){return WM.replace(Gg,n)}function PT(n,e){return e.map(t=>t.replace(Gg,n))}var Ql=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,r,i,o,s,a,l,c=null,u=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=o,this.doc=s,this.platformId=a,this.ngZone=l,this.nonce=c,this.tracingService=u,this.platformIsServer=!1,this.defaultRenderer=new Xl(t,s,l,this.platformIsServer,this.tracingService)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;let i=this.getOrCreateRenderer(t,r);return i instanceof gd?i.applyToHost(t):i instanceof Zl&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,o=i.get(r.id);if(!o){let s=this.doc,a=this.ngZone,l=this.eventManager,c=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,f=this.platformIsServer,h=this.tracingService;switch(r.encapsulation){case Ii.Emulated:o=new gd(l,c,r,this.appId,u,s,a,f,h);break;case Ii.ShadowDom:return new Ug(l,c,t,r,s,a,this.nonce,f,h);default:o=new Zl(l,c,r,u,s,a,f,h);break}i.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(r){return new(r||n)(We(jg),We(Hg),We(Lf),We(KM),We(Mt),We(ra),We(xt),We(Uf),We(Gl,8))};static \u0275prov=Ge({token:n,factory:n.\u0275fac})}return n})(),Xl=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,r,i,o){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.tracingService=o}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(Bg[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(OT(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(OT(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new Ee(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let o=Bg[i];o?e.setAttributeNS(o,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=Bg[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(ni.DashCase|ni.Important)?e.style.setProperty(t,r,i&ni.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&ni.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r,i){if(typeof e=="string"&&(e=Mi().getGlobalEventTarget(this.doc,e),!e))throw new Ee(5102,!1);let o=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(o=this.tracingService.wrapEventListener(e,t,o)),this.eventManager.addEventListener(e,t,o,i)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;e(t)===!1&&t.preventDefault()}}};function OT(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var Ug=class extends Xl{sharedStylesHost;hostEl;shadowRoot;constructor(e,t,r,i,o,s,a,l,c){super(e,o,s,l,c),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let u=i.styles;u=PT(i.id,u);for(let h of u){let d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=h,this.shadowRoot.appendChild(d)}let f=i.getExternalStyles?.();if(f)for(let h of f){let d=Vg(h,o);a&&d.setAttribute("nonce",a),this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Zl=class extends Xl{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,r,i,o,s,a,l,c){super(e,o,s,a,l),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i;let u=r.styles;this.styles=c?PT(c,u):u,this.styleUrls=r.getExternalStyles?.(c)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},gd=class extends Zl{contentAttr;hostAttr;constructor(e,t,r,i,o,s,a,l,c){let u=i+"-"+r.id;super(e,t,r,o,s,a,l,c,u),this.contentAttr=YM(u),this.hostAttr=XM(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}};var _d=class n extends ql{supportsDOMEvents=!0;static makeCurrent(){Mg(new n)}onAndCancel(e,t,r,i){return e.addEventListener(t,r,i),()=>{e.removeEventListener(t,r,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=ZM();return t==null?null:QM(t)}resetBaseElement(){Jl=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Lg(document.cookie,e)}},Jl=null;function ZM(){return Jl=Jl||document.head.querySelector("base"),Jl?Jl.getAttribute("href"):null}function QM(n){return new URL(n,document.baseURI).pathname}var JM=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ge({token:n,factory:n.\u0275fac})}return n})(),BT=(()=>{class n extends Yl{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i,o){return t.addEventListener(r,i,o),()=>this.removeEventListener(t,r,i,o)}removeEventListener(t,r,i,o){return t.removeEventListener(r,i,o)}static \u0275fac=function(r){return new(r||n)(We(Mt))};static \u0275prov=Ge({token:n,factory:n.\u0275fac})}return n})(),LT=["alt","control","meta","shift"],eO={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},tO={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},VT=(()=>{class n extends Yl{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i,o){let s=n.parseEventName(r),a=n.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Mi().onAndCancel(t,s.domEventName,a,o))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let o=n._normalizeKey(r.pop()),s="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),s="code."),LT.forEach(c=>{let u=r.indexOf(c);u>-1&&(r.splice(u,1),s+=c+".")}),s+=o,r.length!=0||o.length===0)return null;let l={};return l.domEventName=i,l.fullKey=s,l}static matchEventFullKeyCode(t,r){let i=eO[t.key]||t.key,o="";return r.indexOf("code.")>-1&&(i=t.code,o="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),LT.forEach(s=>{if(s!==i){let a=tO[s];a(t)&&(o+=s+".")}}),o+=i,o===r)}static eventCallback(t,r,i){return o=>{n.matchEventFullKeyCode(o,t)&&i.runGuarded(()=>r(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(r){return new(r||n)(We(Mt))};static \u0275prov=Ge({token:n,factory:n.\u0275fac})}return n})();function $g(n,e){return DT(Me({rootComponent:n},nO(e)))}function nO(n){return{appProviders:[...aO,...n?.providers??[]],platformProviders:sO}}function rO(){_d.makeCurrent()}function iO(){return new Zr}function oO(){return Wm(document),document}var sO=[{provide:ra,useValue:FT},{provide:Bf,useValue:rO,multi:!0},{provide:Mt,useFactory:oO}];var aO=[{provide:pl,useValue:"root"},{provide:Zr,useFactory:iO},{provide:vd,useClass:BT,multi:!0,deps:[Mt]},{provide:vd,useClass:VT,multi:!0,deps:[Mt]},Ql,Hg,jg,{provide:Fi,useExisting:Ql},{provide:Kl,useClass:JM},[]];var Wg=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ge({token:n,factory:function(r){let i=null;return r?i=new(r||n):i=We(cO),i},providedIn:"root"})}return n})(),cO=(()=>{class n extends Wg{_doc;constructor(t){super(),this._doc=t}sanitize(t,r){if(r==null)return null;switch(t){case xr.NONE:return r;case xr.HTML:return ao(r,"HTML")?ri(r):Gf(this._doc,String(r)).toString();case xr.STYLE:return ao(r,"Style")?ri(r):r;case xr.SCRIPT:if(ao(r,"Script"))return ri(r);throw new Ee(5200,!1);case xr.URL:return ao(r,"URL")?ri(r):Hf(String(r));case xr.RESOURCE_URL:if(ao(r,"ResourceURL"))return ri(r);throw new Ee(5201,!1);default:throw new Ee(5202,!1)}}bypassSecurityTrustHtml(t){return Km(t)}bypassSecurityTrustStyle(t){return Ym(t)}bypassSecurityTrustScript(t){return Xm(t)}bypassSecurityTrustUrl(t){return Zm(t)}bypassSecurityTrustResourceUrl(t){return Qm(t)}static \u0275fac=function(r){return new(r||n)(We(Mt))};static \u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var YT=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,r){this._renderer=t,this._elementRef=r}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(r){return new(r||n)(ae(Ur),ae(It))};static \u0275dir=ze({type:n})}return n})(),ic=(()=>{class n extends YT{static \u0275fac=(()=>{let t;return function(i){return(t||(t=ns(n)))(i||n)}})();static \u0275dir=ze({type:n,features:[Dn]})}return n})(),ho=new Re("");var fO={provide:ho,useExisting:Tn(()=>Gt),multi:!0};function dO(){let n=Mi()?Mi().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var hO=new Re(""),Gt=(()=>{class n extends YT{_compositionMode;_composing=!1;constructor(t,r,i){super(t,r),this._compositionMode=i,this._compositionMode==null&&(this._compositionMode=!dO())}writeValue(t){let r=t??"";this.setProperty("value",r)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(r){return new(r||n)(ae(Ur),ae(It),ae(hO,8))};static \u0275dir=ze({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){r&1&&Ce("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},standalone:!1,features:[sr([fO]),Dn]})}return n})();function Zg(n){return n==null||Qg(n)===0}function Qg(n){return n==null?null:Array.isArray(n)||typeof n=="string"?n.length:n instanceof Set?n.size:null}var Id=new Re(""),Ad=new Re(""),pO=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Se=class{static min(e){return mO(e)}static max(e){return gO(e)}static required(e){return vO(e)}static requiredTrue(e){return _O(e)}static email(e){return yO(e)}static minLength(e){return xO(e)}static maxLength(e){return EO(e)}static pattern(e){return TO(e)}static nullValidator(e){return XT()}static compose(e){return nw(e)}static composeAsync(e){return iw(e)}};function mO(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function gO(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function vO(n){return Zg(n.value)?{required:!0}:null}function _O(n){return n.value===!0?null:{required:!0}}function yO(n){return Zg(n.value)||pO.test(n.value)?null:{email:!0}}function xO(n){return e=>{let t=e.value?.length??Qg(e.value);return t===null||t===0?null:t<n?{minlength:{requiredLength:n,actualLength:t}}:null}}function EO(n){return e=>{let t=e.value?.length??Qg(e.value);return t!==null&&t>n?{maxlength:{requiredLength:n,actualLength:t}}:null}}function TO(n){if(!n)return XT;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),r=>{if(Zg(r.value))return null;let i=r.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}function XT(n){return null}function ZT(n){return n!=null}function QT(n){return oa(n)?Xr(n):n}function JT(n){let e={};return n.forEach(t=>{e=t!=null?Me(Me({},e),t):e}),Object.keys(e).length===0?null:e}function ew(n,e){return e.map(t=>t(n))}function wO(n){return!n.validate}function tw(n){return n.map(e=>wO(e)?e:t=>e.validate(t))}function nw(n){if(!n)return null;let e=n.filter(ZT);return e.length==0?null:function(t){return JT(ew(t,e))}}function rw(n){return n!=null?nw(tw(n)):null}function iw(n){if(!n)return null;let e=n.filter(ZT);return e.length==0?null:function(t){let r=ew(t,e).map(QT);return j0(r).pipe(Nr(JT))}}function ow(n){return n!=null?iw(tw(n)):null}function UT(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function sw(n){return n._rawValidators}function aw(n){return n._rawAsyncValidators}function zg(n){return n?Array.isArray(n)?n:[n]:[]}function Ed(n,e){return Array.isArray(n)?n.includes(e):n===e}function jT(n,e){let t=zg(e);return zg(n).forEach(i=>{Ed(t,i)||t.push(i)}),t}function HT(n,e){return zg(e).filter(t=>!Ed(n,t))}var Td=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=rw(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=ow(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Tr=class extends Td{name;get formDirective(){return null}get path(){return null}},ua=class extends Td{_parent=null;name=null;valueAccessor=null},wd=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},CO={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Zte=tt(Me({},CO),{"[class.ng-submitted]":"isSubmitted"}),on=(()=>{class n extends wd{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(ae(ua,2))};static \u0275dir=ze({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){r&2&&Ie("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},standalone:!1,features:[Dn]})}return n})(),sn=(()=>{class n extends wd{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(ae(Tr,10))};static \u0275dir=ze({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,i){r&2&&Ie("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},standalone:!1,features:[Dn]})}return n})();var ec="VALID",yd="INVALID",la="PENDING",tc="DISABLED",fo=class{},Cd=class extends fo{value;source;constructor(e,t){super(),this.value=e,this.source=t}},nc=class extends fo{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},rc=class extends fo{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},ca=class extends fo{status;source;constructor(e,t){super(),this.status=e,this.source=t}},qg=class extends fo{source;constructor(e){super(),this.source=e}},Kg=class extends fo{source;constructor(e){super(),this.source=e}};function Jg(n){return(Fd(n)?n.validators:n)||null}function DO(n){return Array.isArray(n)?rw(n):n||null}function ev(n,e){return(Fd(e)?e.asyncValidators:n)||null}function SO(n){return Array.isArray(n)?ow(n):n||null}function Fd(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function lw(n,e,t){let r=n.controls;if(!(e?Object.keys(r):r).length)throw new Ee(1e3,"");if(!r[t])throw new Ee(1001,"")}function cw(n,e,t){n._forEachChild((r,i)=>{if(t[i]===void 0)throw new Ee(1002,"")})}var fa=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return ci(this.statusReactive)}set status(e){ci(()=>this.statusReactive.set(e))}_status=aa(()=>this.statusReactive());statusReactive=$n(void 0);get valid(){return this.status===ec}get invalid(){return this.status===yd}get pending(){return this.status==la}get disabled(){return this.status===tc}get enabled(){return this.status!==tc}errors;get pristine(){return ci(this.pristineReactive)}set pristine(e){ci(()=>this.pristineReactive.set(e))}_pristine=aa(()=>this.pristineReactive());pristineReactive=$n(!0);get dirty(){return!this.pristine}get touched(){return ci(this.touchedReactive)}set touched(e){ci(()=>this.touchedReactive.set(e))}_touched=aa(()=>this.touchedReactive());touchedReactive=$n(!1);get untouched(){return!this.touched}_events=new St;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(jT(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(jT(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(HT(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(HT(e,this._rawAsyncValidators))}hasValidator(e){return Ed(this._rawValidators,e)}hasAsyncValidator(e){return Ed(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(tt(Me({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new rc(!0,r))}markAllAsDirty(e={}){this.markAsDirty({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsDirty(e))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),t&&e.emitEvent!==!1&&this._events.next(new rc(!1,r))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(tt(Me({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new nc(!1,r))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),t&&e.emitEvent!==!1&&this._events.next(new nc(!0,r))}markAsPending(e={}){this.status=la;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new ca(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(tt(Me({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=tc,this.errors=null,this._forEachChild(i=>{i.disable(tt(Me({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Cd(this.value,r)),this._events.next(new ca(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(tt(Me({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=ec,this._forEachChild(r=>{r.enable(tt(Me({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(tt(Me({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===ec||this.status===la)&&this._runAsyncValidator(r,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Cd(this.value,t)),this._events.next(new ca(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(tt(Me({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?tc:ec}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=la,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1,shouldHaveEmitted:e!==!1};let r=QT(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new ca(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,r)}_initObservables(){this.valueChanges=new ot,this.statusChanges=new ot}_calculateStatus(){return this._allControlsDisabled()?tc:this.errors?yd:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(la)?la:this._anyControlsHaveStatus(yd)?yd:ec}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),i&&this._events.next(new nc(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new rc(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Fd(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=DO(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=SO(this._rawAsyncValidators)}},Dd=class extends fa{constructor(e,t,r){super(Jg(t),ev(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){cw(this,!0,e),Object.keys(e).forEach(r=>{lw(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>r._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,o)=>{r=t(r,i,o)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var Yg=class extends Dd{};var tv=new Re("",{providedIn:"root",factory:()=>kd}),kd="always";function nv(n,e){return[...e.path,n]}function GT(n,e,t=kd){rv(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),IO(n,e),FO(n,e),AO(n,e),bO(n,e)}function $T(n,e,t=!0){let r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),bd(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function Sd(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function bO(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function rv(n,e){let t=sw(n);e.validator!==null?n.setValidators(UT(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=aw(n);e.asyncValidator!==null?n.setAsyncValidators(UT(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();Sd(e._rawValidators,i),Sd(e._rawAsyncValidators,i)}function bd(n,e){let t=!1;if(n!==null){if(e.validator!==null){let i=sw(n);if(Array.isArray(i)&&i.length>0){let o=i.filter(s=>s!==e.validator);o.length!==i.length&&(t=!0,n.setValidators(o))}}if(e.asyncValidator!==null){let i=aw(n);if(Array.isArray(i)&&i.length>0){let o=i.filter(s=>s!==e.asyncValidator);o.length!==i.length&&(t=!0,n.setAsyncValidators(o))}}}let r=()=>{};return Sd(e._rawValidators,r),Sd(e._rawAsyncValidators,r),t}function IO(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&uw(n,e)})}function AO(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&uw(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function uw(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function FO(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function kO(n,e){n==null,rv(n,e)}function NO(n,e){return bd(n,e)}function MO(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function OO(n){return Object.getPrototypeOf(n.constructor)===ic}function RO(n,e){n._syncPendingControls(),e.forEach(t=>{let r=t.control;r.updateOn==="submit"&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function PO(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(o=>{o.constructor===Gt?t=o:OO(o)?r=o:i=o}),i||r||t||null}function LO(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function WT(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function zT(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var xd=class extends fa{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,r){super(Jg(t),ev(r,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Fd(t)&&(t.nonNullable||t.initialValueIsDefault)&&(zT(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){WT(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){WT(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){zT(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var BO=n=>n instanceof xd,VO=(()=>{class n extends Tr{_parent;ngOnInit(){this._checkParentType(),this.formDirective.addFormGroup(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormGroup(this)}get control(){return this.formDirective.getFormGroup(this)}get path(){return nv(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}static \u0275fac=(()=>{let t;return function(i){return(t||(t=ns(n)))(i||n)}})();static \u0275dir=ze({type:n,standalone:!1,features:[Dn]})}return n})();var An=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275dir=ze({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})(),UO={provide:ho,useExisting:Tn(()=>oc),multi:!0},oc=(()=>{class n extends ic{writeValue(t){let r=t??"";this.setProperty("value",r)}registerOnChange(t){this.onChange=r=>{t(r==""?null:parseFloat(r))}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=ns(n)))(i||n)}})();static \u0275dir=ze({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(r,i){r&1&&Ce("input",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},standalone:!1,features:[sr([UO]),Dn]})}return n})(),jO={provide:ho,useExisting:Tn(()=>lr),multi:!0};var HO=(()=>{class n{_accessors=[];add(t,r){this._accessors.push([t,r])}remove(t){for(let r=this._accessors.length-1;r>=0;--r)if(this._accessors[r][1]===t){this._accessors.splice(r,1);return}}select(t){this._accessors.forEach(r=>{this._isSameGroup(r,t)&&r[1]!==t&&r[1].fireUncheck(t.value)})}_isSameGroup(t,r){return t[0].control?t[0]._parent===r._control._parent&&t[1].name===r.name:!1}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),lr=(()=>{class n extends ic{_registry;_injector;_state;_control;_fn;setDisabledStateFired=!1;onChange=()=>{};name;formControlName;value;callSetDisabledState=Pe(tv,{optional:!0})??kd;constructor(t,r,i,o){super(t,r),this._registry=i,this._injector=o}ngOnInit(){this._control=this._injector.get(ua),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(t){this._state=t===this.value,this.setProperty("checked",this._state)}registerOnChange(t){this._fn=t,this.onChange=()=>{t(this.value),this._registry.select(this)}}setDisabledState(t){(this.setDisabledStateFired||t||this.callSetDisabledState==="whenDisabledForLegacyCode")&&this.setProperty("disabled",t),this.setDisabledStateFired=!0}fireUncheck(t){this.writeValue(t)}_checkName(){this.name&&this.formControlName&&(this.name,this.formControlName),!this.name&&this.formControlName&&(this.name=this.formControlName)}static \u0275fac=function(r){return new(r||n)(ae(Ur),ae(It),ae(HO),ae(On))};static \u0275dir=ze({type:n,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(r,i){r&1&&Ce("change",function(){return i.onChange()})("blur",function(){return i.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},standalone:!1,features:[sr([jO]),Dn]})}return n})();var fw=new Re("");var GO={provide:Tr,useExisting:Tn(()=>$t)},$t=(()=>{class n extends Tr{callSetDisabledState;get submitted(){return ci(this._submittedReactive)}set submitted(t){this._submittedReactive.set(t)}_submitted=aa(()=>this._submittedReactive());_submittedReactive=$n(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];form=null;ngSubmit=new ot;constructor(t,r,i){super(),this.callSetDisabledState=i,this._setValidators(t),this._setAsyncValidators(r)}ngOnChanges(t){t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(bd(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){let r=this.form.get(t.path);return GT(r,t,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),r}getControl(t){return this.form.get(t.path)}removeControl(t){$T(t.control||null,t,!1),LO(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,r){this.form.get(t.path).setValue(r)}onSubmit(t){return this._submittedReactive.set(!0),RO(this.form,this.directives),this.ngSubmit.emit(t),this.form._events.next(new qg(this.control)),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0,r={}){this.form.reset(t,r),this._submittedReactive.set(!1),r?.emitEvent!==!1&&this.form._events.next(new Kg(this.form))}_updateDomValue(){this.directives.forEach(t=>{let r=t.control,i=this.form.get(t.path);r!==i&&($T(r||null,t),BO(i)&&(GT(i,t,this.callSetDisabledState),t.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){let r=this.form.get(t.path);kO(r,t),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){let r=this.form.get(t.path);r&&NO(r,t)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){rv(this.form,this),this._oldForm&&bd(this._oldForm,this)}static \u0275fac=function(r){return new(r||n)(ae(Id,10),ae(Ad,10),ae(tv,8))};static \u0275dir=ze({type:n,selectors:[["","formGroup",""]],hostBindings:function(r,i){r&1&&Ce("submit",function(s){return i.onSubmit(s)})("reset",function(){return i.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[sr([GO]),Dn,Vr]})}return n})(),$O={provide:Tr,useExisting:Tn(()=>da)},da=(()=>{class n extends VO{name=null;constructor(t,r,i){super(),this._parent=t,this._setValidators(r),this._setAsyncValidators(i)}_checkParentType(){dw(this._parent)}static \u0275fac=function(r){return new(r||n)(ae(Tr,13),ae(Id,10),ae(Ad,10))};static \u0275dir=ze({type:n,selectors:[["","formGroupName",""]],inputs:{name:[0,"formGroupName","name"]},standalone:!1,features:[sr([$O]),Dn]})}return n})(),WO={provide:Tr,useExisting:Tn(()=>ha)},ha=(()=>{class n extends Tr{_parent;name=null;constructor(t,r,i){super(),this._parent=t,this._setValidators(r),this._setAsyncValidators(i)}ngOnInit(){dw(this._parent),this.formDirective.addFormArray(this)}ngOnDestroy(){this.formDirective?.removeFormArray(this)}get control(){return this.formDirective.getFormArray(this)}get formDirective(){return this._parent?this._parent.formDirective:null}get path(){return nv(this.name==null?this.name:this.name.toString(),this._parent)}static \u0275fac=function(r){return new(r||n)(ae(Tr,13),ae(Id,10),ae(Ad,10))};static \u0275dir=ze({type:n,selectors:[["","formArrayName",""]],inputs:{name:[0,"formArrayName","name"]},standalone:!1,features:[sr([WO]),Dn]})}return n})();function dw(n){return!(n instanceof da)&&!(n instanceof $t)&&!(n instanceof ha)}var zO={provide:ua,useExisting:Tn(()=>en)},en=(()=>{class n extends ua{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(t){}model;update=new ot;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(t,r,i,o,s){super(),this._ngModelWarningConfig=s,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=PO(this,o)}ngOnChanges(t){this._added||this._setUpControl(),MO(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return nv(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(r){return new(r||n)(ae(Tr,13),ae(Id,10),ae(Ad,10),ae(ho,10),ae(fw,8))};static \u0275dir=ze({type:n,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[sr([zO]),Dn,Vr]})}return n})();var qO={provide:ho,useExisting:Tn(()=>Nd),multi:!0};function hw(n,e){return n==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function KO(n){return n.split(":")[0]}var Nd=(()=>{class n extends ic{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let r=this._getOptionId(t),i=hw(r,t);this.setProperty("value",i)}registerOnChange(t){this.onChange=r=>{this.value=this._getOptionValue(r),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r),t))return r;return null}_getOptionValue(t){let r=KO(t);return this._optionMap.has(r)?this._optionMap.get(r):t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=ns(n)))(i||n)}})();static \u0275dir=ze({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(r,i){r&1&&Ce("change",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[sr([qO]),Dn]})}return n})(),pw=(()=>{class n{_element;_renderer;_select;id;constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption())}set ngValue(t){this._select!=null&&(this._select._optionMap.set(this.id,t),this._setElementValue(hw(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(r){return new(r||n)(ae(It),ae(Ur),ae(Nd,9))};static \u0275dir=ze({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})(),YO={provide:ho,useExisting:Tn(()=>mw),multi:!0};function qT(n,e){return n==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function XO(n){return n.split(":")[0]}var mw=(()=>{class n extends ic{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let r;if(Array.isArray(t)){let i=t.map(o=>this._getOptionId(o));r=(o,s)=>{o._setSelected(i.indexOf(s.toString())>-1)}}else r=(i,o)=>{i._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(t){this.onChange=r=>{let i=[],o=r.selectedOptions;if(o!==void 0){let s=o;for(let a=0;a<s.length;a++){let l=s[a],c=this._getOptionValue(l.value);i.push(c)}}else{let s=r.options;for(let a=0;a<s.length;a++){let l=s[a];if(l.selected){let c=this._getOptionValue(l.value);i.push(c)}}}this.value=i,t(i)}}_registerOption(t){let r=(this._idCounter++).toString();return this._optionMap.set(r,t),r}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r)._value,t))return r;return null}_getOptionValue(t){let r=XO(t);return this._optionMap.has(r)?this._optionMap.get(r)._value:t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=ns(n)))(i||n)}})();static \u0275dir=ze({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(r,i){r&1&&Ce("change",function(s){return i.onChange(s.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[sr([YO]),Dn]})}return n})(),gw=(()=>{class n{_element;_renderer;_select;id;_value;constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){this._select!=null&&(this._value=t,this._setElementValue(qT(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(qT(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(r){return new(r||n)(ae(It),ae(Ur),ae(mw,9))};static \u0275dir=ze({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})();var ZO=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=ir({type:n});static \u0275inj=Gn({})}return n})(),Xg=class extends fa{constructor(e,t,r){super(Jg(t),ev(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,r={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(e,t={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,r={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),t&&(this.controls.splice(i,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){cw(this,!1,e),e.forEach((r,i)=>{lw(this,!1,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(e.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((r,i)=>{r.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,r)=>r._syncPendingControls()?!0:t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,r)=>{e(t,r)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function KT(n){return!!n&&(n.asyncValidators!==void 0||n.validators!==void 0||n.updateOn!==void 0)}var an=(()=>{class n{useNonNullable=!1;get nonNullable(){let t=new n;return t.useNonNullable=!0,t}group(t,r=null){let i=this._reduceControls(t),o={};return KT(r)?o=r:r!==null&&(o.validators=r.validator,o.asyncValidators=r.asyncValidator),new Dd(i,o)}record(t,r=null){let i=this._reduceControls(t);return new Yg(i,r)}control(t,r,i){let o={};return this.useNonNullable?(KT(r)?o=r:(o.validators=r,o.asyncValidators=i),new xd(t,tt(Me({},o),{nonNullable:!0}))):new xd(t,r,i)}array(t,r,i){let o=t.map(s=>this._createControl(s));return new Xg(o,r,i)}_reduceControls(t){let r={};return Object.keys(t).forEach(i=>{r[i]=this._createControl(t[i])}),r}_createControl(t){if(t instanceof xd)return t;if(t instanceof fa)return t;if(Array.isArray(t)){let r=t[0],i=t.length>1?t[1]:null,o=t.length>2?t[2]:null;return this.control(r,i,o)}else return this.control(t)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Wt=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:fw,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:tv,useValue:t.callSetDisabledState??kd}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=ir({type:n});static \u0275inj=Gn({imports:[ZO]})}return n})();var QO=["content"],JO=["scroll"],eR=["padding"],yw=["*"],ac=n=>({searchTerm:n});function tR(n,e){if(n&1&&(E(0,"div",3),sa(1,6),_()),n&2){let t=re();A(),H("ngTemplateOutlet",t.headerTemplate)("ngTemplateOutletContext",is(2,ac,t.filterValue))}}function nR(n,e){if(n&1&&(E(0,"div",5),sa(1,6),_()),n&2){let t=re();A(),H("ngTemplateOutlet",t.footerTemplate)("ngTemplateOutletContext",is(2,ac,t.filterValue))}}var rR=["searchInput"],iR=["clearButton"],oR=(n,e,t)=>({item:n,clear:e,label:t}),sR=(n,e)=>({items:n,clear:e}),aR=(n,e,t,r)=>({item:n,item$:e,index:t,searchTerm:r});function lR(n,e){if(n&1&&(E(0,"div",20),C(1),_()),n&2){let t=re(2);A(),Je(t.placeholder)}}function cR(n,e){}function uR(n,e){if(n&1&&be(0,lR,2,1,"ng-template",null,1,li)(2,cR,0,0,"ng-template",19),n&2){let t=Er(1),r=re();A(2),H("ngTemplateOutlet",r.placeholderTemplate||t)}}function fR(n,e){if(n&1){let t=_t();E(0,"span",23),Ce("click",function(){qe(t);let i=re().$implicit,o=re(2);return Ke(o.unselect(i))}),C(1,"\xD7"),_(),J(2,"span",24)}if(n&2){let t=re().$implicit,r=re(2);A(2),H("ngItemLabel",t.label)("escape",r.escapeHTML)}}function dR(n,e){}function hR(n,e){if(n&1&&(E(0,"div",22),be(1,fR,3,2,"ng-template",null,2,li)(3,dR,0,0,"ng-template",12),_()),n&2){let t=e.$implicit,r=Er(2),i=re(2);Ie("ng-value-disabled",t.disabled),A(3),H("ngTemplateOutlet",i.labelTemplate||r)("ngTemplateOutletContext",Cg(4,oR,t.value,i.clearItem,t.label))}}function pR(n,e){if(n&1&&td(0,hR,4,8,"div",21,ed().trackByOption,!0),n&2){let t=re();nd(t.selectedItems)}}function mR(n,e){}function gR(n,e){if(n&1&&be(0,mR,0,0,"ng-template",12),n&2){let t=re();H("ngTemplateOutlet",t.multiLabelTemplate)("ngTemplateOutletContext",wg(2,sR,t.selectedValues,t.clearItem))}}function vR(n,e){n&1&&J(0,"div",25)}function _R(n,e){}function yR(n,e){if(n&1&&be(0,vR,1,0,"ng-template",null,3,li)(2,_R,0,0,"ng-template",19),n&2){let t=Er(1),r=re();A(2),H("ngTemplateOutlet",r.loadingSpinnerTemplate||t)}}function xR(n,e){if(n&1&&sa(0,19),n&2){let t=re(2);H("ngTemplateOutlet",t.clearButtonTemplate)}}function ER(n,e){if(n&1&&(E(0,"span",26,4)(2,"span",27),C(3,"\xD7"),_()()),n&2){let t=re(2);H("title",Tg(t.clearAllText)),or("tabindex",t.tabFocusOnClear()?0:-1)}}function TR(n,e){if(n&1&&Sn(0,xR,1,1,"ng-container",19)(1,ER,4,3,"span",26),n&2){let t=re();bn(t.clearButtonTemplate?0:1)}}function wR(n,e){if(n&1&&J(0,"span",32),n&2){let t=re().$implicit,r=re(2);H("ngItemLabel",t.label)("escape",r.escapeHTML)}}function CR(n,e){}function DR(n,e){if(n&1){let t=_t();E(0,"div",31),Ce("click",function(){let i=qe(t).$implicit,o=re(2);return Ke(o.toggleItem(i))})("mouseover",function(){let i=qe(t).$implicit,o=re(2);return Ke(o.onItemHover(i))}),be(1,wR,1,2,"ng-template",null,5,li)(3,CR,0,0,"ng-template",12),_()}if(n&2){let t=e.$implicit,r=Er(2),i=re(2);Ie("ng-option-disabled",t.disabled)("ng-option-selected",t.selected)("ng-optgroup",t.children)("ng-option",!t.children)("ng-option-child",!!t.parent)("ng-option-marked",t===i.itemsList.markedItem),or("role",t.children?"group":"option")("aria-selected",t.selected)("id",t==null?null:t.htmlId)("aria-setsize",i.itemsList.filteredItems.length)("aria-posinset",t.index+1),A(3),H("ngTemplateOutlet",t.children?i.optgroupTemplate||r:i.optionTemplate||r)("ngTemplateOutletContext",Dg(19,aR,t.value,t,t.index,i.searchTerm))}}function SR(n,e){if(n&1&&(E(0,"span")(1,"span",34),C(2),_(),C(3),_()),n&2){let t=re(3);A(2),Je(t.addTagText),A(),rt('"',t.searchTerm,'"')}}function bR(n,e){}function IR(n,e){if(n&1){let t=_t();E(0,"div",33),Ce("mouseover",function(){qe(t);let i=re(2);return Ke(i.itemsList.unmarkItem())})("click",function(){qe(t);let i=re(2);return Ke(i.selectTag())}),be(1,SR,4,2,"ng-template",null,6,li)(3,bR,0,0,"ng-template",12),_()}if(n&2){let t=Er(2),r=re(2);Ie("ng-option-marked",!r.itemsList.markedItem),A(3),H("ngTemplateOutlet",r.tagTemplate||t)("ngTemplateOutletContext",is(4,ac,r.searchTerm))}}function AR(n,e){if(n&1&&(E(0,"div",35),C(1),_()),n&2){let t=re(3);A(),Je(t.notFoundText)}}function FR(n,e){}function kR(n,e){if(n&1&&be(0,AR,2,1,"ng-template",null,7,li)(2,FR,0,0,"ng-template",12),n&2){let t=Er(1),r=re(2);A(2),H("ngTemplateOutlet",r.notFoundTemplate||t)("ngTemplateOutletContext",is(2,ac,r.searchTerm))}}function NR(n,e){if(n&1&&(E(0,"div",35),C(1),_()),n&2){let t=re(3);A(),Je(t.typeToSearchText)}}function MR(n,e){}function OR(n,e){if(n&1&&be(0,NR,2,1,"ng-template",null,8,li)(2,MR,0,0,"ng-template",19),n&2){let t=Er(1),r=re(2);A(2),H("ngTemplateOutlet",r.typeToSearchTemplate||t)}}function RR(n,e){if(n&1&&(E(0,"div",35),C(1),_()),n&2){let t=re(3);A(),Je(t.loadingText)}}function PR(n,e){}function LR(n,e){if(n&1&&be(0,RR,2,1,"ng-template",null,9,li)(2,PR,0,0,"ng-template",12),n&2){let t=Er(1),r=re(2);A(2),H("ngTemplateOutlet",r.loadingTextTemplate||t)("ngTemplateOutletContext",is(2,ac,r.searchTerm))}}function BR(n,e){if(n&1){let t=_t();E(0,"ng-dropdown-panel",28),Ce("update",function(i){qe(t);let o=re();return Ke(o.viewPortItems=i)})("scroll",function(i){qe(t);let o=re();return Ke(o.scroll.emit(i))})("scrollToEnd",function(i){qe(t);let o=re();return Ke(o.scrollToEnd.emit(i))})("outsideClick",function(){qe(t);let i=re();return Ke(i.close())}),oi(1),td(2,DR,4,24,"div",29,ed().trackByOption,!0),Sn(4,IR,4,6,"div",30),si(),Sn(5,kR,3,4),Sn(6,OR,3,1),Sn(7,LR,3,4),_()}if(n&2){let t=re();Ie("ng-select-multiple",t.multiple),H("virtualScroll",t.virtualScroll)("bufferAmount",t.bufferAmount)("appendTo",t.appendTo)("position",t.dropdownPosition)("headerTemplate",t.headerTemplate)("footerTemplate",t.footerTemplate)("filterValue",t.searchTerm)("items",t.itemsList.filteredItems)("markedItem",t.itemsList.markedItem)("ngClass",t.appendTo?t.ngClass?t.ngClass:t.classes:null)("id",t.dropdownId)("ariaLabelDropdown",t.ariaLabelDropdown),A(2),nd(t.viewPortItems),A(2),bn(t.showAddTag?4:-1),A(),bn(t.showNoItemsFound()?5:-1),A(),bn(t.showTypeToSearch()?6:-1),A(),bn(t.loading&&t.itemsList.filteredItems.length===0?7:-1)}}function VR(n,e){if(n&1&&C(0),n&2){let t=re();rt(" ",t.notFoundText," ")}}var xw=/[&<>"']/g,UR=RegExp(xw.source),jR={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function HR(n){return n&&UR.test(n)?n.replace(xw,e=>jR[e]):n}function Dt(n){return n!=null}function sc(n){return typeof n=="object"&&Dt(n)}function GR(n){return n instanceof Promise}function Od(n){return n instanceof Function}var $R=(()=>{let e=class e{constructor(r){this.element=r,this.escape=!0}ngOnChanges(r){this.element.nativeElement.innerHTML=this.escape?HR(this.ngItemLabel):this.ngItemLabel}};e.\u0275fac=function(i){return new(i||e)(ae(It))},e.\u0275dir=ze({type:e,selectors:[["","ngItemLabel",""]],inputs:{ngItemLabel:"ngItemLabel",escape:"escape"},features:[Vr]});let n=e;return n})(),WR=(()=>{let e=class e{constructor(r){this.template=r}};e.\u0275fac=function(i){return new(i||e)(ae(Qe))},e.\u0275dir=ze({type:e,selectors:[["","ng-option-tmp",""]]});let n=e;return n})(),zR=(()=>{let e=class e{constructor(r){this.template=r}};e.\u0275fac=function(i){return new(i||e)(ae(Qe))},e.\u0275dir=ze({type:e,selectors:[["","ng-optgroup-tmp",""]]});let n=e;return n})(),qR=(()=>{let e=class e{constructor(r){this.template=r}};e.\u0275fac=function(i){return new(i||e)(ae(Qe))},e.\u0275dir=ze({type:e,selectors:[["","ng-label-tmp",""]]});let n=e;return n})(),KR=(()=>{let e=class e{constructor(r){this.template=r}};e.\u0275fac=function(i){return new(i||e)(ae(Qe))},e.\u0275dir=ze({type:e,selectors:[["","ng-multi-label-tmp",""]]});let n=e;return n})(),YR=(()=>{let e=class e{constructor(r){this.template=r}};e.\u0275fac=function(i){return new(i||e)(ae(Qe))},e.\u0275dir=ze({type:e,selectors:[["","ng-header-tmp",""]]});let n=e;return n})(),XR=(()=>{let e=class e{constructor(r){this.template=r}};e.\u0275fac=function(i){return new(i||e)(ae(Qe))},e.\u0275dir=ze({type:e,selectors:[["","ng-footer-tmp",""]]});let n=e;return n})(),ZR=(()=>{let e=class e{constructor(r){this.template=r}};e.\u0275fac=function(i){return new(i||e)(ae(Qe))},e.\u0275dir=ze({type:e,selectors:[["","ng-notfound-tmp",""]]});let n=e;return n})(),QR=(()=>{let e=class e{constructor(r){this.template=r}};e.\u0275fac=function(i){return new(i||e)(ae(Qe))},e.\u0275dir=ze({type:e,selectors:[["","ng-placeholder-tmp",""]]});let n=e;return n})(),JR=(()=>{let e=class e{constructor(r){this.template=r}};e.\u0275fac=function(i){return new(i||e)(ae(Qe))},e.\u0275dir=ze({type:e,selectors:[["","ng-typetosearch-tmp",""]]});let n=e;return n})(),eP=(()=>{let e=class e{constructor(r){this.template=r}};e.\u0275fac=function(i){return new(i||e)(ae(Qe))},e.\u0275dir=ze({type:e,selectors:[["","ng-loadingtext-tmp",""]]});let n=e;return n})(),tP=(()=>{let e=class e{constructor(r){this.template=r}};e.\u0275fac=function(i){return new(i||e)(ae(Qe))},e.\u0275dir=ze({type:e,selectors:[["","ng-tag-tmp",""]]});let n=e;return n})(),nP=(()=>{let e=class e{constructor(r){this.template=r}};e.\u0275fac=function(i){return new(i||e)(ae(Qe))},e.\u0275dir=ze({type:e,selectors:[["","ng-loadingspinner-tmp",""]]});let n=e;return n})(),rP=(()=>{let e=class e{constructor(r){this.template=r}};e.\u0275fac=function(i){return new(i||e)(ae(Qe))},e.\u0275dir=ze({type:e,selectors:[["","ng-clearbutton-tmp",""]]});let n=e;return n})();function Ew(){return"axxxxxxxxxxx".replace(/[x]/g,()=>(Math.random()*16|0).toString(16))}var iP={"\u24B6":"A",\uFF21:"A",\u00C0:"A",\u00C1:"A",\u00C2:"A",\u1EA6:"A",\u1EA4:"A",\u1EAA:"A",\u1EA8:"A",\u00C3:"A",\u0100:"A",\u0102:"A",\u1EB0:"A",\u1EAE:"A",\u1EB4:"A",\u1EB2:"A",\u0226:"A",\u01E0:"A",\u00C4:"A",\u01DE:"A",\u1EA2:"A",\u00C5:"A",\u01FA:"A",\u01CD:"A",\u0200:"A",\u0202:"A",\u1EA0:"A",\u1EAC:"A",\u1EB6:"A",\u1E00:"A",\u0104:"A","\u023A":"A","\u2C6F":"A","\uA732":"AA",\u00C6:"AE",\u01FC:"AE",\u01E2:"AE","\uA734":"AO","\uA736":"AU","\uA738":"AV","\uA73A":"AV","\uA73C":"AY","\u24B7":"B",\uFF22:"B",\u1E02:"B",\u1E04:"B",\u1E06:"B","\u0243":"B",\u0182:"B",\u0181:"B","\u24B8":"C",\uFF23:"C",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u00C7:"C",\u1E08:"C",\u0187:"C","\u023B":"C","\uA73E":"C","\u24B9":"D",\uFF24:"D",\u1E0A:"D",\u010E:"D",\u1E0C:"D",\u1E10:"D",\u1E12:"D",\u1E0E:"D",\u0110:"D",\u018B:"D",\u018A:"D",\u0189:"D","\uA779":"D",\u01F1:"DZ",\u01C4:"DZ",\u01F2:"Dz",\u01C5:"Dz","\u24BA":"E",\uFF25:"E",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u1EC0:"E",\u1EBE:"E",\u1EC4:"E",\u1EC2:"E",\u1EBC:"E",\u0112:"E",\u1E14:"E",\u1E16:"E",\u0114:"E",\u0116:"E",\u00CB:"E",\u1EBA:"E",\u011A:"E",\u0204:"E",\u0206:"E",\u1EB8:"E",\u1EC6:"E",\u0228:"E",\u1E1C:"E",\u0118:"E",\u1E18:"E",\u1E1A:"E",\u0190:"E",\u018E:"E","\u24BB":"F",\uFF26:"F",\u1E1E:"F",\u0191:"F","\uA77B":"F","\u24BC":"G",\uFF27:"G",\u01F4:"G",\u011C:"G",\u1E20:"G",\u011E:"G",\u0120:"G",\u01E6:"G",\u0122:"G",\u01E4:"G",\u0193:"G","\uA7A0":"G","\uA77D":"G","\uA77E":"G","\u24BD":"H",\uFF28:"H",\u0124:"H",\u1E22:"H",\u1E26:"H",\u021E:"H",\u1E24:"H",\u1E28:"H",\u1E2A:"H",\u0126:"H","\u2C67":"H","\u2C75":"H","\uA78D":"H","\u24BE":"I",\uFF29:"I",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u0128:"I",\u012A:"I",\u012C:"I",\u0130:"I",\u00CF:"I",\u1E2E:"I",\u1EC8:"I",\u01CF:"I",\u0208:"I",\u020A:"I",\u1ECA:"I",\u012E:"I",\u1E2C:"I",\u0197:"I","\u24BF":"J",\uFF2A:"J",\u0134:"J","\u0248":"J","\u24C0":"K",\uFF2B:"K",\u1E30:"K",\u01E8:"K",\u1E32:"K",\u0136:"K",\u1E34:"K",\u0198:"K","\u2C69":"K","\uA740":"K","\uA742":"K","\uA744":"K","\uA7A2":"K","\u24C1":"L",\uFF2C:"L",\u013F:"L",\u0139:"L",\u013D:"L",\u1E36:"L",\u1E38:"L",\u013B:"L",\u1E3C:"L",\u1E3A:"L",\u0141:"L","\u023D":"L","\u2C62":"L","\u2C60":"L","\uA748":"L","\uA746":"L","\uA780":"L",\u01C7:"LJ",\u01C8:"Lj","\u24C2":"M",\uFF2D:"M",\u1E3E:"M",\u1E40:"M",\u1E42:"M","\u2C6E":"M",\u019C:"M","\u24C3":"N",\uFF2E:"N",\u01F8:"N",\u0143:"N",\u00D1:"N",\u1E44:"N",\u0147:"N",\u1E46:"N",\u0145:"N",\u1E4A:"N",\u1E48:"N","\u0220":"N",\u019D:"N","\uA790":"N","\uA7A4":"N",\u01CA:"NJ",\u01CB:"Nj","\u24C4":"O",\uFF2F:"O",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u1ED2:"O",\u1ED0:"O",\u1ED6:"O",\u1ED4:"O",\u00D5:"O",\u1E4C:"O",\u022C:"O",\u1E4E:"O",\u014C:"O",\u1E50:"O",\u1E52:"O",\u014E:"O",\u022E:"O",\u0230:"O",\u00D6:"O",\u022A:"O",\u1ECE:"O",\u0150:"O",\u01D1:"O",\u020C:"O",\u020E:"O",\u01A0:"O",\u1EDC:"O",\u1EDA:"O",\u1EE0:"O",\u1EDE:"O",\u1EE2:"O",\u1ECC:"O",\u1ED8:"O",\u01EA:"O",\u01EC:"O",\u00D8:"O",\u01FE:"O",\u0186:"O",\u019F:"O","\uA74A":"O","\uA74C":"O",\u01A2:"OI","\uA74E":"OO",\u0222:"OU","\u24C5":"P",\uFF30:"P",\u1E54:"P",\u1E56:"P",\u01A4:"P","\u2C63":"P","\uA750":"P","\uA752":"P","\uA754":"P","\u24C6":"Q",\uFF31:"Q","\uA756":"Q","\uA758":"Q","\u024A":"Q","\u24C7":"R",\uFF32:"R",\u0154:"R",\u1E58:"R",\u0158:"R",\u0210:"R",\u0212:"R",\u1E5A:"R",\u1E5C:"R",\u0156:"R",\u1E5E:"R","\u024C":"R","\u2C64":"R","\uA75A":"R","\uA7A6":"R","\uA782":"R","\u24C8":"S",\uFF33:"S","\u1E9E":"S",\u015A:"S",\u1E64:"S",\u015C:"S",\u1E60:"S",\u0160:"S",\u1E66:"S",\u1E62:"S",\u1E68:"S",\u0218:"S",\u015E:"S","\u2C7E":"S","\uA7A8":"S","\uA784":"S","\u24C9":"T",\uFF34:"T",\u1E6A:"T",\u0164:"T",\u1E6C:"T",\u021A:"T",\u0162:"T",\u1E70:"T",\u1E6E:"T",\u0166:"T",\u01AC:"T",\u01AE:"T","\u023E":"T","\uA786":"T","\uA728":"TZ","\u24CA":"U",\uFF35:"U",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u0168:"U",\u1E78:"U",\u016A:"U",\u1E7A:"U",\u016C:"U",\u00DC:"U",\u01DB:"U",\u01D7:"U",\u01D5:"U",\u01D9:"U",\u1EE6:"U",\u016E:"U",\u0170:"U",\u01D3:"U",\u0214:"U",\u0216:"U",\u01AF:"U",\u1EEA:"U",\u1EE8:"U",\u1EEE:"U",\u1EEC:"U",\u1EF0:"U",\u1EE4:"U",\u1E72:"U",\u0172:"U",\u1E76:"U",\u1E74:"U","\u0244":"U","\u24CB":"V",\uFF36:"V",\u1E7C:"V",\u1E7E:"V",\u01B2:"V","\uA75E":"V","\u0245":"V","\uA760":"VY","\u24CC":"W",\uFF37:"W",\u1E80:"W",\u1E82:"W",\u0174:"W",\u1E86:"W",\u1E84:"W",\u1E88:"W","\u2C72":"W","\u24CD":"X",\uFF38:"X",\u1E8A:"X",\u1E8C:"X","\u24CE":"Y",\uFF39:"Y",\u1EF2:"Y",\u00DD:"Y",\u0176:"Y",\u1EF8:"Y",\u0232:"Y",\u1E8E:"Y",\u0178:"Y",\u1EF6:"Y",\u1EF4:"Y",\u01B3:"Y","\u024E":"Y","\u1EFE":"Y","\u24CF":"Z",\uFF3A:"Z",\u0179:"Z",\u1E90:"Z",\u017B:"Z",\u017D:"Z",\u1E92:"Z",\u1E94:"Z",\u01B5:"Z",\u0224:"Z","\u2C7F":"Z","\u2C6B":"Z","\uA762":"Z","\u24D0":"a",\uFF41:"a",\u1E9A:"a",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u1EA7:"a",\u1EA5:"a",\u1EAB:"a",\u1EA9:"a",\u00E3:"a",\u0101:"a",\u0103:"a",\u1EB1:"a",\u1EAF:"a",\u1EB5:"a",\u1EB3:"a",\u0227:"a",\u01E1:"a",\u00E4:"a",\u01DF:"a",\u1EA3:"a",\u00E5:"a",\u01FB:"a",\u01CE:"a",\u0201:"a",\u0203:"a",\u1EA1:"a",\u1EAD:"a",\u1EB7:"a",\u1E01:"a",\u0105:"a","\u2C65":"a",\u0250:"a","\uA733":"aa",\u00E6:"ae",\u01FD:"ae",\u01E3:"ae","\uA735":"ao","\uA737":"au","\uA739":"av","\uA73B":"av","\uA73D":"ay","\u24D1":"b",\uFF42:"b",\u1E03:"b",\u1E05:"b",\u1E07:"b",\u0180:"b",\u0183:"b",\u0253:"b","\u24D2":"c",\uFF43:"c",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u00E7:"c",\u1E09:"c",\u0188:"c","\u023C":"c","\uA73F":"c","\u2184":"c","\u24D3":"d",\uFF44:"d",\u1E0B:"d",\u010F:"d",\u1E0D:"d",\u1E11:"d",\u1E13:"d",\u1E0F:"d",\u0111:"d",\u018C:"d",\u0256:"d",\u0257:"d","\uA77A":"d",\u01F3:"dz",\u01C6:"dz","\u24D4":"e",\uFF45:"e",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u1EC1:"e",\u1EBF:"e",\u1EC5:"e",\u1EC3:"e",\u1EBD:"e",\u0113:"e",\u1E15:"e",\u1E17:"e",\u0115:"e",\u0117:"e",\u00EB:"e",\u1EBB:"e",\u011B:"e",\u0205:"e",\u0207:"e",\u1EB9:"e",\u1EC7:"e",\u0229:"e",\u1E1D:"e",\u0119:"e",\u1E19:"e",\u1E1B:"e","\u0247":"e",\u025B:"e",\u01DD:"e","\u24D5":"f",\uFF46:"f",\u1E1F:"f",\u0192:"f","\uA77C":"f","\u24D6":"g",\uFF47:"g",\u01F5:"g",\u011D:"g",\u1E21:"g",\u011F:"g",\u0121:"g",\u01E7:"g",\u0123:"g",\u01E5:"g",\u0260:"g","\uA7A1":"g","\u1D79":"g","\uA77F":"g","\u24D7":"h",\uFF48:"h",\u0125:"h",\u1E23:"h",\u1E27:"h",\u021F:"h",\u1E25:"h",\u1E29:"h",\u1E2B:"h",\u1E96:"h",\u0127:"h","\u2C68":"h","\u2C76":"h",\u0265:"h",\u0195:"hv","\u24D8":"i",\uFF49:"i",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u0129:"i",\u012B:"i",\u012D:"i",\u00EF:"i",\u1E2F:"i",\u1EC9:"i",\u01D0:"i",\u0209:"i",\u020B:"i",\u1ECB:"i",\u012F:"i",\u1E2D:"i",\u0268:"i",\u0131:"i","\u24D9":"j",\uFF4A:"j",\u0135:"j",\u01F0:"j","\u0249":"j","\u24DA":"k",\uFF4B:"k",\u1E31:"k",\u01E9:"k",\u1E33:"k",\u0137:"k",\u1E35:"k",\u0199:"k","\u2C6A":"k","\uA741":"k","\uA743":"k","\uA745":"k","\uA7A3":"k","\u24DB":"l",\uFF4C:"l",\u0140:"l",\u013A:"l",\u013E:"l",\u1E37:"l",\u1E39:"l",\u013C:"l",\u1E3D:"l",\u1E3B:"l",\u017F:"l",\u0142:"l",\u019A:"l",\u026B:"l","\u2C61":"l","\uA749":"l","\uA781":"l","\uA747":"l",\u01C9:"lj","\u24DC":"m",\uFF4D:"m",\u1E3F:"m",\u1E41:"m",\u1E43:"m",\u0271:"m",\u026F:"m","\u24DD":"n",\uFF4E:"n",\u01F9:"n",\u0144:"n",\u00F1:"n",\u1E45:"n",\u0148:"n",\u1E47:"n",\u0146:"n",\u1E4B:"n",\u1E49:"n",\u019E:"n",\u0272:"n",\u0149:"n","\uA791":"n","\uA7A5":"n",\u01CC:"nj","\u24DE":"o",\uFF4F:"o",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u1ED3:"o",\u1ED1:"o",\u1ED7:"o",\u1ED5:"o",\u00F5:"o",\u1E4D:"o",\u022D:"o",\u1E4F:"o",\u014D:"o",\u1E51:"o",\u1E53:"o",\u014F:"o",\u022F:"o",\u0231:"o",\u00F6:"o",\u022B:"o",\u1ECF:"o",\u0151:"o",\u01D2:"o",\u020D:"o",\u020F:"o",\u01A1:"o",\u1EDD:"o",\u1EDB:"o",\u1EE1:"o",\u1EDF:"o",\u1EE3:"o",\u1ECD:"o",\u1ED9:"o",\u01EB:"o",\u01ED:"o",\u00F8:"o",\u01FF:"o",\u0254:"o","\uA74B":"o","\uA74D":"o",\u0275:"o",\u01A3:"oi",\u0223:"ou","\uA74F":"oo","\u24DF":"p",\uFF50:"p",\u1E55:"p",\u1E57:"p",\u01A5:"p","\u1D7D":"p","\uA751":"p","\uA753":"p","\uA755":"p","\u24E0":"q",\uFF51:"q","\u024B":"q","\uA757":"q","\uA759":"q","\u24E1":"r",\uFF52:"r",\u0155:"r",\u1E59:"r",\u0159:"r",\u0211:"r",\u0213:"r",\u1E5B:"r",\u1E5D:"r",\u0157:"r",\u1E5F:"r","\u024D":"r",\u027D:"r","\uA75B":"r","\uA7A7":"r","\uA783":"r","\u24E2":"s",\uFF53:"s",\u00DF:"s",\u015B:"s",\u1E65:"s",\u015D:"s",\u1E61:"s",\u0161:"s",\u1E67:"s",\u1E63:"s",\u1E69:"s",\u0219:"s",\u015F:"s","\u023F":"s","\uA7A9":"s","\uA785":"s",\u1E9B:"s","\u24E3":"t",\uFF54:"t",\u1E6B:"t",\u1E97:"t",\u0165:"t",\u1E6D:"t",\u021B:"t",\u0163:"t",\u1E71:"t",\u1E6F:"t",\u0167:"t",\u01AD:"t",\u0288:"t","\u2C66":"t","\uA787":"t","\uA729":"tz","\u24E4":"u",\uFF55:"u",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u0169:"u",\u1E79:"u",\u016B:"u",\u1E7B:"u",\u016D:"u",\u00FC:"u",\u01DC:"u",\u01D8:"u",\u01D6:"u",\u01DA:"u",\u1EE7:"u",\u016F:"u",\u0171:"u",\u01D4:"u",\u0215:"u",\u0217:"u",\u01B0:"u",\u1EEB:"u",\u1EE9:"u",\u1EEF:"u",\u1EED:"u",\u1EF1:"u",\u1EE5:"u",\u1E73:"u",\u0173:"u",\u1E77:"u",\u1E75:"u",\u0289:"u","\u24E5":"v",\uFF56:"v",\u1E7D:"v",\u1E7F:"v",\u028B:"v","\uA75F":"v",\u028C:"v","\uA761":"vy","\u24E6":"w",\uFF57:"w",\u1E81:"w",\u1E83:"w",\u0175:"w",\u1E87:"w",\u1E85:"w",\u1E98:"w",\u1E89:"w","\u2C73":"w","\u24E7":"x",\uFF58:"x",\u1E8B:"x",\u1E8D:"x","\u24E8":"y",\uFF59:"y",\u1EF3:"y",\u00FD:"y",\u0177:"y",\u1EF9:"y",\u0233:"y",\u1E8F:"y",\u00FF:"y",\u1EF7:"y",\u1E99:"y",\u1EF5:"y",\u01B4:"y","\u024F":"y","\u1EFF":"y","\u24E9":"z",\uFF5A:"z",\u017A:"z",\u1E91:"z",\u017C:"z",\u017E:"z",\u1E93:"z",\u1E95:"z",\u01B6:"z",\u0225:"z","\u0240":"z","\u2C6C":"z","\uA763":"z",\u0386:"\u0391",\u0388:"\u0395",\u0389:"\u0397",\u038A:"\u0399",\u03AA:"\u0399",\u038C:"\u039F",\u038E:"\u03A5",\u03AB:"\u03A5",\u038F:"\u03A9",\u03AC:"\u03B1",\u03AD:"\u03B5",\u03AE:"\u03B7",\u03AF:"\u03B9",\u03CA:"\u03B9",\u0390:"\u03B9",\u03CC:"\u03BF",\u03CD:"\u03C5",\u03CB:"\u03C5",\u03B0:"\u03C5",\u03C9:"\u03C9",\u03C2:"\u03C3"};function Md(n){let e=t=>iP[t]||t;return n.replace(/[^\u0000-\u007E]/g,e)}var iv=class{constructor(e,t){this._ngSelect=e,this._selectionModel=t,this._items=[],this._filteredItems=[],this._markedIndex=-1}get items(){return this._items}get filteredItems(){return this._filteredItems}get markedIndex(){return this._markedIndex}get selectedItems(){return this._selectionModel.value}get markedItem(){return this._filteredItems[this._markedIndex]}get noItemsToSelect(){return this._ngSelect.hideSelected&&this._items.length===this.selectedItems.length}get maxItemsSelected(){return this._ngSelect.multiple&&this._ngSelect.maxSelectedItems<=this.selectedItems.length}get lastSelectedItem(){let e=this.selectedItems.length-1;for(;e>=0;e--){let t=this.selectedItems[e];if(!t.disabled)return t}return null}setItems(e){this._items=e.map((t,r)=>this.mapItem(t,r)),this._ngSelect.groupBy?(this._groups=this._groupBy(this._items,this._ngSelect.groupBy),this._items=this._flatten(this._groups)):(this._groups=new Map,this._groups.set(void 0,this._items)),this._filteredItems=[...this._items]}select(e){if(e.selected||this.maxItemsSelected)return;let t=this._ngSelect.multiple;t||this.clearSelected(),this._selectionModel.select(e,t,this._ngSelect.selectableGroupAsModel),this._ngSelect.hideSelected&&this._hideSelected(e)}unselect(e){e.selected&&(this._selectionModel.unselect(e,this._ngSelect.multiple),this._ngSelect.hideSelected&&Dt(e.index)&&this._ngSelect.multiple&&this._showSelected(e))}findItem(e){let t;return this._ngSelect.compareWith?t=r=>this._ngSelect.compareWith(r.value,e):this._ngSelect.bindValue?t=r=>!r.children&&this.resolveNested(r.value,this._ngSelect.bindValue)===e:t=r=>r.value===e||!r.children&&r.label&&r.label===this.resolveNested(e,this._ngSelect.bindLabel),this._items.find(r=>t(r))}addItem(e){let t=this.mapItem(e,this._items.length);return this._items.push(t),this._filteredItems.push(t),t}clearSelected(e=!1){this._selectionModel.clear(e),this._items.forEach(t=>{t.selected=e&&t.selected&&t.disabled,t.marked=!1}),this._ngSelect.hideSelected&&this.resetFilteredItems()}findByLabel(e){return e=Md(e).toLocaleLowerCase(),this.filteredItems.find(t=>Md(t.label).toLocaleLowerCase().substr(0,e.length)===e)}filter(e){if(!e){this.resetFilteredItems();return}this._filteredItems=[],e=this._ngSelect.searchFn?e:Md(e).toLocaleLowerCase();let t=this._ngSelect.searchFn||this._defaultSearchFn,r=this._ngSelect.hideSelected;for(let i of Array.from(this._groups.keys())){let o=[];for(let s of this._groups.get(i)){if(r&&(s.parent&&s.parent.selected||s.selected))continue;let a=this._ngSelect.searchFn?s.value:s;t(e,a)&&o.push(s)}if(o.length>0){let[s]=o.slice(-1);if(s.parent){let a=this._items.find(l=>l===s.parent);this._filteredItems.push(a)}this._filteredItems.push(...o)}}}resetFilteredItems(){this._filteredItems.length!==this._items.length&&(this._ngSelect.hideSelected&&this.selectedItems.length>0?this._filteredItems=this._items.filter(e=>!e.selected):this._filteredItems=this._items)}unmarkItem(){this._markedIndex=-1}markNextItem(){this._stepToItem(1)}markPreviousItem(){this._stepToItem(-1)}markItem(e){this._markedIndex=this._filteredItems.indexOf(e)}markSelectedOrDefault(e){if(this._filteredItems.length===0)return;let t=this._getLastMarkedIndex();t>-1?this._markedIndex=t:this._markedIndex=e?this.filteredItems.findIndex(r=>!r.disabled):-1}resolveNested(e,t){if(!sc(e))return e;if(t.indexOf(".")===-1)return e[t];{let r=t.split("."),i=e;for(let o=0,s=r.length;o<s;++o){if(i==null)return null;i=i[r[o]]}return i}}mapItem(e,t){let r=Dt(e.$ngOptionLabel)?e.$ngOptionLabel:this.resolveNested(e,this._ngSelect.bindLabel),i=Dt(e.$ngOptionValue)?e.$ngOptionValue:e;return{index:t,label:Dt(r)?r.toString():"",value:i,disabled:e.disabled,htmlId:`${this._ngSelect.dropdownId}-${t}`}}mapSelectedItems(){let e=this._ngSelect.multiple;for(let t of this.selectedItems){let r=this._ngSelect.bindValue?this.resolveNested(t.value,this._ngSelect.bindValue):t.value,i=Dt(r)?this.findItem(r):null;this._selectionModel.unselect(t,e),this._selectionModel.select(i||t,e,this._ngSelect.selectableGroupAsModel)}this._ngSelect.hideSelected&&(this._filteredItems=this.filteredItems.filter(t=>this.selectedItems.indexOf(t)===-1))}_showSelected(e){if(this._filteredItems.push(e),e.parent){let t=e.parent;this._filteredItems.find(i=>i===t)||this._filteredItems.push(t)}else if(e.children)for(let t of e.children)t.selected=!1,this._filteredItems.push(t);this._filteredItems=[...this._filteredItems.sort((t,r)=>t.index-r.index)]}_hideSelected(e){this._filteredItems=this._filteredItems.filter(t=>t!==e),e.parent?e.parent.children.every(r=>r.selected)&&(this._filteredItems=this._filteredItems.filter(r=>r!==e.parent)):e.children&&(this._filteredItems=this.filteredItems.filter(t=>t.parent!==e))}_defaultSearchFn(e,t){return Md(t.label).toLocaleLowerCase().indexOf(e)>-1}_getNextItemIndex(e){return e>0?this._markedIndex>=this._filteredItems.length-1?0:this._markedIndex+1:this._markedIndex<=0?this._filteredItems.length-1:this._markedIndex-1}_stepToItem(e){this._filteredItems.length===0||this._filteredItems.every(t=>t.disabled)||(this._markedIndex=this._getNextItemIndex(e),this.markedItem.disabled&&this._stepToItem(e))}_getLastMarkedIndex(){if(this._ngSelect.hideSelected||this._markedIndex>-1&&this.markedItem===void 0)return-1;let e=this._filteredItems.indexOf(this.lastSelectedItem);return this.lastSelectedItem&&e<0?-1:Math.max(this.markedIndex,e)}_groupBy(e,t){let r=new Map;if(e.length===0)return r;if(Array.isArray(e[0].value[t])){for(let s of e){let a=(s.value[t]||[]).map((l,c)=>this.mapItem(l,c));r.set(s,a)}return r}let i=Od(this._ngSelect.groupBy),o=s=>{let a=i?t(s.value):s.value[t];return Dt(a)?a:void 0};for(let s of e){let a=o(s),l=r.get(a);l?l.push(s):r.set(a,[s])}return r}_flatten(e){let t=Od(this._ngSelect.groupBy),r=[];for(let i of Array.from(e.keys())){let o=r.length;if(i===void 0){let f=e.get(void 0)||[];r.push(...f.map(h=>(h.index=o++,h)));continue}let s=sc(i),a={label:s?"":String(i),children:void 0,parent:null,index:o++,disabled:!this._ngSelect.selectableGroup,htmlId:Ew()},l=t?this._ngSelect.bindLabel:this._ngSelect.groupBy,c=this._ngSelect.groupValue||(()=>s?i.value:{[l]:i}),u=e.get(i).map(f=>(f.parent=a,f.children=void 0,f.index=o++,f));a.children=u,a.value=c(i,u.map(f=>f.value)),r.push(a),r.push(...u)}return r}},Tw=(()=>{let e=class e{constructor(){this._dimensions={itemHeight:0,panelHeight:0,itemsPerViewport:0}}get dimensions(){return this._dimensions}calculateItems(r,i,o){let s=this._dimensions,a=s.itemHeight*i,c=Math.max(0,r)/a*i,u=Math.min(i,Math.ceil(c)+(s.itemsPerViewport+1)),h=Math.max(0,u-s.itemsPerViewport),d=Math.min(h,Math.floor(c)),m=s.itemHeight*Math.ceil(d)-s.itemHeight*Math.min(d,o);return m=isNaN(m)?0:m,d=isNaN(d)?-1:d,u=isNaN(u)?-1:u,d-=o,d=Math.max(0,d),u+=o,u=Math.min(i,u),{topPadding:m,scrollHeight:a,start:d,end:u}}setDimensions(r,i){let o=Math.max(1,Math.floor(i/r));this._dimensions={itemHeight:r,panelHeight:i,itemsPerViewport:o}}getScrollTo(r,i,o){let{panelHeight:s}=this.dimensions,a=r+i,l=o,c=l+s;return s>=a&&o===r?null:a>c?l+a-c:r<=l?r:null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Ge({token:e,factory:e.\u0275fac});let n=e;return n})(),vw=["top","right","bottom","left"],oP=typeof requestAnimationFrame<"u"?B0:L0,_w=(()=>{let e=class e{constructor(r,i,o,s,a){this._renderer=r,this._zone=i,this._panelService=o,this._document=a,this.items=[],this.position="auto",this.virtualScroll=!1,this.filterValue=null,this.ariaLabelDropdown=kg(null),this.update=new ot,this.scroll=new ot,this.scrollToEnd=new ot,this.outsideClick=new ot,this._destroy$=new St,this._scrollToEndFired=!1,this._updateScrollHeight=!1,this._lastScrollPosition=0,this._dropdown=s.nativeElement}get currentPosition(){return this._currentPosition}get itemsLength(){return this._itemsLength}set itemsLength(r){r!==this._itemsLength&&(this._itemsLength=r,this._onItemsLengthChanged())}get _startOffset(){if(this.markedItem){let{itemHeight:r,panelHeight:i}=this._panelService.dimensions,o=this.markedItem.index*r;return i>o?0:o}return 0}ngOnInit(){this._select=this._dropdown.parentElement,this._virtualPadding=this.paddingElementRef.nativeElement,this._scrollablePanel=this.scrollElementRef.nativeElement,this._contentPanel=this.contentElementRef.nativeElement,this._handleScroll(),this._handleOutsideClick(),this._appendDropdown(),this._setupMousedownListener()}ngOnChanges(r){if(r.items){let i=r.items;this._onItemsChange(i.currentValue,i.firstChange)}}ngOnDestroy(){this._destroy$.next(),this._destroy$.complete(),this._destroy$.unsubscribe(),this.appendTo&&this._renderer.removeChild(this._dropdown.parentNode,this._dropdown)}scrollTo(r,i=!1){if(!r)return;let o=this.items.indexOf(r);if(o<0||o>=this.itemsLength)return;let s;if(this.virtualScroll){let a=this._panelService.dimensions.itemHeight;s=this._panelService.getScrollTo(o*a,a,this._lastScrollPosition)}else{let a=this._dropdown.querySelector(`#${r.htmlId}`),l=i?a.offsetTop:this._lastScrollPosition;s=this._panelService.getScrollTo(a.offsetTop,a.clientHeight,l)}Dt(s)&&(this._scrollablePanel.scrollTop=s)}scrollToTag(){let r=this._scrollablePanel;r.scrollTop=r.scrollHeight-r.clientHeight}adjustPosition(){this._updateYPosition()}_handleDropdownPosition(){this._currentPosition=this._calculateCurrentPosition(this._dropdown),vw.includes(this._currentPosition)?this._updateDropdownClass(this._currentPosition):this._updateDropdownClass("bottom"),this.appendTo&&this._updateYPosition(),this._dropdown.style.opacity="1"}_updateDropdownClass(r){vw.forEach(o=>{let s=`ng-select-${o}`;this._renderer.removeClass(this._dropdown,s),this._renderer.removeClass(this._select,s)});let i=`ng-select-${r}`;this._renderer.addClass(this._dropdown,i),this._renderer.addClass(this._select,i)}_handleScroll(){this._zone.runOutsideAngular(()=>{Ki(this.scrollElementRef.nativeElement,"scroll").pipe(Yi(this._destroy$),G0(0,oP)).subscribe(r=>{let i=r.path||r.composedPath&&r.composedPath();if(!i||i.length===0&&!r.target)return;let o=!i||i.length===0?r.target.scrollTop:i[0].scrollTop;this._onContentScrolled(o)})})}_handleOutsideClick(){this._document&&this._zone.runOutsideAngular(()=>{al(Ki(this._document,"touchstart",{capture:!0}),Ki(this._document,"click",{capture:!0})).pipe(Yi(this._destroy$)).subscribe(r=>this._checkToClose(r))})}_checkToClose(r){if(this._select.contains(r.target)||this._dropdown.contains(r.target))return;let i=r.path||r.composedPath&&r.composedPath();r.target&&r.target.shadowRoot&&i&&i[0]&&this._select.contains(i[0])||this._zone.run(()=>this.outsideClick.emit())}_onItemsChange(r,i){this.items=r||[],this._scrollToEndFired=!1,this.itemsLength=r.length,this.virtualScroll?this._updateItemsRange(i):(this._setVirtualHeight(),this._updateItems(i))}_updateItems(r){this.update.emit(this.items),r!==!1&&this._zone.runOutsideAngular(()=>{Promise.resolve().then(()=>{let i=this._scrollablePanel.clientHeight;this._panelService.setDimensions(0,i),this._handleDropdownPosition(),this.scrollTo(this.markedItem,r)})})}_updateItemsRange(r){this._zone.runOutsideAngular(()=>{this._measureDimensions().then(()=>{r?(this._renderItemsRange(this._startOffset),this._handleDropdownPosition()):this._renderItemsRange()})})}_onContentScrolled(r){this.virtualScroll&&this._renderItemsRange(r),this._lastScrollPosition=r,this._fireScrollToEnd(r)}_updateVirtualHeight(r){this._updateScrollHeight&&(this._virtualPadding.style.height=`${r}px`,this._updateScrollHeight=!1)}_setVirtualHeight(){this._virtualPadding&&(this._virtualPadding.style.height="0px")}_onItemsLengthChanged(){this._updateScrollHeight=!0}_renderItemsRange(r=null){if(r&&this._lastScrollPosition===r)return;r=r||this._scrollablePanel.scrollTop;let i=this._panelService.calculateItems(r,this.itemsLength,this.bufferAmount);this._updateVirtualHeight(i.scrollHeight),this._contentPanel.style.transform=`translateY(${i.topPadding}px)`,this._zone.run(()=>{this.update.emit(this.items.slice(i.start,i.end)),this.scroll.emit({start:i.start,end:i.end})}),Dt(r)&&this._lastScrollPosition===0&&(this._scrollablePanel.scrollTop=r,this._lastScrollPosition=r)}_measureDimensions(){if(this._panelService.dimensions.itemHeight>0||this.itemsLength===0)return Promise.resolve(this._panelService.dimensions);let[r]=this.items;return this.update.emit([r]),Promise.resolve().then(()=>{let o=this._dropdown.querySelector(`#${r.htmlId}`).clientHeight;this._virtualPadding.style.height=`${o*this.itemsLength}px`;let s=this._scrollablePanel.clientHeight;return this._panelService.setDimensions(o,s),this._panelService.dimensions})}_fireScrollToEnd(r){if(this._scrollToEndFired||r===0)return;let i=this.virtualScroll?this._virtualPadding:this._contentPanel;r+this._dropdown.clientHeight>=i.clientHeight-1&&(this._zone.run(()=>this.scrollToEnd.emit()),this._scrollToEndFired=!0)}_calculateCurrentPosition(r){if(this.position!=="auto")return this.position;let i=this._select.getBoundingClientRect(),o=document.documentElement.scrollTop||document.body.scrollTop,s=i.top+window.pageYOffset,a=i.height,l=r.getBoundingClientRect().height;return s+a+l>o+document.documentElement.clientHeight?"top":"bottom"}_appendDropdown(){if(this.appendTo){if(this._parent=this._dropdown.shadowRoot?this._dropdown.shadowRoot.querySelector(this.appendTo):document.querySelector(this.appendTo),!this._parent)throw new Error(`appendTo selector ${this.appendTo} did not found any parent element`);this._updateXPosition(),this._parent.appendChild(this._dropdown)}}_updateXPosition(){let r=this._select.getBoundingClientRect(),i=this._parent.getBoundingClientRect(),o=document.documentElement.dir==="rtl",s=r.left-i.left;if(o){let a=i.right-r.right;this._dropdown.style.right=a+"px",this._dropdown.style.left="auto"}else this._dropdown.style.left=s+"px",this._dropdown.style.right="auto";this._dropdown.style.width=r.width+"px",this._dropdown.style.minWidth=r.width+"px"}_updateYPosition(){let r=this._select.getBoundingClientRect(),i=this._parent.getBoundingClientRect(),o=r.height;if(this._currentPosition==="top"){let s=i.bottom-r.bottom;this._dropdown.style.bottom=s+o+"px",this._dropdown.style.top="auto"}else if(this._currentPosition==="bottom"){let s=r.top-i.top;this._dropdown.style.top=s+o+"px",this._dropdown.style.bottom="auto"}}_setupMousedownListener(){this._zone.runOutsideAngular(()=>{Ki(this._dropdown,"mousedown").pipe(Yi(this._destroy$)).subscribe(r=>{r.target.tagName!=="INPUT"&&r.preventDefault()})})}};e.\u0275fac=function(i){return new(i||e)(ae(Ur),ae(xt),ae(Tw),ae(It),ae(Mt,8))},e.\u0275cmp=nt({type:e,selectors:[["ng-dropdown-panel"]],viewQuery:function(i,o){if(i&1&&(co(QO,7,It),co(JO,7,It),co(eR,7,It)),i&2){let s;Ot(s=Rt())&&(o.contentElementRef=s.first),Ot(s=Rt())&&(o.scrollElementRef=s.first),Ot(s=Rt())&&(o.paddingElementRef=s.first)}},inputs:{items:"items",markedItem:"markedItem",position:"position",appendTo:"appendTo",bufferAmount:"bufferAmount",virtualScroll:[2,"virtualScroll","virtualScroll",Ht],headerTemplate:"headerTemplate",footerTemplate:"footerTemplate",filterValue:"filterValue",ariaLabelDropdown:[1,"ariaLabelDropdown"]},outputs:{update:"update",scroll:"scroll",scrollToEnd:"scrollToEnd",outsideClick:"outsideClick"},features:[Vr],ngContentSelectors:yw,decls:9,vars:7,consts:[["scroll",""],["padding",""],["content",""],[1,"ng-dropdown-header"],["role","listbox",1,"ng-dropdown-panel-items","scroll-host"],[1,"ng-dropdown-footer"],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(i,o){i&1&&(id(),Sn(0,tR,2,4,"div",3),E(1,"div",4,0),J(3,"div",null,1),E(5,"div",null,2),od(7),_()(),Sn(8,nR,2,4,"div",5)),i&2&&(bn(o.headerTemplate?0:-1),A(),or("aria-label",o.ariaLabelDropdown()),A(2),Ie("total-padding",o.virtualScroll),A(2),Ie("scrollable-content",o.virtualScroll&&o.items.length),A(3),bn(o.footerTemplate?8:-1))},dependencies:[pd],encapsulation:2,changeDetection:0});let n=e;return n})(),sP=(()=>{let e=class e{constructor(r){this.elementRef=r,this.disabled=!1,this.stateChange$=new St}get label(){return(this.elementRef.nativeElement.textContent||"").trim()}ngOnChanges(r){r.disabled&&this.stateChange$.next({value:this.value,disabled:this.disabled})}ngAfterViewChecked(){this.label!==this._previousLabel&&(this._previousLabel=this.label,this.stateChange$.next({value:this.value,disabled:this.disabled,label:this.elementRef.nativeElement.innerHTML}))}ngOnDestroy(){this.stateChange$.complete()}};e.\u0275fac=function(i){return new(i||e)(ae(It))},e.\u0275cmp=nt({type:e,selectors:[["ng-option"]],inputs:{value:"value",disabled:[2,"disabled","disabled",Ht]},features:[Vr],ngContentSelectors:yw,decls:1,vars:0,template:function(i,o){i&1&&(id(),od(0))},encapsulation:2,changeDetection:0});let n=e;return n})(),ui=function(n){return n.Tab="Tab",n.Enter="Enter",n.Esc="Escape",n.Space=" ",n.ArrowUp="ArrowUp",n.ArrowDown="ArrowDown",n.Backspace="Backspace",n}(ui||{});function aP(){return new ov}var ov=class{constructor(){this._selected=[]}get value(){return this._selected}select(e,t,r){if(e.selected=!0,(!e.children||!t&&r)&&this._selected.push(e),t)if(e.parent){let i=e.parent.children.length,o=e.parent.children.filter(s=>s.selected).length;e.parent.selected=i===o}else e.children&&(this._setChildrenSelectedState(e.children,!0),this._removeChildren(e),r&&this._activeChildren(e)?this._selected=[...this._selected.filter(i=>i.parent!==e),e]:this._selected=[...this._selected,...e.children.filter(i=>!i.disabled)])}unselect(e,t){if(this._selected=this._selected.filter(r=>r!==e),e.selected=!1,t)if(e.parent&&e.parent.selected){let r=e.parent.children;this._removeParent(e.parent),this._removeChildren(e.parent),this._selected.push(...r.filter(i=>i!==e&&!i.disabled)),e.parent.selected=!1}else e.children&&(this._setChildrenSelectedState(e.children,!1),this._removeChildren(e))}clear(e){this._selected=e?this._selected.filter(t=>t.disabled):[]}_setChildrenSelectedState(e,t){for(let r of e)r.disabled||(r.selected=t)}_removeChildren(e){this._selected=[...this._selected.filter(t=>t.parent!==e),...e.children.filter(t=>t.parent===e&&t.disabled&&t.selected)]}_removeParent(e){this._selected=this._selected.filter(t=>t!==e)}_activeChildren(e){return e.children.every(t=>!t.disabled||t.selected)}},lP=(()=>{let e=class e{constructor(){this.fixedPlaceholder=!0,this.notFoundText="No items found",this.typeToSearchText="Type to search",this.addTagText="Add item",this.loadingText="Loading...",this.clearAllText="Clear all",this.disableVirtualScroll=!0,this.openOnEnter=!0,this.appearance="underline",this.tabFocusOnClear=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Ge({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),cP=(()=>{let e=class e{warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Ge({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),uP=new Re("ng-select-selection-model"),po=(()=>{let e=class e{constructor(r,i,o,s,a,l,c){this.classes=r,this.autoFocus=i,this.config=o,this._cd=l,this._console=c,this.ariaLabelDropdown="Options List",this.markFirst=!0,this.fixedPlaceholder=!0,this.preventToggleOnRightClick=!1,this.dropdownPosition="auto",this.loading=!1,this.closeOnSelect=!0,this.hideSelected=!1,this.selectOnTab=!1,this.bufferAmount=4,this.selectableGroup=!1,this.selectableGroupAsModel=!0,this.searchFn=null,this.trackByFn=null,this.clearOnBackspace=!0,this.labelForId=null,this.inputAttrs={},this.tabFocusOnClearButton=kg(),this.readonly=!1,this.searchWhileComposing=!0,this.minTermLength=0,this.editableSearchTerm=!1,this.ngClass=null,this.multiple=!1,this.addTag=!1,this.searchable=!0,this.clearable=!0,this.isOpen=!1,this.blurEvent=new ot,this.focusEvent=new ot,this.changeEvent=new ot,this.openEvent=new ot,this.closeEvent=new ot,this.searchEvent=new ot,this.clearEvent=new ot,this.addEvent=new ot,this.removeEvent=new ot,this.scroll=new ot,this.scrollToEnd=new ot,this.useDefaultClass=!0,this.viewPortItems=[],this.searchTerm=null,this.dropdownId=Ew(),this.escapeHTML=!0,this.tabFocusOnClear=$n(!0),this._defaultLabel="label",this._pressedKeys=[],this._isComposing=!1,this._destroy$=new St,this._keyPress$=new St,this._items=[],this.keyDownFn=u=>!0,this.clearItem=u=>{let f=this.selectedItems.find(h=>h.value===u);this.unselect(f)},this.trackByOption=(u,f)=>this.trackByFn?this.trackByFn(f.value):f,this._onChange=u=>{},this._onTouched=()=>{},this._mergeGlobalConfig(o),this.itemsList=new iv(this,s?s():aP()),this.element=a.nativeElement}get filtered(){return!!this.searchTerm&&this.searchable||this._isComposing}get single(){return!this.multiple}get items(){return this._items}set items(r){this._itemsAreUsed=!0,this._items=r??[]}get disabled(){return this.readonly||this._disabled}get compareWith(){return this._compareWith}set compareWith(r){if(r!=null&&!Od(r))throw Error("`compareWith` must be a function.");this._compareWith=r}get clearSearchOnAdd(){return Dt(this._clearSearchOnAdd)?this._clearSearchOnAdd:Dt(this.config.clearSearchOnAdd)?this.config.clearSearchOnAdd:this.closeOnSelect}set clearSearchOnAdd(r){this._clearSearchOnAdd=r}get deselectOnClick(){return Dt(this._deselectOnClick)?this._deselectOnClick:Dt(this.config.deselectOnClick)?this.config.deselectOnClick:this.multiple}set deselectOnClick(r){this._deselectOnClick=r}get selectedItems(){return this.itemsList.selectedItems}get selectedValues(){return this.selectedItems.map(r=>r.value)}get hasValue(){return this.selectedItems.length>0}get currentPanelPosition(){if(this.dropdownPanel)return this.dropdownPanel.currentPosition}get showAddTag(){if(!this._validTerm)return!1;let r=this.searchTerm.toLowerCase().trim();return this.addTag&&!this.itemsList.filteredItems.some(i=>i.label.toLowerCase()===r)&&(!this.hideSelected&&this.isOpen||!this.selectedItems.some(i=>i.label.toLowerCase()===r))&&!this.loading}get _editableSearchTerm(){return this.editableSearchTerm&&!this.multiple}get _isTypeahead(){return this.typeahead&&this.typeahead.observers.length>0}get _validTerm(){let r=this.searchTerm?.trim();return r&&r.length>=this.minTermLength}ngOnInit(){this._handleKeyPresses(),this._setInputAttributes()}ngOnChanges(r){r.multiple&&this.itemsList.clearSelected(),r.items&&this._setItems(r.items.currentValue||[]),r.isOpen&&(this._manualOpen=Dt(r.isOpen.currentValue)),r.groupBy&&(r.items||this._setItems([...this.items])),r.inputAttrs&&this._setInputAttributes(),this._setTabFocusOnClear()}ngAfterViewInit(){this._itemsAreUsed||(this.escapeHTML=!1,this._setItemsFromNgOptions()),Dt(this.autoFocus)&&this.focus()}ngOnDestroy(){this._destroy$.next(),this._destroy$.complete()}handleKeyDown(r){let i=r.key;if(Object.values(ui).includes(i)){if(this.keyDownFn(r)===!1)return;this.handleKeyCode(r)}else i&&i.length===1&&this._keyPress$.next(i.toLocaleLowerCase())}handleKeyCode(r){let i=r.target;this.clearButton&&this.clearButton.nativeElement===i?this.handleKeyCodeClear(r):this.handleKeyCodeInput(r)}handleKeyCodeInput(r){switch(r.key){case ui.ArrowDown:this._handleArrowDown(r);break;case ui.ArrowUp:this._handleArrowUp(r);break;case ui.Space:this._handleSpace(r);break;case ui.Enter:this._handleEnter(r);break;case ui.Tab:this._handleTab(r);break;case ui.Esc:this.close(),r.preventDefault();break;case ui.Backspace:this._handleBackspace();break}}handleKeyCodeClear(r){switch(r.key){case ui.Enter:this.handleClearClick(),r.preventDefault();break}}handleMousedown(r){if(this.preventToggleOnRightClick&&r.button===2)return!1;let i=r.target;if(i.tagName!=="INPUT"&&r.preventDefault(),i.classList.contains("ng-clear-wrapper")){this.handleClearClick();return}if(i.classList.contains("ng-arrow-wrapper")){this.handleArrowClick();return}i.classList.contains("ng-value-icon")||(this.focused||this.focus(),this.searchable?this.open():this.toggle())}handleArrowClick(){this.isOpen?this.close():this.open()}handleClearClick(){this.hasValue&&(this.itemsList.clearSelected(!0),this._updateNgModel()),this._clearSearch(),this.focus(),this.clearEvent.emit(),this._onSelectionChanged()}clearModel(){this.clearable&&(this.itemsList.clearSelected(),this._updateNgModel())}writeValue(r){this.itemsList.clearSelected(),this._handleWriteValue(r),this._cd.markForCheck()}registerOnChange(r){this._onChange=r}registerOnTouched(r){this._onTouched=r}setDisabledState(r){this._disabled=r,this._cd.markForCheck()}toggle(){this.isOpen?this.close():this.open()}open(){this.disabled||this.isOpen||this._manualOpen||!this._isTypeahead&&!this.addTag&&this.itemsList.noItemsToSelect||(this.isOpen=!0,this.itemsList.markSelectedOrDefault(this.markFirst),this.openEvent.emit(),this.searchTerm||this.focus(),this.detectChanges())}close(){!this.isOpen||this._manualOpen||(this.isOpen=!1,this._isComposing=!1,this._editableSearchTerm?this.itemsList.resetFilteredItems():this._clearSearch(),this.itemsList.unmarkItem(),this._onTouched(),this.closeEvent.emit(),this._cd.markForCheck())}toggleItem(r){!r||r.disabled||this.disabled||(this.deselectOnClick&&r.selected?this.unselect(r):this.select(r),this._editableSearchTerm&&this._setSearchTermFromItems())}select(r){r.selected||(this.itemsList.select(r),this.clearSearchOnAdd&&!this._editableSearchTerm&&this._clearSearch(),this._updateNgModel(),this.multiple&&this.addEvent.emit(r.value)),(this.closeOnSelect||this.itemsList.noItemsToSelect)&&this.close(),this._onSelectionChanged()}focus(){this.searchInput.nativeElement.focus()}blur(){this.searchInput.nativeElement.blur()}unselect(r){r&&(this.itemsList.unselect(r),this.focus(),this._updateNgModel(),this.removeEvent.emit(r.value),this._onSelectionChanged())}selectTag(){let r;Od(this.addTag)?r=this.addTag(this.searchTerm):r=this._primitive?this.searchTerm:{[this.bindLabel]:this.searchTerm};let i=o=>this._isTypeahead||!this.isOpen?this.itemsList.mapItem(o,null):this.itemsList.addItem(o);GR(r)?r.then(o=>this.select(i(o))).catch(()=>{}):r&&this.select(i(r))}showClear(){return this.clearable&&(this.hasValue||this.searchTerm)&&!this.disabled}focusOnClear(){this.blur(),this.clearButton&&this.clearButton.nativeElement.focus()}showNoItemsFound(){let r=this.itemsList.filteredItems.length===0;return(r&&!this._isTypeahead&&!this.loading||r&&this._isTypeahead&&this._validTerm&&!this.loading)&&!this.showAddTag}showTypeToSearch(){return this.itemsList.filteredItems.length===0&&this._isTypeahead&&!this._validTerm&&!this.loading}onCompositionStart(){this._isComposing=!0}onCompositionEnd(r){this._isComposing=!1,!this.searchWhileComposing&&this.filter(r)}filter(r){this._isComposing&&!this.searchWhileComposing||(this.searchTerm=r,this._isTypeahead&&(this._validTerm||this.minTermLength===0)&&this.typeahead.next(r),this._isTypeahead||(this.itemsList.filter(this.searchTerm),this.isOpen&&this.itemsList.markSelectedOrDefault(this.markFirst)),this.searchEvent.emit({term:r,items:this.itemsList.filteredItems.map(i=>i.value)}),this.open())}onInputFocus(r){this.focused||(this._editableSearchTerm&&this._setSearchTermFromItems(),this.element.classList.add("ng-select-focused"),this.focusEvent.emit(r),this.focused=!0)}onInputBlur(r){this.element.classList.remove("ng-select-focused"),this.blurEvent.emit(r),!this.isOpen&&!this.disabled&&this._onTouched(),this._editableSearchTerm&&this._setSearchTermFromItems(),this.focused=!1}onItemHover(r){r.disabled||this.itemsList.markItem(r)}detectChanges(){this._cd.destroyed||this._cd.detectChanges()}_setSearchTermFromItems(){let r=this.selectedItems?.[0];this.searchTerm=r?.label??null}_setItems(r){let i=r[0];this.bindLabel=this.bindLabel||this._defaultLabel,this._primitive=Dt(i)?!sc(i):this._primitive||this.bindLabel===this._defaultLabel,this.itemsList.setItems(r),r.length>0&&this.hasValue&&this.itemsList.mapSelectedItems(),this.isOpen&&Dt(this.searchTerm)&&!this._isTypeahead&&this.itemsList.filter(this.searchTerm),(this._isTypeahead||this.isOpen)&&this.itemsList.markSelectedOrDefault(this.markFirst)}_setItemsFromNgOptions(){let r=o=>{this.items=o.map(s=>({$ngOptionValue:s.value,$ngOptionLabel:s.elementRef.nativeElement.innerHTML,disabled:s.disabled})),this.itemsList.setItems(this.items),this.hasValue&&this.itemsList.mapSelectedItems(),this.detectChanges()},i=()=>{let o=al(this.ngOptions.changes,this._destroy$);al(...this.ngOptions.map(s=>s.stateChange$)).pipe(Yi(o)).subscribe(s=>{let a=this.itemsList.findItem(s.value);a.disabled=s.disabled,a.label=s.label||a.label,this._cd.detectChanges()})};this.ngOptions.changes.pipe(W0(this.ngOptions),Yi(this._destroy$)).subscribe(o=>{this.bindLabel=this._defaultLabel,r(o),i()})}_isValidWriteValue(r){if(!Dt(r)||this.multiple&&r===""||Array.isArray(r)&&r.length===0)return!1;let i=o=>!Dt(this.compareWith)&&sc(o)&&this.bindValue?(this._console.warn(`Setting object(${JSON.stringify(o)}) as your model with bindValue is not allowed unless [compareWith] is used.`),!1):!0;return this.multiple?Array.isArray(r)?r.every(o=>i(o)):(this._console.warn("Multiple select ngModel should be array."),!1):i(r)}_handleWriteValue(r){if(!this._isValidWriteValue(r))return;let i=o=>{let s=this.itemsList.findItem(o);if(s)this.itemsList.select(s);else{let a=sc(o),l=!a&&!this.bindValue;a||l?this.itemsList.select(this.itemsList.mapItem(o,null)):this.bindValue&&(s={[this.bindLabel]:null,[this.bindValue]:o},this.itemsList.select(this.itemsList.mapItem(s,null)))}};this.multiple?r.forEach(o=>i(o)):i(r)}_handleKeyPresses(){this.searchable||this._keyPress$.pipe(Yi(this._destroy$),z0(r=>this._pressedKeys.push(r)),$0(200),H0(()=>this._pressedKeys.length>0),Nr(()=>this._pressedKeys.join(""))).subscribe(r=>{let i=this.itemsList.findByLabel(r);i&&(this.isOpen?(this.itemsList.markItem(i),this._scrollToMarked(),this._cd.markForCheck()):this.select(i)),this._pressedKeys=[]})}_setInputAttributes(){let r=this.searchInput.nativeElement,i=Me({type:"text",autocorrect:"off",autocapitalize:"off",autocomplete:"off","aria-controls":this.dropdownId},this.inputAttrs);for(let o of Object.keys(i))r.setAttribute(o,i[o])}_setTabFocusOnClear(){this.tabFocusOnClear.set(Dt(this.tabFocusOnClearButton())?!!this.tabFocusOnClearButton():this.config.tabFocusOnClear)}_updateNgModel(){let r=[];for(let o of this.selectedItems)if(this.bindValue){let s=null;if(o.children){let a=this.groupValue?this.bindValue:this.groupBy;s=o.value[a||this.groupBy]}else s=this.itemsList.resolveNested(o.value,this.bindValue);r.push(s)}else r.push(o.value);let i=this.selectedItems.map(o=>o.value);this.multiple?(this._onChange(r),this.changeEvent.emit(i)):(this._onChange(Dt(r[0])?r[0]:null),this.changeEvent.emit(i[0])),this._cd.markForCheck()}_clearSearch(){this.searchTerm&&(this._changeSearch(null),this.itemsList.resetFilteredItems())}_changeSearch(r){this.searchTerm=r,this._isTypeahead&&this.typeahead.next(r)}_scrollToMarked(){!this.isOpen||!this.dropdownPanel||this.dropdownPanel.scrollTo(this.itemsList.markedItem)}_scrollToTag(){!this.isOpen||!this.dropdownPanel||this.dropdownPanel.scrollToTag()}_onSelectionChanged(){this.isOpen&&this.deselectOnClick&&this.appendTo&&(this._cd.detectChanges(),this.dropdownPanel.adjustPosition())}_handleTab(r){if(this.isOpen===!1){if(this.showClear()&&!r.shiftKey&&this.tabFocusOnClear())this.focusOnClear(),r.preventDefault();else if(!this.addTag)return}this.selectOnTab?this.itemsList.markedItem?(this.toggleItem(this.itemsList.markedItem),r.preventDefault()):this.showAddTag?(this.selectTag(),r.preventDefault()):this.close():this.close()}_handleEnter(r){if(this.isOpen||this._manualOpen)this.itemsList.markedItem?this.toggleItem(this.itemsList.markedItem):this.showAddTag&&this.selectTag();else if(this.openOnEnter)this.open();else return;r.preventDefault()}_handleSpace(r){this.isOpen||this._manualOpen||(this.open(),r.preventDefault())}_handleArrowDown(r){this._nextItemIsTag(1)?(this.itemsList.unmarkItem(),this._scrollToTag()):(this.itemsList.markNextItem(),this._scrollToMarked()),this.open(),r.preventDefault()}_handleArrowUp(r){this.isOpen&&(this._nextItemIsTag(-1)?(this.itemsList.unmarkItem(),this._scrollToTag()):(this.itemsList.markPreviousItem(),this._scrollToMarked()),r.preventDefault())}_nextItemIsTag(r){let i=this.itemsList.markedIndex+r;return this.addTag&&this.searchTerm&&this.itemsList.markedItem&&(i<0||i===this.itemsList.filteredItems.length)}_handleBackspace(){this.searchTerm||!this.clearable||!this.clearOnBackspace||!this.hasValue||(this.multiple?this.unselect(this.itemsList.lastSelectedItem):this.clearModel())}_mergeGlobalConfig(r){this.placeholder=this.placeholder||r.placeholder,this.fixedPlaceholder=this.fixedPlaceholder||r.fixedPlaceholder,this.notFoundText=this.notFoundText||r.notFoundText,this.typeToSearchText=this.typeToSearchText||r.typeToSearchText,this.addTagText=this.addTagText||r.addTagText,this.loadingText=this.loadingText||r.loadingText,this.clearAllText=this.clearAllText||r.clearAllText,this.virtualScroll=this.getVirtualScroll(r),this.openOnEnter=Dt(this.openOnEnter)?this.openOnEnter:r.openOnEnter,this.appendTo=this.appendTo||r.appendTo,this.bindValue=this.bindValue||r.bindValue,this.bindLabel=this.bindLabel||r.bindLabel,this.appearance=this.appearance||r.appearance,this._setTabFocusOnClear()}getVirtualScroll(r){return Dt(this.virtualScroll)?this.virtualScroll:this.isVirtualScrollDisabled(r)}isVirtualScrollDisabled(r){return Dt(r.disableVirtualScroll)?!r.disableVirtualScroll:!1}};e.\u0275fac=function(i){return new(i||e)(Bl("class"),Bl("autofocus"),ae(lP),ae(uP,8),ae(It),ae(ud),ae(cP))},e.\u0275cmp=nt({type:e,selectors:[["ng-select"]],contentQueries:function(i,o,s){if(i&1&&(In(s,WR,5,Qe),In(s,zR,5,Qe),In(s,qR,5,Qe),In(s,KR,5,Qe),In(s,YR,5,Qe),In(s,XR,5,Qe),In(s,ZR,5,Qe),In(s,QR,5,Qe),In(s,JR,5,Qe),In(s,eP,5,Qe),In(s,tP,5,Qe),In(s,nP,5,Qe),In(s,rP,5,Qe),In(s,sP,5)),i&2){let a;Ot(a=Rt())&&(o.optionTemplate=a.first),Ot(a=Rt())&&(o.optgroupTemplate=a.first),Ot(a=Rt())&&(o.labelTemplate=a.first),Ot(a=Rt())&&(o.multiLabelTemplate=a.first),Ot(a=Rt())&&(o.headerTemplate=a.first),Ot(a=Rt())&&(o.footerTemplate=a.first),Ot(a=Rt())&&(o.notFoundTemplate=a.first),Ot(a=Rt())&&(o.placeholderTemplate=a.first),Ot(a=Rt())&&(o.typeToSearchTemplate=a.first),Ot(a=Rt())&&(o.loadingTextTemplate=a.first),Ot(a=Rt())&&(o.tagTemplate=a.first),Ot(a=Rt())&&(o.loadingSpinnerTemplate=a.first),Ot(a=Rt())&&(o.clearButtonTemplate=a.first),Ot(a=Rt())&&(o.ngOptions=a)}},viewQuery:function(i,o){if(i&1&&(co(_w,5),co(rR,7),co(iR,5)),i&2){let s;Ot(s=Rt())&&(o.dropdownPanel=s.first),Ot(s=Rt())&&(o.searchInput=s.first),Ot(s=Rt())&&(o.clearButton=s.first)}},hostVars:20,hostBindings:function(i,o){i&1&&Ce("keydown",function(a){return o.handleKeyDown(a)}),i&2&&Ie("ng-select-typeahead",o.typeahead)("ng-select-multiple",o.multiple)("ng-select-taggable",o.addTag)("ng-select-searchable",o.searchable)("ng-select-clearable",o.clearable)("ng-select-opened",o.isOpen)("ng-select",o.useDefaultClass)("ng-select-filtered",o.filtered)("ng-select-single",o.single)("ng-select-disabled",o.disabled)},inputs:{ariaLabelDropdown:"ariaLabelDropdown",bindLabel:"bindLabel",bindValue:"bindValue",ariaLabel:"ariaLabel",markFirst:[2,"markFirst","markFirst",Ht],placeholder:"placeholder",fixedPlaceholder:"fixedPlaceholder",notFoundText:"notFoundText",typeToSearchText:"typeToSearchText",preventToggleOnRightClick:"preventToggleOnRightClick",addTagText:"addTagText",loadingText:"loadingText",clearAllText:"clearAllText",appearance:"appearance",dropdownPosition:"dropdownPosition",appendTo:"appendTo",loading:[2,"loading","loading",Ht],closeOnSelect:[2,"closeOnSelect","closeOnSelect",Ht],hideSelected:[2,"hideSelected","hideSelected",Ht],selectOnTab:[2,"selectOnTab","selectOnTab",Ht],openOnEnter:[2,"openOnEnter","openOnEnter",Ht],maxSelectedItems:[2,"maxSelectedItems","maxSelectedItems",zl],groupBy:"groupBy",groupValue:"groupValue",bufferAmount:[2,"bufferAmount","bufferAmount",zl],virtualScroll:[2,"virtualScroll","virtualScroll",Ht],selectableGroup:[2,"selectableGroup","selectableGroup",Ht],selectableGroupAsModel:[2,"selectableGroupAsModel","selectableGroupAsModel",Ht],searchFn:"searchFn",trackByFn:"trackByFn",clearOnBackspace:[2,"clearOnBackspace","clearOnBackspace",Ht],labelForId:"labelForId",inputAttrs:"inputAttrs",tabIndex:[2,"tabIndex","tabIndex",zl],tabFocusOnClearButton:[1,"tabFocusOnClearButton"],readonly:[2,"readonly","readonly",Ht],searchWhileComposing:[2,"searchWhileComposing","searchWhileComposing",Ht],minTermLength:[2,"minTermLength","minTermLength",zl],editableSearchTerm:[2,"editableSearchTerm","editableSearchTerm",Ht],ngClass:"ngClass",typeahead:"typeahead",multiple:[2,"multiple","multiple",Ht],addTag:"addTag",searchable:[2,"searchable","searchable",Ht],clearable:[2,"clearable","clearable",Ht],isOpen:"isOpen",items:"items",compareWith:"compareWith",clearSearchOnAdd:"clearSearchOnAdd",deselectOnClick:"deselectOnClick",keyDownFn:"keyDownFn"},outputs:{blurEvent:"blur",focusEvent:"focus",changeEvent:"change",openEvent:"open",closeEvent:"close",searchEvent:"search",clearEvent:"clear",addEvent:"add",removeEvent:"remove",scroll:"scroll",scrollToEnd:"scrollToEnd"},features:[sr([{provide:ho,useExisting:Tn(()=>e),multi:!0},Tw]),Vr],decls:15,vars:20,consts:[["searchInput",""],["defaultPlaceholderTemplate",""],["defaultLabelTemplate",""],["defaultLoadingSpinnerTemplate",""],["clearButton",""],["defaultOptionTemplate",""],["defaultTagTemplate",""],["defaultNotFoundTemplate",""],["defaultTypeToSearchTemplate",""],["defaultLoadingTextTemplate",""],[1,"ng-select-container",3,"mousedown"],[1,"ng-value-container"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"ng-input"],["aria-autocomplete","list","role","combobox",3,"blur","change","compositionend","compositionstart","focus","input","disabled","readOnly","value"],[1,"ng-arrow-wrapper"],[1,"ng-arrow"],[1,"ng-dropdown-panel",3,"virtualScroll","bufferAmount","appendTo","position","headerTemplate","footerTemplate","filterValue","items","markedItem","ng-select-multiple","ngClass","id","ariaLabelDropdown"],["aria-atomic","true","aria-live","polite","role","status",1,"ng-visually-hidden"],[3,"ngTemplateOutlet"],[1,"ng-placeholder"],[1,"ng-value",3,"ng-value-disabled"],[1,"ng-value"],["aria-hidden","true",1,"ng-value-icon","left",3,"click"],[1,"ng-value-label",3,"ngItemLabel","escape"],[1,"ng-spinner-loader"],["role","button","tabindex","0",1,"ng-clear-wrapper",3,"title"],["aria-hidden","true",1,"ng-clear"],[1,"ng-dropdown-panel",3,"update","scroll","scrollToEnd","outsideClick","virtualScroll","bufferAmount","appendTo","position","headerTemplate","footerTemplate","filterValue","items","markedItem","ngClass","id","ariaLabelDropdown"],[1,"ng-option",3,"ng-option-disabled","ng-option-selected","ng-optgroup","ng-option","ng-option-child","ng-option-marked"],["role","option",1,"ng-option",3,"ng-option-marked"],[1,"ng-option",3,"click","mouseover"],[1,"ng-option-label",3,"ngItemLabel","escape"],["role","option",1,"ng-option",3,"mouseover","click"],[1,"ng-tag-label"],[1,"ng-option","ng-option-disabled"]],template:function(i,o){if(i&1){let s=_t();E(0,"div",10),Ce("mousedown",function(l){return qe(s),Ke(o.handleMousedown(l))}),E(1,"div",11),Sn(2,uR,3,1),Sn(3,pR,2,0),Sn(4,gR,1,5,null,12),E(5,"div",13)(6,"input",14,0),Ce("blur",function(l){return qe(s),Ke(o.onInputBlur(l))})("change",function(l){return qe(s),Ke(l.stopPropagation())})("compositionend",function(){qe(s);let l=Er(7);return Ke(o.onCompositionEnd(l.value))})("compositionstart",function(){return qe(s),Ke(o.onCompositionStart())})("focus",function(l){return qe(s),Ke(o.onInputFocus(l))})("input",function(){qe(s);let l=Er(7);return Ke(o.filter(l.value))}),_()()(),Sn(8,yR,3,1),Sn(9,TR,2,1),E(10,"span",15),J(11,"span",16),_()(),Sn(12,BR,8,18,"ng-dropdown-panel",17),E(13,"div",18),Sn(14,VR,1,1),_()}i&2&&(Ie("ng-appearance-outline",o.appearance==="outline")("ng-has-value",o.hasValue),A(2),bn(o.selectedItems.length===0&&!o.searchTerm||o.fixedPlaceholder?2:-1),A(),bn((!o.multiLabelTemplate||!o.multiple)&&o.selectedItems.length>0?3:-1),A(),bn(o.multiple&&o.multiLabelTemplate&&o.selectedValues.length>0?4:-1),A(2),H("disabled",o.disabled)("readOnly",!o.searchable||o.itemsList.maxItemsSelected)("value",o.searchTerm??""),or("aria-activedescendant",o.isOpen?o.itemsList==null||o.itemsList.markedItem==null?null:o.itemsList.markedItem.htmlId:null)("aria-controls",o.isOpen?o.dropdownId:null)("aria-expanded",o.isOpen)("aria-label",o.ariaLabel)("id",o.labelForId)("tabindex",o.tabIndex),A(2),bn(o.loading?8:-1),A(),bn(o.showClear()?9:-1),A(3),bn(o.isOpen?12:-1),A(2),bn(o.isOpen&&o.showNoItemsFound()?14:-1))},dependencies:[pd,$R,_w,os],styles:[`@charset "UTF-8";.ng-select{position:relative;display:block;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.ng-select div,.ng-select input,.ng-select span{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.ng-select [hidden]{display:none}.ng-select.ng-select-searchable .ng-select-container .ng-value-container .ng-input{opacity:1}.ng-select.ng-select-opened .ng-select-container{z-index:1001}.ng-select.ng-select-disabled .ng-select-container .ng-value-container .ng-placeholder,.ng-select.ng-select-disabled .ng-select-container .ng-value-container .ng-value{-webkit-user-select:none;user-select:none;cursor:default}.ng-select.ng-select-disabled .ng-arrow-wrapper{cursor:default}.ng-select.ng-select-filtered .ng-placeholder{display:none}.ng-select .ng-select-container{cursor:default;display:flex;outline:none;overflow:hidden;position:relative;width:100%}.ng-select .ng-select-container .ng-value-container{display:flex;flex:1}.ng-select .ng-select-container .ng-value-container .ng-input{opacity:0}.ng-select .ng-select-container .ng-value-container .ng-input>input{box-sizing:content-box;background:none transparent;border:0 none;box-shadow:none;outline:none;padding:0;cursor:default;width:100%}.ng-select .ng-select-container .ng-value-container .ng-input>input::-ms-clear{display:none}.ng-select .ng-select-container .ng-value-container .ng-input>input[readonly]{-webkit-user-select:unset;user-select:unset;width:0;padding:0}.ng-select.ng-select-single.ng-select-filtered .ng-select-container .ng-value-container .ng-value{visibility:hidden}.ng-select.ng-select-single .ng-select-container .ng-value-container,.ng-select.ng-select-single .ng-select-container .ng-value-container .ng-value{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ng-select.ng-select-single .ng-select-container .ng-value-container .ng-value .ng-value-icon{display:none}.ng-select.ng-select-single .ng-select-container .ng-value-container .ng-input{position:absolute;left:0;width:100%}.ng-select.ng-select-multiple.ng-select-disabled>.ng-select-container .ng-value-container .ng-value .ng-value-icon{display:none}.ng-select.ng-select-multiple .ng-select-container .ng-value-container{flex-wrap:wrap}.ng-select.ng-select-multiple .ng-select-container .ng-value-container .ng-placeholder{position:absolute}.ng-select.ng-select-multiple .ng-select-container .ng-value-container .ng-value{white-space:nowrap}.ng-select.ng-select-multiple .ng-select-container .ng-value-container .ng-value.ng-value-disabled .ng-value-icon{display:none}.ng-select.ng-select-multiple .ng-select-container .ng-value-container .ng-value .ng-value-icon{cursor:pointer}.ng-select.ng-select-multiple .ng-select-container .ng-value-container .ng-input{flex:1;z-index:2}.ng-select.ng-select-multiple .ng-select-container .ng-value-container .ng-placeholder{z-index:1}.ng-select .ng-clear-wrapper{cursor:pointer;position:relative;width:17px;-webkit-user-select:none;user-select:none}.ng-select .ng-clear-wrapper .ng-clear{display:inline-block;font-size:18px;line-height:1;pointer-events:none}.ng-select .ng-spinner-loader{border-radius:50%;width:17px;height:17px;margin-right:5px;font-size:10px;position:relative;text-indent:-9999em;border-top:2px solid rgba(66,66,66,.2);border-right:2px solid rgba(66,66,66,.2);border-bottom:2px solid rgba(66,66,66,.2);border-left:2px solid #424242;transform:translateZ(0);animation:load8 .8s infinite linear}.ng-select .ng-spinner-loader:after{border-radius:50%;width:17px;height:17px}@-webkit-keyframes load8{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes load8{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.ng-select .ng-arrow-wrapper{cursor:pointer;position:relative;text-align:center;-webkit-user-select:none;user-select:none}.ng-select .ng-arrow-wrapper .ng-arrow{pointer-events:none;display:inline-block;height:0;width:0;position:relative}.ng-dropdown-panel{box-sizing:border-box;position:absolute;opacity:0;width:100%;z-index:1050;-webkit-overflow-scrolling:touch}.ng-dropdown-panel .ng-dropdown-panel-items{display:block;height:auto;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;max-height:240px;overflow-y:auto}.ng-dropdown-panel .ng-dropdown-panel-items .ng-optgroup{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ng-dropdown-panel .ng-dropdown-panel-items .ng-option{box-sizing:border-box;cursor:pointer;display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ng-dropdown-panel .ng-dropdown-panel-items .ng-option .ng-option-label:empty:before{content:"\\200b"}.ng-dropdown-panel .ng-dropdown-panel-items .ng-option .highlighted{font-weight:700;text-decoration:underline}.ng-dropdown-panel .ng-dropdown-panel-items .ng-option.disabled{cursor:default}.ng-dropdown-panel .scroll-host{overflow:hidden;overflow-y:auto;position:relative;display:block;-webkit-overflow-scrolling:touch}.ng-dropdown-panel .scrollable-content{top:0;left:0;width:100%;height:100%;position:absolute}.ng-dropdown-panel .total-padding{width:1px;opacity:0}.ng-visually-hidden{position:absolute!important;width:1px;height:1px;margin:-1px;padding:0;overflow:hidden;clip:rect(0 0 0 0);border:0;white-space:nowrap}
`],encapsulation:2,changeDetection:0});let n=e;return n})();var pa=class{generateDateTimeTDSC(e){let t=e?new Date(e):new Date,r=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),a=String(t.getMinutes()).padStart(2,"0"),l=String(t.getSeconds()).padStart(2,"0");return`${r}-${i}-${o} ${s}:${a}:${l}.0`}generateDate(e){let t=e?new Date(e):new Date,r=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0");return`${r}-${i}-${o}`}generateCompactDateTime(e){let t=e?new Date(e):new Date,r=(u,f=2)=>String(u).padStart(f,"0"),i=t.getFullYear(),o=r(t.getMonth()+1),s=r(t.getDate()),a=r(t.getHours()),l=r(t.getMinutes()),c=r(t.getSeconds());return`${i}${o}${s}${a}${l}${c}`}generateDateTime(e){let t=e?new Date(e):new Date,r=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),a=String(t.getMinutes()).padStart(2,"0"),l=String(t.getSeconds()).padStart(2,"0");return`${r}-${i}-${o} ${s}:${a}:${l}`}};var sv=class{_document;_textarea;constructor(e,t){this._document=t;let r=this._textarea=this._document.createElement("textarea"),i=r.style;i.position="fixed",i.top=i.opacity="0",i.left="-999em",r.setAttribute("aria-hidden","true"),r.value=e,r.readOnly=!0,(this._document.fullscreenElement||this._document.body).appendChild(r)}copy(){let e=this._textarea,t=!1;try{if(e){let r=this._document.activeElement;e.select(),e.setSelectionRange(0,e.value.length),t=this._document.execCommand("copy"),r&&r.focus()}}catch{}return t}destroy(){let e=this._textarea;e&&(e.remove(),this._textarea=void 0)}},Rd=(()=>{class n{_document=Pe(Mt);constructor(){}copy(t){let r=this.beginCopy(t),i=r.copy();return r.destroy(),i}beginCopy(t){return new sv(t,this._document)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Pd=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=ir({type:n});static \u0275inj=Gn({})}return n})();function fP(n,e){if(n&1&&(E(0,"span",3),C(1),_()),n&2){let t=re();A(),Je(t.isCopied?"Copied!":"Copy")}}var ln=class n{constructor(e){this.clipboard=e}textToCopy="";showIconOnly=!1;isCopied=!1;copy(e){e.target&&(this.clipboard.copy(this.textToCopy),this.isCopied=!0,setTimeout(()=>{this.isCopied=!1},2e3))}static \u0275fac=function(t){return new(t||n)(ae(Rd))};static \u0275cmp=nt({type:n,selectors:[["app-copy-button"]],inputs:{textToCopy:"textToCopy",showIconOnly:"showIconOnly"},decls:3,vars:5,consts:[["type","button",1,"copy-btn",3,"click","disabled"],[3,"ngClass"],["class","ms-1",4,"ngIf"],[1,"ms-1"]],template:function(t,r){t&1&&(E(0,"button",0),Ce("click",function(o){return r.copy(o)}),J(1,"i",1),be(2,fP,2,1,"span",2),_()),t&2&&(Ie("icon-only",r.showIconOnly),H("disabled",r.isCopied),A(),H("ngClass",r.isCopied?"fa-solid fa-check":"fa-regular fa-copy"),A(),H("ngIf",!r.showIconOnly))},dependencies:[mt,os,Pt,Pd],encapsulation:2})};var mo=class n{constructor(e){this.clipboard=e}codeText="";copied=!1;copyToClipboard(){let e=typeof this.codeText=="string"?this.codeText:JSON.stringify(this.codeText,null,2);this.clipboard.copy(e)&&(this.copied=!0,setTimeout(()=>this.copied=!1,2e3))}formatCodeText(e){return typeof e=="string"?e:JSON.stringify(e,null,2)}static \u0275fac=function(t){return new(t||n)(ae(Rd))};static \u0275cmp=nt({type:n,selectors:[["app-code-box"]],inputs:{codeText:"codeText"},decls:6,vars:4,consts:[[1,"code-container"],["type","button",1,"copy-btn",3,"click","disabled"],[1,"me-1",3,"ngClass"],[1,"code-content"]],template:function(t,r){t&1&&(E(0,"div",0)(1,"button",1),Ce("click",function(){return r.copyToClipboard()}),J(2,"i",2),C(3),_(),E(4,"div",3),C(5),_()()),t&2&&(A(),H("disabled",r.copied),A(),H("ngClass",r.copied?"fa-solid fa-check":"fa-regular fa-copy"),A(),rt(" ",r.copied?"Copied!":"Copy"," "),A(2),rt(" ",r.formatCodeText(r.codeText)," "))},dependencies:[mt,os,Pd],encapsulation:2})};var $e=function(n){return n[n.State=0]="State",n[n.Transition=1]="Transition",n[n.Sequence=2]="Sequence",n[n.Group=3]="Group",n[n.Animate=4]="Animate",n[n.Keyframes=5]="Keyframes",n[n.Style=6]="Style",n[n.Trigger=7]="Trigger",n[n.Reference=8]="Reference",n[n.AnimateChild=9]="AnimateChild",n[n.AnimateRef=10]="AnimateRef",n[n.Query=11]="Query",n[n.Stagger=12]="Stagger",n}($e||{}),wr="*";function av(n,e){return{type:$e.Trigger,name:n,definitions:e,options:{}}}function Ld(n,e=null){return{type:$e.Animate,styles:e,timings:n}}function Cw(n,e=null){return{type:$e.Sequence,steps:n,options:e}}function go(n){return{type:$e.Style,styles:n,offset:null}}function lc(n,e,t){return{type:$e.State,name:n,styles:e,options:t}}function Bd(n,e,t=null){return{type:$e.Transition,expr:n,animation:e,options:t}}var fi=class{_onDoneFns=[];_onStartFns=[];_onDestroyFns=[];_originalOnDoneFns=[];_originalOnStartFns=[];_started=!1;_destroyed=!1;_finished=!1;_position=0;parentPlayer=null;totalTime;constructor(e=0,t=0){this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){let t=e=="start"?this._onStartFns:this._onDoneFns;t.forEach(r=>r()),t.length=0}},ss=class{_onDoneFns=[];_onStartFns=[];_finished=!1;_started=!1;_destroyed=!1;_onDestroyFns=[];parentPlayer=null;totalTime=0;players;constructor(e){this.players=e;let t=0,r=0,i=0,o=this.players.length;o==0?queueMicrotask(()=>this._onFinish()):this.players.forEach(s=>{s.onDone(()=>{++t==o&&this._onFinish()}),s.onDestroy(()=>{++r==o&&this._onDestroy()}),s.onStart(()=>{++i==o&&this._onStart()})}),this.totalTime=this.players.reduce((s,a)=>Math.max(s,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){let t=e*this.totalTime;this.players.forEach(r=>{let i=r.totalTime?Math.min(1,t/r.totalTime):1;r.setPosition(i)})}getPosition(){let e=this.players.reduce((t,r)=>t===null||r.totalTime>t.totalTime?r:t,null);return e!=null?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){let t=e=="start"?this._onStartFns:this._onDoneFns;t.forEach(r=>r()),t.length=0}},ma="!";var Dw=["toast-component",""];function dP(n,e){if(n&1){let t=_t();E(0,"button",5),Ce("click",function(){qe(t);let i=re();return Ke(i.remove())}),E(1,"span",6),C(2,"\xD7"),_()()}}function hP(n,e){if(n&1&&(oi(0),C(1),si()),n&2){let t=re(2);A(),rt("[",t.duplicatesCount+1,"]")}}function pP(n,e){if(n&1&&(E(0,"div"),C(1),be(2,hP,2,1,"ng-container",4),_()),n&2){let t=re();ai(t.options.titleClass),or("aria-label",t.title),A(),rt(" ",t.title," "),A(),H("ngIf",t.duplicatesCount)}}function mP(n,e){if(n&1&&J(0,"div",7),n&2){let t=re();ai(t.options.messageClass),H("innerHTML",t.message,$f)}}function gP(n,e){if(n&1&&(E(0,"div",8),C(1),_()),n&2){let t=re();ai(t.options.messageClass),or("aria-label",t.message),A(),rt(" ",t.message," ")}}function vP(n,e){if(n&1&&(E(0,"div"),J(1,"div",9),_()),n&2){let t=re();A(),rs("width",t.width()+"%")}}function _P(n,e){if(n&1){let t=_t();E(0,"button",5),Ce("click",function(){qe(t);let i=re();return Ke(i.remove())}),E(1,"span",6),C(2,"\xD7"),_()()}}function yP(n,e){if(n&1&&(oi(0),C(1),si()),n&2){let t=re(2);A(),rt("[",t.duplicatesCount+1,"]")}}function xP(n,e){if(n&1&&(E(0,"div"),C(1),be(2,yP,2,1,"ng-container",4),_()),n&2){let t=re();ai(t.options.titleClass),or("aria-label",t.title),A(),rt(" ",t.title," "),A(),H("ngIf",t.duplicatesCount)}}function EP(n,e){if(n&1&&J(0,"div",7),n&2){let t=re();ai(t.options.messageClass),H("innerHTML",t.message,$f)}}function TP(n,e){if(n&1&&(E(0,"div",8),C(1),_()),n&2){let t=re();ai(t.options.messageClass),or("aria-label",t.message),A(),rt(" ",t.message," ")}}function wP(n,e){if(n&1&&(E(0,"div"),J(1,"div",9),_()),n&2){let t=re();A(),rs("width",t.width()+"%")}}var lv=class{_attachedHost;component;viewContainerRef;injector;constructor(e,t){this.component=e,this.injector=t}attach(e,t){return this._attachedHost=e,e.attach(this,t)}detach(){let e=this._attachedHost;if(e)return this._attachedHost=void 0,e.detach()}get isAttached(){return this._attachedHost!=null}setAttachedHost(e){this._attachedHost=e}},cv=class{_attachedPortal;_disposeFn;attach(e,t){return this._attachedPortal=e,this.attachComponentPortal(e,t)}detach(){this._attachedPortal&&this._attachedPortal.setAttachedHost(),this._attachedPortal=void 0,this._disposeFn&&(this._disposeFn(),this._disposeFn=void 0)}setDisposeFn(e){this._disposeFn=e}},uv=class{_overlayRef;componentInstance;duplicatesCount=0;_afterClosed=new St;_activate=new St;_manualClose=new St;_resetTimeout=new St;_countDuplicate=new St;constructor(e){this._overlayRef=e}manualClose(){this._manualClose.next(),this._manualClose.complete()}manualClosed(){return this._manualClose.asObservable()}timeoutReset(){return this._resetTimeout.asObservable()}countDuplicate(){return this._countDuplicate.asObservable()}close(){this._overlayRef.detach(),this._afterClosed.next(),this._manualClose.next(),this._afterClosed.complete(),this._manualClose.complete(),this._activate.complete(),this._resetTimeout.complete(),this._countDuplicate.complete()}afterClosed(){return this._afterClosed.asObservable()}isInactive(){return this._activate.isStopped}activate(){this._activate.next(),this._activate.complete()}afterActivate(){return this._activate.asObservable()}onDuplicate(e,t){e&&this._resetTimeout.next(),t&&this._countDuplicate.next(++this.duplicatesCount)}},ga=class{toastId;config;message;title;toastType;toastRef;_onTap=new St;_onAction=new St;constructor(e,t,r,i,o,s){this.toastId=e,this.config=t,this.message=r,this.title=i,this.toastType=o,this.toastRef=s,this.toastRef.afterClosed().subscribe(()=>{this._onAction.complete(),this._onTap.complete()})}triggerTap(){this._onTap.next(),this.config.tapToDismiss&&this._onTap.complete()}onTap(){return this._onTap.asObservable()}triggerAction(e){this._onAction.next(e)}onAction(){return this._onAction.asObservable()}},Sw={maxOpened:0,autoDismiss:!1,newestOnTop:!0,preventDuplicates:!1,countDuplicates:!1,resetTimeoutOnDuplicate:!1,includeTitleDuplicates:!1,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},closeButton:!1,disableTimeOut:!1,timeOut:5e3,extendedTimeOut:1e3,enableHtml:!1,progressBar:!1,toastClass:"ngx-toastr",positionClass:"toast-top-right",titleClass:"toast-title",messageClass:"toast-message",easing:"ease-in",easeTime:300,tapToDismiss:!0,onActivateTick:!1,progressAnimation:"decreasing"},bw=new Re("ToastConfig"),fv=class extends cv{_hostDomElement;_componentFactoryResolver;_appRef;constructor(e,t,r){super(),this._hostDomElement=e,this._componentFactoryResolver=t,this._appRef=r}attachComponentPortal(e,t){let r=this._componentFactoryResolver.resolveComponentFactory(e.component),i;return i=r.create(e.injector),this._appRef.attachView(i.hostView),this.setDisposeFn(()=>{this._appRef.detachView(i.hostView),i.destroy()}),t?this._hostDomElement.insertBefore(this._getComponentRootNode(i),this._hostDomElement.firstChild):this._hostDomElement.appendChild(this._getComponentRootNode(i)),i}_getComponentRootNode(e){return e.hostView.rootNodes[0]}},CP=(()=>{class n{_document=Pe(Mt);_containerElement;ngOnDestroy(){this._containerElement&&this._containerElement.parentNode&&this._containerElement.parentNode.removeChild(this._containerElement)}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){let t=this._document.createElement("div");t.classList.add("overlay-container"),t.setAttribute("aria-live","polite"),this._document.body.appendChild(t),this._containerElement=t}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),dv=class{_portalHost;constructor(e){this._portalHost=e}attach(e,t=!0){return this._portalHost.attach(e,t)}detach(){return this._portalHost.detach()}},DP=(()=>{class n{_overlayContainer=Pe(CP);_componentFactoryResolver=Pe(ia);_appRef=Pe(ii);_document=Pe(Mt);_paneElements=new Map;create(t,r){return this._createOverlayRef(this.getPaneElement(t,r))}getPaneElement(t="",r){return this._paneElements.get(r)||this._paneElements.set(r,{}),this._paneElements.get(r)[t]||(this._paneElements.get(r)[t]=this._createPaneElement(t,r)),this._paneElements.get(r)[t]}_createPaneElement(t,r){let i=this._document.createElement("div");return i.id="toast-container",i.classList.add(t),i.classList.add("toast-container"),r?r.getContainerElement().appendChild(i):this._overlayContainer.getContainerElement().appendChild(i),i}_createPortalHost(t){return new fv(t,this._componentFactoryResolver,this._appRef)}_createOverlayRef(t){return new dv(this._createPortalHost(t))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Cr=(()=>{class n{overlay;_injector;sanitizer;ngZone;toastrConfig;currentlyActive=0;toasts=[];overlayContainer;previousToastMessage;index=0;constructor(t,r,i,o,s){this.overlay=r,this._injector=i,this.sanitizer=o,this.ngZone=s,this.toastrConfig=Me(Me({},t.default),t.config),t.config.iconClasses&&(this.toastrConfig.iconClasses=Me(Me({},t.default.iconClasses),t.config.iconClasses))}show(t,r,i={},o=""){return this._preBuildNotification(o,t,r,this.applyConfig(i))}success(t,r,i={}){let o=this.toastrConfig.iconClasses.success||"";return this._preBuildNotification(o,t,r,this.applyConfig(i))}error(t,r,i={}){let o=this.toastrConfig.iconClasses.error||"";return this._preBuildNotification(o,t,r,this.applyConfig(i))}info(t,r,i={}){let o=this.toastrConfig.iconClasses.info||"";return this._preBuildNotification(o,t,r,this.applyConfig(i))}warning(t,r,i={}){let o=this.toastrConfig.iconClasses.warning||"";return this._preBuildNotification(o,t,r,this.applyConfig(i))}clear(t){for(let r of this.toasts)if(t!==void 0){if(r.toastId===t){r.toastRef.manualClose();return}}else r.toastRef.manualClose()}remove(t){let r=this._findToast(t);if(!r||(r.activeToast.toastRef.close(),this.toasts.splice(r.index,1),this.currentlyActive=this.currentlyActive-1,!this.toastrConfig.maxOpened||!this.toasts.length))return!1;if(this.currentlyActive<this.toastrConfig.maxOpened&&this.toasts[this.currentlyActive]){let i=this.toasts[this.currentlyActive].toastRef;i.isInactive()||(this.currentlyActive=this.currentlyActive+1,i.activate())}return!0}findDuplicate(t="",r="",i,o){let{includeTitleDuplicates:s}=this.toastrConfig;for(let a of this.toasts){let l=s&&a.title===t;if((!s||l)&&a.message===r)return a.toastRef.onDuplicate(i,o),a}return null}applyConfig(t={}){return Me(Me({},this.toastrConfig),t)}_findToast(t){for(let r=0;r<this.toasts.length;r++)if(this.toasts[r].toastId===t)return{index:r,activeToast:this.toasts[r]};return null}_preBuildNotification(t,r,i,o){return o.onActivateTick?this.ngZone.run(()=>this._buildNotification(t,r,i,o)):this._buildNotification(t,r,i,o)}_buildNotification(t,r,i,o){if(!o.toastComponent)throw new Error("toastComponent required");let s=this.findDuplicate(i,r,this.toastrConfig.resetTimeoutOnDuplicate&&o.timeOut>0,this.toastrConfig.countDuplicates);if((this.toastrConfig.includeTitleDuplicates&&i||r)&&this.toastrConfig.preventDuplicates&&s!==null)return s;this.previousToastMessage=r;let a=!1;this.toastrConfig.maxOpened&&this.currentlyActive>=this.toastrConfig.maxOpened&&(a=!0,this.toastrConfig.autoDismiss&&this.clear(this.toasts[0].toastId));let l=this.overlay.create(o.positionClass,this.overlayContainer);this.index=this.index+1;let c=r;r&&o.enableHtml&&(c=this.sanitizer.sanitize(xr.HTML,r));let u=new uv(l),f=new ga(this.index,o,c,i,t,u),h=[{provide:ga,useValue:f}],d=On.create({providers:h,parent:this._injector}),m=new lv(o.toastComponent,d),p=l.attach(m,o.newestOnTop);u.componentInstance=p.instance;let g={toastId:this.index,title:i||"",message:r||"",toastRef:u,onShown:u.afterActivate(),onHidden:u.afterClosed(),onTap:f.onTap(),onAction:f.onAction(),portal:p};return a||(this.currentlyActive=this.currentlyActive+1,setTimeout(()=>{g.toastRef.activate()})),this.toasts.push(g),g}static \u0275fac=function(r){return new(r||n)(We(bw),We(DP),We(On),We(Wg),We(xt))};static \u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),SP=(()=>{class n{toastrService;toastPackage;ngZone;message;title;options;duplicatesCount;originalTimeout;width=$n(-1);toastClasses="";state;get _state(){return this.state()}get displayStyle(){if(this.state().value==="inactive")return"none"}timeout;intervalId;hideTime;sub;sub1;sub2;sub3;constructor(t,r,i){this.toastrService=t,this.toastPackage=r,this.ngZone=i,this.message=r.message,this.title=r.title,this.options=r.config,this.originalTimeout=r.config.timeOut,this.toastClasses=`${r.toastType} ${r.config.toastClass}`,this.sub=r.toastRef.afterActivate().subscribe(()=>{this.activateToast()}),this.sub1=r.toastRef.manualClosed().subscribe(()=>{this.remove()}),this.sub2=r.toastRef.timeoutReset().subscribe(()=>{this.resetTimeout()}),this.sub3=r.toastRef.countDuplicate().subscribe(o=>{this.duplicatesCount=o}),this.state=$n({value:"inactive",params:{easeTime:this.toastPackage.config.easeTime,easing:"ease-in"}})}ngOnDestroy(){this.sub.unsubscribe(),this.sub1.unsubscribe(),this.sub2.unsubscribe(),this.sub3.unsubscribe(),clearInterval(this.intervalId),clearTimeout(this.timeout)}activateToast(){this.state.update(t=>tt(Me({},t),{value:"active"})),!(this.options.disableTimeOut===!0||this.options.disableTimeOut==="timeOut")&&this.options.timeOut&&(this.outsideTimeout(()=>this.remove(),this.options.timeOut),this.hideTime=new Date().getTime()+this.options.timeOut,this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10))}updateProgress(){if(this.width()===0||this.width()===100||!this.options.timeOut)return;let t=new Date().getTime(),r=this.hideTime-t;this.width.set(r/this.options.timeOut*100),this.options.progressAnimation==="increasing"&&this.width.update(i=>100-i),this.width()<=0&&this.width.set(0),this.width()>=100&&this.width.set(100)}resetTimeout(){clearTimeout(this.timeout),clearInterval(this.intervalId),this.state.update(t=>tt(Me({},t),{value:"active"})),this.outsideTimeout(()=>this.remove(),this.originalTimeout),this.options.timeOut=this.originalTimeout,this.hideTime=new Date().getTime()+(this.options.timeOut||0),this.width.set(-1),this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10)}remove(){this.state().value!=="removed"&&(clearTimeout(this.timeout),this.state.update(t=>tt(Me({},t),{value:"removed"})),this.outsideTimeout(()=>this.toastrService.remove(this.toastPackage.toastId),+this.toastPackage.config.easeTime))}tapToast(){this.state().value!=="removed"&&(this.toastPackage.triggerTap(),this.options.tapToDismiss&&this.remove())}stickAround(){this.state().value!=="removed"&&this.options.disableTimeOut!=="extendedTimeOut"&&(clearTimeout(this.timeout),this.options.timeOut=0,this.hideTime=0,clearInterval(this.intervalId),this.width.set(0))}delayedHideToast(){this.options.disableTimeOut===!0||this.options.disableTimeOut==="extendedTimeOut"||this.options.extendedTimeOut===0||this.state().value==="removed"||(this.outsideTimeout(()=>this.remove(),this.options.extendedTimeOut),this.options.timeOut=this.options.extendedTimeOut,this.hideTime=new Date().getTime()+(this.options.timeOut||0),this.width.set(-1),this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10))}outsideTimeout(t,r){this.ngZone?this.ngZone.runOutsideAngular(()=>this.timeout=setTimeout(()=>this.runInsideAngular(t),r)):this.timeout=setTimeout(()=>t(),r)}outsideInterval(t,r){this.ngZone?this.ngZone.runOutsideAngular(()=>this.intervalId=setInterval(()=>this.runInsideAngular(t),r)):this.intervalId=setInterval(()=>t(),r)}runInsideAngular(t){this.ngZone?this.ngZone.run(()=>t()):t()}static \u0275fac=function(r){return new(r||n)(ae(Cr),ae(ga),ae(xt))};static \u0275cmp=nt({type:n,selectors:[["","toast-component",""]],hostVars:5,hostBindings:function(r,i){r&1&&Ce("click",function(){return i.tapToast()})("mouseenter",function(){return i.stickAround()})("mouseleave",function(){return i.delayedHideToast()}),r&2&&(rd("@flyInOut",i._state),ai(i.toastClasses),rs("display",i.displayStyle))},attrs:Dw,decls:5,vars:5,consts:[["type","button","class","toast-close-button","aria-label","Close",3,"click",4,"ngIf"],[3,"class",4,"ngIf"],["role","alert",3,"class","innerHTML",4,"ngIf"],["role","alert",3,"class",4,"ngIf"],[4,"ngIf"],["type","button","aria-label","Close",1,"toast-close-button",3,"click"],["aria-hidden","true"],["role","alert",3,"innerHTML"],["role","alert"],[1,"toast-progress"]],template:function(r,i){r&1&&be(0,dP,3,0,"button",0)(1,pP,3,5,"div",1)(2,mP,1,3,"div",2)(3,gP,2,4,"div",3)(4,vP,2,2,"div",4),r&2&&(H("ngIf",i.options.closeButton),A(),H("ngIf",i.title),A(),H("ngIf",i.message&&i.options.enableHtml),A(),H("ngIf",i.message&&!i.options.enableHtml),A(),H("ngIf",i.options.progressBar))},dependencies:[Pt],encapsulation:2,data:{animation:[av("flyInOut",[lc("inactive",go({opacity:0})),lc("active",go({opacity:1})),lc("removed",go({opacity:0})),Bd("inactive => active",Ld("{{ easeTime }}ms {{ easing }}")),Bd("active => removed",Ld("{{ easeTime }}ms {{ easing }}"))])]},changeDetection:0})}return n})(),bP=tt(Me({},Sw),{toastComponent:SP}),Iw=(n={})=>hl([{provide:bw,useValue:{default:bP,config:n}}]);var IP=(()=>{class n{toastrService;toastPackage;appRef;message;title;options;duplicatesCount;originalTimeout;width=$n(-1);toastClasses="";get displayStyle(){return this.state()==="inactive"?"none":null}state=$n("inactive");timeout;intervalId;hideTime;sub;sub1;sub2;sub3;constructor(t,r,i){this.toastrService=t,this.toastPackage=r,this.appRef=i,this.message=r.message,this.title=r.title,this.options=r.config,this.originalTimeout=r.config.timeOut,this.toastClasses=`${r.toastType} ${r.config.toastClass}`,this.sub=r.toastRef.afterActivate().subscribe(()=>{this.activateToast()}),this.sub1=r.toastRef.manualClosed().subscribe(()=>{this.remove()}),this.sub2=r.toastRef.timeoutReset().subscribe(()=>{this.resetTimeout()}),this.sub3=r.toastRef.countDuplicate().subscribe(o=>{this.duplicatesCount=o})}ngOnDestroy(){this.sub.unsubscribe(),this.sub1.unsubscribe(),this.sub2.unsubscribe(),this.sub3.unsubscribe(),clearInterval(this.intervalId),clearTimeout(this.timeout)}activateToast(){this.state.set("active"),!(this.options.disableTimeOut===!0||this.options.disableTimeOut==="timeOut")&&this.options.timeOut&&(this.timeout=setTimeout(()=>{this.remove()},this.options.timeOut),this.hideTime=new Date().getTime()+this.options.timeOut,this.options.progressBar&&(this.intervalId=setInterval(()=>this.updateProgress(),10))),this.options.onActivateTick&&this.appRef.tick()}updateProgress(){if(this.width()===0||this.width()===100||!this.options.timeOut)return;let t=new Date().getTime(),r=this.hideTime-t;this.width.set(r/this.options.timeOut*100),this.options.progressAnimation==="increasing"&&this.width.update(i=>100-i),this.width()<=0&&this.width.set(0),this.width()>=100&&this.width.set(100)}resetTimeout(){clearTimeout(this.timeout),clearInterval(this.intervalId),this.state.set("active"),this.options.timeOut=this.originalTimeout,this.timeout=setTimeout(()=>this.remove(),this.originalTimeout),this.hideTime=new Date().getTime()+(this.originalTimeout||0),this.width.set(-1),this.options.progressBar&&(this.intervalId=setInterval(()=>this.updateProgress(),10))}remove(){this.state()!=="removed"&&(clearTimeout(this.timeout),this.state.set("removed"),this.timeout=setTimeout(()=>this.toastrService.remove(this.toastPackage.toastId)))}tapToast(){this.state()!=="removed"&&(this.toastPackage.triggerTap(),this.options.tapToDismiss&&this.remove())}stickAround(){this.state()!=="removed"&&(clearTimeout(this.timeout),this.options.timeOut=0,this.hideTime=0,clearInterval(this.intervalId),this.width.set(0))}delayedHideToast(){this.options.disableTimeOut===!0||this.options.disableTimeOut==="extendedTimeOut"||this.options.extendedTimeOut===0||this.state()==="removed"||(this.timeout=setTimeout(()=>this.remove(),this.options.extendedTimeOut),this.options.timeOut=this.options.extendedTimeOut,this.hideTime=new Date().getTime()+(this.options.timeOut||0),this.width.set(-1),this.options.progressBar&&(this.intervalId=setInterval(()=>this.updateProgress(),10)))}static \u0275fac=function(r){return new(r||n)(ae(Cr),ae(ga),ae(ii))};static \u0275cmp=nt({type:n,selectors:[["","toast-component",""]],hostVars:4,hostBindings:function(r,i){r&1&&Ce("click",function(){return i.tapToast()})("mouseenter",function(){return i.stickAround()})("mouseleave",function(){return i.delayedHideToast()}),r&2&&(ai(i.toastClasses),rs("display",i.displayStyle))},attrs:Dw,decls:5,vars:5,consts:[["type","button","class","toast-close-button","aria-label","Close",3,"click",4,"ngIf"],[3,"class",4,"ngIf"],["role","alert",3,"class","innerHTML",4,"ngIf"],["role","alert",3,"class",4,"ngIf"],[4,"ngIf"],["type","button","aria-label","Close",1,"toast-close-button",3,"click"],["aria-hidden","true"],["role","alert",3,"innerHTML"],["role","alert"],[1,"toast-progress"]],template:function(r,i){r&1&&be(0,_P,3,0,"button",0)(1,xP,3,5,"div",1)(2,EP,1,3,"div",2)(3,TP,2,4,"div",3)(4,wP,2,2,"div",4),r&2&&(H("ngIf",i.options.closeButton),A(),H("ngIf",i.title),A(),H("ngIf",i.message&&i.options.enableHtml),A(),H("ngIf",i.message&&!i.options.enableHtml),A(),H("ngIf",i.options.progressBar))},dependencies:[Pt],encapsulation:2,changeDetection:0})}return n})(),sre=tt(Me({},Sw),{toastComponent:IP});function AP(n,e){if(n&1&&(E(0,"span"),C(1),_()),n&2){let t=re();A(),rt("(",t.dispatchForm.value.orderFlow=="CROSS_DOCK"?"Cross Dock":"KeepStock",")")}}function FP(n,e){if(n&1){let t=_t();E(0,"button",35),Ce("click",function(){qe(t);let i=re().index,o=re();return Ke(o.removeDeliveryOrder(i))}),C(1,"\u2013"),_()}}function kP(n,e){if(n&1){let t=_t();E(0,"div",32)(1,"textarea",33),Ce("input",function(){let i=qe(t).index,o=re();return Ke(o.onChangedInputDelivery(i))}),_(),be(2,FP,2,0,"button",34),_()}if(n&2){let t,r=e.$implicit,i=e.index,o=re();H("formGroupName",i),A(),Ie("is-invalid",((t=r.get("value"))==null?null:t.invalid)&&((t=r.get("value"))==null?null:t.touched)),A(),H("ngIf",o.deliveryOrders.length>1)}}function NP(n,e){if(n&1){let t=_t();E(0,"div")(1,"button",36),Ce("click",function(){qe(t);let i=re();return Ke(i.addDeliveryOrder())}),C(2,"+ Add Delivery Order"),_()()}}function MP(n,e){n&1&&(E(0,"div",37)(1,"label"),C(2,"Price Date Source:"),_(),E(3,"label"),J(4,"input",38),C(5," Manual "),_(),E(6,"label"),J(7,"input",39),C(8," Query Database "),_()())}function OP(n,e){if(n&1&&(E(0,"div",40)(1,"p")(2,"b"),C(3,"Step3:"),_(),C(4," Copy the Mongo query below to retrieve the price date in collection "),E(5,"b"),C(6,"stock.external_prices"),_(),C(7," > "),E(8,"b"),C(9,"Copy Value as Plain Text"),_()(),J(10,"app-code-box",41),E(11,"p",40)(12,"b"),C(13,"Step4:"),_(),C(14," Paste your result of external prices here"),_(),J(15,"textarea",42),_()),n&2){let t,r=re();A(10),H("codeText",r.queryExternalPriceString),A(5),Ie("is-invalid",((t=r.dispatchForm.get("externalPrice"))==null?null:t.invalid)&&((t=r.dispatchForm.get("externalPrice"))==null?null:t.touched))}}function RP(n,e){if(n&1&&(E(0,"div")(1,"div",15)(2,"label",43),C(3,"ToteId:"),_(),J(4,"input",44),E(5,"small",45),C(6,"\u0E40\u0E0A\u0E48\u0E19 TB990001"),_()()()),n&2){let t,r=re();A(4),Ie("is-invalid",((t=r.dispatchForm.get("toteId"))==null?null:t.invalid)&&((t=r.dispatchForm.get("toteId"))==null?null:t.touched))}}function PP(n,e){if(n&1&&(E(0,"div",15)(1,"label",52),C(2,"Prefix Tote Code:"),_(),J(3,"input",53),E(4,"small",49),C(5,"\u0E40\u0E0A\u0E48\u0E19 TDS,TLS,TMS,TSS"),_()()),n&2){let t,r=re(2);A(3),Ie("is-invalid",((t=r.dispatchForm.get("specifyToteCode"))==null?null:t.invalid)&&((t=r.dispatchForm.get("specifyToteCode"))==null?null:t.touched))}}function LP(n,e){if(n&1&&(E(0,"div"),J(1,"h3"),be(2,PP,6,2,"div",46),E(3,"div",15)(4,"label",47),C(5,"Subfix Tote Code:"),_(),J(6,"input",48),E(7,"small",49),C(8,"\u0E40\u0E25\u0E02\u0E01\u0E48\u0E2D\u0E19 running number \u0E08\u0E30\u0E43\u0E2A\u0E48\u0E2B\u0E23\u0E37\u0E2D\u0E44\u0E21\u0E48\u0E43\u0E2A\u0E48\u0E01\u0E47\u0E44\u0E14\u0E49 \u0E40\u0E0A\u0E48\u0E19 9999 -> TB9999xxxx (xxxx \u0E04\u0E37\u0E2D running number)"),_()(),E(9,"div",15)(10,"label",50),C(11,"Start Running Number:"),_(),J(12,"input",51),E(13,"small",49),C(14,"\u0E40\u0E0A\u0E48\u0E19 1 \u0E08\u0E30\u0E44\u0E14\u0E49 0001 , 0002 ... n \u0E08\u0E30 generate tote Id \u0E15\u0E31\u0E49\u0E07\u0E41\u0E15\u0E48 1 - n (\u0E15\u0E32\u0E21\u0E08\u0E33\u0E19\u0E27\u0E19 items \u0E43\u0E19 do)"),_()()()),n&2){let t,r,i=re();A(2),H("ngIf",i.dispatchForm.value.mode==="SPECIFY_TOTE"),A(4),Ie("is-invalid",((t=i.dispatchForm.get("subfixToteCode"))==null?null:t.invalid)&&((t=i.dispatchForm.get("subfixToteCode"))==null?null:t.touched)),A(6),Ie("is-invalid",((r=i.dispatchForm.get("startRunningNumber"))==null?null:r.invalid)&&((r=i.dispatchForm.get("startRunningNumber"))==null?null:r.touched))}}function BP(n,e){if(n&1){let t=_t();E(0,"button",63),Ce("click",function(){qe(t);let i=re(2);return Ke(i.onPreviewToteDetail())}),C(1,"Re-Generate"),_()}}function VP(n,e){n&1&&(E(0,"th",59),C(1,"Price Date"),_())}function UP(n,e){if(n&1&&(E(0,"td",59),J(1,"input",71),_()),n&2){let t,r=re().$implicit;A(),Ie("is-invalid",((t=r.get("priceDate"))==null?null:t.invalid)&&((t=r.get("priceDate"))==null?null:t.touched))}}function jP(n,e){if(n&1){let t=_t();E(0,"div",80)(1,"button",81),Ce("click",function(){qe(t);let i=re().index,o=re().index,s=re(2);return Ke(s.removeDetail(o,i))}),C(2,"\u2013"),_()()}}function HP(n,e){if(n&1&&(E(0,"tr",72)(1,"td",69)(2,"div",73)(3,"div",74),J(4,"input",75),_(),E(5,"div",76),J(6,"input",77)(7,"app-copy-button",78),_(),be(8,jP,3,0,"div",79),_()()()),n&2){let t,r,i,o=e.$implicit,s=e.index,a=re().index,l=re(2);H("formGroupName",s),A(4),Ie("is-invalid",((t=o.get("pickQty"))==null?null:t.invalid)&&((t=o.get("pickQty"))==null?null:t.touched)),A(2),Ie("is-invalid",((r=o.get("toteId"))==null?null:r.invalid)&&((r=o.get("toteId"))==null?null:r.touched)),A(),H("textToCopy",(i=o.get("toteId"))==null?null:i.value)("showIconOnly",!0),A(),H("ngIf",l.getDetails(a).length>1)}}function GP(n,e){if(n&1){let t=_t();E(0,"tr",64)(1,"td"),C(2),_(),E(3,"td"),C(4),_(),E(5,"td",65),C(6),J(7,"app-copy-button",66),_(),E(8,"td",59)(9,"strong"),C(10),_(),C(11),_(),E(12,"td",59),C(13),_(),be(14,UP,2,2,"td",60),E(15,"td")(16,"table",67),be(17,HP,9,8,"tr",68),E(18,"tr")(19,"td",69)(20,"button",70),Ce("click",function(){let i=qe(t).index,o=re(2);return Ke(o.addDetail(i))}),C(21," + Split Tote "),_()()()()()()}if(n&2){let t,r,i,o,s,a,l,c=e.$implicit,u=e.index,f=re(2);H("formGroupName",u),A(2),Je((t=c.get("doNo"))==null?null:t.value),A(2),Je((r=c.get("productName"))==null?null:r.value),A(2),rt(" ",(i=c.get("barcode"))==null?null:i.value," "),A(),H("textToCopy",(o=c.get("barcode"))==null?null:o.value)("showIconOnly",!0),A(3),Je((s=c.get("assignedQty"))==null?null:s.value),A(),rt(" (",((a=c.get("assignedQty"))==null?null:a.value)*((a=c.get("unitFactor"))==null?null:a.value)," PC) "),A(2),Je((l=c.get("unit"))==null?null:l.value),A(),H("ngIf",f.dispatchForm.value.orderFlow=="CROSS_DOCK"),A(3),H("ngForOf",f.getDetails(u).controls)}}function $P(n,e){if(n&1&&(E(0,"div")(1,"div",54)(2,"h3",55),C(3,"Tote Details"),_(),be(4,BP,2,0,"button",56),_(),E(5,"form",57)(6,"table",58)(7,"thead")(8,"tr")(9,"th",59),C(10,"Delivery Order No."),_(),E(11,"th",59),C(12,"Product Name"),_(),E(13,"th",59),C(14,"Barcode"),_(),E(15,"th",59),C(16,"Assigned Qty"),_(),E(17,"th",59),C(18,"Unit"),_(),be(19,VP,2,0,"th",60),E(20,"th",59),C(21,"Pick Details"),_()()(),E(22,"tbody",61),be(23,GP,22,11,"tr",62),_()()()()),n&2){let t=re();A(4),H("ngIf",t.dispatchForm.value.mode==="RANDOM_TOTE"||t.dispatchForm.value.mode==="SPECIFY_TOTE"),A(),H("formGroup",t.toteForm),A(14),H("ngIf",t.dispatchForm.value.orderFlow=="CROSS_DOCK"),A(4),H("ngForOf",t.items.controls)}}function WP(n,e){if(n&1&&(E(0,"div")(1,"h3"),C(2,"Payload Confirm Tote Output:"),_(),J(3,"app-code-box",41),_()),n&2){let t=re();A(3),H("codeText",t.confirmToteData)}}function zP(n,e){if(n&1&&(E(0,"div",40)(1,"h3"),C(2,"Payload Confirm Shipment Output:"),_(),J(3,"app-code-box",41),_()),n&2){let t=re();A(3),H("codeText",t.confirmShipmentData)}}function qP(n,e){if(n&1&&(E(0,"tr")(1,"td"),C(2),_(),E(3,"td"),C(4),_()()),n&2){let t=e.$implicit;A(2),Je(t.code),A(2),Je(t.nameTh)}}var Vd=class n{constructor(e,t){this.fb=e;this.toastr=t}dispatchForm;toteForm;dateUtils=new pa;toteIdList=[];modal;confirmToteData;confirmShipmentData;barcodList=[];priceDateList=[];queryExternalPriceString="";modes=[{id:"CUSTOM_TOTE",name:"Custom Tote"},{id:"RANDOM_TOTE",name:"Random Tote"},{id:"SINGLE_TOTE",name:"Single Tote"},{id:"SPECIFY_TOTE",name:"Specify Tote"}];orderFlows=[{id:"KEEP_STOCK",name:"Keep Stock (Bug !!)"},{id:"CROSS_DOCK",name:"Cross Dock"}];prefixToteList=[{code:"BDG",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E02\u0E35\u0E22\u0E27",toteGroup:"10"},{code:"BDP",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E0A\u0E21\u0E1E\u0E39",toteGroup:"7"},{code:"BDR",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E41\u0E14\u0E07",toteGroup:"4"},{code:"BDS",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E07\u0E34\u0E19",toteGroup:"1"},{code:"BDB",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E19\u0E49\u0E33\u0E40\u0E07\u0E34\u0E19",toteGroup:"14"},{code:"BDT",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E19\u0E49\u0E33\u0E15\u0E32\u0E25",toteGroup:"15"},{code:"BDY",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E2B\u0E25\u0E37\u0E2D\u0E07",toteGroup:"16"},{code:"BLG",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E02\u0E35\u0E22\u0E27",toteGroup:"10"},{code:"BLP",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E0A\u0E21\u0E1E\u0E39",toteGroup:"7"},{code:"BLR",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E41\u0E14\u0E07",toteGroup:"4"},{code:"BLS",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E07\u0E34\u0E19",toteGroup:"1"},{code:"BLB",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E19\u0E49\u0E33\u0E40\u0E07\u0E34\u0E19",toteGroup:"14"},{code:"BLT",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E19\u0E49\u0E33\u0E15\u0E32\u0E25",toteGroup:"15"},{code:"BLY",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E2B\u0E25\u0E37\u0E2D\u0E07",toteGroup:"16"},{code:"BMG",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E02\u0E35\u0E22\u0E27",toteGroup:"10"},{code:"BMP",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E0A\u0E21\u0E1E\u0E39",toteGroup:"7"},{code:"BMR",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E41\u0E14\u0E07",toteGroup:"4"},{code:"BMS",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E07\u0E34\u0E19",toteGroup:"1"},{code:"BMB",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E19\u0E49\u0E33\u0E40\u0E07\u0E34\u0E19",toteGroup:"14"},{code:"BMT",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E19\u0E49\u0E33\u0E15\u0E32\u0E25",toteGroup:"15"},{code:"BMY",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E2B\u0E25\u0E37\u0E2D\u0E07",toteGroup:"16"},{code:"BSG",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E02\u0E35\u0E22\u0E27",toteGroup:"10"},{code:"BSP",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E0A\u0E21\u0E1E\u0E39",toteGroup:"7"},{code:"BSR",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E41\u0E14\u0E07",toteGroup:"4"},{code:"BSS",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E07\u0E34\u0E19",toteGroup:"1"},{code:"BSB",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E19\u0E49\u0E33\u0E40\u0E07\u0E34\u0E19",toteGroup:"14"},{code:"BST",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E19\u0E49\u0E33\u0E15\u0E32\u0E25",toteGroup:"15"},{code:"BSY",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E2B\u0E25\u0E37\u0E2D\u0E07",toteGroup:"16"},{code:"BTG",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E02\u0E35\u0E22\u0E27",toteGroup:"10"},{code:"BTP",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E0A\u0E21\u0E1E\u0E39",toteGroup:"7"},{code:"BTR",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E41\u0E14\u0E07",toteGroup:"4"},{code:"BTS",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E07\u0E34\u0E19",toteGroup:"1"},{code:"BTB",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E19\u0E49\u0E33\u0E40\u0E07\u0E34\u0E19",toteGroup:"14"},{code:"BTT",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E19\u0E49\u0E33\u0E15\u0E32\u0E25",toteGroup:"15"},{code:"BTY",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E2B\u0E25\u0E37\u0E2D\u0E07",toteGroup:"16"},{code:"BXG",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E02\u0E35\u0E22\u0E27",toteGroup:"10"},{code:"BXP",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E0A\u0E21\u0E1E\u0E39",toteGroup:"7"},{code:"BXR",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E41\u0E14\u0E07",toteGroup:"4"},{code:"BXS",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E07\u0E34\u0E19",toteGroup:"1"},{code:"BXB",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E19\u0E49\u0E33\u0E40\u0E07\u0E34\u0E19",toteGroup:"14"},{code:"BXT",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E19\u0E49\u0E33\u0E15\u0E32\u0E25",toteGroup:"15"},{code:"BXY",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E2B\u0E25\u0E37\u0E2D\u0E07",toteGroup:"16"},{code:"PL",nameTh:"\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01",toteGroup:"19"},{code:"TDG",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E02\u0E35\u0E22\u0E27",toteGroup:"9"},{code:"TDP",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E0A\u0E21\u0E1E\u0E39",toteGroup:"6"},{code:"TDR",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E41\u0E14\u0E07",toteGroup:"3"},{code:"TDS",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E07\u0E34\u0E19",toteGroup:"0"},{code:"TDB",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E19\u0E49\u0E33\u0E40\u0E07\u0E34\u0E19",toteGroup:"13"},{code:"TDT",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E19\u0E49\u0E33\u0E15\u0E32\u0E25",toteGroup:"12"},{code:"TDY",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E2B\u0E25\u0E37\u0E2D\u0E07",toteGroup:"11"},{code:"TLG",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E02\u0E35\u0E22\u0E27",toteGroup:"9"},{code:"TLP",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E0A\u0E21\u0E1E\u0E39",toteGroup:"6"},{code:"TLR",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E41\u0E14\u0E07",toteGroup:"3"},{code:"TLS",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E07\u0E34\u0E19",toteGroup:"0"},{code:"TLB",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E19\u0E49\u0E33\u0E40\u0E07\u0E34\u0E19",toteGroup:"13"},{code:"TLT",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E19\u0E49\u0E33\u0E15\u0E32\u0E25",toteGroup:"12"},{code:"TLY",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E2B\u0E25\u0E37\u0E2D\u0E07",toteGroup:"11"},{code:"TMG",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E02\u0E35\u0E22\u0E27",toteGroup:"9"},{code:"TMP",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E0A\u0E21\u0E1E\u0E39",toteGroup:"6"},{code:"TMR",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E41\u0E14\u0E07",toteGroup:"3"},{code:"TMS",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E07\u0E34\u0E19",toteGroup:"0"},{code:"TMB",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E19\u0E49\u0E33\u0E40\u0E07\u0E34\u0E19",toteGroup:"13"},{code:"TMT",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E19\u0E49\u0E33\u0E15\u0E32\u0E25",toteGroup:"12"},{code:"TMY",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E2B\u0E25\u0E37\u0E2D\u0E07",toteGroup:"11"},{code:"TSG",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E02\u0E35\u0E22\u0E27",toteGroup:"9"},{code:"TSP",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E0A\u0E21\u0E1E\u0E39",toteGroup:"6"},{code:"TSR",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E41\u0E14\u0E07",toteGroup:"3"},{code:"TSS",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E07\u0E34\u0E19",toteGroup:"0"},{code:"TSB",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E19\u0E49\u0E33\u0E40\u0E07\u0E34\u0E19",toteGroup:"13"},{code:"TST",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E19\u0E49\u0E33\u0E15\u0E32\u0E25",toteGroup:"12"},{code:"TSY",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E2B\u0E25\u0E37\u0E2D\u0E07",toteGroup:"11"},{code:"TSYE",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E2B\u0E25\u0E37\u0E2D\u0E07 (\u0E09\u0E25\u0E32\u0E01\u0E40\u0E22\u0E25\u0E42\u0E25\u0E48)",toteGroup:"11"},{code:"TTG",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E02\u0E35\u0E22\u0E27",toteGroup:"9"},{code:"TTP",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E0A\u0E21\u0E1E\u0E39",toteGroup:"6"},{code:"TTR",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E41\u0E14\u0E07",toteGroup:"3"},{code:"TTS",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E07\u0E34\u0E19",toteGroup:"0"},{code:"TTB",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E19\u0E49\u0E33\u0E40\u0E07\u0E34\u0E19",toteGroup:"13"},{code:"TTT",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E19\u0E49\u0E33\u0E15\u0E32\u0E25",toteGroup:"12"},{code:"TTY",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E2B\u0E25\u0E37\u0E2D\u0E07",toteGroup:"11"},{code:"TXG",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E02\u0E35\u0E22\u0E27",toteGroup:"9"},{code:"TXP",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E0A\u0E21\u0E1E\u0E39",toteGroup:"6"},{code:"TXR",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E41\u0E14\u0E07",toteGroup:"3"},{code:"TXS",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E07\u0E34\u0E19",toteGroup:"0"},{code:"TXB",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E19\u0E49\u0E33\u0E40\u0E07\u0E34\u0E19",toteGroup:"13"},{code:"TXT",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E19\u0E49\u0E33\u0E15\u0E32\u0E25",toteGroup:"12"},{code:"TXY",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E2B\u0E25\u0E37\u0E2D\u0E07",toteGroup:"11"},{code:"TX",nameTh:"\u0E25\u0E31\u0E07\u0E01\u0E23\u0E30\u0E14\u0E32\u0E29\u0E04\u0E32\u0E14\u0E2A\u0E35",toteGroup:"17"},{code:"TDO",nameTh:"\u0E04\u0E32\u0E14\u0E2A\u0E49\u0E21",toteGroup:"18"}];ngOnInit(){this.prefixToteList=this.prefixToteList.slice().sort((t,r)=>+t.toteGroup-+r.toteGroup);let e=new Date;this.dispatchForm=this.fb.group({deliveryOrders:this.fb.array([this.fb.group({value:["",Se.required]})]),mode:[null,Se.required],orderFlow:[null,Se.required],subfixToteCode:[""],startRunningNumber:[""],specifyToteCode:[""],toteId:[""],platNo:["Truck@Galaxy",Se.required],driverName:["Dominic Toretto",Se.required],externalPrice:[null],priceDateSource:["MANUAL"]}),this.toteForm=this.fb.group({items:this.fb.array([])}),this.dispatchForm.get("mode")?.valueChanges.subscribe(t=>{let r=this.dispatchForm.get("toteId"),i=this.dispatchForm.get("subfixToteCode"),o=this.dispatchForm.get("startRunningNumber"),s=this.dispatchForm.get("specifyToteCode");t==="SINGLE_TOTE"?(r?.setValidators([Se.required]),i?.clearValidators(),o?.clearValidators()):t==="RANDOM_TOTE"?(i?.setValidators([Se.required]),o?.setValidators([Se.required,Se.min(1)]),r?.clearValidators()):t==="SPECIFY_TOTE"?(s?.setValidators([Se.required]),i?.setValidators([Se.required]),o?.setValidators([Se.required,Se.min(1)]),r?.clearValidators()):(s?.clearValidators(),r?.clearValidators(),i?.clearValidators(),o?.clearValidators()),s?.updateValueAndValidity(),r?.updateValueAndValidity(),i?.updateValueAndValidity(),o?.updateValueAndValidity()}),this.dispatchForm.get("orderFlow")?.valueChanges.subscribe(t=>{this.setAndClearValidateExternalPrice(),this.onPreviewToteDetail()}),ol([this.dispatchForm.get("subfixToteCode").valueChanges,this.dispatchForm.get("startRunningNumber").valueChanges]).subscribe(([t,r])=>{t&&r&&this.onPreviewToteDetail()}),this.dispatchForm.get("toteId")?.valueChanges.subscribe(t=>{this.onPreviewToteDetail()}),this.dispatchForm.get("externalPrice")?.valueChanges.subscribe(t=>{this.onPreviewToteDetail()}),this.dispatchForm.get("priceDateSource")?.valueChanges.subscribe(t=>{this.setAndClearValidateExternalPrice(),this.generateExternalPriceQuery(),this.onPreviewToteDetail()})}ngAfterViewInit(){let e=document.getElementById("totePreviewModal");e&&(this.modal=new bootstrap.Modal(e))}get deliveryOrders(){return this.dispatchForm.get("deliveryOrders")}get items(){return this.toteForm.get("items")}openModal(){this.modal?.show()}addDeliveryOrder(){this.deliveryOrders.push(this.fb.group({value:["",Se.required]}))}setAndClearValidateExternalPrice(){let e=this.dispatchForm.get("externalPrice"),t=this.dispatchForm.get("orderFlow")?.value,r=this.dispatchForm.get("priceDateSource")?.value;t==="CROSS_DOCK"&&r==="QUERY"?e?.setValidators([Se.required]):(e?.clearValidators(),e?.updateValueAndValidity())}removeDeliveryOrder(e){this.deliveryOrders.removeAt(e),this.onPreviewToteDetail()}getInputDeliveryOrderList(){return this.dispatchForm.get("deliveryOrders").controls.map(e=>{let t=e.get("value")?.value??"";try{return JSON.parse(t)}catch{return console.error("Invalid JSON:",t),null}}).filter(e=>e!==null)}onChangedInputDelivery(e){this.generateExternalPriceQuery(),this.onPreviewToteDetail()}onChangedOrderFlow(){this.deliveryOrders.clear(),this.deliveryOrders.push(this.fb.group({value:["",Se.required]}))}generateExternalPriceQuery(){this.queryExternalPriceString="";let e=this.dispatchForm.get("orderFlow")?.value,t=this.dispatchForm.get("priceDateSource")?.value;if(e=="CROSS_DOCK"&&t=="QUERY"&&this.dispatchForm.get("deliveryOrders")?.value.length>0){let r=[];this.getInputDeliveryOrderList().forEach(s=>{s.items.length>0&&s.items.forEach(a=>{r.push(a.barcode)})});let o=r.map(s=>`"${s}"`).join(", ");this.queryExternalPriceString=`db.external_prices.aggregate([{"$match":{"barcode":{"$in":[${o}]}}},{"$sort":{"createdDate":-1}},{"$group":{"_id":"$barcode","latest":{"$first":"$$ROOT"}}},{"$replaceRoot":{"newRoot":"$latest"}},{"$project":{"_id":0,"articleNo":1,"barcode":1,"createdDate":1}}])`}}createItem(e,t,r,i,o,s,a,l,c,u,f,h,d,m){let p=new Date;return this.fb.group({productName:[e],articleNo:[t],barcode:[r],assignedQty:[i],unit:[o],unitFactor:[a],doNo:[l],deliveryDate:[c],pickDate:[u],poNo:[f],shipmentNo:[h],orderType:[d],priceDate:[m,Se.required],details:this.fb.array([this.createDetail(i,s)])})}createDetail(e,t){return this.fb.group({pickQty:[e,Se.required],toteId:[t,Se.required]})}get f(){return this.dispatchForm.controls}onChangedMode(){this.items.clear(),this.onPreviewToteDetail()}onPreviewToteDetail(){let e=this.dispatchForm.get("mode")?.value??"",t=this.dispatchForm.get("orderFlow")?.value??"",r=this.dispatchForm.get("priceDateSource")?.value??"",i=this.getInputDeliveryOrderList(),o=this.getTotalSizeFromDeliveryOrders();this.items.clear();let s=this.dispatchForm.get("specifyToteCode")?.value,a=this.dispatchForm.get("subfixToteCode")?.value,l=this.dispatchForm.get("startRunningNumber")?.value,c=this.dispatchForm.get("toteId")?.value;o==0||e=="SPECIFY_TOTE"&&(!a||!l||!s)||e=="RANDOM_TOTE"&&(!a||!l)||e=="SIGNLE_TOTE"&&!c||i.forEach(u=>{if(u&&Array.isArray(u.items)){if(t=="KEEP_STOCK"&&u.orderFlow!="KEEP_STOCK"||t=="CROSS_DOCK"&&u.orderFlow!="CROSS_DOCK"){this.toastr.error("Invalid delivery order structure: mismatched order flow type","\u0E41\u0E08\u0E49\u0E07\u0E40\u0E15\u0E37\u0E2D\u0E19");return}let f=u.items,h=u.doNo,d=this.dateUtils.generateDateTimeTDSC(new Date(u.po.cutOffDeliveryDate)),m=this.dateUtils.generateDateTimeTDSC(new Date(u.po.pickDate)),p=t=="KEEP_STOCK";if(e=="RANDOM_TOTE"?this.generateToteIdList(o):e=="SPECIFY_TOTE"&&this.generateSpecifyToteIdList(o),f&&Array.isArray(f)){let g=p||r=="MANUAL"?{}:this.getBarcodeCreatedDateMap(),w=new Date().toISOString().slice(0,10);f.forEach((y,S)=>{let B=e=="RANDOM_TOTE"||e=="SPECIFY_TOTE"?this.toteIdList[S]:e=="SINGLE_TOTE"?this.dispatchForm.get("toteId")?.value:"";this.items.push(this.createItem(y.productName??"",y.articleNo??"",y.barcode??"",p?y.qty:y.assignedQty,p?y.unit:y.crossDock?.unit,B,y.unitFactor??0,h,d,m,p?u?.po.poNo:"",p?u?.shipment?.shipmentNo:"",p?u?.po?.orderType:"",p||r=="MANUAL"?w:g.get(y.barcode)??""))})}}else console.warn("Invalid delivery order or items missing")})}getBarcodeCreatedDateMap(){let e=this.dispatchForm.get("priceDateSource")?.value,t=JSON.parse(this.dispatchForm.get("externalPrice")?.value);return e=="MANUAL"?{}:(t&&!Array.isArray(t)&&(t=[t]),t?new Map((t??[]).map(r=>{let i=new Date(r.createdDate).toISOString().slice(0,10);return[r.barcode,i]})):(console.warn("externalPrices is null or undefined"),new Map))}getDetails(e){return this.items.at(e).get("details")}addDetail(e){this.getDetails(e).push(this.createDetail())}removeDetail(e,t){let r=this.getDetails(e);r.length>1?r.removeAt(t):this.toastr.warning("\u0E15\u0E49\u0E2D\u0E07\u0E21\u0E35 Pick Detail \u0E2D\u0E22\u0E48\u0E32\u0E07\u0E19\u0E49\u0E2D\u0E22 1 \u0E23\u0E32\u0E22\u0E01\u0E32\u0E23","\u0E41\u0E08\u0E49\u0E07\u0E40\u0E15\u0E37\u0E2D\u0E19")}validateForm(){return this.dispatchForm.invalid||this.toteForm.invalid?(this.dispatchForm.markAllAsTouched(),this.dispatchForm.get("mode")?.value=="CUSTOM_TOTE"&&this.toteForm.markAllAsTouched(),this.toastr.error("Invalid form","\u0E41\u0E08\u0E49\u0E07\u0E40\u0E15\u0E37\u0E2D\u0E19"),!0):!1}onSubmit(){if(this.validateForm())return;let e=this.dispatchForm.value,t=e.orderFlow,r=e.platNo,i=e.driverName;if(this.getTotalSizeFromDeliveryOrders()==0){this.toastr.error("Invalid deliveryOrder structure: missing items array","\u0E41\u0E08\u0E49\u0E07\u0E40\u0E15\u0E37\u0E2D\u0E19");return}t=="CROSS_DOCK"?this.generateDispatchCrossDock(i,r):this.generateDispatcKeepStock()}mapRowCsv(e,t,r,i,o,s,a,l,c,u,f,h,d){return["01",e,t,r,Number(i??0).toFixed(2),o??"",s,a,l,"","",c,u,"",`LD${this.dateUtils.generateCompactDateTime(new Date)}`,f===null||f===""?"YYYY-MM-DD":f,h,d,d,`LTEST-${t.split("-").slice(1).join("-")}`]}getTotalSizeFromDeliveryOrders(){let e=0,t=this.getInputDeliveryOrderList();for(let r=0;r<t.length;r++)e+=t[r].items.length;return e}buildCSVData(e,t){let r=[],i=this.items.value,o=i.length,a=this.dispatchForm.value.mode,l=this.getInputDeliveryOrderList(),c=new Date,u=c.toISOString().split("T")[0],f=new Date(new Date().setFullYear(new Date().getFullYear()+1)).toISOString().split("T")[0],d=`SO-${l[0]?.po?.storeCode}-${this.dateUtils.generateCompactDateTime(c)}`;if(o>0)for(let m=0;m<o;m++){let p=i[m];if(p.details)for(let g=0;g<p.details.length;g++){let w=p.details[g];r.push(this.mapRowCsv(d,p.doNo,p.barcode,w.pickQty,p.unit,w.toteId,p.deliveryDate,p.pickDate,e,t,p.priceDate,f,u))}}return r}generateDispatchCrossDock(e,t){let r=["01","shipmentNo","doNo","barcode","pickedQty","uom","toteId","deliverydate","pickupdate","couriercode","couriername","drivername","truckId","plateno","loadingNo","priceDate","expDate","mfgDate","recDate","lotNo"],i=[];i.push(...this.buildCSVData(e,t));let s=[r,...i].map(h=>{for(;h.length>1&&h[h.length-1]==="";)h.pop();return h.join("|")}).join(`
`),a="\uFEFF",l=this.getInputDeliveryOrderList()[0],c=new Blob([a+s],{type:"text/csv;charset=utf-8;"}),u=URL.createObjectURL(c),f=document.createElement("a");f.href=u,f.download=`shipment_${l.po.storeCode}_${this.dateUtils.generateCompactDateTime(new Date)}.csv`,f.click()}generateDispatcKeepStock(){let e=[],t=[],r=[],i=[],o=this.getInputDeliveryOrderList(),s=this.dispatchForm.value,a=s.platNo,l=s.driverName,c=new Date,u=s.mode,f=this.dateUtils.generateDateTime(c),h=this.items.value,d=this.getTotalSizeFromDeliveryOrders();if(u=="CUSTOM_TOTE"||h.length>0)h.forEach((m,p)=>{if(m.details){for(let y=0;y<m.details.length;y++){let S=m.details[y];t.push(this.createConfirmToteDetail(m.doNo,m.articleNo,S.toteId,S.pickQty,m.unitFactor)),e.push(this.createConfirmShipmentDetail(m.doNo,p+1,m.articleNo,S.pickQty,m.unitFactor,this.dateUtils.generateDate(c)))}let g=r.some(y=>y.docNo===m.doNo),w=r.some(y=>y.docNo===m.doNo);g||r.push(this.buildConfirmShipmentData(m.orderType,m.doNo,m.poNo,m.shipmentNo,f,a,l,e)),w||i.push(this.buildConfirmToteData(m.orderType,m.doNo,m.poNo,m.shipmentNo,t))}});else if(u=="RANDOM_TOTE"||u=="SPECIFY_TOTE")u=="RANDOM_TOTE"?this.generateToteIdList(d):u=="SPECIFY_TOTE"&&this.generateSpecifyToteIdList(d),d>0&&(this.items.clear(),o.forEach(m=>{let p=this.dateUtils.generateDateTimeTDSC(new Date(m.po.cutOffDeliveryDate)),g=this.dateUtils.generateDateTimeTDSC(new Date(m.po.pickDate));m.items.forEach((w,y)=>{let S=this.toteIdList[y];this.items.push(this.createItem(w.productName??"",w.articleNo??"",w.barcode??"",w.qty??0,w.unit??"",S,w.unitFactor??0,m.doNo,p,g,m.po.poNo,m.shipment.shipmentNo,m.po.orderType)),t.push(this.createConfirmToteDetail(m.doNo,w.articleNo,S,w.qty,w.unitFactor)),e.push(this.createConfirmShipmentDetail(m.doNo,y+1,w.articleNo,w.qty,w.unitFactor,this.dateUtils.generateDate(c)))}),r.push(this.buildConfirmShipmentData(m.po.orderType,m.doNo,m.po.poNo,m.shipment.shipmentNo,f,a,l,e)),i.push(this.buildConfirmToteData(m.po.orderType,m.doNo,m.po.poNo,m.shipment.shipmentNo,t))}));else{let m=s.toteId;d>0&&(this.items.clear(),o.forEach(p=>{let g=this.dateUtils.generateDateTimeTDSC(new Date(p.po.cutOffDeliveryDate)),w=this.dateUtils.generateDateTimeTDSC(new Date(p.po.pickDate));p.items.forEach((y,S)=>{this.items.push(this.createItem(y.productName??"",y.articleNo??"",y.barcode??"",y.qty??0,y.unit??"",m,y.unitFactor??0,p.doNo,g,w,p.po.poNo,p.shipment.shipmentNo,p.po.orderType)),t.push(this.createConfirmToteDetail(p.doNo,y.articleNo,m,y.qty,y.unitFactor)),e.push(this.createConfirmShipmentDetail(p.doNo,S+1,y.articleNo,y.qty,y.unitFactor,this.dateUtils.generateDate(c)))}),r.push(this.buildConfirmShipmentData(p.po.orderType,p.doNo,p.po.poNo,p.shipment.shipmentNo,f,a,l,e)),i.push(this.buildConfirmToteData(p.po.orderType,p.doNo,p.po.poNo,p.shipment.shipmentNo,t))}))}this.confirmShipmentData={xmldata:{data:{orderinfo:r}}},this.confirmToteData={xmldata:{data:{orderinfo:i}}}}buildConfirmShipmentData(e,t,r,i,o,s,a,l){return{warehouseId:"TDNE-01",orderType:e,customerId:"TD001",docNo:t,soReferenceA:r,soReferenceB:i,deliveryNo:t,carrierId:"210000263",shippedTime:o,userDefine1:s,userDefine2:a,details:l}}buildConfirmToteData(e,t,r,i,o){return{_comment:"this file has to change 'warehouseId, orderType, docNo, soReferenceA, soReferenceB, referenceNo, sku. toteId'",warehouseId:"TDNE-01",orderType:e,customerId:"TD001",docNo:t,soReferenceA:r,soReferenceB:i,details:o}}createConfirmToteDetail(e,t,r,i,o){return{referenceNo:e,sku:t,toteId:r,qtyOrdered:i*o}}createConfirmShipmentDetail(e,t,r,i,o,s){return{referenceNo:e,lineNo:t,sku:r,qtyShipped:i*o,lotAtt01:"",lotAtt02:"",lotAtt03:s,lotAtt05:"CJ",lotAtt06:"CJ",lotAtt08:"N"}}generateToteIdList(e){let t=this.dispatchForm.get("subfixToteCode")?.value,r=this.dispatchForm.get("startRunningNumber")?.value;this.toteIdList=[];for(let i=0;i<e;i++){let o=Math.floor(Math.random()*this.prefixToteList.length),s=`${this.prefixToteList[o].code}${t}${String(r+i).padStart(4,"0")}`;this.toteIdList.push(s)}}generateSpecifyToteIdList(e){let t=this.dispatchForm.get("specifyToteCode")?.value,r=this.dispatchForm.get("subfixToteCode")?.value,i=this.dispatchForm.get("startRunningNumber")?.value;this.toteIdList=[];let o=t.split(",").map(a=>a.trim()),s=o.length;for(let a=0;a<e;a++){let l=a<s?a:Math.floor(Math.random()*s),c=o[l],u=c=="PL"?c:`${c}${r}${String(i+a).padStart(4,"0")}`;this.toteIdList.push(u)}}clearData(){this.items.clear(),this.toteIdList=[],this.dispatchForm.reset(),this.toteForm.reset(),this.deliveryOrders.clear(),this.deliveryOrders.push(this.fb.group({value:["",Se.required]})),this.confirmShipmentData=null,this.confirmToteData=null}copyToClipboard(e,t){let r=document.createRange();r.selectNode(e);let i=window.getSelection();i&&(i.removeAllRanges(),i.addRange(r),document.execCommand("copy"),i.removeAllRanges()),t.innerHTML='<i class="fa-solid fa-check"></i> Copied!',t.disabled=!0,setTimeout(()=>{t.innerHTML='<i class="fa-regular fa-copy"></i> Copy',t.disabled=!1},2e3)}static \u0275fac=function(t){return new(t||n)(ae(an),ae(Cr))};static \u0275cmp=nt({type:n,selectors:[["app-dispatch-order"]],decls:72,vars:23,consts:[[3,"ngSubmit","formGroup"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"mb-0"],[4,"ngIf"],["type","button",1,"btn","btn-outline-primary",3,"click"],[1,"form-group","mb-3","mt-3"],["for","orderFlow",1,"text-red","text-xl",2,"font-size","25px"],["bindLabel","name","bindValue","id","placeholder","Select mode","formControlName","orderFlow",1,"custom-ng-select",3,"change","items"],["for","mode",1,"text-red","text-xl",2,"font-size","25px"],["bindLabel","name","bindValue","id","placeholder","Select mode","formControlName","mode",1,"custom-ng-select",3,"change","items"],["formArrayName","deliveryOrders"],["class","textarea-row",3,"formGroupName",4,"ngFor","ngForOf"],["class","radio-group",4,"ngIf"],["class","mt-3",4,"ngIf"],[1,"mt-4"],[1,"form-group"],["for","platNo"],["type","text","id","platNo","formControlName","platNo","placeholder","Enter PlatNo"],["for","driverName"],["type","text","id","driverName","formControlName","driverName","placeholder","Enter DriverName"],["type","button",1,"btn","btn-primary","me-2",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"mt-5"],["id","totePreviewModal","tabindex","-1","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","\u0E1B\u0E34\u0E14",1,"btn-close"],[1,"modal-body"],[1,"table","table-bordered","table-striped"],[4,"ngFor","ngForOf"],[1,"textarea-row",3,"formGroupName"],["formControlName","value",1,"form-control","textarea-flex",3,"input"],["type","button","class","btn btn-danger btn-sm ms-2",3,"click",4,"ngIf"],["type","button",1,"btn","btn-danger","btn-sm","ms-2",3,"click"],["type","button",1,"btn","btn-primary","btn-sm","mt-2",3,"click"],[1,"radio-group"],["type","radio","formControlName","priceDateSource","value","MANUAL"],["type","radio","formControlName","priceDateSource","value","QUERY"],[1,"mt-3"],[3,"codeText"],["formControlName","externalPrice",1,"form-control","textarea-flex"],["for","toteId"],["type","text","id","toteId","formControlName","toteId","placeholder","Enter ToteId"],[1,"form-text","text-muted","ms-2"],["class","form-group",4,"ngIf"],["for","subfixToteCode"],["type","text","id","subfixToteCode","formControlName","subfixToteCode","placeholder","Enter Tote Code"],[1,"form-text","text-muted",2,"margin-left","10px"],["for","startRunningNumber"],["type","number","id","startRunningNumber","formControlName","startRunningNumber","placeholder","Enter Start Running Number"],["for","specifyToteCode"],["type","text","id","specifyToteCode","formControlName","specifyToteCode","placeholder","Enter Tote Code"],[2,"display","flex","align-items","center"],[2,"margin","0"],["type","button","class","btn btn-secondary btn-sm mx-2",3,"click",4,"ngIf"],[3,"formGroup"],[1,"table","table-bordered"],[1,"text-center"],["class","text-center",4,"ngIf"],["formArrayName","items"],[3,"formGroupName",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-secondary","btn-sm","mx-2",3,"click"],[3,"formGroupName"],[2,"white-space","nowrap"],[3,"textToCopy","showIconOnly"],["formArrayName","details",1,"table","table-sm","table-borderless"],["class","pick-detail-row",3,"formGroupName",4,"ngFor","ngForOf"],["colspan","3"],["type","button",1,"btn","btn-primary","btn-sm",2,"border","1px solid #0d6efd !important","padding","0.25rem 0.75rem",3,"click"],["type","text","formControlName","priceDate","placeholder","Price Date",1,"form-control"],[1,"pick-detail-row",3,"formGroupName"],[1,"row"],[1,"col-4"],["type","text","formControlName","pickQty","placeholder","Pick Qty",1,"form-control"],[1,"col-7","d-flex","align-items-center"],["type","text","formControlName","toteId","placeholder","Tote ID",1,"form-control"],[1,"ms-2",3,"textToCopy","showIconOnly"],["class","col-1",4,"ngIf"],[1,"col-1"],["type","button",1,"btn","btn-danger","btn-sm",3,"click"]],template:function(t,r){if(t&1&&(E(0,"form",0),Ce("ngSubmit",function(){return r.onSubmit()}),E(1,"div",1)(2,"h1",2),C(3," Generate Payload Dispatch Order "),be(4,AP,2,1,"span",3),_(),E(5,"button",4),Ce("click",function(){return r.openModal()}),C(6,"Show Tote Codes"),_()(),E(7,"div",5)(8,"label",6),C(9,"Order Flow :"),_(),E(10,"ng-select",7),Ce("change",function(){return r.onChangedOrderFlow()}),_()(),E(11,"div",5)(12,"label",8),C(13,"Mode :"),_(),E(14,"ng-select",9),Ce("change",function(){return r.onChangedMode()}),_()(),E(15,"p")(16,"b"),C(17,"Step1:"),_(),C(18," Go to mongodb collection "),E(19,"b"),C(20,"order.delivery_orders"),_(),C(21," then right click at your document and select copy > "),E(22,"b"),C(23,"Copy Value as Plain Text"),_()(),E(24,"p")(25,"b"),C(26,"Step2:"),_(),C(27," Paste your Delivery Order here"),_(),E(28,"div",10),be(29,kP,3,4,"div",11),_(),be(30,NP,3,0,"div",3)(31,MP,9,0,"div",12)(32,OP,16,3,"div",13),J(33,"hr",14),be(34,RP,7,2,"div",3)(35,LP,15,5,"div",3)(36,$P,24,4,"div",3),E(37,"h3"),C(38,"Fill in Shipment information"),_(),E(39,"div",15)(40,"label",16),C(41,"Plat No:"),_(),J(42,"input",17),_(),E(43,"div",15)(44,"label",18),C(45,"Driver Name:"),_(),J(46,"input",19),_(),E(47,"div",14)(48,"button",20),Ce("click",function(){return r.onSubmit()}),C(49),_(),E(50,"button",21),Ce("click",function(){return r.clearData()}),C(51,"Clear"),_()(),J(52,"hr",22),_(),be(53,WP,4,1,"div",3)(54,zP,4,1,"div",13),E(55,"div",23)(56,"div",24)(57,"div",25)(58,"div",26)(59,"h5",27),C(60,"\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23 Tote"),_(),J(61,"button",28),_(),E(62,"div",29)(63,"table",30)(64,"thead")(65,"tr")(66,"th"),C(67,"Tote Code"),_(),E(68,"th"),C(69,"Tote Name"),_()()(),E(70,"tbody"),be(71,qP,5,2,"tr",31),_()()()()()()),t&2){let i,o,s,a,l;H("formGroup",r.dispatchForm),A(4),H("ngIf",r.dispatchForm.value.orderFlow),A(6),Ie("is-invalid",((i=r.dispatchForm.get("orderFlow"))==null?null:i.invalid)&&((i=r.dispatchForm.get("orderFlow"))==null?null:i.touched)),H("items",r.orderFlows),A(4),Ie("is-invalid",((o=r.dispatchForm.get("mode"))==null?null:o.invalid)&&((o=r.dispatchForm.get("mode"))==null?null:o.touched)),H("items",r.modes),A(15),H("ngForOf",r.deliveryOrders.controls),A(),H("ngIf",r.dispatchForm.value.orderFlow=="CROSS_DOCK"),A(),H("ngIf",r.dispatchForm.value.orderFlow==="CROSS_DOCK"),A(),H("ngIf",r.dispatchForm.value.orderFlow=="CROSS_DOCK"&&r.dispatchForm.value.priceDateSource==="QUERY"),A(2),H("ngIf",r.dispatchForm.value.mode==="SINGLE_TOTE"),A(),H("ngIf",r.dispatchForm.value.mode==="RANDOM_TOTE"||r.dispatchForm.value.mode==="SPECIFY_TOTE"),A(),H("ngIf",r.items.value.length>0),A(6),Ie("is-invalid",((s=r.dispatchForm.get("platNo"))==null?null:s.invalid)&&((s=r.dispatchForm.get("platNo"))==null?null:s.touched)),A(4),Ie("is-invalid",((a=r.dispatchForm.get("driverName"))==null?null:a.invalid)&&((a=r.dispatchForm.get("driverName"))==null?null:a.touched)),A(3),rt(" ",((l=r.dispatchForm.get("orderFlow"))==null?null:l.value)=="KEEP_STOCK"?"Generate Payload":"Export CSV"),A(4),H("ngIf",r.confirmToteData),A(),H("ngIf",r.confirmShipmentData),A(17),H("ngForOf",r.prefixToteList)}},dependencies:[mt,uo,Pt,Wt,An,Gt,oc,lr,on,sn,$t,en,da,ha,po,ln,mo],encapsulation:2})};function KP(n,e){if(n&1&&(E(0,"pre",17),C(1),_()),n&2){let t=re();A(),Je(t.sortedOutput)}}var Ud=class n{constructor(e){this.fb=e}form;sortResult=[];isAsc=!1;ngOnInit(){this.form=this.fb.group({inputText:[""],inputSeparator:["NEW_LINE"],outputSeparator:["NEW_LINE"]})}sortText(){let{inputText:e,inputSeparator:t}=this.form.value,r=t==="NEW_LINE"?/\r?\n/:",",i=e.split(r).map(o=>o.trim()).filter(o=>o);this.sortResult=i.sort((o,s)=>this.thaiLocaleCompare(o,s,this.isAsc))}toggleSortOrder(){this.isAsc=!this.isAsc,this.sortText()}clearDataSorting(){this.form.patchValue({inputText:""}),this.sortResult=[]}get sortedOutput(){let e=this.form.value.outputSeparator;return this.sortResult.join(e==="COMMA"?", ":`
`)}thaiLocaleCompare(e,t,r=!0){let i=new Intl.Collator("th-TH"),o=/^[A-Za-z]/.test(e),s=/^[A-Za-z]/.test(t);if(o&&!s)return r?-1:1;if(!o&&s)return r?1:-1;let a=i.compare(this.getThaiComparisonString(e),this.getThaiComparisonString(t));return r?a:-a}getThaiComparisonString(e){return e.trim().toLowerCase()}static \u0275fac=function(t){return new(t||n)(ae(an))};static \u0275cmp=nt({type:n,selectors:[["app-thai-locale-compare"]],decls:37,vars:4,consts:[[3,"formGroup"],[1,"radio-group"],[2,"margin-right","13px"],["type","radio","formControlName","inputSeparator","value","NEW_LINE"],["type","radio","formControlName","inputSeparator","value","COMMA"],["type","radio","formControlName","outputSeparator","value","NEW_LINE"],["type","radio","formControlName","outputSeparator","value","COMMA"],[1,"textarea-content",2,"margin-top","20px"],["formControlName","inputText","rows","5",2,"width","100%","margin-top","10px"],[2,"margin-top","10px"],["type","button",1,"btn","btn-primary",2,"margin-right","10px",3,"click"],[1,"fas","fa-sort-amount-up-alt"],["type","button",1,"btn","btn-danger",3,"click"],[2,"margin-top","30px"],[1,"me-2",2,"font-size","24px","font-weight","500"],[3,"textToCopy"],["id","sortingOutput","class","payload-content mt-4","style","font-size: 18px;",4,"ngIf"],["id","sortingOutput",1,"payload-content","mt-4",2,"font-size","18px"]],template:function(t,r){t&1&&(E(0,"form",0)(1,"h1"),C(2,"Thai Locale Compare"),_(),E(3,"div",1)(4,"label",2),C(5,"Input Separator:"),_(),E(6,"label"),J(7,"input",3),C(8," New Line "),_(),E(9,"label"),J(10,"input",4),C(11," Comma "),_()(),E(12,"div",1)(13,"label"),C(14,"Output Separator:"),_(),E(15,"label"),J(16,"input",5),C(17," New Line "),_(),E(18,"label"),J(19,"input",6),C(20," Comma "),_()(),E(21,"div",7)(22,"label"),C(23,"Enter Text:"),_(),J(24,"textarea",8),_(),E(25,"div",9)(26,"button",10),Ce("click",function(){return r.toggleSortOrder()}),J(27,"i",11),C(28),_(),E(29,"button",12),Ce("click",function(){return r.clearDataSorting()}),C(30,"Clear"),_()(),J(31,"hr",13),E(32,"div")(33,"span",14),C(34,"Result of Sort:"),_(),J(35,"app-copy-button",15),_(),be(36,KP,2,1,"pre",16),_()),t&2&&(H("formGroup",r.form),A(28),rt(" Sort ",r.isAsc?"A to Z":"Z to A"," "),A(7),H("textToCopy",r.sortedOutput),A(),H("ngIf",r.sortResult.length>0))},dependencies:[mt,Pt,Wt,An,Gt,lr,on,sn,$t,en,ln],encapsulation:2})};function YP(n,e){if(n&1&&(E(0,"pre",19),C(1),_()),n&2){let t=re();A(),Je(t.formatterOutput)}}var jd=class n{constructor(e){this.fb=e;this.formatterForm=this.fb.group({inputSeparator:["NEW_LINE"],outputSeparator:["NEW_LINE"],outputQuote:["NO_QUOTE"],inputText:[""]})}formatterForm;formatterOutput="";processFormatter(){let{inputSeparator:e,outputSeparator:t,outputQuote:r,inputText:i}=this.formatterForm.value,o=i.replace(/["']/g,""),s=e==="NEW_LINE"?o.split(`
`).filter(c=>c.trim()!==""):o.split(",").map(c=>c.trim()),a=c=>r==="DOUBLE_QUOTE"?`"${c}"`:r==="SINGLE_QUOTE"?`'${c}'`:c,l="";t==="NEW_LINE"?l=s.map(a).join(`
`):t==="COMMA_NEWLINE"?l=s.map(a).join(`,
`):l=s.map(a).join(","),this.formatterOutput=l}clearFormatter(){this.formatterForm.reset({inputSeparator:"NEW_LINE",outputSeparator:"NEW_LINE",outputQuote:"NO_QUOTE",inputText:""}),this.formatterOutput=""}static \u0275fac=function(t){return new(t||n)(ae(an))};static \u0275cmp=nt({type:n,selectors:[["app-array-formatter"]],decls:50,vars:3,consts:[[3,"formGroup"],[1,"radio-group"],[2,"margin-right","13px"],["type","radio","formControlName","inputSeparator","value","NEW_LINE"],["type","radio","formControlName","inputSeparator","value","COMMA"],["type","radio","formControlName","outputSeparator","value","NEW_LINE"],["type","radio","formControlName","outputSeparator","value","COMMA"],["type","radio","formControlName","outputSeparator","value","COMMA_NEWLINE"],["type","radio","formControlName","outputQuote","value","NO_QUOTE"],["type","radio","formControlName","outputQuote","value","SINGLE_QUOTE"],["type","radio","formControlName","outputQuote","value","DOUBLE_QUOTE"],[1,"textarea-content",2,"margin-top","20px"],["formControlName","inputText",2,"margin-top","10px"],[1,"mt-2"],["type","button",1,"btn","btn-primary",2,"margin-right","10px",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[2,"margin-top","30px"],[3,"textToCopy"],["class","payload-content",4,"ngIf"],[1,"payload-content"]],template:function(t,r){t&1&&(E(0,"form",0)(1,"h1"),C(2,"Array Formatter"),_(),E(3,"div",1)(4,"label",2),C(5,"Input Separator:"),_(),E(6,"label"),J(7,"input",3),C(8," New Line "),_(),E(9,"label"),J(10,"input",4),C(11," Comma "),_()(),E(12,"div",1)(13,"label"),C(14,"Output Separator:"),_(),E(15,"label"),J(16,"input",5),C(17,"New Line"),_(),E(18,"label"),J(19,"input",6),C(20,"Comma"),_(),E(21,"label"),J(22,"input",7),C(23,"Comma with New Line"),_()(),E(24,"div",1)(25,"label"),C(26,"Output Quote:"),_(),E(27,"label"),J(28,"input",8),C(29,"No Quote"),_(),E(30,"label"),J(31,"input",9),C(32,"Single Quote"),_(),E(33,"label"),J(34,"input",10),C(35,"Double Quote"),_()(),E(36,"div",11)(37,"label"),C(38,"Enter Text:"),_(),J(39,"textarea",12),_(),E(40,"div",13)(41,"button",14),Ce("click",function(){return r.processFormatter()}),C(42,"Processing"),_(),E(43,"button",15),Ce("click",function(){return r.clearFormatter()}),C(44,"Clear"),_()(),J(45,"hr",16),E(46,"h2"),C(47,"Result of Sort: "),J(48,"app-copy-button",17),_(),be(49,YP,2,1,"pre",18),_()),t&2&&(H("formGroup",r.formatterForm),A(48),H("textToCopy",r.formatterOutput),A(),H("ngIf",r.formatterOutput))},dependencies:[mt,Pt,Wt,An,Gt,lr,on,sn,$t,en,ln],encapsulation:2})};var Hd=class n{constructor(e){this.fb=e;this.form=this.fb.group({inputUnicode:[""]})}form;unicodeOutput="";copied=!1;processUnicodeConverter(){let e={},r=(this.form.get("inputUnicode")?.value||"").split(`
`),i=/^\s*(\S+)\s*=\s*(.*)$/,o=0;for(;o<r.length;){let s=r[o],a=i.exec(s);if(a){let l=a[1],c=a[2].trim();for(;c.endsWith("\\")&&(o++,o<r.length);){let f=r[o].trim();f&&(c+=f)}let u=c.replace(/\\u([0-9A-Fa-f]{4})/g,(f,h)=>String.fromCharCode(parseInt(h,16))).replace(/\\/g,"");e[l]=u}o++}this.unicodeOutput=Object.entries(e).map(([s,a])=>`${s}: ${a}`).join(`
`)}clearDataUnicode(){this.form.reset(),this.unicodeOutput="",this.copied=!1}static \u0275fac=function(t){return new(t||n)(ae(an))};static \u0275cmp=nt({type:n,selectors:[["app-unicode-converter"]],decls:16,vars:3,consts:[[3,"formGroup"],[1,"textarea-content"],["formControlName","inputUnicode","rows","10",1,"input-area"],[1,"mt-3"],[1,"btn","btn-primary","me-2",3,"click"],[1,"btn","btn-danger",3,"click"],[2,"margin-top","30px"],[3,"textToCopy"],[1,"payload-content"]],template:function(t,r){t&1&&(E(0,"div",0)(1,"h1"),C(2,"Unicode Converter"),_(),E(3,"div",1),J(4,"textarea",2),_(),E(5,"div",3)(6,"button",4),Ce("click",function(){return r.processUnicodeConverter()}),C(7,"Decode"),_(),E(8,"button",5),Ce("click",function(){return r.clearDataUnicode()}),C(9,"Clear"),_()(),J(10,"hr",6),E(11,"h2"),C(12," Result will show here: "),J(13,"app-copy-button",7),_(),E(14,"pre",8),C(15),_()()),t&2&&(H("formGroup",r.form),A(13),H("textToCopy",r.unicodeOutput),A(2),Je(r.unicodeOutput))},dependencies:[mt,Wt,Gt,on,sn,$t,en,ln],encapsulation:2})};function XP(n,e){n&1&&(E(0,"div",2)(1,"label"),C(2,"Stores:"),_(),E(3,"small",12),C(4,"\u0E04\u0E31\u0E48\u0E19\u0E14\u0E49\u0E27\u0E22 comma (,) \u0E40\u0E0A\u0E48\u0E19 CJX0001,CJX0002"),_(),J(5,"textarea",27),_())}var Gd=class n{constructor(e){this.fb=e}stockCountForm;stockCountRequestOutput="";showInputStores=!1;ngOnInit(){this.stockCountForm=this.fb.group({subject:["",Se.required],itemType:["",Se.required],inputSeparator:["NEW_LINE"],inputCodes:["",Se.required],selectStore:["",Se.required],inputStores:[""]}),this.stockCountForm.get("selectStore")?.valueChanges.subscribe(e=>{this.showInputStores=e==="OTHER"})}generatePayload(){let e=this.stockCountForm.value,t=e.inputSeparator==="NEW_LINE"?`
`:",",r=e.inputCodes.split(t).map(u=>u.trim()).filter(u=>u),i=[];switch(e.selectStore){case"DEAR":i=["PANDA01","PANDA02"];break;case"TUNG":i=["CJX12491","CJX12492","CJX7777","PANDA01","PANDA02"];break;case"ANDROID":i=["GX000001","GX999999"];break;case"DEAR+ANDROID":i=["PANDA01","PANDA02","GX000001","GX999999"];break;case"OTHER":i=e.inputStores.split(",").map(u=>u.trim()).filter(u=>u);break}let o=new Date;o.setMinutes(0,0,0),o.setHours(o.getHours()+1);let s=o.toISOString(),a=new Date;a.setDate(a.getDate()+7),a.setHours(23,59,59,999);let l=a.toISOString(),c={subject:e.subject,countStartDatetime:s,countEndDatetime:l,itemType:e.itemType,items:r,selectStore:"SELECT_BY_STORE",storeCodes:i};this.stockCountRequestOutput=JSON.stringify(c,null,2)}clearForm(){this.stockCountForm.reset({inputSeparator:"NEW_LINE"}),this.stockCountRequestOutput=""}static \u0275fac=function(t){return new(t||n)(ae(an))};static \u0275cmp=nt({type:n,selectors:[["app-create-stock-count-request"]],decls:61,vars:4,consts:[["outputDiv",""],[3,"formGroup"],[1,"form-group"],["type","text","formControlName","subject",2,"width","500px !important"],["formControlName","itemType"],["value",""],["value","ARTICLE"],["value","CLASS"],[1,"radio-group","mt-2","mb-2"],[2,"margin-right","55px"],["type","radio","value","NEW_LINE","formControlName","inputSeparator"],["type","radio","value","COMMA","formControlName","inputSeparator"],[1,"form-text","text-muted"],["formControlName","inputCodes","rows","4"],["formControlName","selectStore"],["value","DEAR"],["value","TUNG"],["value","ANDROID"],["value","DEAR+ANDROID"],["value","OTHER"],["class","form-group",4,"ngIf"],[1,"mt-3"],["type","button",1,"btn","btn-primary","me-2",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[2,"margin-top","30px"],[3,"textToCopy"],["id","stockCountRequestOutput"],["formControlName","inputStores","rows","2"]],template:function(t,r){if(t&1){let i=_t();E(0,"h1"),C(1,"Stock Count Request"),_(),E(2,"form",1)(3,"div",2)(4,"label"),C(5,"Subject:"),_(),J(6,"input",3),_(),E(7,"div",2)(8,"label"),C(9,"Select by:"),_(),E(10,"select",4)(11,"option",5),C(12,"Select by"),_(),E(13,"option",6),C(14,"Select item by Item"),_(),E(15,"option",7),C(16,"Select item by Class"),_()()(),E(17,"div",8)(18,"label",9),C(19,"Input Separator:"),_(),E(20,"label"),J(21,"input",10),C(22," New Line "),_(),E(23,"label"),J(24,"input",11),C(25," Comma "),_(),E(26,"small",12),C(27,"\u0E23\u0E39\u0E1B\u0E41\u0E1A\u0E1A\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E04\u0E31\u0E48\u0E19\u0E14\u0E49\u0E27\u0E22 comma (,) \u0E40\u0E0A\u0E48\u0E19 10100,10200"),_()(),E(28,"div",2)(29,"label"),C(30,"Class Code / ArticleNo:"),_(),J(31,"textarea",13),_(),E(32,"div",2)(33,"label"),C(34,"Select Store:"),_(),E(35,"select",14)(36,"option",5),C(37,"Select a store"),_(),E(38,"option",15),C(39,"Dear's Store"),_(),E(40,"option",16),C(41,"P'Tung's Store"),_(),E(42,"option",17),C(43,"Android's Store"),_(),E(44,"option",18),C(45,"Dear+Android's Store"),_(),E(46,"option",19),C(47,"Other"),_()()(),be(48,XP,6,0,"div",20),E(49,"div",21)(50,"button",22),Ce("click",function(){return qe(i),Ke(r.generatePayload())}),C(51,"Generate Payload"),_(),E(52,"button",23),Ce("click",function(){return qe(i),Ke(r.clearForm())}),C(53,"Clear"),_()()(),J(54,"hr",24),E(55,"h2"),C(56," Payload Output: "),J(57,"app-copy-button",25),_(),E(58,"pre",26,0),C(60),_()}t&2&&(A(2),H("formGroup",r.stockCountForm),A(46),H("ngIf",r.showInputStores),A(9),H("textToCopy",r.stockCountRequestOutput),A(3),Je(r.stockCountRequestOutput))},dependencies:[mt,Pt,Wt,An,pw,gw,Gt,Nd,lr,on,sn,$t,en,ln],encapsulation:2})};var $d=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=nt({type:n,selectors:[["app-create-stock-count-group"]],decls:2,vars:0,template:function(t,r){t&1&&(E(0,"p"),C(1,"create-stock-count-group works!"),_())},dependencies:[mt,Wt],encapsulation:2})};var _c={};_c.version="0.18.5";var ls=1200,ba=1252,ZP=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],QP={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},mC=function(n){ZP.indexOf(n)!=-1&&(ba=QP[0]=n)};function JP(){mC(1252)}var yc=function(n){ls=n,mC(n)};function e4(){yc(1200),JP()}function t4(n){for(var e=[],t=0;t<n.length>>1;++t)e[t]=String.fromCharCode(n.charCodeAt(2*t+1)+(n.charCodeAt(2*t)<<8));return e.join("")}var Wd=function(e){return String.fromCharCode(e)},Aw=function(e){return String.fromCharCode(e)},yt;var pi=null,uc=!0,_o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function xc(n){for(var e="",t=0,r=0,i=0,o=0,s=0,a=0,l=0,c=0;c<n.length;)t=n.charCodeAt(c++),o=t>>2,r=n.charCodeAt(c++),s=(t&3)<<4|r>>4,i=n.charCodeAt(c++),a=(r&15)<<2|i>>6,l=i&63,isNaN(r)?a=l=64:isNaN(i)&&(l=64),e+=_o.charAt(o)+_o.charAt(s)+_o.charAt(a)+_o.charAt(l);return e}function Vi(n){var e="",t=0,r=0,i=0,o=0,s=0,a=0,l=0;n=n.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<n.length;)o=_o.indexOf(n.charAt(c++)),s=_o.indexOf(n.charAt(c++)),t=o<<2|s>>4,e+=String.fromCharCode(t),a=_o.indexOf(n.charAt(c++)),r=(s&15)<<4|a>>2,a!==64&&(e+=String.fromCharCode(r)),l=_o.indexOf(n.charAt(c++)),i=(a&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var st=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ji=function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function us(n){return st?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function Fw(n){return st?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var $r=function(e){return st?ji(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function hh(n){if(typeof ArrayBuffer>"u")return $r(n);for(var e=new ArrayBuffer(n.length),t=new Uint8Array(e),r=0;r!=n.length;++r)t[r]=n.charCodeAt(r)&255;return e}function Dc(n){if(Array.isArray(n))return n.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],t=0;t<n.length;++t)e[t]=String.fromCharCode(n[t]);return e.join("")}function n4(n){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(n)}var vn=st?function(n){return Buffer.concat(n.map(function(e){return Buffer.isBuffer(e)?e:ji(e)}))}:function(n){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<n.length;++e)t+=n[e].length;var r=new Uint8Array(t),i=0;for(e=0,t=0;e<n.length;t+=i,++e)if(i=n[e].length,n[e]instanceof Uint8Array)r.set(n[e],t);else{if(typeof n[e]=="string")throw"wtf";r.set(new Uint8Array(n[e]),t)}return r}return[].concat.apply([],n.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function r4(n){for(var e=[],t=0,r=n.length+250,i=us(n.length+255),o=0;o<n.length;++o){var s=n.charCodeAt(o);if(s<128)i[t++]=s;else if(s<2048)i[t++]=192|s>>6&31,i[t++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var a=n.charCodeAt(++o)&1023;i[t++]=240|s>>8&7,i[t++]=128|s>>2&63,i[t++]=128|a>>6&15|(s&3)<<4,i[t++]=128|a&63}else i[t++]=224|s>>12&15,i[t++]=128|s>>6&63,i[t++]=128|s&63;t>r&&(e.push(i.slice(0,t)),t=0,i=us(65535),r=65530)}return e.push(i.slice(0,t)),vn(e)}var Ta=/\u0000/g,zd=/[\u0001-\u0006]/g;function wa(n){for(var e="",t=n.length-1;t>=0;)e+=n.charAt(t--);return e}function Wr(n,e){var t=""+n;return t.length>=e?t:Lt("0",e-t.length)+t}function Dv(n,e){var t=""+n;return t.length>=e?t:Lt(" ",e-t.length)+t}function eh(n,e){var t=""+n;return t.length>=e?t:t+Lt(" ",e-t.length)}function i4(n,e){var t=""+Math.round(n);return t.length>=e?t:Lt("0",e-t.length)+t}function o4(n,e){var t=""+n;return t.length>=e?t:Lt("0",e-t.length)+t}var kw=Math.pow(2,32);function va(n,e){if(n>kw||n<-kw)return i4(n,e);var t=Math.round(n);return o4(t,e)}function th(n,e){return e=e||0,n.length>=7+e&&(n.charCodeAt(e)|32)===103&&(n.charCodeAt(e+1)|32)===101&&(n.charCodeAt(e+2)|32)===110&&(n.charCodeAt(e+3)|32)===101&&(n.charCodeAt(e+4)|32)===114&&(n.charCodeAt(e+5)|32)===97&&(n.charCodeAt(e+6)|32)===108}var Nw=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],hv=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function s4(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',n}var Bt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},Mw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},a4={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function nh(n,e,t){for(var r=n<0?-1:1,i=n*r,o=0,s=1,a=0,l=1,c=0,u=0,f=Math.floor(i);c<e&&(f=Math.floor(i),a=f*s+o,u=f*c+l,!(i-f<5e-8));)i=1/(i-f),o=s,s=a,l=c,c=u;if(u>e&&(c>e?(u=l,a=o):(u=c,a=s)),!t)return[0,r*a,u];var h=Math.floor(r*a/u);return[h,r*a-h*u,u]}function qd(n,e,t){if(n>2958465||n<0)return null;var r=n|0,i=Math.floor(86400*(n-r)),o=0,s=[],a={D:r,T:i,u:86400*(n-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),e&&e.date1904&&(r+=1462),a.u>.9999&&(a.u=0,++i==86400&&(a.T=i=0,++r,++a.D)),r===60)s=t?[1317,10,29]:[1900,2,29],o=3;else if(r===0)s=t?[1317,8,29]:[1900,1,0],o=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],o=l.getDay(),r<60&&(o=(o+6)%7),t&&(o=p4(l,s))}return a.y=s[0],a.m=s[1],a.d=s[2],a.S=i%60,i=Math.floor(i/60),a.M=i%60,i=Math.floor(i/60),a.H=i,a.q=o,a}var gC=new Date(1899,11,31,0,0,0),l4=gC.getTime(),c4=new Date(1900,2,1,0,0,0);function vC(n,e){var t=n.getTime();return e?t-=1461*24*60*60*1e3:n>=c4&&(t+=24*60*60*1e3),(t-(l4+(n.getTimezoneOffset()-gC.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Sv(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function u4(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function f4(n){var e=n<0?12:11,t=Sv(n.toFixed(12));return t.length<=e||(t=n.toPrecision(10),t.length<=e)?t:n.toExponential(5)}function d4(n){var e=Sv(n.toFixed(11));return e.length>(n<0?12:11)||e==="0"||e==="-0"?n.toPrecision(6):e}function h4(n){var e=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),t;return e>=-4&&e<=-1?t=n.toPrecision(10+e):Math.abs(e)<=9?t=f4(n):e===10?t=n.toFixed(10).substr(0,12):t=d4(n),Sv(u4(t.toUpperCase()))}function Ev(n,e){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):h4(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return xo(14,vC(n,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+n)}function p4(n,e){e[0]-=581;var t=n.getDay();return n<60&&(t=(t+6)%7),t}function m4(n,e,t,r){var i="",o=0,s=0,a=t.y,l,c=0;switch(n){case 98:a=t.y+543;case 121:switch(e.length){case 1:case 2:l=a%100,c=2;break;default:l=a%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=t.m,c=e.length;break;case 3:return hv[t.m-1][1];case 5:return hv[t.m-1][0];default:return hv[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=t.d,c=e.length;break;case 3:return Nw[t.q][0];default:return Nw[t.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(t.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=t.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=t.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?Wr(t.S,e.length):(r>=2?s=r===3?1e3:100:s=r===1?10:1,o=Math.round(s*(t.S+t.u)),o>=60*s&&(o=0),e==="s"?o===0?"0":""+o/s:(i=Wr(o,2+r),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=t.D*24+t.H;break;case"[m]":case"[mm]":l=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":l=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=a,c=1;break}var u=c>0?Wr(l,c):"";return u}function yo(n){var e=3;if(n.length<=e)return n;for(var t=n.length%e,r=n.substr(0,t);t!=n.length;t+=e)r+=(r.length>0?",":"")+n.substr(t,e);return r}var _C=/%/g;function g4(n,e,t){var r=e.replace(_C,""),i=e.length-r.length;return Pi(n,r,t*Math.pow(10,2*i))+Lt("%",i)}function v4(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Pi(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function yC(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+yC(n,-e);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%i;if(o<0&&(o+=i),t=(e/Math.pow(10,o)).toPrecision(r+1+(i+o)%i),t.indexOf("e")===-1){var s=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+o):t+="E+"+(s-o);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,u){return l+c+u.substr(0,(i+o)%i)+"."+u.substr(o)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var xC=/# (\?+)( ?)\/( ?)(\d+)/;function _4(n,e,t){var r=parseInt(n[4],10),i=Math.round(e*r),o=Math.floor(i/r),s=i-o*r,a=r;return t+(o===0?"":""+o)+" "+(s===0?Lt(" ",n[1].length+1+n[4].length):Dv(s,n[1].length)+n[2]+"/"+n[3]+Wr(a,n[4].length))}function y4(n,e,t){return t+(e===0?"":""+e)+Lt(" ",n[1].length+2+n[4].length)}var EC=/^#*0*\.([0#]+)/,TC=/\).*[0#]/,wC=/\(###\) ###\\?-####/;function Pn(n){for(var e="",t,r=0;r!=n.length;++r)switch(t=n.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function Ow(n,e){var t=Math.pow(10,e);return""+Math.round(n*t)/t}function Rw(n,e){var t=n-Math.floor(n),r=Math.pow(10,e);return e<(""+Math.round(t*r)).length?0:Math.round(t*r)}function x4(n,e){return e<(""+Math.round((n-Math.floor(n))*Math.pow(10,e))).length?1:0}function E4(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function Dr(n,e,t){if(n.charCodeAt(0)===40&&!e.match(TC)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Dr("n",r,t):"("+Dr("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return v4(n,e,t);if(e.indexOf("%")!==-1)return g4(n,e,t);if(e.indexOf("E")!==-1)return yC(e,t);if(e.charCodeAt(0)===36)return"$"+Dr(n,e.substr(e.charAt(1)==" "?2:1),t);var i,o,s,a,l=Math.abs(t),c=t<0?"-":"";if(e.match(/^00+$/))return c+va(l,e.length);if(e.match(/^[#?]+$/))return i=va(t,0),i==="0"&&(i=""),i.length>e.length?i:Pn(e.substr(0,e.length-i.length))+i;if(o=e.match(xC))return _4(o,l,c);if(e.match(/^#+0+$/))return c+va(l,e.length-e.indexOf("0"));if(o=e.match(EC))return i=Ow(t,o[1].length).replace(/^([^\.]+)$/,"$1."+Pn(o[1])).replace(/\.$/,"."+Pn(o[1])).replace(/\.(\d*)$/,function(m,p){return"."+p+Lt("0",Pn(o[1]).length-p.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return c+Ow(l,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return c+yo(va(l,0));if(o=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Dr(n,e,-t):yo(""+(Math.floor(t)+x4(t,o[1].length)))+"."+Wr(Rw(t,o[1].length),o[1].length);if(o=e.match(/^#,#*,#0/))return Dr(n,e.replace(/^#,#*,/,""),t);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=wa(Dr(n,e.replace(/[\\-]/g,""),t)),s=0,wa(wa(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return s<i.length?i.charAt(s++):m==="0"?"0":""}));if(e.match(wC))return i=Dr(n,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(o[4].length,7),a=nh(l,Math.pow(10,s)-1,!1),i=""+c,u=Pi("n",o[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+o[2]+"/"+o[3],u=eh(a[2],s),u.length<o[4].length&&(u=Pn(o[4].substr(o[4].length-u.length))+u),i+=u,i;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(o[1].length,o[4].length),7),a=nh(l,Math.pow(10,s)-1,!0),c+(a[0]||(a[1]?"":"0"))+" "+(a[1]?Dv(a[1],s)+o[2]+"/"+o[3]+eh(a[2],s):Lt(" ",2*s+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return i=va(t,0),e.length<=i.length?i:Pn(e.substr(0,e.length-i.length))+i;if(o=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var f=e.indexOf(".")-s,h=e.length-i.length-f;return Pn(e.substr(0,f)+i+e.substr(e.length-h))}if(o=e.match(/^00,000\.([#0]*0)$/))return s=Rw(t,o[1].length),t<0?"-"+Dr(n,e,-t):yo(E4(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Wr(0,3-m.length):"")+m})+"."+Wr(s,o[1].length);switch(e){case"###,##0.00":return Dr(n,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var d=yo(va(l,0));return d!=="0"?c+d:"";case"###,###.00":return Dr(n,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Dr(n,"#,##0.00",t).replace(/^0\./,".");default:}throw new Error("unsupported format |"+e+"|")}function T4(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Pi(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function w4(n,e,t){var r=e.replace(_C,""),i=e.length-r.length;return Pi(n,r,t*Math.pow(10,2*i))+Lt("%",i)}function CC(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+CC(n,-e);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%i;if(o<0&&(o+=i),t=(e/Math.pow(10,o)).toPrecision(r+1+(i+o)%i),!t.match(/[Ee]/)){var s=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+o):t+="E+"+(s-o),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,u){return l+c+u.substr(0,(i+o)%i)+"."+u.substr(o)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function di(n,e,t){if(n.charCodeAt(0)===40&&!e.match(TC)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?di("n",r,t):"("+di("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return T4(n,e,t);if(e.indexOf("%")!==-1)return w4(n,e,t);if(e.indexOf("E")!==-1)return CC(e,t);if(e.charCodeAt(0)===36)return"$"+di(n,e.substr(e.charAt(1)==" "?2:1),t);var i,o,s,a,l=Math.abs(t),c=t<0?"-":"";if(e.match(/^00+$/))return c+Wr(l,e.length);if(e.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>e.length?i:Pn(e.substr(0,e.length-i.length))+i;if(o=e.match(xC))return y4(o,l,c);if(e.match(/^#+0+$/))return c+Wr(l,e.length-e.indexOf("0"));if(o=e.match(EC))return i=(""+t).replace(/^([^\.]+)$/,"$1."+Pn(o[1])).replace(/\.$/,"."+Pn(o[1])),i=i.replace(/\.(\d*)$/,function(m,p){return"."+p+Lt("0",Pn(o[1]).length-p.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return c+yo(""+l);if(o=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+di(n,e,-t):yo(""+t)+"."+Lt("0",o[1].length);if(o=e.match(/^#,#*,#0/))return di(n,e.replace(/^#,#*,/,""),t);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=wa(di(n,e.replace(/[\\-]/g,""),t)),s=0,wa(wa(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return s<i.length?i.charAt(s++):m==="0"?"0":""}));if(e.match(wC))return i=di(n,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(o[4].length,7),a=nh(l,Math.pow(10,s)-1,!1),i=""+c,u=Pi("n",o[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+o[2]+"/"+o[3],u=eh(a[2],s),u.length<o[4].length&&(u=Pn(o[4].substr(o[4].length-u.length))+u),i+=u,i;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(o[1].length,o[4].length),7),a=nh(l,Math.pow(10,s)-1,!0),c+(a[0]||(a[1]?"":"0"))+" "+(a[1]?Dv(a[1],s)+o[2]+"/"+o[3]+eh(a[2],s):Lt(" ",2*s+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return i=""+t,e.length<=i.length?i:Pn(e.substr(0,e.length-i.length))+i;if(o=e.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var f=e.indexOf(".")-s,h=e.length-i.length-f;return Pn(e.substr(0,f)+i+e.substr(e.length-h))}if(o=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+di(n,e,-t):yo(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Wr(0,3-m.length):"")+m})+"."+Wr(0,o[1].length);switch(e){case"###,###":case"##,###":case"#,###":var d=yo(""+l);return d!=="0"?c+d:"";default:if(e.match(/\.[0#?]*$/))return di(n,e.slice(0,e.lastIndexOf(".")),t)+Pn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Pi(n,e,t){return(t|0)===t?di(n,e,t):Dr(n,e,t)}function C4(n){for(var e=[],t=!1,r=0,i=0;r<n.length;++r)switch(n.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=n.substr(i,r-i),i=r+1}if(e[e.length]=n.substr(i),t===!0)throw new Error("Format |"+n+"| unterminated string ");return e}var DC=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function SC(n){for(var e=0,t="",r="";e<n.length;)switch(t=n.charAt(e)){case"G":th(n,e)&&(e+=6),e++;break;case'"':for(;n.charCodeAt(++e)!==34&&e<n.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(n.charAt(e+1)==="1"||n.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(n.substr(e,3).toUpperCase()==="A/P"||n.substr(e,5).toUpperCase()==="AM/PM"||n.substr(e,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++e;break;case"[":for(r=t;n.charAt(e++)!=="]"&&e<n.length;)r+=n.charAt(e);if(r.match(DC))return!0;break;case".":case"0":case"#":for(;e<n.length&&("0#?.,E+-%".indexOf(t=n.charAt(++e))>-1||t=="\\"&&n.charAt(e+1)=="-"&&"0#".indexOf(n.charAt(e+2))>-1););break;case"?":for(;n.charAt(++e)===t;);break;case"*":++e,(n.charAt(e)==" "||n.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<n.length&&"0123456789".indexOf(n.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function D4(n,e,t,r){for(var i=[],o="",s=0,a="",l="t",c,u,f,h="H";s<n.length;)switch(a=n.charAt(s)){case"G":if(!th(n,s))throw new Error("unrecognized character "+a+" in "+n);i[i.length]={t:"G",v:"General"},s+=7;break;case'"':for(o="";(f=n.charCodeAt(++s))!==34&&s<n.length;)o+=String.fromCharCode(f);i[i.length]={t:"t",v:o},++s;break;case"\\":var d=n.charAt(++s),m=d==="("||d===")"?d:"t";i[i.length]={t:m,v:d},++s;break;case"_":i[i.length]={t:"t",v:" "},s+=2;break;case"@":i[i.length]={t:"T",v:e},++s;break;case"B":case"b":if(n.charAt(s+1)==="1"||n.charAt(s+1)==="2"){if(c==null&&(c=qd(e,t,n.charAt(s+1)==="2"),c==null))return"";i[i.length]={t:"X",v:n.substr(s,2)},l=a,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":a=a.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=qd(e,t),c==null))return"";for(o=a;++s<n.length&&n.charAt(s).toLowerCase()===a;)o+=a;a==="m"&&l.toLowerCase()==="h"&&(a="M"),a==="h"&&(a=h),i[i.length]={t:a,v:o},l=a;break;case"A":case"a":case"\u4E0A":var p={t:a,v:a};if(c==null&&(c=qd(e,t)),n.substr(s,3).toUpperCase()==="A/P"?(c!=null&&(p.v=c.H>=12?"P":"A"),p.t="T",h="h",s+=3):n.substr(s,5).toUpperCase()==="AM/PM"?(c!=null&&(p.v=c.H>=12?"PM":"AM"),p.t="T",s+=5,h="h"):n.substr(s,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(c!=null&&(p.v=c.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),p.t="T",s+=5,h="h"):(p.t="t",++s),c==null&&p.t==="T")return"";i[i.length]=p,l=a;break;case"[":for(o=a;n.charAt(s++)!=="]"&&s<n.length;)o+=n.charAt(s);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(DC)){if(c==null&&(c=qd(e,t),c==null))return"";i[i.length]={t:"Z",v:o.toLowerCase()},l=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",SC(n)||(i[i.length]={t:"t",v:o}));break;case".":if(c!=null){for(o=a;++s<n.length&&(a=n.charAt(s))==="0";)o+=a;i[i.length]={t:"s",v:o};break}case"0":case"#":for(o=a;++s<n.length&&"0#?.,E+-%".indexOf(a=n.charAt(s))>-1;)o+=a;i[i.length]={t:"n",v:o};break;case"?":for(o=a;n.charAt(++s)===a;)o+=a;i[i.length]={t:a,v:o},l=a;break;case"*":++s,(n.charAt(s)==" "||n.charAt(s)=="*")&&++s;break;case"(":case")":i[i.length]={t:r===1?"t":a,v:a},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=a;s<n.length&&"0123456789".indexOf(n.charAt(++s))>-1;)o+=n.charAt(s);i[i.length]={t:"D",v:o};break;case" ":i[i.length]={t:a,v:a},++s;break;case"$":i[i.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(a)===-1)throw new Error("unrecognized character "+a+" in "+n);i[i.length]={t:"t",v:a},++s;break}var g=0,w=0,y;for(s=i.length-1,l="t";s>=0;--s)switch(i[s].t){case"h":case"H":i[s].t=h,l="h",g<1&&(g=1);break;case"s":(y=i[s].v.match(/\.0+$/))&&(w=Math.max(w,y[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":l=i[s].t;break;case"m":l==="s"&&(i[s].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&i[s].v.match(/[Hh]/)&&(g=1),g<2&&i[s].v.match(/[Mm]/)&&(g=2),g<3&&i[s].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var S="",B;for(s=0;s<i.length;++s)switch(i[s].t){case"t":case"T":case" ":case"D":break;case"X":i[s].v="",i[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[s].v=m4(i[s].t.charCodeAt(0),i[s].v,c,w),i[s].t="t";break;case"n":case"?":for(B=s+1;i[B]!=null&&((a=i[B].t)==="?"||a==="D"||(a===" "||a==="t")&&i[B+1]!=null&&(i[B+1].t==="?"||i[B+1].t==="t"&&i[B+1].v==="/")||i[s].t==="("&&(a===" "||a==="n"||a===")")||a==="t"&&(i[B].v==="/"||i[B].v===" "&&i[B+1]!=null&&i[B+1].t=="?"));)i[s].v+=i[B].v,i[B]={v:"",t:";"},++B;S+=i[s].v,s=B-1;break;case"G":i[s].t="t",i[s].v=Ev(e,t);break}var Z="",ce,O;if(S.length>0){S.charCodeAt(0)==40?(ce=e<0&&S.charCodeAt(0)===45?-e:e,O=Pi("n",S,ce)):(ce=e<0&&r>1?-e:e,O=Pi("n",S,ce),ce<0&&i[0]&&i[0].t=="t"&&(O=O.substr(1),i[0].v="-"+i[0].v)),B=O.length-1;var L=i.length;for(s=0;s<i.length;++s)if(i[s]!=null&&i[s].t!="t"&&i[s].v.indexOf(".")>-1){L=s;break}var G=i.length;if(L===i.length&&O.indexOf("E")===-1){for(s=i.length-1;s>=0;--s)i[s]==null||"n?".indexOf(i[s].t)===-1||(B>=i[s].v.length-1?(B-=i[s].v.length,i[s].v=O.substr(B+1,i[s].v.length)):B<0?i[s].v="":(i[s].v=O.substr(0,B+1),B=-1),i[s].t="t",G=s);B>=0&&G<i.length&&(i[G].v=O.substr(0,B+1)+i[G].v)}else if(L!==i.length&&O.indexOf("E")===-1){for(B=O.indexOf(".")-1,s=L;s>=0;--s)if(!(i[s]==null||"n?".indexOf(i[s].t)===-1)){for(u=i[s].v.indexOf(".")>-1&&s===L?i[s].v.indexOf(".")-1:i[s].v.length-1,Z=i[s].v.substr(u+1);u>=0;--u)B>=0&&(i[s].v.charAt(u)==="0"||i[s].v.charAt(u)==="#")&&(Z=O.charAt(B--)+Z);i[s].v=Z,i[s].t="t",G=s}for(B>=0&&G<i.length&&(i[G].v=O.substr(0,B+1)+i[G].v),B=O.indexOf(".")+1,s=L;s<i.length;++s)if(!(i[s]==null||"n?(".indexOf(i[s].t)===-1&&s!==L)){for(u=i[s].v.indexOf(".")>-1&&s===L?i[s].v.indexOf(".")+1:0,Z=i[s].v.substr(0,u);u<i[s].v.length;++u)B<O.length&&(Z+=O.charAt(B++));i[s].v=Z,i[s].t="t",G=s}}}for(s=0;s<i.length;++s)i[s]!=null&&"n?".indexOf(i[s].t)>-1&&(ce=r>1&&e<0&&s>0&&i[s-1].v==="-"?-e:e,i[s].v=Pi(i[s].t,i[s].v,ce),i[s].t="t");var V="";for(s=0;s!==i.length;++s)i[s]!=null&&(V+=i[s].v);return V}var Pw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Lw(n,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(n==t)return!0;break;case">":if(n>t)return!0;break;case"<":if(n<t)return!0;break;case"<>":if(n!=t)return!0;break;case">=":if(n>=t)return!0;break;case"<=":if(n<=t)return!0;break}return!1}function S4(n,e){var t=C4(n),r=t.length,i=t[r-1].indexOf("@");if(r<4&&i>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break;case 4:break}var o=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,o];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var s=t[0].match(Pw),a=t[1].match(Pw);return Lw(e,s)?[r,t[0]]:Lw(e,a)?[r,t[1]]:[r,t[s!=null&&a!=null?2:1]]}return[r,o]}function xo(n,e,t){t==null&&(t={});var r="";switch(typeof n){case"string":n=="m/d/yy"&&t.dateNF?r=t.dateNF:r=n;break;case"number":n==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:Bt)[n],r==null&&(r=t.table&&t.table[Mw[n]]||Bt[Mw[n]]),r==null&&(r=a4[n]||"General");break}if(th(r,0))return Ev(e,t);e instanceof Date&&(e=vC(e,t.date1904));var i=S4(r,e);if(th(i[1]))return Ev(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return D4(i[1],e,t,i[0])}function bC(n,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(Bt[t]==null){e<0&&(e=t);continue}if(Bt[t]==n){e=t;break}}e<0&&(e=391)}return Bt[e]=n,e}function ph(n){for(var e=0;e!=392;++e)n[e]!==void 0&&bC(n[e],e)}function mh(){Bt=s4()}var IC=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function b4(n){var e=typeof n=="number"?Bt[n]:n;return e=e.replace(IC,"(\\d+)"),new RegExp("^"+e+"$")}function I4(n,e,t){var r=-1,i=-1,o=-1,s=-1,a=-1,l=-1;(e.match(IC)||[]).forEach(function(f,h){var d=parseInt(t[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":r=d;break;case"d":o=d;break;case"h":s=d;break;case"s":l=d;break;case"m":s>=0?a=d:i=d;break}}),l>=0&&a==-1&&i>=0&&(a=i,i=-1);var c=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return s==-1&&a==-1&&l==-1?c:r==-1&&i==-1&&o==-1?u:c+"T"+u}var A4=function(){var n={};n.version="1.2.0";function e(){for(var O=0,L=new Array(256),G=0;G!=256;++G)O=G,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,L[G]=O;return typeof Int32Array<"u"?new Int32Array(L):L}var t=e();function r(O){var L=0,G=0,V=0,K=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(V=0;V!=256;++V)K[V]=O[V];for(V=0;V!=256;++V)for(G=O[V],L=256+V;L<4096;L+=256)G=K[L]=G>>>8^O[G&255];var W=[];for(V=1;V!=16;++V)W[V-1]=typeof Int32Array<"u"?K.subarray(V*256,V*256+256):K.slice(V*256,V*256+256);return W}var i=r(t),o=i[0],s=i[1],a=i[2],l=i[3],c=i[4],u=i[5],f=i[6],h=i[7],d=i[8],m=i[9],p=i[10],g=i[11],w=i[12],y=i[13],S=i[14];function B(O,L){for(var G=L^-1,V=0,K=O.length;V<K;)G=G>>>8^t[(G^O.charCodeAt(V++))&255];return~G}function Z(O,L){for(var G=L^-1,V=O.length-15,K=0;K<V;)G=S[O[K++]^G&255]^y[O[K++]^G>>8&255]^w[O[K++]^G>>16&255]^g[O[K++]^G>>>24]^p[O[K++]]^m[O[K++]]^d[O[K++]]^h[O[K++]]^f[O[K++]]^u[O[K++]]^c[O[K++]]^l[O[K++]]^a[O[K++]]^s[O[K++]]^o[O[K++]]^t[O[K++]];for(V+=15;K<V;)G=G>>>8^t[(G^O[K++])&255];return~G}function ce(O,L){for(var G=L^-1,V=0,K=O.length,W=0,ue=0;V<K;)W=O.charCodeAt(V++),W<128?G=G>>>8^t[(G^W)&255]:W<2048?(G=G>>>8^t[(G^(192|W>>6&31))&255],G=G>>>8^t[(G^(128|W&63))&255]):W>=55296&&W<57344?(W=(W&1023)+64,ue=O.charCodeAt(V++)&1023,G=G>>>8^t[(G^(240|W>>8&7))&255],G=G>>>8^t[(G^(128|W>>2&63))&255],G=G>>>8^t[(G^(128|ue>>6&15|(W&3)<<4))&255],G=G>>>8^t[(G^(128|ue&63))&255]):(G=G>>>8^t[(G^(224|W>>12&15))&255],G=G>>>8^t[(G^(128|W>>6&63))&255],G=G>>>8^t[(G^(128|W&63))&255]);return~G}return n.table=t,n.bstr=B,n.buf=Z,n.str=ce,n}(),gt=function(){var e={};e.version="1.2.1";function t(v,D){for(var x=v.split("/"),T=D.split("/"),b=0,I=0,z=Math.min(x.length,T.length);b<z;++b){if(I=x[b].length-T[b].length)return I;if(x[b]!=T[b])return x[b]<T[b]?-1:1}return x.length-T.length}function r(v){if(v.charAt(v.length-1)=="/")return v.slice(0,-1).indexOf("/")===-1?v:r(v.slice(0,-1));var D=v.lastIndexOf("/");return D===-1?v:v.slice(0,D+1)}function i(v){if(v.charAt(v.length-1)=="/")return i(v.slice(0,-1));var D=v.lastIndexOf("/");return D===-1?v:v.slice(D+1)}function o(v,D){typeof D=="string"&&(D=new Date(D));var x=D.getHours();x=x<<6|D.getMinutes(),x=x<<5|D.getSeconds()>>>1,v.write_shift(2,x);var T=D.getFullYear()-1980;T=T<<4|D.getMonth()+1,T=T<<5|D.getDate(),v.write_shift(2,T)}function s(v){var D=v.read_shift(2)&65535,x=v.read_shift(2)&65535,T=new Date,b=x&31;x>>>=5;var I=x&15;x>>>=4,T.setMilliseconds(0),T.setFullYear(x+1980),T.setMonth(I-1),T.setDate(b);var z=D&31;D>>>=5;var ne=D&63;return D>>>=6,T.setHours(D),T.setMinutes(ne),T.setSeconds(z<<1),T}function a(v){ur(v,0);for(var D={},x=0;v.l<=v.length-4;){var T=v.read_shift(2),b=v.read_shift(2),I=v.l+b,z={};switch(T){case 21589:x=v.read_shift(1),x&1&&(z.mtime=v.read_shift(4)),b>5&&(x&2&&(z.atime=v.read_shift(4)),x&4&&(z.ctime=v.read_shift(4))),z.mtime&&(z.mt=new Date(z.mtime*1e3));break}v.l=I,D[T]=z}return D}var l;function c(){return l||(l={})}function u(v,D){if(v[0]==80&&v[1]==75)return Q1(v,D);if((v[0]|32)==109&&(v[1]|32)==105)return Qb(v,D);if(v.length<512)throw new Error("CFB file size "+v.length+" < 512");var x=3,T=512,b=0,I=0,z=0,ne=0,Y=0,q=[],X=v.slice(0,512);ur(X,0);var de=f(X);switch(x=de[0],x){case 3:T=512;break;case 4:T=4096;break;case 0:if(de[1]==0)return Q1(v,D);default:throw new Error("Major Version: Expected 3 or 4 saw "+x)}T!==512&&(X=v.slice(0,T),ur(X,28));var ye=v.slice(0,T);h(X,x);var Ae=X.read_shift(4,"i");if(x===3&&Ae!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ae);X.l+=4,z=X.read_shift(4,"i"),X.l+=4,X.chk("00100000","Mini Stream Cutoff Size: "),ne=X.read_shift(4,"i"),b=X.read_shift(4,"i"),Y=X.read_shift(4,"i"),I=X.read_shift(4,"i");for(var xe=-1,we=0;we<109&&(xe=X.read_shift(4,"i"),!(xe<0));++we)q[we]=xe;var Ue=d(v,T);g(Y,I,Ue,T,q);var Tt=y(Ue,z,q,T);Tt[z].name="!Directory",b>0&&ne!==ue&&(Tt[ne].name="!MiniFAT"),Tt[q[0]].name="!FAT",Tt.fat_addrs=q,Tt.ssz=T;var jn={},Vt=[],Qn=[],Wa=[];S(z,Tt,Ue,Vt,b,jn,Qn,ne),m(Qn,Wa,Vt),Vt.shift();var za={FileIndex:Qn,FullPaths:Wa};return D&&D.raw&&(za.raw={header:ye,sectors:Ue}),za}function f(v){if(v[v.l]==80&&v[v.l+1]==75)return[0,0];v.chk(Oe,"Header Signature: "),v.l+=16;var D=v.read_shift(2,"u");return[v.read_shift(2,"u"),D]}function h(v,D){var x=9;switch(v.l+=2,x=v.read_shift(2)){case 9:if(D!=3)throw new Error("Sector Shift: Expected 9 saw "+x);break;case 12:if(D!=4)throw new Error("Sector Shift: Expected 12 saw "+x);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+x)}v.chk("0600","Mini Sector Shift: "),v.chk("000000000000","Reserved: ")}function d(v,D){for(var x=Math.ceil(v.length/D)-1,T=[],b=1;b<x;++b)T[b-1]=v.slice(b*D,(b+1)*D);return T[x-1]=v.slice(x*D),T}function m(v,D,x){for(var T=0,b=0,I=0,z=0,ne=0,Y=x.length,q=[],X=[];T<Y;++T)q[T]=X[T]=T,D[T]=x[T];for(;ne<X.length;++ne)T=X[ne],b=v[T].L,I=v[T].R,z=v[T].C,q[T]===T&&(b!==-1&&q[b]!==b&&(q[T]=q[b]),I!==-1&&q[I]!==I&&(q[T]=q[I])),z!==-1&&(q[z]=T),b!==-1&&T!=q[T]&&(q[b]=q[T],X.lastIndexOf(b)<ne&&X.push(b)),I!==-1&&T!=q[T]&&(q[I]=q[T],X.lastIndexOf(I)<ne&&X.push(I));for(T=1;T<Y;++T)q[T]===T&&(I!==-1&&q[I]!==I?q[T]=q[I]:b!==-1&&q[b]!==b&&(q[T]=q[b]));for(T=1;T<Y;++T)if(v[T].type!==0){if(ne=T,ne!=q[ne])do ne=q[ne],D[T]=D[ne]+"/"+D[T];while(ne!==0&&q[ne]!==-1&&ne!=q[ne]);q[T]=-1}for(D[0]+="/",T=1;T<Y;++T)v[T].type!==2&&(D[T]+="/")}function p(v,D,x){for(var T=v.start,b=v.size,I=[],z=T;x&&b>0&&z>=0;)I.push(D.slice(z*W,z*W+W)),b-=W,z=as(x,z*4);return I.length===0?te(0):vn(I).slice(0,v.size)}function g(v,D,x,T,b){var I=ue;if(v===ue){if(D!==0)throw new Error("DIFAT chain shorter than expected")}else if(v!==-1){var z=x[v],ne=(T>>>2)-1;if(!z)return;for(var Y=0;Y<ne&&(I=as(z,Y*4))!==ue;++Y)b.push(I);g(as(z,T-4),D-1,x,T,b)}}function w(v,D,x,T,b){var I=[],z=[];b||(b=[]);var ne=T-1,Y=0,q=0;for(Y=D;Y>=0;){b[Y]=!0,I[I.length]=Y,z.push(v[Y]);var X=x[Math.floor(Y*4/T)];if(q=Y*4&ne,T<4+q)throw new Error("FAT boundary crossed: "+Y+" 4 "+T);if(!v[X])break;Y=as(v[X],q)}return{nodes:I,data:Ww([z])}}function y(v,D,x,T){var b=v.length,I=[],z=[],ne=[],Y=[],q=T-1,X=0,de=0,ye=0,Ae=0;for(X=0;X<b;++X)if(ne=[],ye=X+D,ye>=b&&(ye-=b),!z[ye]){Y=[];var xe=[];for(de=ye;de>=0;){xe[de]=!0,z[de]=!0,ne[ne.length]=de,Y.push(v[de]);var we=x[Math.floor(de*4/T)];if(Ae=de*4&q,T<4+Ae)throw new Error("FAT boundary crossed: "+de+" 4 "+T);if(!v[we]||(de=as(v[we],Ae),xe[de]))break}I[ye]={nodes:ne,data:Ww([Y])}}return I}function S(v,D,x,T,b,I,z,ne){for(var Y=0,q=T.length?2:0,X=D[v].data,de=0,ye=0,Ae;de<X.length;de+=128){var xe=X.slice(de,de+128);ur(xe,64),ye=xe.read_shift(2),Ae=_h(xe,0,ye-q),T.push(Ae);var we={name:Ae,type:xe.read_shift(1),color:xe.read_shift(1),L:xe.read_shift(4,"i"),R:xe.read_shift(4,"i"),C:xe.read_shift(4,"i"),clsid:xe.read_shift(16),state:xe.read_shift(4,"i"),start:0,size:0},Ue=xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2);Ue!==0&&(we.ct=B(xe,xe.l-8));var Tt=xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2);Tt!==0&&(we.mt=B(xe,xe.l-8)),we.start=xe.read_shift(4,"i"),we.size=xe.read_shift(4,"i"),we.size<0&&we.start<0&&(we.size=we.type=0,we.start=ue,we.name=""),we.type===5?(Y=we.start,b>0&&Y!==ue&&(D[Y].name="!StreamData")):we.size>=4096?(we.storage="fat",D[we.start]===void 0&&(D[we.start]=w(x,we.start,D.fat_addrs,D.ssz)),D[we.start].name=we.name,we.content=D[we.start].data.slice(0,we.size)):(we.storage="minifat",we.size<0?we.size=0:Y!==ue&&we.start!==ue&&D[Y]&&(we.content=p(we,D[Y].data,(D[ne]||{}).data))),we.content&&ur(we.content,0),I[Ae]=we,z.push(we)}}function B(v,D){return new Date((cn(v,D+4)/1e7*Math.pow(2,32)+cn(v,D)/1e7-11644473600)*1e3)}function Z(v,D){return c(),u(l.readFileSync(v),D)}function ce(v,D){var x=D&&D.type;switch(x||st&&Buffer.isBuffer(v)&&(x="buffer"),x||"base64"){case"file":return Z(v,D);case"base64":return u($r(Vi(v)),D);case"binary":return u($r(v),D)}return u(v,D)}function O(v,D){var x=D||{},T=x.root||"Root Entry";if(v.FullPaths||(v.FullPaths=[]),v.FileIndex||(v.FileIndex=[]),v.FullPaths.length!==v.FileIndex.length)throw new Error("inconsistent CFB structure");v.FullPaths.length===0&&(v.FullPaths[0]=T+"/",v.FileIndex[0]={name:T,type:5}),x.CLSID&&(v.FileIndex[0].clsid=x.CLSID),L(v)}function L(v){var D="Sh33tJ5";if(!gt.find(v,"/"+D)){var x=te(4);x[0]=55,x[1]=x[3]=50,x[2]=54,v.FileIndex.push({name:D,type:2,content:x,size:4,L:69,R:69,C:69}),v.FullPaths.push(v.FullPaths[0]+D),G(v)}}function G(v,D){O(v);for(var x=!1,T=!1,b=v.FullPaths.length-1;b>=0;--b){var I=v.FileIndex[b];switch(I.type){case 0:T?x=!0:(v.FileIndex.pop(),v.FullPaths.pop());break;case 1:case 2:case 5:T=!0,isNaN(I.R*I.L*I.C)&&(x=!0),I.R>-1&&I.L>-1&&I.R==I.L&&(x=!0);break;default:x=!0;break}}if(!(!x&&!D)){var z=new Date(1987,1,19),ne=0,Y=Object.create?Object.create(null):{},q=[];for(b=0;b<v.FullPaths.length;++b)Y[v.FullPaths[b]]=!0,v.FileIndex[b].type!==0&&q.push([v.FullPaths[b],v.FileIndex[b]]);for(b=0;b<q.length;++b){var X=r(q[b][0]);T=Y[X],T||(q.push([X,{name:i(X).replace("/",""),type:1,clsid:ie,ct:z,mt:z,content:null}]),Y[X]=!0)}for(q.sort(function(Ae,xe){return t(Ae[0],xe[0])}),v.FullPaths=[],v.FileIndex=[],b=0;b<q.length;++b)v.FullPaths[b]=q[b][0],v.FileIndex[b]=q[b][1];for(b=0;b<q.length;++b){var de=v.FileIndex[b],ye=v.FullPaths[b];if(de.name=i(ye).replace("/",""),de.L=de.R=de.C=-(de.color=1),de.size=de.content?de.content.length:0,de.start=0,de.clsid=de.clsid||ie,b===0)de.C=q.length>1?1:-1,de.size=0,de.type=5;else if(ye.slice(-1)=="/"){for(ne=b+1;ne<q.length&&r(v.FullPaths[ne])!=ye;++ne);for(de.C=ne>=q.length?-1:ne,ne=b+1;ne<q.length&&r(v.FullPaths[ne])!=r(ye);++ne);de.R=ne>=q.length?-1:ne,de.type=1}else r(v.FullPaths[b+1]||"")==r(ye)&&(de.R=b+1),de.type=2}}}function V(v,D){var x=D||{};if(x.fileType=="mad")return Jb(v,x);switch(G(v),x.fileType){case"zip":return zb(v,x)}var T=function(Ae){for(var xe=0,we=0,Ue=0;Ue<Ae.FileIndex.length;++Ue){var Tt=Ae.FileIndex[Ue];if(Tt.content){var jn=Tt.content.length;jn>0&&(jn<4096?xe+=jn+63>>6:we+=jn+511>>9)}}for(var Vt=Ae.FullPaths.length+3>>2,Qn=xe+7>>3,Wa=xe+127>>7,za=Qn+we+Vt+Wa,No=za+127>>7,o0=No<=109?0:Math.ceil((No-109)/127);za+No+o0+127>>7>No;)o0=++No<=109?0:Math.ceil((No-109)/127);var _i=[1,o0,No,Wa,Vt,we,xe,0];return Ae.FileIndex[0].size=xe<<6,_i[7]=(Ae.FileIndex[0].start=_i[0]+_i[1]+_i[2]+_i[3]+_i[4]+_i[5])+(_i[6]+7>>3),_i}(v),b=te(T[7]<<9),I=0,z=0;{for(I=0;I<8;++I)b.write_shift(1,Te[I]);for(I=0;I<8;++I)b.write_shift(2,0);for(b.write_shift(2,62),b.write_shift(2,3),b.write_shift(2,65534),b.write_shift(2,9),b.write_shift(2,6),I=0;I<3;++I)b.write_shift(2,0);for(b.write_shift(4,0),b.write_shift(4,T[2]),b.write_shift(4,T[0]+T[1]+T[2]+T[3]-1),b.write_shift(4,0),b.write_shift(4,4096),b.write_shift(4,T[3]?T[0]+T[1]+T[2]-1:ue),b.write_shift(4,T[3]),b.write_shift(-4,T[1]?T[0]-1:ue),b.write_shift(4,T[1]),I=0;I<109;++I)b.write_shift(-4,I<T[2]?T[1]+I:-1)}if(T[1])for(z=0;z<T[1];++z){for(;I<236+z*127;++I)b.write_shift(-4,I<T[2]?T[1]+I:-1);b.write_shift(-4,z===T[1]-1?ue:z+1)}var ne=function(Ae){for(z+=Ae;I<z-1;++I)b.write_shift(-4,I+1);Ae&&(++I,b.write_shift(-4,ue))};for(z=I=0,z+=T[1];I<z;++I)b.write_shift(-4,ee.DIFSECT);for(z+=T[2];I<z;++I)b.write_shift(-4,ee.FATSECT);ne(T[3]),ne(T[4]);for(var Y=0,q=0,X=v.FileIndex[0];Y<v.FileIndex.length;++Y)X=v.FileIndex[Y],X.content&&(q=X.content.length,!(q<4096)&&(X.start=z,ne(q+511>>9)));for(ne(T[6]+7>>3);b.l&511;)b.write_shift(-4,ee.ENDOFCHAIN);for(z=I=0,Y=0;Y<v.FileIndex.length;++Y)X=v.FileIndex[Y],X.content&&(q=X.content.length,!(!q||q>=4096)&&(X.start=z,ne(q+63>>6)));for(;b.l&511;)b.write_shift(-4,ee.ENDOFCHAIN);for(I=0;I<T[4]<<2;++I){var de=v.FullPaths[I];if(!de||de.length===0){for(Y=0;Y<17;++Y)b.write_shift(4,0);for(Y=0;Y<3;++Y)b.write_shift(4,-1);for(Y=0;Y<12;++Y)b.write_shift(4,0);continue}X=v.FileIndex[I],I===0&&(X.start=X.size?X.start-1:ue);var ye=I===0&&x.root||X.name;if(q=2*(ye.length+1),b.write_shift(64,ye,"utf16le"),b.write_shift(2,q),b.write_shift(1,X.type),b.write_shift(1,X.color),b.write_shift(-4,X.L),b.write_shift(-4,X.R),b.write_shift(-4,X.C),X.clsid)b.write_shift(16,X.clsid,"hex");else for(Y=0;Y<4;++Y)b.write_shift(4,0);b.write_shift(4,X.state||0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,X.start),b.write_shift(4,X.size),b.write_shift(4,0)}for(I=1;I<v.FileIndex.length;++I)if(X=v.FileIndex[I],X.size>=4096)if(b.l=X.start+1<<9,st&&Buffer.isBuffer(X.content))X.content.copy(b,b.l,0,X.size),b.l+=X.size+511&-512;else{for(Y=0;Y<X.size;++Y)b.write_shift(1,X.content[Y]);for(;Y&511;++Y)b.write_shift(1,0)}for(I=1;I<v.FileIndex.length;++I)if(X=v.FileIndex[I],X.size>0&&X.size<4096)if(st&&Buffer.isBuffer(X.content))X.content.copy(b,b.l,0,X.size),b.l+=X.size+63&-64;else{for(Y=0;Y<X.size;++Y)b.write_shift(1,X.content[Y]);for(;Y&63;++Y)b.write_shift(1,0)}if(st)b.l=b.length;else for(;b.l<b.length;)b.write_shift(1,0);return b}function K(v,D){var x=v.FullPaths.map(function(Y){return Y.toUpperCase()}),T=x.map(function(Y){var q=Y.split("/");return q[q.length-(Y.slice(-1)=="/"?2:1)]}),b=!1;D.charCodeAt(0)===47?(b=!0,D=x[0].slice(0,-1)+D):b=D.indexOf("/")!==-1;var I=D.toUpperCase(),z=b===!0?x.indexOf(I):T.indexOf(I);if(z!==-1)return v.FileIndex[z];var ne=!I.match(zd);for(I=I.replace(Ta,""),ne&&(I=I.replace(zd,"!")),z=0;z<x.length;++z)if((ne?x[z].replace(zd,"!"):x[z]).replace(Ta,"")==I||(ne?T[z].replace(zd,"!"):T[z]).replace(Ta,"")==I)return v.FileIndex[z];return null}var W=64,ue=-2,Oe="d0cf11e0a1b11ae1",Te=[208,207,17,224,161,177,26,225],ie="00000000000000000000000000000000",ee={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ue,FREESECT:-1,HEADER_SIGNATURE:Oe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ie,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function k(v,D,x){c();var T=V(v,x);l.writeFileSync(D,T)}function R(v){for(var D=new Array(v.length),x=0;x<v.length;++x)D[x]=String.fromCharCode(v[x]);return D.join("")}function pe(v,D){var x=V(v,D);switch(D&&D.type||"buffer"){case"file":return c(),l.writeFileSync(D.filename,x),x;case"binary":return typeof x=="string"?x:R(x);case"base64":return xc(typeof x=="string"?x:R(x));case"buffer":if(st)return Buffer.isBuffer(x)?x:ji(x);case"array":return typeof x=="string"?$r(x):x}return x}var De;function F(v){try{var D=v.InflateRaw,x=new D;if(x._processChunk(new Uint8Array([3,0]),x._finishFlushFlag),x.bytesRead)De=v;else throw new Error("zlib does not expose bytesRead")}catch(T){console.error("cannot use native zlib: "+(T.message||T))}}function U(v,D){if(!De)return X1(v,D);var x=De.InflateRaw,T=new x,b=T._processChunk(v.slice(v.l),T._finishFlushFlag);return v.l+=T.bytesRead,b}function M(v){return De?De.deflateRawSync(v):ko(v)}var P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],se=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],he=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Q(v){var D=(v<<1|v<<11)&139536|(v<<5|v<<15)&558144;return(D>>16|D>>8|D)&255}for(var j=typeof Uint8Array<"u",N=j?new Uint8Array(256):[],oe=0;oe<256;++oe)N[oe]=Q(oe);function ge(v,D){var x=N[v&255];return D<=8?x>>>8-D:(x=x<<8|N[v>>8&255],D<=16?x>>>16-D:(x=x<<8|N[v>>16&255],x>>>24-D))}function Fe(v,D){var x=D&7,T=D>>>3;return(v[T]|(x<=6?0:v[T+1]<<8))>>>x&3}function me(v,D){var x=D&7,T=D>>>3;return(v[T]|(x<=5?0:v[T+1]<<8))>>>x&7}function Ne(v,D){var x=D&7,T=D>>>3;return(v[T]|(x<=4?0:v[T+1]<<8))>>>x&15}function ke(v,D){var x=D&7,T=D>>>3;return(v[T]|(x<=3?0:v[T+1]<<8))>>>x&31}function fe(v,D){var x=D&7,T=D>>>3;return(v[T]|(x<=1?0:v[T+1]<<8))>>>x&127}function Xe(v,D,x){var T=D&7,b=D>>>3,I=(1<<x)-1,z=v[b]>>>T;return x<8-T||(z|=v[b+1]<<8-T,x<16-T)||(z|=v[b+2]<<16-T,x<24-T)||(z|=v[b+3]<<24-T),z&I}function et(v,D,x){var T=D&7,b=D>>>3;return T<=5?v[b]|=(x&7)<<T:(v[b]|=x<<T&255,v[b+1]=(x&7)>>8-T),D+3}function En(v,D,x){var T=D&7,b=D>>>3;return x=(x&1)<<T,v[b]|=x,D+1}function hn(v,D,x){var T=D&7,b=D>>>3;return x<<=T,v[b]|=x&255,x>>>=8,v[b+1]=x,D+8}function vi(v,D,x){var T=D&7,b=D>>>3;return x<<=T,v[b]|=x&255,x>>>=8,v[b+1]=x&255,v[b+2]=x>>>8,D+16}function Ao(v,D){var x=v.length,T=2*x>D?2*x:D+5,b=0;if(x>=D)return v;if(st){var I=Fw(T);if(v.copy)v.copy(I);else for(;b<v.length;++b)I[b]=v[b];return I}else if(j){var z=new Uint8Array(T);if(z.set)z.set(v);else for(;b<x;++b)z[b]=v[b];return z}return v.length=T,v}function Xn(v){for(var D=new Array(v),x=0;x<v;++x)D[x]=0;return D}function Ss(v,D,x){var T=1,b=0,I=0,z=0,ne=0,Y=v.length,q=j?new Uint16Array(32):Xn(32);for(I=0;I<32;++I)q[I]=0;for(I=Y;I<x;++I)v[I]=0;Y=v.length;var X=j?new Uint16Array(Y):Xn(Y);for(I=0;I<Y;++I)q[b=v[I]]++,T<b&&(T=b),X[I]=0;for(q[0]=0,I=1;I<=T;++I)q[I+16]=ne=ne+q[I-1]<<1;for(I=0;I<Y;++I)ne=v[I],ne!=0&&(X[I]=q[ne+16]++);var de=0;for(I=0;I<Y;++I)if(de=v[I],de!=0)for(ne=ge(X[I],T)>>T-de,z=(1<<T+4-de)-1;z>=0;--z)D[ne|z<<de]=de&15|I<<4;return T}var Fo=j?new Uint16Array(512):Xn(512),bs=j?new Uint16Array(32):Xn(32);if(!j){for(var Vn=0;Vn<512;++Vn)Fo[Vn]=0;for(Vn=0;Vn<32;++Vn)bs[Vn]=0}(function(){for(var v=[],D=0;D<32;D++)v.push(5);Ss(v,bs,32);var x=[];for(D=0;D<=143;D++)x.push(8);for(;D<=255;D++)x.push(9);for(;D<=279;D++)x.push(7);for(;D<=287;D++)x.push(8);Ss(x,Fo,288)})();var Wc=function(){for(var D=j?new Uint8Array(32768):[],x=0,T=0;x<he.length-1;++x)for(;T<he[x+1];++T)D[T]=x;for(;T<32768;++T)D[T]=29;var b=j?new Uint8Array(259):[];for(x=0,T=0;x<se.length-1;++x)for(;T<se[x+1];++T)b[T]=x;function I(ne,Y){for(var q=0;q<ne.length;){var X=Math.min(65535,ne.length-q),de=q+X==ne.length;for(Y.write_shift(1,+de),Y.write_shift(2,X),Y.write_shift(2,~X&65535);X-- >0;)Y[Y.l++]=ne[q++]}return Y.l}function z(ne,Y){for(var q=0,X=0,de=j?new Uint16Array(32768):[];X<ne.length;){var ye=Math.min(65535,ne.length-X);if(ye<10){for(q=et(Y,q,+(X+ye==ne.length)),q&7&&(q+=8-(q&7)),Y.l=q/8|0,Y.write_shift(2,ye),Y.write_shift(2,~ye&65535);ye-- >0;)Y[Y.l++]=ne[X++];q=Y.l*8;continue}q=et(Y,q,+(X+ye==ne.length)+2);for(var Ae=0;ye-- >0;){var xe=ne[X];Ae=(Ae<<5^xe)&32767;var we=-1,Ue=0;if((we=de[Ae])&&(we|=X&-32768,we>X&&(we-=32768),we<X))for(;ne[we+Ue]==ne[X+Ue]&&Ue<250;)++Ue;if(Ue>2){xe=b[Ue],xe<=22?q=hn(Y,q,N[xe+1]>>1)-1:(hn(Y,q,3),q+=5,hn(Y,q,N[xe-23]>>5),q+=3);var Tt=xe<8?0:xe-4>>2;Tt>0&&(vi(Y,q,Ue-se[xe]),q+=Tt),xe=D[X-we],q=hn(Y,q,N[xe]>>3),q-=3;var jn=xe<4?0:xe-2>>1;jn>0&&(vi(Y,q,X-we-he[xe]),q+=jn);for(var Vt=0;Vt<Ue;++Vt)de[Ae]=X&32767,Ae=(Ae<<5^ne[X])&32767,++X;ye-=Ue-1}else xe<=143?xe=xe+48:q=En(Y,q,1),q=hn(Y,q,N[xe]),de[Ae]=X&32767,++X}q=hn(Y,q,0)-1}return Y.l=(q+7)/8|0,Y.l}return function(Y,q){return Y.length<8?I(Y,q):z(Y,q)}}();function ko(v){var D=te(50+Math.floor(v.length*1.1)),x=Wc(v,D);return D.slice(0,x)}var Ga=j?new Uint16Array(32768):Xn(32768),$a=j?new Uint16Array(32768):Xn(32768),$i=j?new Uint16Array(128):Xn(128),Un=1,Zn=1;function Gb(v,D){var x=ke(v,D)+257;D+=5;var T=ke(v,D)+1;D+=5;var b=Ne(v,D)+4;D+=4;for(var I=0,z=j?new Uint8Array(19):Xn(19),ne=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Y=1,q=j?new Uint8Array(8):Xn(8),X=j?new Uint8Array(8):Xn(8),de=z.length,ye=0;ye<b;++ye)z[P[ye]]=I=me(v,D),Y<I&&(Y=I),q[I]++,D+=3;var Ae=0;for(q[0]=0,ye=1;ye<=Y;++ye)X[ye]=Ae=Ae+q[ye-1]<<1;for(ye=0;ye<de;++ye)(Ae=z[ye])!=0&&(ne[ye]=X[Ae]++);var xe=0;for(ye=0;ye<de;++ye)if(xe=z[ye],xe!=0){Ae=N[ne[ye]]>>8-xe;for(var we=(1<<7-xe)-1;we>=0;--we)$i[Ae|we<<xe]=xe&7|ye<<3}var Ue=[];for(Y=1;Ue.length<x+T;)switch(Ae=$i[fe(v,D)],D+=Ae&7,Ae>>>=3){case 16:for(I=3+Fe(v,D),D+=2,Ae=Ue[Ue.length-1];I-- >0;)Ue.push(Ae);break;case 17:for(I=3+me(v,D),D+=3;I-- >0;)Ue.push(0);break;case 18:for(I=11+fe(v,D),D+=7;I-- >0;)Ue.push(0);break;default:Ue.push(Ae),Y<Ae&&(Y=Ae);break}var Tt=Ue.slice(0,x),jn=Ue.slice(x);for(ye=x;ye<286;++ye)Tt[ye]=0;for(ye=T;ye<30;++ye)jn[ye]=0;return Un=Ss(Tt,Ga,286),Zn=Ss(jn,$a,30),D}function $b(v,D){if(v[0]==3&&!(v[1]&3))return[us(D),2];for(var x=0,T=0,b=Fw(D||1<<18),I=0,z=b.length>>>0,ne=0,Y=0;(T&1)==0;){if(T=me(v,x),x+=3,T>>>1)T>>1==1?(ne=9,Y=5):(x=Gb(v,x),ne=Un,Y=Zn);else{x&7&&(x+=8-(x&7));var q=v[x>>>3]|v[(x>>>3)+1]<<8;if(x+=32,q>0)for(!D&&z<I+q&&(b=Ao(b,I+q),z=b.length);q-- >0;)b[I++]=v[x>>>3],x+=8;continue}for(;;){!D&&z<I+32767&&(b=Ao(b,I+32767),z=b.length);var X=Xe(v,x,ne),de=T>>>1==1?Fo[X]:Ga[X];if(x+=de&15,de>>>=4,(de>>>8&255)===0)b[I++]=de;else{if(de==256)break;de-=257;var ye=de<8?0:de-4>>2;ye>5&&(ye=0);var Ae=I+se[de];ye>0&&(Ae+=Xe(v,x,ye),x+=ye),X=Xe(v,x,Y),de=T>>>1==1?bs[X]:$a[X],x+=de&15,de>>>=4;var xe=de<4?0:de-2>>1,we=he[de];for(xe>0&&(we+=Xe(v,x,xe),x+=xe),!D&&z<Ae&&(b=Ao(b,Ae+100),z=b.length);I<Ae;)b[I]=b[I-we],++I}}}return D?[b,x+7>>>3]:[b.slice(0,I),x+7>>>3]}function X1(v,D){var x=v.slice(v.l||0),T=$b(x,D);return v.l+=T[1],T[0]}function Z1(v,D){if(v)typeof console<"u"&&console.error(D);else throw new Error(D)}function Q1(v,D){var x=v;ur(x,0);var T=[],b=[],I={FileIndex:T,FullPaths:b};O(I,{root:D.root});for(var z=x.length-4;(x[z]!=80||x[z+1]!=75||x[z+2]!=5||x[z+3]!=6)&&z>=0;)--z;x.l=z+4,x.l+=4;var ne=x.read_shift(2);x.l+=6;var Y=x.read_shift(4);for(x.l=Y,z=0;z<ne;++z){x.l+=20;var q=x.read_shift(4),X=x.read_shift(4),de=x.read_shift(2),ye=x.read_shift(2),Ae=x.read_shift(2);x.l+=8;var xe=x.read_shift(4),we=a(x.slice(x.l+de,x.l+de+ye));x.l+=de+ye+Ae;var Ue=x.l;x.l=xe+4,Wb(x,q,X,I,we),x.l=Ue}return I}function Wb(v,D,x,T,b){v.l+=2;var I=v.read_shift(2),z=v.read_shift(2),ne=s(v);if(I&8257)throw new Error("Unsupported ZIP encryption");for(var Y=v.read_shift(4),q=v.read_shift(4),X=v.read_shift(4),de=v.read_shift(2),ye=v.read_shift(2),Ae="",xe=0;xe<de;++xe)Ae+=String.fromCharCode(v[v.l++]);if(ye){var we=a(v.slice(v.l,v.l+ye));(we[21589]||{}).mt&&(ne=we[21589].mt),((b||{})[21589]||{}).mt&&(ne=b[21589].mt)}v.l+=ye;var Ue=v.slice(v.l,v.l+q);switch(z){case 8:Ue=U(v,X);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+z)}var Tt=!1;I&8&&(Y=v.read_shift(4),Y==134695760&&(Y=v.read_shift(4),Tt=!0),q=v.read_shift(4),X=v.read_shift(4)),q!=D&&Z1(Tt,"Bad compressed size: "+D+" != "+q),X!=x&&Z1(Tt,"Bad uncompressed size: "+x+" != "+X),i0(T,Ae,Ue,{unsafe:!0,mt:ne})}function zb(v,D){var x=D||{},T=[],b=[],I=te(1),z=x.compression?8:0,ne=0,Y=!1;Y&&(ne|=8);var q=0,X=0,de=0,ye=0,Ae=v.FullPaths[0],xe=Ae,we=v.FileIndex[0],Ue=[],Tt=0;for(q=1;q<v.FullPaths.length;++q)if(xe=v.FullPaths[q].slice(Ae.length),we=v.FileIndex[q],!(!we.size||!we.content||xe=="Sh33tJ5")){var jn=de,Vt=te(xe.length);for(X=0;X<xe.length;++X)Vt.write_shift(1,xe.charCodeAt(X)&127);Vt=Vt.slice(0,Vt.l),Ue[ye]=A4.buf(we.content,0);var Qn=we.content;z==8&&(Qn=M(Qn)),I=te(30),I.write_shift(4,67324752),I.write_shift(2,20),I.write_shift(2,ne),I.write_shift(2,z),we.mt?o(I,we.mt):I.write_shift(4,0),I.write_shift(-4,ne&8?0:Ue[ye]),I.write_shift(4,ne&8?0:Qn.length),I.write_shift(4,ne&8?0:we.content.length),I.write_shift(2,Vt.length),I.write_shift(2,0),de+=I.length,T.push(I),de+=Vt.length,T.push(Vt),de+=Qn.length,T.push(Qn),ne&8&&(I=te(12),I.write_shift(-4,Ue[ye]),I.write_shift(4,Qn.length),I.write_shift(4,we.content.length),de+=I.l,T.push(I)),I=te(46),I.write_shift(4,33639248),I.write_shift(2,0),I.write_shift(2,20),I.write_shift(2,ne),I.write_shift(2,z),I.write_shift(4,0),I.write_shift(-4,Ue[ye]),I.write_shift(4,Qn.length),I.write_shift(4,we.content.length),I.write_shift(2,Vt.length),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(4,0),I.write_shift(4,jn),Tt+=I.l,b.push(I),Tt+=Vt.length,b.push(Vt),++ye}return I=te(22),I.write_shift(4,101010256),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,ye),I.write_shift(2,ye),I.write_shift(4,Tt),I.write_shift(4,de),I.write_shift(2,0),vn([vn(T),vn(b),I])}var zc={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function qb(v,D){if(v.ctype)return v.ctype;var x=v.name||"",T=x.match(/\.([^\.]+)$/);return T&&zc[T[1]]||D&&(T=(x=D).match(/[\.\\]([^\.\\])+$/),T&&zc[T[1]])?zc[T[1]]:"application/octet-stream"}function Kb(v){for(var D=xc(v),x=[],T=0;T<D.length;T+=76)x.push(D.slice(T,T+76));return x.join(`\r
`)+`\r
`}function Yb(v){var D=v.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(q){var X=q.charCodeAt(0).toString(16).toUpperCase();return"="+(X.length==1?"0"+X:X)});D=D.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),D.charAt(0)==`
`&&(D="=0D"+D.slice(1)),D=D.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var x=[],T=D.split(`\r
`),b=0;b<T.length;++b){var I=T[b];if(I.length==0){x.push("");continue}for(var z=0;z<I.length;){var ne=76,Y=I.slice(z,z+ne);Y.charAt(ne-1)=="="?ne--:Y.charAt(ne-2)=="="?ne-=2:Y.charAt(ne-3)=="="&&(ne-=3),Y=I.slice(z,z+ne),z+=ne,z<I.length&&(Y+="="),x.push(Y)}}return x.join(`\r
`)}function Xb(v){for(var D=[],x=0;x<v.length;++x){for(var T=v[x];x<=v.length&&T.charAt(T.length-1)=="=";)T=T.slice(0,T.length-1)+v[++x];D.push(T)}for(var b=0;b<D.length;++b)D[b]=D[b].replace(/[=][0-9A-Fa-f]{2}/g,function(I){return String.fromCharCode(parseInt(I.slice(1),16))});return $r(D.join(`\r
`))}function Zb(v,D,x){for(var T="",b="",I="",z,ne=0;ne<10;++ne){var Y=D[ne];if(!Y||Y.match(/^\s*$/))break;var q=Y.match(/^(.*?):\s*([^\s].*)$/);if(q)switch(q[1].toLowerCase()){case"content-location":T=q[2].trim();break;case"content-type":I=q[2].trim();break;case"content-transfer-encoding":b=q[2].trim();break}}switch(++ne,b.toLowerCase()){case"base64":z=$r(Vi(D.slice(ne).join("")));break;case"quoted-printable":z=Xb(D.slice(ne));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+b)}var X=i0(v,T.slice(x.length),z,{unsafe:!0});I&&(X.ctype=I)}function Qb(v,D){if(R(v.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var x=D&&D.root||"",T=(st&&Buffer.isBuffer(v)?v.toString("binary"):R(v)).split(`\r
`),b=0,I="";for(b=0;b<T.length;++b)if(I=T[b],!!/^Content-Location:/i.test(I)&&(I=I.slice(I.indexOf("file")),x||(x=I.slice(0,I.lastIndexOf("/")+1)),I.slice(0,x.length)!=x))for(;x.length>0&&(x=x.slice(0,x.length-1),x=x.slice(0,x.lastIndexOf("/")+1),I.slice(0,x.length)!=x););var z=(T[1]||"").match(/boundary="(.*?)"/);if(!z)throw new Error("MAD cannot find boundary");var ne="--"+(z[1]||""),Y=[],q=[],X={FileIndex:Y,FullPaths:q};O(X);var de,ye=0;for(b=0;b<T.length;++b){var Ae=T[b];Ae!==ne&&Ae!==ne+"--"||(ye++&&Zb(X,T.slice(de,b),x),de=b)}return X}function Jb(v,D){var x=D||{},T=x.boundary||"SheetJS";T="------="+T;for(var b=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+T.slice(2)+'"',"","",""],I=v.FullPaths[0],z=I,ne=v.FileIndex[0],Y=1;Y<v.FullPaths.length;++Y)if(z=v.FullPaths[Y].slice(I.length),ne=v.FileIndex[Y],!(!ne.size||!ne.content||z=="Sh33tJ5")){z=z.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ue){return"_x"+Ue.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ue){return"_u"+Ue.charCodeAt(0).toString(16)+"_"});for(var q=ne.content,X=st&&Buffer.isBuffer(q)?q.toString("binary"):R(q),de=0,ye=Math.min(1024,X.length),Ae=0,xe=0;xe<=ye;++xe)(Ae=X.charCodeAt(xe))>=32&&Ae<128&&++de;var we=de>=ye*4/5;b.push(T),b.push("Content-Location: "+(x.root||"file:///C:/SheetJS/")+z),b.push("Content-Transfer-Encoding: "+(we?"quoted-printable":"base64")),b.push("Content-Type: "+qb(ne,z)),b.push(""),b.push(we?Yb(X):Kb(X))}return b.push(T+`--\r
`),b.join(`\r
`)}function e2(v){var D={};return O(D,v),D}function i0(v,D,x,T){var b=T&&T.unsafe;b||O(v);var I=!b&&gt.find(v,D);if(!I){var z=v.FullPaths[0];D.slice(0,z.length)==z?z=D:(z.slice(-1)!="/"&&(z+="/"),z=(z+D).replace("//","/")),I={name:i(D),type:2},v.FileIndex.push(I),v.FullPaths.push(z),b||gt.utils.cfb_gc(v)}return I.content=x,I.size=x?x.length:0,T&&(T.CLSID&&(I.clsid=T.CLSID),T.mt&&(I.mt=T.mt),T.ct&&(I.ct=T.ct)),I}function t2(v,D){O(v);var x=gt.find(v,D);if(x){for(var T=0;T<v.FileIndex.length;++T)if(v.FileIndex[T]==x)return v.FileIndex.splice(T,1),v.FullPaths.splice(T,1),!0}return!1}function n2(v,D,x){O(v);var T=gt.find(v,D);if(T){for(var b=0;b<v.FileIndex.length;++b)if(v.FileIndex[b]==T)return v.FileIndex[b].name=i(x),v.FullPaths[b]=x,!0}return!1}function r2(v){G(v,!0)}return e.find=K,e.read=ce,e.parse=u,e.write=pe,e.writeFile=k,e.utils={cfb_new:e2,cfb_add:i0,cfb_del:t2,cfb_mov:n2,cfb_gc:r2,ReadShift:pc,CheckField:jC,prep_blob:ur,bconcat:vn,use_zlib:F,_deflateRaw:ko,_inflateRaw:X1,consts:ee},e}(),Kd;function F4(n){return typeof n=="string"?hh(n):Array.isArray(n)?n4(n):n}function Sc(n,e,t){if(typeof Kd<"u"&&Kd.writeFileSync)return t?Kd.writeFileSync(n,e,t):Kd.writeFileSync(n,e);if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=hh(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(n,e)}var r=t=="utf8"?Ri(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,n);if(typeof Blob<"u"){var i=new Blob([F4(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,n);if(typeof saveAs<"u")return saveAs(i,n);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:n,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=n,s.href=o,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var a=File(n);return a.open("w"),a.encoding="binary",Array.isArray(e)&&(e=Dc(e)),a.write(e),a.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+n)}function xn(n){for(var e=Object.keys(n),t=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(n,e[r])&&t.push(e[r]);return t}function Bw(n,e){for(var t=[],r=xn(n),i=0;i!==r.length;++i)t[n[r[i]][e]]==null&&(t[n[r[i]][e]]=r[i]);return t}function bv(n){for(var e=[],t=xn(n),r=0;r!==t.length;++r)e[n[t[r]]]=t[r];return e}function gh(n){for(var e=[],t=xn(n),r=0;r!==t.length;++r)e[n[t[r]]]=parseInt(t[r],10);return e}function k4(n){for(var e=[],t=xn(n),r=0;r!==t.length;++r)e[n[t[r]]]==null&&(e[n[t[r]]]=[]),e[n[t[r]]].push(t[r]);return e}var rh=new Date(1899,11,30,0,0,0);function zn(n,e){var t=n.getTime();e&&(t-=1462*24*60*60*1e3);var r=rh.getTime()+(n.getTimezoneOffset()-rh.getTimezoneOffset())*6e4;return(t-r)/(24*60*60*1e3)}var AC=new Date,N4=rh.getTime()+(AC.getTimezoneOffset()-rh.getTimezoneOffset())*6e4,Vw=AC.getTimezoneOffset();function FC(n){var e=new Date;return e.setTime(n*24*60*60*1e3+N4),e.getTimezoneOffset()!==Vw&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Vw)*6e4),e}var Uw=new Date("2017-02-19T19:06:09.000Z"),kC=isNaN(Uw.getFullYear())?new Date("2/19/17"):Uw,M4=kC.getFullYear()==2017;function Bn(n,e){var t=new Date(n);if(M4)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(n instanceof Date)return n;if(kC.getFullYear()==1917&&!isNaN(t.getFullYear())){var r=t.getFullYear();return n.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var i=n.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return n.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function vh(n,e){if(st&&Buffer.isBuffer(n)){if(e){if(n[0]==255&&n[1]==254)return Ri(n.slice(2).toString("utf16le"));if(n[1]==254&&n[2]==255)return Ri(t4(n.slice(2).toString("binary")))}return n.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(n[0]==255&&n[1]==254)return Ri(new TextDecoder("utf-16le").decode(n.slice(2)));if(n[0]==254&&n[1]==255)return Ri(new TextDecoder("utf-16be").decode(n.slice(2)))}var t={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[]/g,function(o){return t[o]||o})}catch{}for(var r=[],i=0;i!=n.length;++i)r.push(String.fromCharCode(n[i]));return r.join("")}function qn(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=qn(n[t]));return e}function Lt(n,e){for(var t="";t.length<e;)t+=n;return t}function Li(n){var e=Number(n);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(n))return e;var t=1,r=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(](.*)[)]/,function(i,o){return t=-t,o}),!isNaN(e=Number(r)))?e/t:e}var O4=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ec(n){var e=new Date(n),t=new Date(NaN),r=e.getYear(),i=e.getMonth(),o=e.getDate();if(isNaN(o))return t;var s=n.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&O4.indexOf(s)==-1)return t}else if(s.match(/[a-z]/))return t;return r<0||r>8099?t:(i>0||o>1)&&r!=101?e:n.match(/[^-0-9:,\/\\]/)?t:e}function Ye(n,e,t){if(n.FullPaths){if(typeof t=="string"){var r;return st?r=ji(t):r=r4(t),gt.utils.cfb_add(n,e,r)}gt.utils.cfb_add(n,e,t)}else n.file(e,t)}function Iv(){return gt.utils.cfb_new()}var Kt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`;var R4={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Av=bv(R4);var Fv=/[&<>'"]/g,P4=/[\u0000-\u0008\u000b-\u001f]/g;function dt(n){var e=n+"";return e.replace(Fv,function(t){return Av[t]}).replace(P4,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function jw(n){return dt(n).replace(/ /g,"_x0020_")}var NC=/[\u0000-\u001f]/g;function L4(n){var e=n+"";return e.replace(Fv,function(t){return Av[t]}).replace(/\n/g,"<br/>").replace(NC,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function B4(n){var e=n+"";return e.replace(Fv,function(t){return Av[t]}).replace(NC,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function V4(n){return n.replace(/(\r\n|[\r\n])/g,"&#10;")}function U4(n){switch(n){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function pv(n){for(var e="",t=0,r=0,i=0,o=0,s=0,a=0;t<n.length;){if(r=n.charCodeAt(t++),r<128){e+=String.fromCharCode(r);continue}if(i=n.charCodeAt(t++),r>191&&r<224){s=(r&31)<<6,s|=i&63,e+=String.fromCharCode(s);continue}if(o=n.charCodeAt(t++),r<240){e+=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63);continue}s=n.charCodeAt(t++),a=((r&7)<<18|(i&63)<<12|(o&63)<<6|s&63)-65536,e+=String.fromCharCode(55296+(a>>>10&1023)),e+=String.fromCharCode(56320+(a&1023))}return e}function Hw(n){var e=us(2*n.length),t,r,i=1,o=0,s=0,a;for(r=0;r<n.length;r+=i)i=1,(a=n.charCodeAt(r))<128?t=a:a<224?(t=(a&31)*64+(n.charCodeAt(r+1)&63),i=2):a<240?(t=(a&15)*4096+(n.charCodeAt(r+1)&63)*64+(n.charCodeAt(r+2)&63),i=3):(i=4,t=(a&7)*262144+(n.charCodeAt(r+1)&63)*4096+(n.charCodeAt(r+2)&63)*64+(n.charCodeAt(r+3)&63),t-=65536,s=55296+(t>>>10&1023),t=56320+(t&1023)),s!==0&&(e[o++]=s&255,e[o++]=s>>>8,s=0),e[o++]=t%256,e[o++]=t>>>8;return e.slice(0,o).toString("ucs2")}function Gw(n){return ji(n,"binary").toString("utf8")}var Yd="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",hc=st&&(Gw(Yd)==pv(Yd)&&Gw||Hw(Yd)==pv(Yd)&&Hw)||pv,Ri=st?function(n){return ji(n,"utf8").toString("binary")}:function(n){for(var e=[],t=0,r=0,i=0;t<n.length;)switch(r=n.charCodeAt(t++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=n.charCodeAt(t++)-56320+(r<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")};var j4=function(){var n=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<n.length;++i)r=r.replace(n[i][0],n[i][1]);return r}}();var MC=/(^\s|\s$|\n)/;function _n(n,e){return"<"+n+(e.match(MC)?' xml:space="preserve"':"")+">"+e+"</"+n+">"}function Tc(n){return xn(n).map(function(e){return" "+e+'="'+n[e]+'"'}).join("")}function ve(n,e,t){return"<"+n+(t!=null?Tc(t):"")+(e!=null?(e.match(MC)?' xml:space="preserve"':"")+">"+e+"</"+n:"/")+">"}function Tv(n,e){try{return n.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function H4(n,e){switch(typeof n){case"string":var t=ve("vt:lpwstr",dt(n));return e&&(t=t.replace(/&quot;/g,"_x0022_")),t;case"number":return ve((n|0)==n?"vt:i4":"vt:r8",dt(String(n)));case"boolean":return ve("vt:bool",n?"true":"false")}if(n instanceof Date)return ve("vt:filetime",Tv(n));throw new Error("Unable to serialize "+n)}var un={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Aa=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],fr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function G4(n,e){for(var t=1-2*(n[e+7]>>>7),r=((n[e+7]&127)<<4)+(n[e+6]>>>4&15),i=n[e+6]&15,o=5;o>=0;--o)i=i*256+n[e+o];return r==2047?i==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),t*Math.pow(2,r-52)*i)}function $4(n,e,t){var r=(e<0||1/e==-1/0?1:0)<<7,i=0,o=0,s=r?-e:e;isFinite(s)?s==0?i=o=0:(i=Math.floor(Math.log(s)/Math.LN2),o=s*Math.pow(2,52-i),i<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?i=-1022:(o-=Math.pow(2,52),i+=1023)):(i=2047,o=isNaN(e)?26985:0);for(var a=0;a<=5;++a,o/=256)n[t+a]=o&255;n[t+6]=(i&15)<<4|o&15,n[t+7]=i>>4|r}var $w=function(n){for(var e=[],t=10240,r=0;r<n[0].length;++r)if(n[0][r])for(var i=0,o=n[0][r].length;i<o;i+=t)e.push.apply(e,n[0][r].slice(i,i+t));return e},Ww=st?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(e){return Buffer.isBuffer(e)?e:ji(e)})):$w(n)}:$w,zw=function(n,e,t){for(var r=[],i=e;i<t;i+=2)r.push(String.fromCharCode(dc(n,i)));return r.join("").replace(Ta,"")},_h=st?function(n,e,t){return Buffer.isBuffer(n)?n.toString("utf16le",e,t).replace(Ta,""):zw(n,e,t)}:zw,qw=function(n,e,t){for(var r=[],i=e;i<e+t;++i)r.push(("0"+n[i].toString(16)).slice(-2));return r.join("")},OC=st?function(n,e,t){return Buffer.isBuffer(n)?n.toString("hex",e,e+t):qw(n,e,t)}:qw,Kw=function(n,e,t){for(var r=[],i=e;i<t;i++)r.push(String.fromCharCode(xa(n,i)));return r.join("")},Fa=st?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):Kw(e,t,r)}:Kw,RC=function(n,e){var t=cn(n,e);return t>0?Fa(n,e+4,e+4+t-1):""},kv=RC,PC=function(n,e){var t=cn(n,e);return t>0?Fa(n,e+4,e+4+t-1):""},Nv=PC,LC=function(n,e){var t=2*cn(n,e);return t>0?Fa(n,e+4,e+4+t-1):""},Mv=LC,BC=function(e,t){var r=cn(e,t);return r>0?_h(e,t+4,t+4+r):""},Ov=BC,VC=function(n,e){var t=cn(n,e);return t>0?Fa(n,e+4,e+4+t):""},Rv=VC,UC=function(n,e){return G4(n,e)},ih=UC,Pv=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};st&&(kv=function(e,t){if(!Buffer.isBuffer(e))return RC(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},Nv=function(e,t){if(!Buffer.isBuffer(e))return PC(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},Mv=function(e,t){if(!Buffer.isBuffer(e))return LC(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},Ov=function(e,t){if(!Buffer.isBuffer(e))return BC(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},Rv=function(e,t){if(!Buffer.isBuffer(e))return VC(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},ih=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):UC(e,t)},Pv=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});function W4(){_h=function(n,e,t){return yt.utils.decode(1200,n.slice(e,t)).replace(Ta,"")},Fa=function(n,e,t){return yt.utils.decode(65001,n.slice(e,t))},kv=function(n,e){var t=cn(n,e);return t>0?yt.utils.decode(ba,n.slice(e+4,e+4+t-1)):""},Nv=function(n,e){var t=cn(n,e);return t>0?yt.utils.decode(ls,n.slice(e+4,e+4+t-1)):""},Mv=function(n,e){var t=2*cn(n,e);return t>0?yt.utils.decode(1200,n.slice(e+4,e+4+t-1)):""},Ov=function(n,e){var t=cn(n,e);return t>0?yt.utils.decode(1200,n.slice(e+4,e+4+t)):""},Rv=function(n,e){var t=cn(n,e);return t>0?yt.utils.decode(65001,n.slice(e+4,e+4+t)):""}}typeof yt<"u"&&W4();var xa=function(n,e){return n[e]},dc=function(n,e){return n[e+1]*256+n[e]},z4=function(n,e){var t=n[e+1]*256+n[e];return t<32768?t:(65535-t+1)*-1},cn=function(n,e){return n[e+3]*(1<<24)+(n[e+2]<<16)+(n[e+1]<<8)+n[e]},as=function(n,e){return n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]},q4=function(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]};function pc(n,e){var t="",r,i,o=[],s,a,l,c;switch(e){case"dbcs":if(c=this.l,st&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*n).toString("utf16le");else for(l=0;l<n;++l)t+=String.fromCharCode(dc(this,c)),c+=2;n*=2;break;case"utf8":t=Fa(this,this.l,this.l+n);break;case"utf16le":n*=2,t=_h(this,this.l,this.l+n);break;case"wstr":if(typeof yt<"u")t=yt.utils.decode(ls,this.slice(this.l,this.l+2*n));else return pc.call(this,n,"dbcs");n=2*n;break;case"lpstr-ansi":t=kv(this,this.l),n=4+cn(this,this.l);break;case"lpstr-cp":t=Nv(this,this.l),n=4+cn(this,this.l);break;case"lpwstr":t=Mv(this,this.l),n=4+2*cn(this,this.l);break;case"lpp4":n=4+cn(this,this.l),t=Ov(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+cn(this,this.l),t=Rv(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,t="";(s=xa(this,this.l+n++))!==0;)o.push(Wd(s));t=o.join("");break;case"_wstr":for(n=0,t="";(s=dc(this,this.l+n))!==0;)o.push(Wd(s)),n+=2;n+=2,t=o.join("");break;case"dbcs-cont":for(t="",c=this.l,l=0;l<n;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=xa(this,c),this.l=c+1,a=pc.call(this,n-l,s?"dbcs-cont":"sbcs-cont"),o.join("")+a;o.push(Wd(dc(this,c))),c+=2}t=o.join(""),n*=2;break;case"cpstr":if(typeof yt<"u"){t=yt.utils.decode(ls,this.slice(this.l,this.l+n));break}case"sbcs-cont":for(t="",c=this.l,l=0;l!=n;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=xa(this,c),this.l=c+1,a=pc.call(this,n-l,s?"dbcs-cont":"sbcs-cont"),o.join("")+a;o.push(Wd(xa(this,c))),c+=1}t=o.join("");break;default:switch(n){case 1:return r=xa(this,this.l),this.l++,r;case 2:return r=(e==="i"?z4:dc)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(r=(n>0?as:q4)(this,this.l),this.l+=4,r):(i=cn(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return n==8?i=ih(this,this.l):i=ih([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;n=8;case 16:t=OC(this,this.l,n);break}}return this.l+=n,t}var K4=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255,n[t+2]=e>>>16&255,n[t+3]=e>>>24&255},Y4=function(n,e,t){n[t]=e&255,n[t+1]=e>>8&255,n[t+2]=e>>16&255,n[t+3]=e>>24&255},X4=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255};function Z4(n,e,t){var r=0,i=0;if(t==="dbcs"){for(i=0;i!=e.length;++i)X4(this,e.charCodeAt(i),this.l+2*i);r=2*e.length}else if(t==="sbcs"){if(typeof yt<"u"&&ba==874)for(i=0;i!=e.length;++i){var o=yt.utils.encode(ba,e.charAt(i));this[this.l+i]=o[0]}else for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;r=e.length}else if(t==="hex"){for(;i<n;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+n,this.length);for(i=0;i<Math.min(e.length,n);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(n){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,K4(this,e,this.l);break;case 8:if(r=8,t==="f"){$4(this,e,this.l);break}case 16:break;case-4:r=4,Y4(this,e,this.l);break}return this.l+=r,this}function jC(n,e){var t=OC(this,this.l,n.length>>1);if(t!==n)throw new Error(e+"Expected "+n+" saw "+t);this.l+=n.length>>1}function ur(n,e){n.l=e,n.read_shift=pc,n.chk=jC,n.write_shift=Z4}function mi(n,e){n.l+=e}function te(n){var e=us(n);return ur(e,0),e}function Wn(){var n=[],e=st?256:2048,t=function(c){var u=te(c);return ur(u,0),u},r=t(e),i=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&n.push(r),r=null)},o=function(c){return r&&c<r.length-r.l?r:(i(),r=t(Math.max(c+1,e)))},s=function(){return i(),vn(n)},a=function(c){i(),r=c,r.l==null&&(r.l=r.length),o(e)};return{next:o,push:a,end:s,_bufs:n}}function le(n,e,t,r){var i=+e,o;if(!isNaN(i)){r||(r=$5[i].p||(t||[]).length||0),o=1+(i>=128?1:0)+1,r>=128&&++o,r>=16384&&++o,r>=2097152&&++o;var s=n.next(o);i<=127?s.write_shift(1,i):(s.write_shift(1,(i&127)+128),s.write_shift(1,i>>7));for(var a=0;a!=4;++a)if(r>=128)s.write_shift(1,(r&127)+128),r>>=7;else{s.write_shift(1,r);break}r>0&&Pv(t)&&n.push(t)}}function mc(n,e,t){var r=qn(n);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function Yw(n,e,t){var r=qn(n);return r.s=mc(r.s,e.s,t),r.e=mc(r.e,e.s,t),r}function gc(n,e){if(n.cRel&&n.c<0)for(n=qn(n);n.c<0;)n.c+=e>8?16384:256;if(n.rRel&&n.r<0)for(n=qn(n);n.r<0;)n.r+=e>8?1048576:e>5?65536:16384;var t=ht(n);return!n.cRel&&n.cRel!=null&&(t=e3(t)),!n.rRel&&n.rRel!=null&&(t=Q4(t)),t}function mv(n,e){return n.s.r==0&&!n.s.rRel&&n.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+Fn(n.s.c)+":"+(n.e.cRel?"":"$")+Fn(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(e.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+yn(n.s.r)+":"+(n.e.rRel?"":"$")+yn(n.e.r):gc(n.s,e.biff)+":"+gc(n.e,e.biff)}function Lv(n){return parseInt(J4(n),10)-1}function yn(n){return""+(n+1)}function Q4(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function J4(n){return n.replace(/\$(\d+)$/,"$1")}function Bv(n){for(var e=t3(n),t=0,r=0;r!==e.length;++r)t=26*t+e.charCodeAt(r)-64;return t-1}function Fn(n){if(n<0)throw new Error("invalid column "+n);var e="";for(++n;n;n=Math.floor((n-1)/26))e=String.fromCharCode((n-1)%26+65)+e;return e}function e3(n){return n.replace(/^([A-Z])/,"$$$1")}function t3(n){return n.replace(/^\$([A-Z])/,"$1")}function n3(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function fn(n){for(var e=0,t=0,r=0;r<n.length;++r){var i=n.charCodeAt(r);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:e-1}}function ht(n){for(var e=n.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(n.r+1)}function dr(n){var e=n.indexOf(":");return e==-1?{s:fn(n),e:fn(n)}:{s:fn(n.slice(0,e)),e:fn(n.slice(e+1))}}function qt(n,e){return typeof e>"u"||typeof e=="number"?qt(n.s,n.e):(typeof n!="string"&&(n=ht(n)),typeof e!="string"&&(e=ht(e)),n==e?n:n+":"+e)}function wt(n){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,i=0,o=n.length;for(t=0;r<o&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(e.s.c=--t,t=0;r<o&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;if(e.s.r=--t,r===o||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,t=0;r!=o&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(e.e.c=--t,t=0;r!=o&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;return e.e.r=--t,e}function Xw(n,e){var t=n.t=="d"&&e instanceof Date;if(n.z!=null)try{return n.w=xo(n.z,t?zn(e):e)}catch{}try{return n.w=xo((n.XF||{}).numFmtId||(t?14:0),t?zn(e):e)}catch{return""+e}}function Ui(n,e,t){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&t&&t.dateNF&&(n.z=t.dateNF),n.t=="e"?bc[n.v]||n.v:e==null?Xw(n,n.v):Xw(n,e))}function hs(n,e){var t=e&&e.sheet?e.sheet:"Sheet1",r={};return r[t]=n,{SheetNames:[t],Sheets:r}}function HC(n,e,t){var r=t||{},i=n?Array.isArray(n):r.dense;pi!=null&&i==null&&(i=pi);var o=n||(i?[]:{}),s=0,a=0;if(o&&r.origin!=null){if(typeof r.origin=="number")s=r.origin;else{var l=typeof r.origin=="string"?fn(r.origin):r.origin;s=l.r,a=l.c}o["!ref"]||(o["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var u=wt(o["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),s==-1&&(c.e.r=s=u.e.r+1)}for(var f=0;f!=e.length;++f)if(e[f]){if(!Array.isArray(e[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=e[f].length;++h)if(!(typeof e[f][h]>"u")){var d={v:e[f][h]},m=s+f,p=a+h;if(c.s.r>m&&(c.s.r=m),c.s.c>p&&(c.s.c=p),c.e.r<m&&(c.e.r=m),c.e.c<p&&(c.e.c=p),e[f][h]&&typeof e[f][h]=="object"&&!Array.isArray(e[f][h])&&!(e[f][h]instanceof Date))d=e[f][h];else if(Array.isArray(d.v)&&(d.f=e[f][h][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(r.nullError)d.t="e",d.v=0;else if(r.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=r.dateNF||Bt[14],r.cellDates?(d.t="d",d.w=xo(d.z,zn(d.v))):(d.t="n",d.v=zn(d.v),d.w=xo(d.z,d.v))):d.t="s";if(i)o[m]||(o[m]=[]),o[m][p]&&o[m][p].z&&(d.z=o[m][p].z),o[m][p]=d;else{var g=ht({c:p,r:m});o[g]&&o[g].z&&(d.z=o[g].z),o[g]=d}}}return c.s.c<1e7&&(o["!ref"]=qt(c)),o}function ka(n,e){return HC(null,n,e)}function r3(n){return n.read_shift(4,"i")}function zr(n,e){return e||(e=te(4)),e.write_shift(4,n),e}function kn(n){var e=n.read_shift(4);return e===0?"":n.read_shift(e,"dbcs")}function dn(n,e){var t=!1;return e==null&&(t=!0,e=te(4+2*n.length)),e.write_shift(4,n.length),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}function i3(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function o3(n,e){return e||(e=te(4)),e.write_shift(2,n.ich||0),e.write_shift(2,n.ifnt||0),e}function Vv(n,e){var t=n.l,r=n.read_shift(1),i=kn(n),o=[],s={t:i,h:i};if((r&1)!==0){for(var a=n.read_shift(4),l=0;l!=a;++l)o.push(i3(n));s.r=o}else s.r=[{ich:0,ifnt:0}];return n.l=t+e,s}function s3(n,e){var t=!1;return e==null&&(t=!0,e=te(15+4*n.t.length)),e.write_shift(1,0),dn(n.t,e),t?e.slice(0,e.l):e}var a3=Vv;function l3(n,e){var t=!1;return e==null&&(t=!0,e=te(23+4*n.t.length)),e.write_shift(1,1),dn(n.t,e),e.write_shift(4,1),o3({ich:0,ifnt:0},e),t?e.slice(0,e.l):e}function br(n){var e=n.read_shift(4),t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:e,iStyleRef:t}}function ps(n,e){return e==null&&(e=te(8)),e.write_shift(-4,n.c),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}function ms(n){var e=n.read_shift(2);return e+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:e}}function gs(n,e){return e==null&&(e=te(4)),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}var c3=kn,GC=dn;function Uv(n){var e=n.read_shift(4);return e===0||e===4294967295?"":n.read_shift(e,"dbcs")}function oh(n,e){var t=!1;return e==null&&(t=!0,e=te(127)),e.write_shift(4,n.length>0?n.length:4294967295),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}var u3=kn,wv=Uv,jv=oh;function $C(n){var e=n.slice(n.l,n.l+4),t=e[0]&1,r=e[0]&2;n.l+=4;var i=r===0?ih([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):as(e,0)>>2;return t?i/100:i}function WC(n,e){e==null&&(e=te(4));var t=0,r=0,i=n*100;if(n==(n|0)&&n>=-(1<<29)&&n<1<<29?r=1:i==(i|0)&&i>=-(1<<29)&&i<1<<29&&(r=1,t=1),r)e.write_shift(-4,((t?i:n)<<2)+(t+2));else throw new Error("unsupported RkNumber "+n)}function zC(n){var e={s:{},e:{}};return e.s.r=n.read_shift(4),e.e.r=n.read_shift(4),e.s.c=n.read_shift(4),e.e.c=n.read_shift(4),e}function f3(n,e){return e||(e=te(16)),e.write_shift(4,n.s.r),e.write_shift(4,n.e.r),e.write_shift(4,n.s.c),e.write_shift(4,n.e.c),e}var vs=zC,Na=f3;function Ma(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function fs(n,e){return(e||te(8)).write_shift(8,n,"f")}function d3(n){var e={},t=n.read_shift(1),r=t>>>1,i=n.read_shift(1),o=n.read_shift(2,"i"),s=n.read_shift(1),a=n.read_shift(1),l=n.read_shift(1);switch(n.l++,r){case 0:e.auto=1;break;case 1:e.index=i;var c=E3[i];c&&(e.rgb=aC(c));break;case 2:e.rgb=aC([s,a,l]);break;case 3:e.theme=i;break}return o!=0&&(e.tint=o>0?o/32767:o/32768),e}function sh(n,e){if(e||(e=te(8)),!n||n.auto)return e.write_shift(4,0),e.write_shift(4,0),e;n.index!=null?(e.write_shift(1,2),e.write_shift(1,n.index)):n.theme!=null?(e.write_shift(1,6),e.write_shift(1,n.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=n.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!n.rgb||n.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var r=n.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),e.write_shift(1,parseInt(r.slice(0,2),16)),e.write_shift(1,parseInt(r.slice(2,4),16)),e.write_shift(1,parseInt(r.slice(4,6),16)),e.write_shift(1,255)}return e}function h3(n){var e=n.read_shift(1);n.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function p3(n,e){e||(e=te(2));var t=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}var qC=2,cr=3,Xd=11;var ah=19;var Zd=64,m3=65,g3=71;var v3=4108,_3=4126,gn=80;var Zw={1:{n:"CodePage",t:qC},2:{n:"Category",t:gn},3:{n:"PresentationFormat",t:gn},4:{n:"ByteCount",t:cr},5:{n:"LineCount",t:cr},6:{n:"ParagraphCount",t:cr},7:{n:"SlideCount",t:cr},8:{n:"NoteCount",t:cr},9:{n:"HiddenCount",t:cr},10:{n:"MultimediaClipCount",t:cr},11:{n:"ScaleCrop",t:Xd},12:{n:"HeadingPairs",t:v3},13:{n:"TitlesOfParts",t:_3},14:{n:"Manager",t:gn},15:{n:"Company",t:gn},16:{n:"LinksUpToDate",t:Xd},17:{n:"CharacterCount",t:cr},19:{n:"SharedDoc",t:Xd},22:{n:"HyperlinksChanged",t:Xd},23:{n:"AppVersion",t:cr,p:"version"},24:{n:"DigSig",t:m3},26:{n:"ContentType",t:gn},27:{n:"ContentStatus",t:gn},28:{n:"Language",t:gn},29:{n:"Version",t:gn},255:{},2147483648:{n:"Locale",t:ah},2147483651:{n:"Behavior",t:ah},1919054434:{}},Qw={1:{n:"CodePage",t:qC},2:{n:"Title",t:gn},3:{n:"Subject",t:gn},4:{n:"Author",t:gn},5:{n:"Keywords",t:gn},6:{n:"Comments",t:gn},7:{n:"Template",t:gn},8:{n:"LastAuthor",t:gn},9:{n:"RevNumber",t:gn},10:{n:"EditTime",t:Zd},11:{n:"LastPrinted",t:Zd},12:{n:"CreatedDate",t:Zd},13:{n:"ModifiedDate",t:Zd},14:{n:"PageCount",t:cr},15:{n:"WordCount",t:cr},16:{n:"CharCount",t:cr},17:{n:"Thumbnail",t:g3},18:{n:"Application",t:gn},19:{n:"DocSecurity",t:cr},255:{},2147483648:{n:"Locale",t:ah},2147483651:{n:"Behavior",t:ah},1919054434:{}};function y3(n){return n.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var x3=y3([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),E3=qn(x3),bc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"};var T3={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Qd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function KC(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function YC(n,e){var t=k4(T3),r=[],i;r[r.length]=Kt,r[r.length]=ve("Types",null,{xmlns:un.CT,"xmlns:xsd":un.xsd,"xmlns:xsi":un.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return ve("Default",null,{Extension:l[0],ContentType:l[1]})}));var o=function(l){n[l]&&n[l].length>0&&(i=n[l][0],r[r.length]=ve("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Qd[l][e.bookType]||Qd[l].xlsx}))},s=function(l){(n[l]||[]).forEach(function(c){r[r.length]=ve("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:Qd[l][e.bookType]||Qd[l].xlsx})})},a=function(l){(n[l]||[]).forEach(function(c){r[r.length]=ve("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:t[l][0]})})};return o("workbooks"),s("sheets"),s("charts"),a("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(a),a("vba"),a("comments"),a("threadedcomments"),a("drawings"),s("metadata"),a("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var it={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function XC(n){var e=n.lastIndexOf("/");return n.slice(0,e+1)+"_rels/"+n.slice(e+1)+".rels"}function Ca(n){var e=[Kt,ve("Relationships",null,{xmlns:un.RELS})];return xn(n["!id"]).forEach(function(t){e[e.length]=ve("Relationship",null,n["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function ft(n,e,t,r,i,o){if(i||(i={}),n["!id"]||(n["!id"]={}),n["!idx"]||(n["!idx"]=1),e<0)for(e=n["!idx"];n["!id"]["rId"+e];++e);if(n["!idx"]=e+1,i.Id="rId"+e,i.Type=r,i.Target=t,o?i.TargetMode=o:[it.HLINK,it.XPATH,it.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),n["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return n["!id"][i.Id]=i,n[("/"+i.Target).replace("//","/")]=i,e}function w3(n){var e=[Kt];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<n.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+n[t][0]+'" manifest:media-type="'+n[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function Jw(n,e,t){return['  <rdf:Description rdf:about="'+n+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function C3(n,e){return['  <rdf:Description rdf:about="'+n+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function D3(n){var e=[Kt];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=n.length;++t)e.push(Jw(n[t][0],n[t][1])),e.push(C3("",n[t][0]));return e.push(Jw("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function ZC(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+_c.version+"</meta:generator></office:meta></office:document-meta>"}var cs=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function gv(n,e,t,r,i){i[n]!=null||e==null||e===""||(i[n]=e,e=dt(e),r[r.length]=t?ve(n,e,t):_n(n,e))}function QC(n,e){var t=e||{},r=[Kt,ve("cp:coreProperties",null,{"xmlns:cp":un.CORE_PROPS,"xmlns:dc":un.dc,"xmlns:dcterms":un.dcterms,"xmlns:dcmitype":un.dcmitype,"xmlns:xsi":un.xsi})],i={};if(!n&&!t.Props)return r.join("");n&&(n.CreatedDate!=null&&gv("dcterms:created",typeof n.CreatedDate=="string"?n.CreatedDate:Tv(n.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),n.ModifiedDate!=null&&gv("dcterms:modified",typeof n.ModifiedDate=="string"?n.ModifiedDate:Tv(n.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var o=0;o!=cs.length;++o){var s=cs[o],a=t.Props&&t.Props[s[1]]!=null?t.Props[s[1]]:n?n[s[1]]:null;a===!0?a="1":a===!1?a="0":typeof a=="number"&&(a=String(a)),a!=null&&gv(s[0],a,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var Da=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],JC=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function eD(n){var e=[],t=ve;return n||(n={}),n.Application="SheetJS",e[e.length]=Kt,e[e.length]=ve("Properties",null,{xmlns:un.EXT_PROPS,"xmlns:vt":un.vt}),Da.forEach(function(r){if(n[r[1]]!==void 0){var i;switch(r[2]){case"string":i=dt(String(n[r[1]]));break;case"bool":i=n[r[1]]?"true":"false";break}i!==void 0&&(e[e.length]=t(r[0],i))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",n.SheetNames.map(function(r){return"<vt:lpstr>"+dt(r)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function tD(n){var e=[Kt,ve("Properties",null,{xmlns:un.CUST_PROPS,"xmlns:vt":un.vt})];if(!n)return e.join("");var t=1;return xn(n).forEach(function(i){++t,e[e.length]=ve("property",H4(n[i],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:dt(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var eC={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function S3(n,e){var t=[];return xn(eC).map(function(r){for(var i=0;i<cs.length;++i)if(cs[i][1]==r)return cs[i];for(i=0;i<Da.length;++i)if(Da[i][1]==r)return Da[i];throw r}).forEach(function(r){if(n[r[1]]!=null){var i=e&&e.Props&&e.Props[r[1]]!=null?e.Props[r[1]]:n[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),t.push(_n(eC[r[1]]||r[1],i))}}),ve("DocumentProperties",t.join(""),{xmlns:fr.o})}function b3(n,e){var t=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return n&&xn(n).forEach(function(o){if(Object.prototype.hasOwnProperty.call(n,o)){for(var s=0;s<cs.length;++s)if(o==cs[s][1])return;for(s=0;s<Da.length;++s)if(o==Da[s][1])return;for(s=0;s<t.length;++s)if(o==t[s])return;var a=n[o],l="string";typeof a=="number"?(l="float",a=String(a)):a===!0||a===!1?(l="boolean",a=a?"1":"0"):a=String(a),i.push(ve(jw(o),a,{"dt:dt":l}))}}),e&&xn(e).forEach(function(o){if(Object.prototype.hasOwnProperty.call(e,o)&&!(n&&Object.prototype.hasOwnProperty.call(n,o))){var s=e[o],a="string";typeof s=="number"?(a="float",s=String(s)):s===!0||s===!1?(a="boolean",s=s?"1":"0"):s instanceof Date?(a="dateTime.tz",s=s.toISOString()):s=String(s),i.push(ve(jw(o),s,{"dt:dt":a}))}}),"<"+r+' xmlns="'+fr.o+'">'+i.join("")+"</"+r+">"}function I3(n){var e=typeof n=="string"?new Date(Date.parse(n)):n,t=e.getTime()/1e3+11644473600,r=t%Math.pow(2,32),i=(t-r)/Math.pow(2,32);r*=1e7,i*=1e7;var o=r/Math.pow(2,32)|0;o>0&&(r=r%Math.pow(2,32),i+=o);var s=te(8);return s.write_shift(4,r),s.write_shift(4,i),s}function tC(n,e){var t=te(4),r=te(4);switch(t.write_shift(4,n==80?31:n),n){case 3:r.write_shift(-4,e);break;case 5:r=te(8),r.write_shift(8,e,"f");break;case 11:r.write_shift(4,e?1:0);break;case 64:r=I3(e);break;case 31:case 80:for(r=te(4+2*(e.length+1)+(e.length%2?0:2)),r.write_shift(4,e.length+1),r.write_shift(0,e,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+e)}return vn([t,r])}var nD=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function A3(n){switch(typeof n){case"boolean":return 11;case"number":return(n|0)==n?3:5;case"string":return 31;case"object":if(n instanceof Date)return 64;break}return-1}function nC(n,e,t){var r=te(8),i=[],o=[],s=8,a=0,l=te(8),c=te(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),o.push(l),i.push(c),s+=8+l.length,!e){c=te(8),c.write_shift(4,0),i.unshift(c);var u=[te(4)];for(u[0].write_shift(4,n.length),a=0;a<n.length;++a){var f=n[a][0];for(l=te(8+2*(f.length+1)+(f.length%2?0:2)),l.write_shift(4,a+2),l.write_shift(4,f.length+1),l.write_shift(0,f,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=vn(u),o.unshift(l),s+=8+l.length}for(a=0;a<n.length;++a)if(!(e&&!e[n[a][0]])&&!(nD.indexOf(n[a][0])>-1||JC.indexOf(n[a][0])>-1)&&n[a][1]!=null){var h=n[a][1],d=0;if(e){d=+e[n[a][0]];var m=t[d];if(m.p=="version"&&typeof h=="string"){var p=h.split(".");h=(+p[0]<<16)+(+p[1]||0)}l=tC(m.t,h)}else{var g=A3(h);g==-1&&(g=31,h=String(h)),l=tC(g,h)}o.push(l),c=te(8),c.write_shift(4,e?d:2+a),i.push(c),s+=8+l.length}var w=8*(o.length+1);for(a=0;a<o.length;++a)i[a].write_shift(4,w),w+=o[a].length;return r.write_shift(4,s),r.write_shift(4,o.length),vn([r].concat(i).concat(o))}function rC(n,e,t,r,i,o){var s=te(i?68:48),a=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,gt.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,i?2:1),s.write_shift(16,e,"hex"),s.write_shift(4,i?68:48);var l=nC(n,t,r);if(a.push(l),i){var c=nC(i,null,null);s.write_shift(16,o,"hex"),s.write_shift(4,68+l.length),a.push(c)}return vn(a)}function F3(n,e){e||(e=te(n));for(var t=0;t<n;++t)e.write_shift(1,0);return e}function k3(n,e){return n.read_shift(e)===1}function Ln(n,e){return e||(e=te(2)),e.write_shift(2,+!!n),e}function rD(n){return n.read_shift(2,"u")}function Sr(n,e){return e||(e=te(2)),e.write_shift(2,n),e}function iD(n,e,t){return t||(t=te(2)),t.write_shift(1,e=="e"?+n:+!!n),t.write_shift(1,e=="e"?1:0),t}function oD(n,e,t){var r=n.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont",o=ls;if(t&&t.biff>=8&&(ls=1200),!t||t.biff==8){var s=n.read_shift(1);s&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var a=r?n.read_shift(r,i):"";return ls=o,a}function N3(n){var e=n.t||"",t=1,r=te(3+(t>1?2:0));r.write_shift(2,e.length),r.write_shift(1,(t>1?8:0)|1),t>1&&r.write_shift(2,t);var i=te(2*e.length);i.write_shift(2*e.length,e,"utf16le");var o=[r,i];return vn(o)}function M3(n,e,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return n.read_shift(e,"cpstr");if(t.biff>=12)return n.read_shift(e,"dbcs-cont")}var i=n.read_shift(1);return i===0?r=n.read_shift(e,"sbcs-cont"):r=n.read_shift(e,"dbcs-cont"),r}function O3(n,e,t){var r=n.read_shift(t&&t.biff==2?1:2);return r===0?(n.l++,""):M3(n,r,t)}function R3(n,e,t){if(t.biff>5)return O3(n,e,t);var r=n.read_shift(1);return r===0?(n.l++,""):n.read_shift(r,t.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function sD(n,e,t){return t||(t=te(3+2*n.length)),t.write_shift(2,n.length),t.write_shift(1,1),t.write_shift(31,n,"utf16le"),t}function iC(n,e){e||(e=te(6+n.length*2)),e.write_shift(4,1+n.length);for(var t=0;t<n.length;++t)e.write_shift(2,n.charCodeAt(t));return e.write_shift(2,0),e}function P3(n){var e=te(512),t=0,r=n.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var i=r.indexOf("#"),o=i>-1?31:23;switch(r.charAt(0)){case"#":o=28;break;case".":o&=-3;break}e.write_shift(4,2),e.write_shift(4,o);var s=[8,6815827,6619237,4849780,83];for(t=0;t<s.length;++t)e.write_shift(4,s[t]);if(o==28)r=r.slice(1),iC(r,e);else if(o&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<s.length;++t)e.write_shift(1,parseInt(s[t],16));var a=i>-1?r.slice(0,i):r;for(e.write_shift(4,2*(a.length+1)),t=0;t<a.length;++t)e.write_shift(2,a.charCodeAt(t));e.write_shift(2,0),o&8&&iC(i>-1?r.slice(i+1):"",e)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<s.length;++t)e.write_shift(1,parseInt(s[t],16));for(var l=0;r.slice(l*3,l*3+3)=="../"||r.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,r.length-3*l+1),t=0;t<r.length-3*l;++t)e.write_shift(1,r.charCodeAt(t+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function ds(n,e,t,r){return r||(r=te(6)),r.write_shift(2,n),r.write_shift(2,e),r.write_shift(2,t||0),r}function L3(n,e,t){var r=t.biff>8?4:2,i=n.read_shift(r),o=n.read_shift(r,"i"),s=n.read_shift(r,"i");return[i,o,s]}function B3(n){var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(2),i=n.read_shift(2);return{s:{c:r,r:e},e:{c:i,r:t}}}function aD(n,e){return e||(e=te(8)),e.write_shift(2,n.s.r),e.write_shift(2,n.e.r),e.write_shift(2,n.s.c),e.write_shift(2,n.e.c),e}function Hv(n,e,t){var r=1536,i=16;switch(t.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var o=te(i);return o.write_shift(2,r),o.write_shift(2,e),i>4&&o.write_shift(2,29282),i>6&&o.write_shift(2,1997),i>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function V3(n,e){var t=!e||e.biff==8,r=te(t?112:54);for(r.write_shift(e.biff==8?2:1,7),t&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(t?0:536870912));r.l<r.length;)r.write_shift(1,t?0:32);return r}function U3(n,e){var t=!e||e.biff>=8?2:1,r=te(8+t*n.name.length);r.write_shift(4,n.pos),r.write_shift(1,n.hs||0),r.write_shift(1,n.dt),r.write_shift(1,n.name.length),e.biff>=8&&r.write_shift(1,1),r.write_shift(t*n.name.length,n.name,e.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function j3(n,e){var t=te(8);t.write_shift(4,n.Count),t.write_shift(4,n.Unique);for(var r=[],i=0;i<n.length;++i)r[i]=N3(n[i],e);var o=vn([t].concat(r));return o.parts=[t.length].concat(r.map(function(s){return s.length})),o}function H3(){var n=te(18);return n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n}function G3(n){var e=te(18),t=1718;return n&&n.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function $3(n,e){var t=n.name||"Arial",r=e&&e.biff==5,i=r?15+t.length:16+2*t.length,o=te(i);return o.write_shift(2,(n.sz||12)*20),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,t.length),r||o.write_shift(1,1),o.write_shift((r?1:2)*t.length,t,r?"sbcs":"utf16le"),o}function W3(n,e,t,r){var i=te(10);return ds(n,e,r,i),i.write_shift(4,t),i}function z3(n,e,t,r,i){var o=!i||i.biff==8,s=te(8+ +o+(1+o)*t.length);return ds(n,e,r,s),s.write_shift(2,t.length),o&&s.write_shift(1,1),s.write_shift((1+o)*t.length,t,o?"utf16le":"sbcs"),s}function q3(n,e,t,r){var i=t&&t.biff==5;r||(r=te(i?3+e.length:5+2*e.length)),r.write_shift(2,n),r.write_shift(i?1:2,e.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var o=r.length>r.l?r.slice(0,r.l):r;return o.l==null&&(o.l=o.length),o}function K3(n,e){var t=e.biff==8||!e.biff?4:2,r=te(2*t+6);return r.write_shift(t,n.s.r),r.write_shift(t,n.e.r+1),r.write_shift(2,n.s.c),r.write_shift(2,n.e.c+1),r.write_shift(2,0),r}function oC(n,e,t,r){var i=t&&t.biff==5;r||(r=te(i?16:20)),r.write_shift(2,0),n.style?(r.write_shift(2,n.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,n.numFmtId||0),r.write_shift(2,e<<4));var o=0;return n.numFmtId>0&&i&&(o|=1024),r.write_shift(4,o),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function Y3(n){var e=te(8);return e.write_shift(4,0),e.write_shift(2,n[0]?n[0]+1:0),e.write_shift(2,n[1]?n[1]+1:0),e}function X3(n,e,t,r,i,o){var s=te(8);return ds(n,e,r,s),iD(t,o,s),s}function Z3(n,e,t,r){var i=te(14);return ds(n,e,r,i),fs(t,i),i}function Q3(n,e,t){if(t.biff<8)return J3(n,e,t);for(var r=[],i=n.l+e,o=n.read_shift(t.biff>8?4:2);o--!==0;)r.push(L3(n,t.biff>8?12:6,t));if(n.l!=i)throw new Error("Bad ExternSheet: "+n.l+" != "+i);return r}function J3(n,e,t){n[n.l+1]==3&&n[n.l]++;var r=oD(n,e,t);return r.charCodeAt(0)==3?r.slice(1):r}function eL(n){var e=te(2+n.length*8);e.write_shift(2,n.length);for(var t=0;t<n.length;++t)aD(n[t],e);return e}function tL(n){var e=te(24),t=fn(n[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(r[i],16));return vn([e,P3(n[1])])}function nL(n){var e=n[1].Tooltip,t=te(10+2*(e.length+1));t.write_shift(2,2048);var r=fn(n[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var i=0;i<e.length;++i)t.write_shift(2,e.charCodeAt(i));return t.write_shift(2,0),t}function rL(n){return n||(n=te(4)),n.write_shift(2,1),n.write_shift(2,1),n}function iL(n,e,t){if(!t.cellStyles)return mi(n,e);var r=t&&t.biff>=12?4:2,i=n.read_shift(r),o=n.read_shift(r),s=n.read_shift(r),a=n.read_shift(r),l=n.read_shift(2);r==2&&(n.l+=2);var c={s:i,e:o,w:s,ixfe:a,flags:l};return(t.biff>=5||!t.biff)&&(c.level=l>>8&7),c}function oL(n,e){var t=te(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,n.width*256),t.write_shift(2,0);var r=0;return n.hidden&&(r|=1),t.write_shift(1,r),r=n.level||0,t.write_shift(1,r),t.write_shift(2,0),t}function sL(n){for(var e=te(2*n),t=0;t<n;++t)e.write_shift(2,t+1);return e}function aL(n,e,t){var r=te(15);return Ac(r,n,e),r.write_shift(8,t,"f"),r}function lL(n,e,t){var r=te(9);return Ac(r,n,e),r.write_shift(2,t),r}var cL=function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=bv({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(a,l){var c=[],u=us(1);switch(l.type){case"base64":u=$r(Vi(a));break;case"binary":u=$r(a);break;case"buffer":case"array":u=a;break}ur(u,0);var f=u.read_shift(1),h=!!(f&136),d=!1,m=!1;switch(f){case 2:break;case 3:break;case 48:d=!0,h=!0;break;case 49:d=!0,h=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,g=521;f==2&&(p=u.read_shift(2)),u.l+=3,f!=2&&(p=u.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(g=u.read_shift(2));var w=u.read_shift(2),y=l.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(y=n[u[u.l]]),u.l+=1,u.l+=2),m&&(u.l+=36);for(var S=[],B={},Z=Math.min(u.length,f==2?521:g-10-(d?264:0)),ce=m?32:11;u.l<Z&&u[u.l]!=13;)switch(B={},B.name=yt.utils.decode(y,u.slice(u.l,u.l+ce)).replace(/[\u0000\r\n].*$/g,""),u.l+=ce,B.type=String.fromCharCode(u.read_shift(1)),f!=2&&!m&&(B.offset=u.read_shift(4)),B.len=u.read_shift(1),f==2&&(B.offset=u.read_shift(2)),B.dec=u.read_shift(1),B.name.length&&S.push(B),f!=2&&(u.l+=m?13:14),B.type){case"B":(!d||B.len!=8)&&l.WTF&&console.log("Skipping "+B.name+":"+B.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+B.name+":"+B.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+B.type)}if(u[u.l]!==13&&(u.l=g-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=g;var O=0,L=0;for(c[0]=[],L=0;L!=S.length;++L)c[0][L]=S[L].name;for(;p-- >0;){if(u[u.l]===42){u.l+=w;continue}for(++u.l,c[++O]=[],L=0,L=0;L!=S.length;++L){var G=u.slice(u.l,u.l+S[L].len);u.l+=S[L].len,ur(G,0);var V=yt.utils.decode(y,G);switch(S[L].type){case"C":V.trim().length&&(c[O][L]=V.replace(/\s+$/,""));break;case"D":V.length===8?c[O][L]=new Date(+V.slice(0,4),+V.slice(4,6)-1,+V.slice(6,8)):c[O][L]=V;break;case"F":c[O][L]=parseFloat(V.trim());break;case"+":case"I":c[O][L]=m?G.read_shift(-4,"i")^2147483648:G.read_shift(4,"i");break;case"L":switch(V.trim().toUpperCase()){case"Y":case"T":c[O][L]=!0;break;case"N":case"F":c[O][L]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+V+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[O][L]="##MEMO##"+(m?parseInt(V.trim(),10):G.read_shift(4));break;case"N":V=V.replace(/\u0000/g,"").trim(),V&&V!="."&&(c[O][L]=+V||0);break;case"@":c[O][L]=new Date(G.read_shift(-8,"f")-621356832e5);break;case"T":c[O][L]=new Date((G.read_shift(4)-2440588)*864e5+G.read_shift(4));break;case"Y":c[O][L]=G.read_shift(4,"i")/1e4+G.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[O][L]=-G.read_shift(-8,"f");break;case"B":if(d&&S[L].len==8){c[O][L]=G.read_shift(8,"f");break}case"G":case"P":G.l+=S[L].len;break;case"0":if(S[L].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[L].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=S,c}function r(a,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=ka(t(a,c),c);return u["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,u}function i(a,l){try{return hs(r(a,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function s(a,l){var c=l||{};if(+c.codepage>=0&&yc(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Wn(),f=dh(a,{header:1,raw:!0,cellDates:!0}),h=f[0],d=f.slice(1),m=a["!cols"]||[],p=0,g=0,w=0,y=1;for(p=0;p<h.length;++p){if(((m[p]||{}).DBF||{}).name){h[p]=m[p].DBF.name,++w;continue}if(h[p]!=null){if(++w,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(g=0;g<1024;++g)if(h.indexOf(h[p]+"_"+g)==-1){h[p]+="_"+g;break}}}}var S=wt(a["!ref"]),B=[],Z=[],ce=[];for(p=0;p<=S.e.c-S.s.c;++p){var O="",L="",G=0,V=[];for(g=0;g<d.length;++g)d[g][p]!=null&&V.push(d[g][p]);if(V.length==0||h[p]==null){B[p]="?";continue}for(g=0;g<V.length;++g){switch(typeof V[g]){case"number":L="B";break;case"string":L="C";break;case"boolean":L="L";break;case"object":L=V[g]instanceof Date?"D":"C";break;default:L="C"}G=Math.max(G,String(V[g]).length),O=O&&O!=L?"C":L}G>250&&(G=250),L=((m[p]||{}).DBF||{}).type,L=="C"&&m[p].DBF.len>G&&(G=m[p].DBF.len),O=="B"&&L=="N"&&(O="N",ce[p]=m[p].DBF.dec,G=m[p].DBF.len),Z[p]=O=="C"||L=="N"?G:o[O]||0,y+=Z[p],B[p]=O}var K=u.next(32);for(K.write_shift(4,318902576),K.write_shift(4,d.length),K.write_shift(2,296+32*w),K.write_shift(2,y),p=0;p<4;++p)K.write_shift(4,0);for(K.write_shift(4,0|(+e[ba]||3)<<8),p=0,g=0;p<h.length;++p)if(h[p]!=null){var W=u.next(32),ue=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);W.write_shift(1,ue,"sbcs"),W.write_shift(1,B[p]=="?"?"C":B[p],"sbcs"),W.write_shift(4,g),W.write_shift(1,Z[p]||o[B[p]]||0),W.write_shift(1,ce[p]||0),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(1,0),W.write_shift(4,0),W.write_shift(4,0),g+=Z[p]||o[B[p]]||0}var Oe=u.next(264);for(Oe.write_shift(4,13),p=0;p<65;++p)Oe.write_shift(4,0);for(p=0;p<d.length;++p){var Te=u.next(y);for(Te.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(B[g]){case"L":Te.write_shift(1,d[p][g]==null?63:d[p][g]?84:70);break;case"B":Te.write_shift(8,d[p][g]||0,"f");break;case"N":var ie="0";for(typeof d[p][g]=="number"&&(ie=d[p][g].toFixed(ce[g]||0)),w=0;w<Z[g]-ie.length;++w)Te.write_shift(1,32);Te.write_shift(1,ie,"sbcs");break;case"D":d[p][g]?(Te.write_shift(4,("0000"+d[p][g].getFullYear()).slice(-4),"sbcs"),Te.write_shift(2,("00"+(d[p][g].getMonth()+1)).slice(-2),"sbcs"),Te.write_shift(2,("00"+d[p][g].getDate()).slice(-2),"sbcs")):Te.write_shift(8,"00000000","sbcs");break;case"C":var ee=String(d[p][g]!=null?d[p][g]:"").slice(0,Z[g]);for(Te.write_shift(1,ee,"sbcs"),w=0;w<Z[g]-ee.length;++w)Te.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:r,from_sheet:s}}(),uL=function(){var n={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+xn(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(h,d){var m=n[d];return typeof m=="number"?Aw(m):m},r=function(h,d,m){var p=d.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return p==59?h:Aw(p)};n["|"]=254;function i(h,d){switch(d.type){case"base64":return o(Vi(h),d);case"binary":return o(h,d);case"buffer":return o(st&&Buffer.isBuffer(h)?h.toString("binary"):Dc(h),d);case"array":return o(vh(h),d)}throw new Error("Unrecognized type "+d.type)}function o(h,d){var m=h.split(/[\n\r]+/),p=-1,g=-1,w=0,y=0,S=[],B=[],Z=null,ce={},O=[],L=[],G=[],V=0,K;for(+d.codepage>=0&&yc(+d.codepage);w!==m.length;++w){V=0;var W=m[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,t),ue=W.replace(/;;/g,"\0").split(";").map(function(P){return P.replace(/\u0000/g,";")}),Oe=ue[0],Te;if(W.length>0)switch(Oe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ue[1].charAt(0)=="P"&&B.push(W.slice(3).replace(/;;/g,";"));break;case"C":var ie=!1,ee=!1,k=!1,R=!1,pe=-1,De=-1;for(y=1;y<ue.length;++y)switch(ue[y].charAt(0)){case"A":break;case"X":g=parseInt(ue[y].slice(1))-1,ee=!0;break;case"Y":for(p=parseInt(ue[y].slice(1))-1,ee||(g=0),K=S.length;K<=p;++K)S[K]=[];break;case"K":Te=ue[y].slice(1),Te.charAt(0)==='"'?Te=Te.slice(1,Te.length-1):Te==="TRUE"?Te=!0:Te==="FALSE"?Te=!1:isNaN(Li(Te))?isNaN(Ec(Te).getDate())||(Te=Bn(Te)):(Te=Li(Te),Z!==null&&SC(Z)&&(Te=FC(Te))),typeof yt<"u"&&typeof Te=="string"&&(d||{}).type!="string"&&(d||{}).codepage&&(Te=yt.utils.decode(d.codepage,Te)),ie=!0;break;case"E":R=!0;var F=l8(ue[y].slice(1),{r:p,c:g});S[p][g]=[S[p][g],F];break;case"S":k=!0,S[p][g]=[S[p][g],"S5S"];break;case"G":break;case"R":pe=parseInt(ue[y].slice(1))-1;break;case"C":De=parseInt(ue[y].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+W)}if(ie&&(S[p][g]&&S[p][g].length==2?S[p][g][0]=Te:S[p][g]=Te,Z=null),k){if(R)throw new Error("SYLK shared formula cannot have own formula");var U=pe>-1&&S[pe][De];if(!U||!U[1])throw new Error("SYLK shared formula cannot find base");S[p][g][1]=c8(U[1],{r:p-pe,c:g-De})}break;case"F":var M=0;for(y=1;y<ue.length;++y)switch(ue[y].charAt(0)){case"X":g=parseInt(ue[y].slice(1))-1,++M;break;case"Y":for(p=parseInt(ue[y].slice(1))-1,K=S.length;K<=p;++K)S[K]=[];break;case"M":V=parseInt(ue[y].slice(1))/20;break;case"F":break;case"G":break;case"P":Z=B[parseInt(ue[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(G=ue[y].slice(1).split(" "),K=parseInt(G[0],10);K<=parseInt(G[1],10);++K)V=parseInt(G[2],10),L[K-1]=V===0?{hidden:!0}:{wch:V},Gv(L[K-1]);break;case"C":g=parseInt(ue[y].slice(1))-1,L[g]||(L[g]={});break;case"R":p=parseInt(ue[y].slice(1))-1,O[p]||(O[p]={}),V>0?(O[p].hpt=V,O[p].hpx=dD(V)):V===0&&(O[p].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+W)}M<1&&(Z=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+W)}}return O.length>0&&(ce["!rows"]=O),L.length>0&&(ce["!cols"]=L),d&&d.sheetRows&&(S=S.slice(0,d.sheetRows)),[S,ce]}function s(h,d){var m=i(h,d),p=m[0],g=m[1],w=ka(p,d);return xn(g).forEach(function(y){w[y]=g[y]}),w}function a(h,d){return hs(s(h,d),d)}function l(h,d,m,p){var g="C;Y"+(m+1)+";X"+(p+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+Wv(h.f,{r:m,c:p}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function c(h,d){d.forEach(function(m,p){var g="F;W"+(p+1)+" "+(p+1)+" ";m.hidden?g+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=lh(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=ch(m.wpx)),typeof m.wch=="number"&&(g+=Math.round(m.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function u(h,d){d.forEach(function(m,p){var g="F;";m.hidden?g+="M0;":m.hpt?g+="M"+20*m.hpt+";":m.hpx&&(g+="M"+20*uh(m.hpx)+";"),g.length>2&&h.push(g+"R"+(p+1))})}function f(h,d){var m=["ID;PWXL;N;E"],p=[],g=wt(h["!ref"]),w,y=Array.isArray(h),S=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),h["!cols"]&&c(m,h["!cols"]),h["!rows"]&&u(m,h["!rows"]),m.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var B=g.s.r;B<=g.e.r;++B)for(var Z=g.s.c;Z<=g.e.c;++Z){var ce=ht({r:B,c:Z});w=y?(h[B]||[])[Z]:h[ce],!(!w||w.v==null&&(!w.f||w.F))&&p.push(l(w,h,B,Z,d))}return m.join(S)+S+p.join(S)+S+"E"+S}return{to_workbook:a,to_sheet:s,from_sheet:f}}(),fL=function(){function n(o,s){switch(s.type){case"base64":return e(Vi(o),s);case"binary":return e(o,s);case"buffer":return e(st&&Buffer.isBuffer(o)?o.toString("binary"):Dc(o),s);case"array":return e(vh(o),s)}throw new Error("Unrecognized type "+s.type)}function e(o,s){for(var a=o.split(`
`),l=-1,c=-1,u=0,f=[];u!==a.length;++u){if(a[u].trim()==="BOT"){f[++l]=[],c=0;continue}if(!(l<0)){var h=a[u].trim().split(","),d=h[0],m=h[1];++u;for(var p=a[u]||"";(p.match(/["]/g)||[]).length&1&&u<a.length-1;)p+=`
`+a[++u];switch(p=p.trim(),+d){case-1:if(p==="BOT"){f[++l]=[],c=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[l][c]=!0:p==="FALSE"?f[l][c]=!1:isNaN(Li(m))?isNaN(Ec(m).getDate())?f[l][c]=m:f[l][c]=Bn(m):f[l][c]=Li(m),++c;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),uc&&p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[l][c++]=p!==""?p:null;break}if(p==="EOD")break}}return s&&s.sheetRows&&(f=f.slice(0,s.sheetRows)),f}function t(o,s){return ka(n(o,s),s)}function r(o,s){return hs(t(o,s),s)}var i=function(){var o=function(l,c,u,f,h){l.push(c),l.push(u+","+f),l.push('"'+h.replace(/"/g,'""')+'"')},s=function(l,c,u,f){l.push(c+","+u),l.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var c=[],u=wt(l["!ref"]),f,h=Array.isArray(l);o(c,"TABLE",0,1,"sheetjs"),o(c,"VECTORS",0,u.e.r-u.s.r+1,""),o(c,"TUPLES",0,u.e.c-u.s.c+1,""),o(c,"DATA",0,0,"");for(var d=u.s.r;d<=u.e.r;++d){s(c,-1,0,"BOT");for(var m=u.s.c;m<=u.e.c;++m){var p=ht({r:d,c:m});if(f=h?(l[d]||[])[m]:l[p],!f){s(c,1,0,"");continue}switch(f.t){case"n":var g=uc?f.w:f.v;!g&&f.v!=null&&(g=f.v),g==null?uc&&f.f&&!f.F?s(c,1,0,"="+f.f):s(c,1,0,""):s(c,0,g,"V");break;case"b":s(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":s(c,1,0,!uc||isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=xo(f.z||Bt[14],zn(Bn(f.v)))),uc?s(c,0,f.w,"V"):s(c,1,0,f.w);break;default:s(c,1,0,"")}}}s(c,-1,0,"EOD");var w=`\r
`,y=c.join(w);return y}}();return{to_workbook:r,to_sheet:t,from_sheet:i}}(),lD=function(){function n(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(f,h){for(var d=f.split(`
`),m=-1,p=-1,g=0,w=[];g!==d.length;++g){var y=d[g].trim().split(":");if(y[0]==="cell"){var S=fn(y[1]);if(w.length<=S.r)for(m=w.length;m<=S.r;++m)w[m]||(w[m]=[]);switch(m=S.r,p=S.c,y[2]){case"t":w[m][p]=n(y[3]);break;case"v":w[m][p]=+y[3];break;case"vtf":var B=y[y.length-1];case"vtc":switch(y[3]){case"nl":w[m][p]=!!+y[4];break;default:w[m][p]=+y[4];break}y[2]=="vtf"&&(w[m][p]=[w[m][p],B])}}}return h&&h.sheetRows&&(w=w.slice(0,h.sheetRows)),w}function r(f,h){return ka(t(f,h),h)}function i(f,h){return hs(r(f,h),h)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var h=[],d=[],m,p="",g=dr(f["!ref"]),w=Array.isArray(f),y=g.s.r;y<=g.e.r;++y)for(var S=g.s.c;S<=g.e.c;++S)if(p=ht({r:y,c:S}),m=w?(f[y]||[])[S]:f[p],!(!m||m.v==null||m.t==="z")){switch(d=["cell",p,"t"],m.t){case"s":case"str":d.push(e(m.v));break;case"n":m.f?(d[2]="vtf",d[3]="n",d[4]=m.v,d[5]=e(m.f)):(d[2]="v",d[3]=m.v);break;case"b":d[2]="vt"+(m.f?"f":"c"),d[3]="nl",d[4]=m.v?"1":"0",d[5]=e(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var B=zn(Bn(m.v));d[2]="vtc",d[3]="nd",d[4]=""+B,d[5]=m.w||xo(m.z||Bt[14],B);break;case"e":continue}h.push(d.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(f){return[o,s,a,s,c(f),l].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:u}}(),dL=function(){function n(u,f,h,d,m){m.raw?f[h][d]=u:u===""||(u==="TRUE"?f[h][d]=!0:u==="FALSE"?f[h][d]=!1:isNaN(Li(u))?isNaN(Ec(u).getDate())?f[h][d]=u:f[h][d]=Bn(u):f[h][d]=Li(u))}function e(u,f){var h=f||{},d=[];if(!u||u.length===0)return d;for(var m=u.split(/[\r\n]/),p=m.length-1;p>=0&&m[p].length===0;)--p;for(var g=10,w=0,y=0;y<=p;++y)w=m[y].indexOf(" "),w==-1?w=m[y].length:w++,g=Math.max(g,w);for(y=0;y<=p;++y){d[y]=[];var S=0;for(n(m[y].slice(0,g).trim(),d,y,S,h),S=1;S<=(m[y].length-g)/10+1;++S)n(m[y].slice(g+(S-1)*10,g+S*10).trim(),d,y,S,h)}return h.sheetRows&&(d=d.slice(0,h.sheetRows)),d}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(u){for(var f={},h=!1,d=0,m=0;d<u.length;++d)(m=u.charCodeAt(d))==34?h=!h:!h&&m in t&&(f[m]=(f[m]||0)+1);m=[];for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&m.push([f[d],d]);if(!m.length){f=r;for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&m.push([f[d],d])}return m.sort(function(p,g){return p[0]-g[0]||r[p[1]]-r[g[1]]}),t[m.pop()[1]]||44}function o(u,f){var h=f||{},d="";pi!=null&&h.dense==null&&(h.dense=pi);var m=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(d=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(d=u.charAt(4),u=u.slice(6)):d=i(u.slice(0,1024)):h&&h.FS?d=h.FS:d=i(u.slice(0,1024));var g=0,w=0,y=0,S=0,B=0,Z=d.charCodeAt(0),ce=!1,O=0,L=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var G=h.dateNF!=null?b4(h.dateNF):null;function V(){var K=u.slice(S,B),W={};if(K.charAt(0)=='"'&&K.charAt(K.length-1)=='"'&&(K=K.slice(1,-1).replace(/""/g,'"')),K.length===0)W.t="z";else if(h.raw)W.t="s",W.v=K;else if(K.trim().length===0)W.t="s",W.v=K;else if(K.charCodeAt(0)==61)K.charCodeAt(1)==34&&K.charCodeAt(K.length-1)==34?(W.t="s",W.v=K.slice(2,-1).replace(/""/g,'"')):u8(K)?(W.t="n",W.f=K.slice(1)):(W.t="s",W.v=K);else if(K=="TRUE")W.t="b",W.v=!0;else if(K=="FALSE")W.t="b",W.v=!1;else if(!isNaN(y=Li(K)))W.t="n",h.cellText!==!1&&(W.w=K),W.v=y;else if(!isNaN(Ec(K).getDate())||G&&K.match(G)){W.z=h.dateNF||Bt[14];var ue=0;G&&K.match(G)&&(K=I4(K,h.dateNF,K.match(G)||[]),ue=1),h.cellDates?(W.t="d",W.v=Bn(K,ue)):(W.t="n",W.v=zn(Bn(K,ue))),h.cellText!==!1&&(W.w=xo(W.z,W.v instanceof Date?zn(W.v):W.v)),h.cellNF||delete W.z}else W.t="s",W.v=K;if(W.t=="z"||(h.dense?(m[g]||(m[g]=[]),m[g][w]=W):m[ht({c:w,r:g})]=W),S=B+1,L=u.charCodeAt(S),p.e.c<w&&(p.e.c=w),p.e.r<g&&(p.e.r=g),O==Z)++w;else if(w=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;B<u.length;++B)switch(O=u.charCodeAt(B)){case 34:L===34&&(ce=!ce);break;case Z:case 10:case 13:if(!ce&&V())break e;break;default:break}return B-S>0&&V(),m["!ref"]=qt(p),m}function s(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?o(u,f):ka(e(u,f),f)}function a(u,f){var h="",d=f.type=="string"?[0,0,0,0]:CV(u,f);switch(f.type){case"base64":h=Vi(u);break;case"binary":h=u;break;case"buffer":f.codepage==65001?h=u.toString("utf8"):f.codepage&&typeof yt<"u"?h=yt.utils.decode(f.codepage,u):h=st&&Buffer.isBuffer(u)?u.toString("binary"):Dc(u);break;case"array":h=vh(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+f.type)}return d[0]==239&&d[1]==187&&d[2]==191?h=hc(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=hc(h):f.type=="binary"&&typeof yt<"u"&&f.codepage&&(h=yt.utils.decode(f.codepage,yt.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?lD.to_sheet(f.type=="string"?h:hc(h),f):s(h,f)}function l(u,f){return hs(a(u,f),f)}function c(u){for(var f=[],h=wt(u["!ref"]),d,m=Array.isArray(u),p=h.s.r;p<=h.e.r;++p){for(var g=[],w=h.s.c;w<=h.e.c;++w){var y=ht({r:p,c:w});if(d=m?(u[p]||[])[w]:u[y],!d||d.v==null){g.push("          ");continue}for(var S=(d.w||(Ui(d),d.w)||"").slice(0,10);S.length<10;)S+=" ";g.push(S+(w===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:a,from_sheet:c}}();var sC=function(){function n(F,U,M){if(F){ur(F,F.l||0);for(var P=M.Enum||pe;F.l<F.length;){var se=F.read_shift(2),he=P[se]||P[65535],Q=F.read_shift(2),j=F.l+Q,N=he.f&&he.f(F,Q,M);if(F.l=j,U(N,he,se))return}}}function e(F,U){switch(U.type){case"base64":return t($r(Vi(F)),U);case"binary":return t($r(F),U);case"buffer":case"array":return t(F,U)}throw"Unsupported type "+U.type}function t(F,U){if(!F)return F;var M=U||{};pi!=null&&M.dense==null&&(M.dense=pi);var P=M.dense?[]:{},se="Sheet1",he="",Q=0,j={},N=[],oe=[],ge={s:{r:0,c:0},e:{r:0,c:0}},Fe=M.sheetRows||0;if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)M.Enum=pe,n(F,function(fe,Xe,et){switch(et){case 0:M.vers=fe,fe>=4096&&(M.qpro=!0);break;case 6:ge=fe;break;case 204:fe&&(he=fe);break;case 222:he=fe;break;case 15:case 51:M.qpro||(fe[1].v=fe[1].v.slice(1));case 13:case 14:case 16:et==14&&(fe[2]&112)==112&&(fe[2]&15)>1&&(fe[2]&15)<15&&(fe[1].z=M.dateNF||Bt[14],M.cellDates&&(fe[1].t="d",fe[1].v=FC(fe[1].v))),M.qpro&&fe[3]>Q&&(P["!ref"]=qt(ge),j[se]=P,N.push(se),P=M.dense?[]:{},ge={s:{r:0,c:0},e:{r:0,c:0}},Q=fe[3],se=he||"Sheet"+(Q+1),he="");var En=M.dense?(P[fe[0].r]||[])[fe[0].c]:P[ht(fe[0])];if(En){En.t=fe[1].t,En.v=fe[1].v,fe[1].z!=null&&(En.z=fe[1].z),fe[1].f!=null&&(En.f=fe[1].f);break}M.dense?(P[fe[0].r]||(P[fe[0].r]=[]),P[fe[0].r][fe[0].c]=fe[1]):P[ht(fe[0])]=fe[1];break;default:}},M);else if(F[2]==26||F[2]==14)M.Enum=De,F[2]==14&&(M.qpro=!0,F.l=0),n(F,function(fe,Xe,et){switch(et){case 204:se=fe;break;case 22:fe[1].v=fe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(fe[3]>Q&&(P["!ref"]=qt(ge),j[se]=P,N.push(se),P=M.dense?[]:{},ge={s:{r:0,c:0},e:{r:0,c:0}},Q=fe[3],se="Sheet"+(Q+1)),Fe>0&&fe[0].r>=Fe)break;M.dense?(P[fe[0].r]||(P[fe[0].r]=[]),P[fe[0].r][fe[0].c]=fe[1]):P[ht(fe[0])]=fe[1],ge.e.c<fe[0].c&&(ge.e.c=fe[0].c),ge.e.r<fe[0].r&&(ge.e.r=fe[0].r);break;case 27:fe[14e3]&&(oe[fe[14e3][0]]=fe[14e3][1]);break;case 1537:oe[fe[0]]=fe[1],fe[0]==Q&&(se=fe[1]);break;default:break}},M);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(P["!ref"]=qt(ge),j[he||se]=P,N.push(he||se),!oe.length)return{SheetNames:N,Sheets:j};for(var me={},Ne=[],ke=0;ke<oe.length;++ke)j[N[ke]]?(Ne.push(oe[ke]||N[ke]),me[oe[ke]]=j[oe[ke]]||j[N[ke]]):(Ne.push(oe[ke]),me[oe[ke]]={"!ref":"A1"});return{SheetNames:Ne,Sheets:me}}function r(F,U){var M=U||{};if(+M.codepage>=0&&yc(+M.codepage),M.type=="string")throw new Error("Cannot write WK1 to JS string");var P=Wn(),se=wt(F["!ref"]),he=Array.isArray(F),Q=[];_e(P,0,o(1030)),_e(P,6,l(se));for(var j=Math.min(se.e.r,8191),N=se.s.r;N<=j;++N)for(var oe=yn(N),ge=se.s.c;ge<=se.e.c;++ge){N===se.s.r&&(Q[ge]=Fn(ge));var Fe=Q[ge]+oe,me=he?(F[N]||[])[ge]:F[Fe];if(!(!me||me.t=="z"))if(me.t=="n")(me.v|0)==me.v&&me.v>=-32768&&me.v<=32767?_e(P,13,d(N,ge,me.v)):_e(P,14,p(N,ge,me.v));else{var Ne=Ui(me);_e(P,15,f(N,ge,Ne.slice(0,239)))}}return _e(P,1),P.end()}function i(F,U){var M=U||{};if(+M.codepage>=0&&yc(+M.codepage),M.type=="string")throw new Error("Cannot write WK3 to JS string");var P=Wn();_e(P,0,s(F));for(var se=0,he=0;se<F.SheetNames.length;++se)(F.Sheets[F.SheetNames[se]]||{})["!ref"]&&_e(P,27,R(F.SheetNames[se],he++));var Q=0;for(se=0;se<F.SheetNames.length;++se){var j=F.Sheets[F.SheetNames[se]];if(!(!j||!j["!ref"])){for(var N=wt(j["!ref"]),oe=Array.isArray(j),ge=[],Fe=Math.min(N.e.r,8191),me=N.s.r;me<=Fe;++me)for(var Ne=yn(me),ke=N.s.c;ke<=N.e.c;++ke){me===N.s.r&&(ge[ke]=Fn(ke));var fe=ge[ke]+Ne,Xe=oe?(j[me]||[])[ke]:j[fe];if(!(!Xe||Xe.t=="z"))if(Xe.t=="n")_e(P,23,V(me,ke,Q,Xe.v));else{var et=Ui(Xe);_e(P,22,O(me,ke,Q,et.slice(0,239)))}}++Q}}return _e(P,1),P.end()}function o(F){var U=te(2);return U.write_shift(2,F),U}function s(F){var U=te(26);U.write_shift(2,4096),U.write_shift(2,4),U.write_shift(4,0);for(var M=0,P=0,se=0,he=0;he<F.SheetNames.length;++he){var Q=F.SheetNames[he],j=F.Sheets[Q];if(!(!j||!j["!ref"])){++se;var N=dr(j["!ref"]);M<N.e.r&&(M=N.e.r),P<N.e.c&&(P=N.e.c)}}return M>8191&&(M=8191),U.write_shift(2,M),U.write_shift(1,se),U.write_shift(1,P),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(1,1),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(4,0),U}function a(F,U,M){var P={s:{c:0,r:0},e:{c:0,r:0}};return U==8&&M.qpro?(P.s.c=F.read_shift(1),F.l++,P.s.r=F.read_shift(2),P.e.c=F.read_shift(1),F.l++,P.e.r=F.read_shift(2),P):(P.s.c=F.read_shift(2),P.s.r=F.read_shift(2),U==12&&M.qpro&&(F.l+=2),P.e.c=F.read_shift(2),P.e.r=F.read_shift(2),U==12&&M.qpro&&(F.l+=2),P.s.c==65535&&(P.s.c=P.e.c=P.s.r=P.e.r=0),P)}function l(F){var U=te(8);return U.write_shift(2,F.s.c),U.write_shift(2,F.s.r),U.write_shift(2,F.e.c),U.write_shift(2,F.e.r),U}function c(F,U,M){var P=[{c:0,r:0},{t:"n",v:0},0,0];return M.qpro&&M.vers!=20768?(P[0].c=F.read_shift(1),P[3]=F.read_shift(1),P[0].r=F.read_shift(2),F.l+=2):(P[2]=F.read_shift(1),P[0].c=F.read_shift(2),P[0].r=F.read_shift(2)),P}function u(F,U,M){var P=F.l+U,se=c(F,U,M);if(se[1].t="s",M.vers==20768){F.l++;var he=F.read_shift(1);return se[1].v=F.read_shift(he,"utf8"),se}return M.qpro&&F.l++,se[1].v=F.read_shift(P-F.l,"cstr"),se}function f(F,U,M){var P=te(7+M.length);P.write_shift(1,255),P.write_shift(2,U),P.write_shift(2,F),P.write_shift(1,39);for(var se=0;se<P.length;++se){var he=M.charCodeAt(se);P.write_shift(1,he>=128?95:he)}return P.write_shift(1,0),P}function h(F,U,M){var P=c(F,U,M);return P[1].v=F.read_shift(2,"i"),P}function d(F,U,M){var P=te(7);return P.write_shift(1,255),P.write_shift(2,U),P.write_shift(2,F),P.write_shift(2,M,"i"),P}function m(F,U,M){var P=c(F,U,M);return P[1].v=F.read_shift(8,"f"),P}function p(F,U,M){var P=te(13);return P.write_shift(1,255),P.write_shift(2,U),P.write_shift(2,F),P.write_shift(8,M,"f"),P}function g(F,U,M){var P=F.l+U,se=c(F,U,M);if(se[1].v=F.read_shift(8,"f"),M.qpro)F.l=P;else{var he=F.read_shift(2);B(F.slice(F.l,F.l+he),se),F.l+=he}return se}function w(F,U,M){var P=U&32768;return U&=-32769,U=(P?F:0)+(U>=8192?U-16384:U),(P?"":"$")+(M?Fn(U):yn(U))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function B(F,U){ur(F,0);for(var M=[],P=0,se="",he="",Q="",j="";F.l<F.length;){var N=F[F.l++];switch(N){case 0:M.push(F.read_shift(8,"f"));break;case 1:he=w(U[0].c,F.read_shift(2),!0),se=w(U[0].r,F.read_shift(2),!1),M.push(he+se);break;case 2:{var oe=w(U[0].c,F.read_shift(2),!0),ge=w(U[0].r,F.read_shift(2),!1);he=w(U[0].c,F.read_shift(2),!0),se=w(U[0].r,F.read_shift(2),!1),M.push(oe+ge+":"+he+se)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:M.push("("+M.pop()+")");break;case 5:M.push(F.read_shift(2));break;case 6:{for(var Fe="";N=F[F.l++];)Fe+=String.fromCharCode(N);M.push('"'+Fe.replace(/"/g,'""')+'"')}break;case 8:M.push("-"+M.pop());break;case 23:M.push("+"+M.pop());break;case 22:M.push("NOT("+M.pop()+")");break;case 20:case 21:j=M.pop(),Q=M.pop(),M.push(["AND","OR"][N-20]+"("+Q+","+j+")");break;default:if(N<32&&S[N])j=M.pop(),Q=M.pop(),M.push(Q+S[N]+j);else if(y[N]){if(P=y[N][1],P==69&&(P=F[F.l++]),P>M.length){console.error("WK1 bad formula parse 0x"+N.toString(16)+":|"+M.join("|")+"|");return}var me=M.slice(-P);M.length-=P,M.push(y[N][0]+"("+me.join(",")+")")}else return N<=7?console.error("WK1 invalid opcode "+N.toString(16)):N<=24?console.error("WK1 unsupported op "+N.toString(16)):N<=30?console.error("WK1 invalid opcode "+N.toString(16)):N<=115?console.error("WK1 unsupported function opcode "+N.toString(16)):console.error("WK1 unrecognized opcode "+N.toString(16))}}M.length==1?U[1].f=""+M[0]:console.error("WK1 bad formula parse |"+M.join("|")+"|")}function Z(F){var U=[{c:0,r:0},{t:"n",v:0},0];return U[0].r=F.read_shift(2),U[3]=F[F.l++],U[0].c=F[F.l++],U}function ce(F,U){var M=Z(F,U);return M[1].t="s",M[1].v=F.read_shift(U-4,"cstr"),M}function O(F,U,M,P){var se=te(6+P.length);se.write_shift(2,F),se.write_shift(1,M),se.write_shift(1,U),se.write_shift(1,39);for(var he=0;he<P.length;++he){var Q=P.charCodeAt(he);se.write_shift(1,Q>=128?95:Q)}return se.write_shift(1,0),se}function L(F,U){var M=Z(F,U);M[1].v=F.read_shift(2);var P=M[1].v>>1;if(M[1].v&1)switch(P&7){case 0:P=(P>>3)*5e3;break;case 1:P=(P>>3)*500;break;case 2:P=(P>>3)/20;break;case 3:P=(P>>3)/200;break;case 4:P=(P>>3)/2e3;break;case 5:P=(P>>3)/2e4;break;case 6:P=(P>>3)/16;break;case 7:P=(P>>3)/64;break}return M[1].v=P,M}function G(F,U){var M=Z(F,U),P=F.read_shift(4),se=F.read_shift(4),he=F.read_shift(2);if(he==65535)return P===0&&se===3221225472?(M[1].t="e",M[1].v=15):P===0&&se===3489660928?(M[1].t="e",M[1].v=42):M[1].v=0,M;var Q=he&32768;return he=(he&32767)-16446,M[1].v=(1-Q*2)*(se*Math.pow(2,he+32)+P*Math.pow(2,he)),M}function V(F,U,M,P){var se=te(14);if(se.write_shift(2,F),se.write_shift(1,M),se.write_shift(1,U),P==0)return se.write_shift(4,0),se.write_shift(4,0),se.write_shift(2,65535),se;var he=0,Q=0,j=0,N=0;return P<0&&(he=1,P=-P),Q=Math.log2(P)|0,P/=Math.pow(2,Q-31),N=P>>>0,(N&2147483648)==0&&(P/=2,++Q,N=P>>>0),P-=N,N|=2147483648,N>>>=0,P*=Math.pow(2,32),j=P>>>0,se.write_shift(4,j),se.write_shift(4,N),Q+=16383+(he?32768:0),se.write_shift(2,Q),se}function K(F,U){var M=G(F,14);return F.l+=U-14,M}function W(F,U){var M=Z(F,U),P=F.read_shift(4);return M[1].v=P>>6,M}function ue(F,U){var M=Z(F,U),P=F.read_shift(8,"f");return M[1].v=P,M}function Oe(F,U){var M=ue(F,14);return F.l+=U-10,M}function Te(F,U){return F[F.l+U-1]==0?F.read_shift(U,"cstr"):""}function ie(F,U){var M=F[F.l++];M>U-1&&(M=U-1);for(var P="";P.length<M;)P+=String.fromCharCode(F[F.l++]);return P}function ee(F,U,M){if(!(!M.qpro||U<21)){var P=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var se=F.read_shift(U-21,"cstr");return[P,se]}}function k(F,U){for(var M={},P=F.l+U;F.l<P;){var se=F.read_shift(2);if(se==14e3){for(M[se]=[0,""],M[se][0]=F.read_shift(2);F[F.l];)M[se][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return M}function R(F,U){var M=te(5+F.length);M.write_shift(2,14e3),M.write_shift(2,U);for(var P=0;P<F.length;++P){var se=F.charCodeAt(P);M[M.l++]=se>127?95:se}return M[M.l++]=0,M}var pe={0:{n:"BOF",f:rD},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:a},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Te},222:{n:"SHEETNAMELP",f:ie},65535:{n:""}},De={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:ce},23:{n:"NUMBER17",f:G},24:{n:"NUMBER18",f:L},25:{n:"FORMULA19",f:K},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:k},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:W},38:{n:"??"},39:{n:"NUMBER27",f:ue},40:{n:"FORMULA28",f:Oe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Te},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ee},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:i,to_workbook:e}}();var hL=/^\s|\s$|[\t\n\r]/;function cD(n,e){if(!e.bookSST)return"";var t=[Kt];t[t.length]=ve("sst",null,{xmlns:Aa[0],count:n.Count,uniqueCount:n.Unique});for(var r=0;r!=n.length;++r)if(n[r]!=null){var i=n[r],o="<si>";i.r?o+=i.r:(o+="<t",i.t||(i.t=""),i.t.match(hL)&&(o+=' xml:space="preserve"'),o+=">"+dt(i.t)+"</t>"),o+="</si>",t[t.length]=o}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function pL(n){return[n.read_shift(4),n.read_shift(4)]}function mL(n,e){return e||(e=te(8)),e.write_shift(4,n.Count),e.write_shift(4,n.Unique),e}var gL=s3;function vL(n){var e=Wn();le(e,159,mL(n));for(var t=0;t<n.length;++t)le(e,19,gL(n[t]));return le(e,160),e.end()}function _L(n){if(typeof yt<"u")return yt.utils.encode(ba,n);for(var e=[],t=n.split(""),r=0;r<t.length;++r)e[r]=t[r].charCodeAt(0);return e}function uD(n){var e=0,t,r=_L(n),i=r.length+1,o,s,a,l,c;for(t=us(i),t[0]=r.length,o=1;o!=i;++o)t[o]=r[o-1];for(o=i-1;o>=0;--o)s=t[o],a=(e&16384)===0?0:1,l=e<<1&32767,c=a|l,e=c^s;return e^52811}var yL=function(){function n(i,o){switch(o.type){case"base64":return e(Vi(i),o);case"binary":return e(i,o);case"buffer":return e(st&&Buffer.isBuffer(i)?i.toString("binary"):Dc(i),o);case"array":return e(vh(i),o)}throw new Error("Unrecognized type "+o.type)}function e(i,o){var s=o||{},a=s.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,f){Array.isArray(a)&&(a[f]=[]);for(var h=/\\\w+\b/g,d=0,m,p=-1;m=h.exec(u);){switch(m[0]){case"\\cell":var g=u.slice(d,h.lastIndex-m[0].length);if(g[0]==" "&&(g=g.slice(1)),++p,g.length){var w={v:g,t:"s"};Array.isArray(a)?a[f][p]=w:a[ht({r:f,c:p})]=w}break}d=h.lastIndex}p>c.e.c&&(c.e.c=p)}),a["!ref"]=qt(c),a}function t(i,o){return hs(n(i,o),o)}function r(i){for(var o=["{\\rtf1\\ansi"],s=wt(i["!ref"]),a,l=Array.isArray(i),c=s.s.r;c<=s.e.r;++c){o.push("\\trowd\\trautofit1");for(var u=s.s.c;u<=s.e.c;++u)o.push("\\cellx"+(u+1));for(o.push("\\pard\\intbl"),u=s.s.c;u<=s.e.c;++u){var f=ht({r:c,c:u});a=l?(i[c]||[])[u]:i[f],!(!a||a.v==null&&(!a.f||a.F))&&(o.push(" "+(a.w||(Ui(a),a.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:t,to_sheet:n,from_sheet:r}}();function aC(n){for(var e=0,t=1;e!=3;++e)t=t*256+(n[e]>255?255:n[e]<0?0:n[e]);return t.toString(16).toUpperCase().slice(1)}var xL=6;var Bi=xL;function lh(n){return Math.floor((n+Math.round(128/Bi)/256)*Bi)}function ch(n){return Math.floor((n-5)/Bi*100+.5)/100}function Cv(n){return Math.round((n*Bi+5)/Bi*256)/256}function Gv(n){n.width?(n.wpx=lh(n.width),n.wch=ch(n.wpx),n.MDW=Bi):n.wpx?(n.wch=ch(n.wpx),n.width=Cv(n.wch),n.MDW=Bi):typeof n.wch=="number"&&(n.width=Cv(n.wch),n.wpx=lh(n.width),n.MDW=Bi),n.customWidth&&delete n.customWidth}var EL=96,fD=EL;function uh(n){return n*96/fD}function dD(n){return n*fD/96}function TL(n){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var r=t[0];r<=t[1];++r)n[r]!=null&&(e[e.length]=ve("numFmt",null,{numFmtId:r,formatCode:dt(n[r])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=ve("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function wL(n){var e=[];return e[e.length]=ve("cellXfs",null),n.forEach(function(t){e[e.length]=ve("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=ve("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function hD(n,e){var t=[Kt,ve("styleSheet",null,{xmlns:Aa[0],"xmlns:vt":un.vt})],r;return n.SSF&&(r=TL(n.SSF))!=null&&(t[t.length]=r),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=wL(e.cellXfs))&&(t[t.length]=r),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function CL(n,e){var t=n.read_shift(2),r=kn(n,e-2);return[t,r]}function DL(n,e,t){t||(t=te(6+4*e.length)),t.write_shift(2,n),dn(e,t);var r=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),r}function SL(n,e,t){var r={};r.sz=n.read_shift(2)/20;var i=h3(n,2,t);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var o=n.read_shift(2);switch(o===700&&(r.bold=1),n.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var s=n.read_shift(1);s!=0&&(r.underline=s);var a=n.read_shift(1);a>0&&(r.family=a);var l=n.read_shift(1);switch(l>0&&(r.charset=l),n.l++,r.color=d3(n,8),n.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=kn(n,e-21),r}function bL(n,e){e||(e=te(25+4*32)),e.write_shift(2,n.sz*20),p3(n,e),e.write_shift(2,n.bold?700:400);var t=0;n.vertAlign=="superscript"?t=1:n.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,n.underline||0),e.write_shift(1,n.family||0),e.write_shift(1,n.charset||0),e.write_shift(1,0),sh(n.color,e);var r=0;return n.scheme=="major"&&(r=1),n.scheme=="minor"&&(r=2),e.write_shift(1,r),dn(n.name,e),e.length>e.l?e.slice(0,e.l):e}var IL=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],vv,AL=mi;function lC(n,e){e||(e=te(4*3+8*7+16*1)),vv||(vv=bv(IL));var t=vv[n.patternType];t==null&&(t=40),e.write_shift(4,t);var r=0;if(t!=40)for(sh({auto:1},e),sh({auto:1},e);r<12;++r)e.write_shift(4,0);else{for(;r<4;++r)e.write_shift(4,0);for(;r<12;++r)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function FL(n,e){var t=n.l+e,r=n.read_shift(2),i=n.read_shift(2);return n.l=t,{ixfe:r,numFmtId:i}}function pD(n,e,t){t||(t=te(16)),t.write_shift(2,e||0),t.write_shift(2,n.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var r=0;return t.write_shift(1,r),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function fc(n,e){return e||(e=te(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var kL=mi;function NL(n,e){return e||(e=te(51)),e.write_shift(1,0),fc(null,e),fc(null,e),fc(null,e),fc(null,e),fc(null,e),e.length>e.l?e.slice(0,e.l):e}function ML(n,e){return e||(e=te(12+4*10)),e.write_shift(4,n.xfId),e.write_shift(2,1),e.write_shift(1,+n.builtinId),e.write_shift(1,0),oh(n.name||"",e),e.length>e.l?e.slice(0,e.l):e}function OL(n,e,t){var r=te(2052);return r.write_shift(4,n),oh(e,r),oh(t,r),r.length>r.l?r.slice(0,r.l):r}function RL(n,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&++t}),t!=0&&(le(n,615,zr(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&le(n,44,DL(i,e[i]))}),le(n,616))}}function PL(n){var e=1;e!=0&&(le(n,611,zr(e)),le(n,43,bL({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),le(n,612))}function LL(n){var e=2;e!=0&&(le(n,603,zr(e)),le(n,45,lC({patternType:"none"})),le(n,45,lC({patternType:"gray125"})),le(n,604))}function BL(n){var e=1;e!=0&&(le(n,613,zr(e)),le(n,46,NL({})),le(n,614))}function VL(n){var e=1;le(n,626,zr(e)),le(n,47,pD({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),le(n,627)}function UL(n,e){le(n,617,zr(e.length)),e.forEach(function(t){le(n,47,pD(t,0))}),le(n,618)}function jL(n){var e=1;le(n,619,zr(e)),le(n,48,ML({xfId:0,builtinId:0,name:"Normal"})),le(n,620)}function HL(n){var e=0;le(n,505,zr(e)),le(n,506)}function GL(n){var e=0;le(n,508,OL(e,"TableStyleMedium9","PivotStyleMedium4")),le(n,509)}function $L(n,e){var t=Wn();return le(t,278),RL(t,n.SSF),PL(t,n),LL(t,n),BL(t,n),VL(t,n),UL(t,e.cellXfs),jL(t,n),HL(t,n),GL(t,n),le(t,279),t.end()}function mD(n,e){if(e&&e.themeXLSX)return e.themeXLSX;if(n&&typeof n.raw=="string")return n.raw;var t=[Kt];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',t[t.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',t[t.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',t[t.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',t[t.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',t[t.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',t[t.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function WL(n,e){return{flags:n.read_shift(4),version:n.read_shift(4),name:kn(n,e-8)}}function zL(n){var e=te(12+2*n.name.length);return e.write_shift(4,n.flags),e.write_shift(4,n.version),dn(n.name,e),e.slice(0,e.l)}function qL(n){for(var e=[],t=n.read_shift(4);t-- >0;)e.push([n.read_shift(4),n.read_shift(4)]);return e}function KL(n){var e=te(4+8*n.length);e.write_shift(4,n.length);for(var t=0;t<n.length;++t)e.write_shift(4,n[t][0]),e.write_shift(4,n[t][1]);return e}function YL(n,e){var t=te(8+2*e.length);return t.write_shift(4,n),dn(e,t),t.slice(0,t.l)}function XL(n){return n.l+=4,n.read_shift(4)!=0}function ZL(n,e){var t=te(8);return t.write_shift(4,n),t.write_shift(4,e?1:0),t}function QL(){var n=Wn();return le(n,332),le(n,334,zr(1)),le(n,335,zL({name:"XLDAPR",version:12e4,flags:3496657072})),le(n,336),le(n,339,YL(1,"XLDAPR")),le(n,52),le(n,35,zr(514)),le(n,4096,zr(0)),le(n,4097,Sr(1)),le(n,36),le(n,53),le(n,340),le(n,337,ZL(1,!0)),le(n,51,KL([[1,0]])),le(n,338),le(n,333),n.end()}function gD(){var n=[Kt];return n.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),n.join("")}function JL(n){var e={};e.i=n.read_shift(4);var t={};t.r=n.read_shift(4),t.c=n.read_shift(4),e.r=ht(t);var r=n.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}var Ea=1024;function vD(n,e){for(var t=[21600,21600],r=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),i=[ve("xml",null,{"xmlns:v":fr.v,"xmlns:o":fr.o,"xmlns:x":fr.x,"xmlns:mv":fr.mv}).replace(/\/>/,">"),ve("o:shapelayout",ve("o:idmap",null,{"v:ext":"edit",data:n}),{"v:ext":"edit"}),ve("v:shapetype",[ve("v:stroke",null,{joinstyle:"miter"}),ve("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:r})];Ea<n*1e3;)Ea+=1e3;return e.forEach(function(o){var s=fn(o[0]),a={color2:"#BEFF82",type:"gradient"};a.type=="gradient"&&(a.angle="-180");var l=a.type=="gradient"?ve("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=ve("v:fill",l,a),u={on:"t",obscured:"t"};++Ea,i=i.concat(["<v:shape"+Tc({id:"_x0000_s"+Ea,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(o[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,ve("v:shadow",null,u),ve("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",_n("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),_n("x:AutoFill","False"),_n("x:Row",String(s.r)),_n("x:Column",String(s.c)),o[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function _D(n){var e=[Kt,ve("comments",null,{xmlns:Aa[0]})],t=[];return e.push("<authors>"),n.forEach(function(r){r[1].forEach(function(i){var o=dt(i.a);t.indexOf(o)==-1&&(t.push(o),e.push("<author>"+o+"</author>")),i.T&&i.ID&&t.indexOf("tc="+i.ID)==-1&&(t.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),n.forEach(function(r){var i=0,o=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?i=t.indexOf("tc="+r[1][0].ID):r[1].forEach(function(l){l.a&&(i=t.indexOf(dt(l.a))),o.push(l.t||"")}),e.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>'),o.length<=1)e.push(_n("t",dt(o[0]||"")));else{for(var s=`Comment:
    `+o[0]+`
`,a=1;a<o.length;++a)s+=`Reply:
    `+o[a]+`
`;e.push(_n("t",dt(s)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function e8(n,e,t){var r=[Kt,ve("ThreadedComments",null,{xmlns:un.TCMNT}).replace(/[\/]>/,">")];return n.forEach(function(i){var o="";(i[1]||[]).forEach(function(s,a){if(!s.T){delete s.ID;return}s.a&&e.indexOf(s.a)==-1&&e.push(s.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};a==0?o=l.id:l.parentId=o,s.ID=l.id,s.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(s.a)).slice(-12)+"}"),r.push(ve("threadedComment",_n("text",s.t||""),l))})}),r.push("</ThreadedComments>"),r.join("")}function t8(n){var e=[Kt,ve("personList",null,{xmlns:un.TCMNT,"xmlns:x":Aa[0]}).replace(/[\/]>/,">")];return n.forEach(function(t,r){e.push(ve("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function n8(n){var e={};e.iauthor=n.read_shift(4);var t=vs(n,16);return e.rfx=t.s,e.ref=ht(t.s),n.l+=16,e}function r8(n,e){return e==null&&(e=te(36)),e.write_shift(4,n[1].iauthor),Na(n[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var i8=kn;function o8(n){return dn(n.slice(0,54))}function s8(n){var e=Wn(),t=[];return le(e,628),le(e,630),n.forEach(function(r){r[1].forEach(function(i){t.indexOf(i.a)>-1||(t.push(i.a.slice(0,54)),le(e,632,o8(i.a)))})}),le(e,631),le(e,633),n.forEach(function(r){r[1].forEach(function(i){i.iauthor=t.indexOf(i.a);var o={s:fn(r[0]),e:fn(r[0])};le(e,635,r8([o,i])),i.t&&i.t.length>0&&le(e,637,l3(i)),le(e,636),delete i.iauthor})}),le(e,634),le(e,629),e.end()}function a8(n,e){e.FullPaths.forEach(function(t,r){if(r!=0){var i=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&gt.utils.cfb_add(n,i,e.FileIndex[r].content)}})}var yD=["xlsb","xlsm","xlam","biff8","xla"];var l8=function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(r,i,o,s){var a=!1,l=!1;o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1)),s.length==0?a=!0:s.charAt(0)=="["&&(a=!0,s=s.slice(1,-1));var c=o.length>0?parseInt(o,10)|0:0,u=s.length>0?parseInt(s,10)|0:0;return a?u+=e.c:--u,l?c+=e.r:--c,i+(a?"":"$")+Fn(u)+(l?"":"$")+yn(c)}return function(i,o){return e=o,i.replace(n,t)}}(),$v=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Wv=function(){return function(e,t){return e.replace($v,function(r,i,o,s,a,l){var c=Bv(s)-(o?0:t.c),u=Lv(l)-(a?0:t.r),f=u==0?"":a?u+1:"["+u+"]",h=c==0?"":o?c+1:"["+c+"]";return i+"R"+f+"C"+h})}}();function c8(n,e){return n.replace($v,function(t,r,i,o,s,a){return r+(i=="$"?i+o:Fn(Bv(o)+e.c))+(s=="$"?s+a:yn(Lv(a)+e.r))})}function u8(n){return n.length!=1}function zt(n){n.l+=1}function Eo(n,e){var t=n.read_shift(e==1?1:2);return[t&16383,t>>14&1,t>>15&1]}function xD(n,e,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return ED(n,e,t);t.biff==12&&(r=4)}var i=n.read_shift(r),o=n.read_shift(r),s=Eo(n,2),a=Eo(n,2);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:o,c:a[0],cRel:a[1],rRel:a[2]}}}function ED(n){var e=Eo(n,2),t=Eo(n,2),r=n.read_shift(1),i=n.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function f8(n,e,t){if(t.biff<8)return ED(n,e,t);var r=n.read_shift(t.biff==12?4:2),i=n.read_shift(t.biff==12?4:2),o=Eo(n,2),s=Eo(n,2);return{s:{r,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}function TD(n,e,t){if(t&&t.biff>=2&&t.biff<=5)return d8(n,e,t);var r=n.read_shift(t&&t.biff==12?4:2),i=Eo(n,2);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function d8(n){var e=Eo(n,2),t=n.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function h8(n){var e=n.read_shift(2),t=n.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function p8(n,e,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return m8(n,e,t);var i=n.read_shift(r>=12?4:2),o=n.read_shift(2),s=(o&16384)>>14,a=(o&32768)>>15;if(o&=16383,a==1)for(;i>524287;)i-=1048576;if(s==1)for(;o>8191;)o=o-16384;return{r:i,c:o,cRel:s,rRel:a}}function m8(n){var e=n.read_shift(2),t=n.read_shift(1),r=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),i==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:i,rRel:r}}function g8(n,e,t){var r=(n[n.l++]&96)>>5,i=xD(n,t.biff>=2&&t.biff<=5?6:8,t);return[r,i]}function v8(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2,"i"),o=8;if(t)switch(t.biff){case 5:n.l+=12,o=6;break;case 12:o=12;break}var s=xD(n,o,t);return[r,i,s]}function _8(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function y8(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),o=8;if(t)switch(t.biff){case 5:n.l+=12,o=6;break;case 12:o=12;break}return n.l+=o,[r,i]}function x8(n,e,t){var r=(n[n.l++]&96)>>5,i=f8(n,e-1,t);return[r,i]}function E8(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t.biff==2?6:t.biff==12?14:7,[r]}function cC(n){var e=n[n.l+1]&1,t=1;return n.l+=4,[e,t]}function T8(n,e,t){n.l+=2;for(var r=n.read_shift(t&&t.biff==2?1:2),i=[],o=0;o<=r;++o)i.push(n.read_shift(t&&t.biff==2?1:2));return i}function w8(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function C8(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function D8(n){var e=n[n.l+1]&255?1:0;return n.l+=2,[e,n.read_shift(2)]}function S8(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=t&&t.biff==2?3:4,[r]}function wD(n){var e=n.read_shift(1),t=n.read_shift(1);return[e,t]}function b8(n){return n.read_shift(2),wD(n,2)}function I8(n){return n.read_shift(2),wD(n,2)}function A8(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=TD(n,0,t);return[r,i]}function F8(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=p8(n,0,t);return[r,i]}function k8(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(2);t&&t.biff==5&&(n.l+=12);var o=TD(n,0,t);return[r,i,o]}function N8(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(t&&t.biff<=3?1:2);return[NB[i],SD[i],r]}function M8(n,e,t){var r=n[n.l++],i=n.read_shift(1),o=t&&t.biff<=3?[r==88?-1:0,n.read_shift(1)]:O8(n);return[i,(o[0]===0?SD:kB)[o[1]]]}function O8(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function R8(n,e,t){n.l+=t&&t.biff==2?3:4}function P8(n,e,t){if(n.l++,t&&t.biff==12)return[n.read_shift(4,"i"),0];var r=n.read_shift(2),i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function L8(n){return n.l++,bc[n.read_shift(1)]}function B8(n){return n.l++,n.read_shift(2)}function V8(n){return n.l++,n.read_shift(1)!==0}function U8(n){return n.l++,Ma(n,8)}function j8(n,e,t){return n.l++,oD(n,e-1,t)}function H8(n,e){var t=[n.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=k3(n,1)?"TRUE":"FALSE",e!=12&&(n.l+=7);break;case 37:case 16:t[1]=bc[n[n.l]],n.l+=e==12?4:8;break;case 0:n.l+=8;break;case 1:t[1]=Ma(n,8);break;case 2:t[1]=R3(n,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function G8(n,e,t){for(var r=n.read_shift(t.biff==12?4:2),i=[],o=0;o!=r;++o)i.push((t.biff==12?vs:B3)(n,8));return i}function $8(n,e,t){var r=0,i=0;t.biff==12?(r=n.read_shift(4),i=n.read_shift(4)):(i=1+n.read_shift(1),r=1+n.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--i==0&&(i=256));for(var o=0,s=[];o!=r&&(s[o]=[]);++o)for(var a=0;a!=i;++a)s[o][a]=H8(n,t.biff);return s}function W8(n,e,t){var r=n.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,o=n.read_shift(i);switch(t.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[r,0,o]}function z8(n,e,t){if(t.biff==5)return q8(n,e,t);var r=n.read_shift(1)>>>5&3,i=n.read_shift(2),o=n.read_shift(4);return[r,i,o]}function q8(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2,"i");n.l+=8;var r=n.read_shift(2);return n.l+=12,[e,t,r]}function K8(n,e,t){var r=n.read_shift(1)>>>5&3;n.l+=t&&t.biff==2?3:4;var i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function Y8(n,e,t){var r=n.read_shift(1)>>>5&3,i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function X8(n,e,t){var r=n.read_shift(1)>>>5&3;return n.l+=4,t.biff<8&&n.l--,t.biff==12&&(n.l+=2),[r]}function Z8(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),o=4;if(t)switch(t.biff){case 5:o=15;break;case 12:o=6;break}return n.l+=o,[r,i]}var Q8=mi,J8=mi,eB=mi;function Ic(n,e,t){return n.l+=2,[h8(n,4,t)]}function zv(n){return n.l+=6,[]}var tB=Ic,nB=zv,rB=zv,iB=Ic;function CD(n){return n.l+=2,[rD(n),n.read_shift(2)&1]}var oB=Ic,sB=CD,aB=zv,lB=Ic,cB=Ic,uB=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function fB(n){n.l+=2;var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(4),i=n.read_shift(2),o=n.read_shift(2),s=uB[t>>2&31];return{ixti:e,coltype:t&3,rt:s,idx:r,c:i,C:o}}function dB(n){return n.l+=2,[n.read_shift(4)]}function hB(n,e,t){return n.l+=5,n.l+=2,n.l+=t.biff==2?1:4,["PTGSHEET"]}function pB(n,e,t){return n.l+=t.biff==2?4:5,["PTGENDSHEET"]}function mB(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function gB(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function vB(n){return n.l+=4,[0,0]}var uC={1:{n:"PtgExp",f:P8},2:{n:"PtgTbl",f:eB},3:{n:"PtgAdd",f:zt},4:{n:"PtgSub",f:zt},5:{n:"PtgMul",f:zt},6:{n:"PtgDiv",f:zt},7:{n:"PtgPower",f:zt},8:{n:"PtgConcat",f:zt},9:{n:"PtgLt",f:zt},10:{n:"PtgLe",f:zt},11:{n:"PtgEq",f:zt},12:{n:"PtgGe",f:zt},13:{n:"PtgGt",f:zt},14:{n:"PtgNe",f:zt},15:{n:"PtgIsect",f:zt},16:{n:"PtgUnion",f:zt},17:{n:"PtgRange",f:zt},18:{n:"PtgUplus",f:zt},19:{n:"PtgUminus",f:zt},20:{n:"PtgPercent",f:zt},21:{n:"PtgParen",f:zt},22:{n:"PtgMissArg",f:zt},23:{n:"PtgStr",f:j8},26:{n:"PtgSheet",f:hB},27:{n:"PtgEndSheet",f:pB},28:{n:"PtgErr",f:L8},29:{n:"PtgBool",f:V8},30:{n:"PtgInt",f:B8},31:{n:"PtgNum",f:U8},32:{n:"PtgArray",f:E8},33:{n:"PtgFunc",f:N8},34:{n:"PtgFuncVar",f:M8},35:{n:"PtgName",f:W8},36:{n:"PtgRef",f:A8},37:{n:"PtgArea",f:g8},38:{n:"PtgMemArea",f:K8},39:{n:"PtgMemErr",f:Q8},40:{n:"PtgMemNoMem",f:J8},41:{n:"PtgMemFunc",f:Y8},42:{n:"PtgRefErr",f:X8},43:{n:"PtgAreaErr",f:_8},44:{n:"PtgRefN",f:F8},45:{n:"PtgAreaN",f:x8},46:{n:"PtgMemAreaN",f:mB},47:{n:"PtgMemNoMemN",f:gB},57:{n:"PtgNameX",f:z8},58:{n:"PtgRef3d",f:k8},59:{n:"PtgArea3d",f:v8},60:{n:"PtgRefErr3d",f:Z8},61:{n:"PtgAreaErr3d",f:y8},255:{}},_B={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},yB={1:{n:"PtgElfLel",f:CD},2:{n:"PtgElfRw",f:lB},3:{n:"PtgElfCol",f:tB},6:{n:"PtgElfRwV",f:cB},7:{n:"PtgElfColV",f:iB},10:{n:"PtgElfRadical",f:oB},11:{n:"PtgElfRadicalS",f:aB},13:{n:"PtgElfColS",f:nB},15:{n:"PtgElfColSV",f:rB},16:{n:"PtgElfRadicalLel",f:sB},25:{n:"PtgList",f:fB},29:{n:"PtgSxName",f:dB},255:{}},xB={0:{n:"PtgAttrNoop",f:vB},1:{n:"PtgAttrSemi",f:S8},2:{n:"PtgAttrIf",f:C8},4:{n:"PtgAttrChoose",f:T8},8:{n:"PtgAttrGoto",f:w8},16:{n:"PtgAttrSum",f:R8},32:{n:"PtgAttrBaxcel",f:cC},33:{n:"PtgAttrBaxcel",f:cC},64:{n:"PtgAttrSpace",f:b8},65:{n:"PtgAttrSpaceSemi",f:I8},128:{n:"PtgAttrIfError",f:D8},255:{}};function EB(n,e,t,r){if(r.biff<8)return mi(n,e);for(var i=n.l+e,o=[],s=0;s!==t.length;++s)switch(t[s][0]){case"PtgArray":t[s][1]=$8(n,0,r),o.push(t[s][1]);break;case"PtgMemArea":t[s][2]=G8(n,t[s][1],r),o.push(t[s][2]);break;case"PtgExp":r&&r.biff==12&&(t[s][1][1]=n.read_shift(4),o.push(t[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[s][0];default:break}return e=i-n.l,e!==0&&o.push(mi(n,e)),o}function TB(n,e,t){for(var r=n.l+e,i,o,s=[];r!=n.l;)e=r-n.l,o=n[n.l],i=uC[o]||uC[_B[o]],(o===24||o===25)&&(i=(o===24?yB:xB)[n[n.l+1]]),!i||!i.f?mi(n,e):s.push([i.n,i.f(n,e,t)]);return s}function wB(n){for(var e=[],t=0;t<n.length;++t){for(var r=n[t],i=[],o=0;o<r.length;++o){var s=r[o];if(s)switch(s[0]){case 2:i.push('"'+s[1].replace(/"/g,'""')+'"');break;default:i.push(s[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var CB={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function DB(n,e){if(!n&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n+"'":n}function DD(n,e,t){if(!n)return"SH33TJSERR0";if(t.biff>8&&(!n.XTI||!n.XTI[e]))return n.SheetNames[e];if(!n.XTI)return"SH33TJSERR6";var r=n.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":n.XTI[e-1];if(!r)return"SH33TJSERR1";var i="";if(t.biff>8)switch(n[r[0]][0]){case 357:return i=r[1]==-1?"#REF":n.SheetNames[r[1]],r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 358:return t.SID!=null?n.SheetNames[t.SID]:"SH33TJSSAME"+n[r[0]][0];case 355:default:return"SH33TJSSRC"+n[r[0]][0]}switch(n[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":n.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 14849:return n[r[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return n[r[0]][0][3]?(i=r[1]==-1?"#REF":n[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+n[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function fC(n,e,t){var r=DD(n,e,t);return r=="#REF"?r:DB(r,t)}function Ia(n,e,t,r,i){var o=i&&i.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},a=[],l,c,u,f=0,h=0,d,m="";if(!n[0]||!n[0][0])return"";for(var p=-1,g="",w=0,y=n[0].length;w<y;++w){var S=n[0][w];switch(S[0]){case"PtgUminus":a.push("-"+a.pop());break;case"PtgUplus":a.push("+"+a.pop());break;case"PtgPercent":a.push(a.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=a.pop(),c=a.pop(),p>=0){switch(n[0][p][1][0]){case 0:g=Lt(" ",n[0][p][1][1]);break;case 1:g=Lt("\r",n[0][p][1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][p][1][0])}c=c+g,p=-1}a.push(c+CB[S[0]]+l);break;case"PtgIsect":l=a.pop(),c=a.pop(),a.push(c+" "+l);break;case"PtgUnion":l=a.pop(),c=a.pop(),a.push(c+","+l);break;case"PtgRange":l=a.pop(),c=a.pop(),a.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=mc(S[1][1],s,i),a.push(gc(u,o));break;case"PtgRefN":u=t?mc(S[1][1],t,i):S[1][1],a.push(gc(u,o));break;case"PtgRef3d":f=S[1][1],u=mc(S[1][2],s,i),m=fC(r,f,i);var B=m;a.push(m+"!"+gc(u,o));break;case"PtgFunc":case"PtgFuncVar":var Z=S[1][0],ce=S[1][1];Z||(Z=0),Z&=127;var O=Z==0?[]:a.slice(-Z);a.length-=Z,ce==="User"&&(ce=O.shift()),a.push(ce+"("+O.join(",")+")");break;case"PtgBool":a.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":a.push(S[1]);break;case"PtgNum":a.push(String(S[1]));break;case"PtgStr":a.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":a.push(S[1]);break;case"PtgAreaN":d=Yw(S[1][1],t?{s:t}:s,i),a.push(mv(d,i));break;case"PtgArea":d=Yw(S[1][1],s,i),a.push(mv(d,i));break;case"PtgArea3d":f=S[1][1],d=S[1][2],m=fC(r,f,i),a.push(m+"!"+mv(d,i));break;case"PtgAttrSum":a.push("SUM("+a.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=S[1][2];var L=(r.names||[])[h-1]||(r[0]||[])[h],G=L?L.Name:"SH33TJSNAME"+String(h);G&&G.slice(0,6)=="_xlfn."&&!i.xlfn&&(G=G.slice(6)),a.push(G);break;case"PtgNameX":var V=S[1][1];h=S[1][2];var K;if(i.biff<=5)V<0&&(V=-V),r[V]&&(K=r[V][h]);else{var W="";if(((r[V]||[])[0]||[])[0]==14849||(((r[V]||[])[0]||[])[0]==1025?r[V][h]&&r[V][h].itab>0&&(W=r.SheetNames[r[V][h].itab-1]+"!"):W=r.SheetNames[h-1]+"!"),r[V]&&r[V][h])W+=r[V][h].Name;else if(r[0]&&r[0][h])W+=r[0][h].Name;else{var ue=(DD(r,V,i)||"").split(";;");ue[h-1]?W=ue[h-1]:W+="SH33TJSERRX"}a.push(W);break}K||(K={Name:"SH33TJSERRY"}),a.push(K.Name);break;case"PtgParen":var Oe="(",Te=")";if(p>=0){switch(g="",n[0][p][1][0]){case 2:Oe=Lt(" ",n[0][p][1][1])+Oe;break;case 3:Oe=Lt("\r",n[0][p][1][1])+Oe;break;case 4:Te=Lt(" ",n[0][p][1][1])+Te;break;case 5:Te=Lt("\r",n[0][p][1][1])+Te;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][p][1][0])}p=-1}a.push(Oe+a.pop()+Te);break;case"PtgRefErr":a.push("#REF!");break;case"PtgRefErr3d":a.push("#REF!");break;case"PtgExp":u={c:S[1][1],r:S[1][0]};var ie={c:t.c,r:t.r};if(r.sharedf[ht(u)]){var ee=r.sharedf[ht(u)];a.push(Ia(ee,s,ie,r,i))}else{var k=!1;for(l=0;l!=r.arrayf.length;++l)if(c=r.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){a.push(Ia(c[1],s,ie,r,i)),k=!0;break}k||a.push(S[1])}break;case"PtgArray":a.push("{"+wB(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":a.push("");break;case"PtgAreaErr":a.push("#REF!");break;case"PtgAreaErr3d":a.push("#REF!");break;case"PtgList":a.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var R=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&p>=0&&R.indexOf(n[0][w][0])==-1){S=n[0][p];var pe=!0;switch(S[1][0]){case 4:pe=!1;case 0:g=Lt(" ",S[1][1]);break;case 5:pe=!1;case 1:g=Lt("\r",S[1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}a.push((pe?g:"")+a.pop()+(pe?"":g)),p=-1}}if(a.length>1&&i.WTF)throw new Error("bad formula stack");return a[0]}function SB(n){if(n==null){var e=te(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof n=="number")return fs(n);return fs(0)}function bB(n,e,t,r,i){var o=ds(e,t,i),s=SB(n.v),a=te(6),l=33;a.write_shift(2,l),a.write_shift(4,0);for(var c=te(n.bf.length),u=0;u<n.bf.length;++u)c[u]=n.bf[u];var f=vn([o,s,a,c]);return f}function yh(n,e,t){var r=n.read_shift(4),i=TB(n,r,t),o=n.read_shift(4),s=o>0?EB(n,o,i,t):null;return[i,s]}var IB=yh,xh=yh,AB=yh,FB=yh,kB={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},SD={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},NB={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function MB(n){var e="of:="+n.replace($v,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function OB(n){return n.replace(/\./,"!")}var vc=typeof Map<"u";function qv(n,e,t){var r=0,i=n.length;if(t){if(vc?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var o=vc?t.get(e):t[e];r<o.length;++r)if(n[o[r]].t===e)return n.Count++,o[r]}}else for(;r<i;++r)if(n[r].t===e)return n.Count++,r;return n[i]={t:e},n.Count++,n.Unique++,t&&(vc?(t.has(e)||t.set(e,[]),t.get(e).push(i)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(i))),i}function Eh(n,e){var t={min:n+1,max:n+1},r=-1;return e.MDW&&(Bi=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?r=ch(e.wpx):e.wch!=null&&(r=e.wch),r>-1?(t.width=Cv(r),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function bD(n,e){if(n){var t=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(t=[1,1,1,1,.5,.5]),n.left==null&&(n.left=t[0]),n.right==null&&(n.right=t[1]),n.top==null&&(n.top=t[2]),n.bottom==null&&(n.bottom=t[3]),n.header==null&&(n.header=t[4]),n.footer==null&&(n.footer=t[5])}}function wo(n,e,t){var r=t.revssf[e.z!=null?e.z:"General"],i=60,o=n.length;if(r==null&&t.ssf){for(;i<392;++i)if(t.ssf[i]==null){bC(e.z,i),t.ssf[i]=e.z,t.revssf[e.z]=r=i;break}}for(i=0;i!=o;++i)if(n[i].numFmtId===r)return i;return n[o]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function RB(n,e,t){if(n&&n["!ref"]){var r=wt(n["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+t+"): "+n["!ref"])}}function PB(n){if(n.length===0)return"";for(var e='<mergeCells count="'+n.length+'">',t=0;t!=n.length;++t)e+='<mergeCell ref="'+qt(n[t])+'"/>';return e+"</mergeCells>"}function LB(n,e,t,r,i){var o=!1,s={},a=null;if(r.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[t];try{e.Workbook&&(l=e.Workbook.Sheets[t].CodeName||l)}catch{}o=!0,s.codeName=Ri(dt(l))}if(n&&n["!outline"]){var c={summaryBelow:1,summaryRight:1};n["!outline"].above&&(c.summaryBelow=0),n["!outline"].left&&(c.summaryRight=0),a=(a||"")+ve("outlinePr",null,c)}!o&&!a||(i[i.length]=ve("sheetPr",a,s))}var BB=["objects","scenarios","selectLockedCells","selectUnlockedCells"],VB=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function UB(n){var e={sheet:1};return BB.forEach(function(t){n[t]!=null&&n[t]&&(e[t]="1")}),VB.forEach(function(t){n[t]!=null&&!n[t]&&(e[t]="0")}),n.password&&(e.password=uD(n.password).toString(16).toUpperCase()),ve("sheetProtection",null,e)}function jB(n){return bD(n),ve("pageMargins",null,n)}function HB(n,e){for(var t=["<cols>"],r,i=0;i!=e.length;++i)(r=e[i])&&(t[t.length]=ve("col",null,Eh(i,r)));return t[t.length]="</cols>",t.join("")}function GB(n,e,t,r){var i=typeof n.ref=="string"?n.ref:qt(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var o=t.Workbook.Names,s=dr(i);s.s.r==s.e.r&&(s.e.r=dr(e["!ref"]).e.r,i=qt(s));for(var a=0;a<o.length;++a){var l=o[a];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==r){l.Ref="'"+t.SheetNames[r]+"'!"+i;break}}return a==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+i}),ve("autoFilter",null,{ref:i})}function $B(n,e,t,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),ve("sheetViews",ve("sheetView",null,i),{})}function WB(n,e,t,r){if(n.c&&t["!comments"].push([e,n.c]),n.v===void 0&&typeof n.f!="string"||n.t==="z"&&!n.f)return"";var i="",o=n.t,s=n.v;if(n.t!=="z")switch(n.t){case"b":i=n.v?"1":"0";break;case"n":i=""+n.v;break;case"e":i=bc[n.v];break;case"d":r&&r.cellDates?i=Bn(n.v,-1).toISOString():(n=qn(n),n.t="n",i=""+(n.v=zn(Bn(n.v)))),typeof n.z>"u"&&(n.z=Bt[14]);break;default:i=n.v;break}var a=_n("v",dt(i)),l={r:e},c=wo(r.cellXfs,n,r);switch(c!==0&&(l.s=c),n.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(n.v==null){delete n.t;break}if(n.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){a=_n("v",""+qv(r.Strings,n.v,r.revStrings)),l.t="s";break}l.t="str";break}if(n.t!=o&&(n.t=o,n.v=s),typeof n.f=="string"&&n.f){var u=n.F&&n.F.slice(0,e.length)==e?{t:"array",ref:n.F}:null;a=ve("f",dt(n.f),u)+(n.v!=null?a:"")}return n.l&&t["!links"].push([e,n.l]),n.D&&(l.cm=1),ve("c",a,l)}function zB(n,e,t,r){var i=[],o=[],s=wt(n["!ref"]),a="",l,c="",u=[],f=0,h=0,d=n["!rows"],m=Array.isArray(n),p={r:c},g,w=-1;for(h=s.s.c;h<=s.e.c;++h)u[h]=Fn(h);for(f=s.s.r;f<=s.e.r;++f){for(o=[],c=yn(f),h=s.s.c;h<=s.e.c;++h){l=u[h]+c;var y=m?(n[f]||[])[h]:n[l];y!==void 0&&(a=WB(y,l,n,e,t,r))!=null&&o.push(a)}(o.length>0||d&&d[f])&&(p={r:c},d&&d[f]&&(g=d[f],g.hidden&&(p.hidden=1),w=-1,g.hpx?w=uh(g.hpx):g.hpt&&(w=g.hpt),w>-1&&(p.ht=w,p.customHeight=1),g.level&&(p.outlineLevel=g.level)),i[i.length]=ve("row",o.join(""),p))}if(d)for(;f<d.length;++f)d&&d[f]&&(p={r:f+1},g=d[f],g.hidden&&(p.hidden=1),w=-1,g.hpx?w=uh(g.hpx):g.hpt&&(w=g.hpt),w>-1&&(p.ht=w,p.customHeight=1),g.level&&(p.outlineLevel=g.level),i[i.length]=ve("row","",p));return i.join("")}function ID(n,e,t,r){var i=[Kt,ve("worksheet",null,{xmlns:Aa[0],"xmlns:r":un.r})],o=t.SheetNames[n],s=0,a="",l=t.Sheets[o];l==null&&(l={});var c=l["!ref"]||"A1",u=wt(c);if(u.e.c>16383||u.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=qt(u)}r||(r={}),l["!comments"]=[];var f=[];LB(l,t,n,e,i),i[i.length]=ve("dimension",null,{ref:c}),i[i.length]=$B(l,e,n,t),e.sheetFormat&&(i[i.length]=ve("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=HB(l,l["!cols"])),i[s=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(a=zB(l,e,n,t,r),a.length>0&&(i[i.length]=a)),i.length>s+1&&(i[i.length]="</sheetData>",i[s]=i[s].replace("/>",">")),l["!protect"]&&(i[i.length]=UB(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=GB(l["!autofilter"],l,t,n)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=PB(l["!merges"]));var h=-1,d,m=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(p){p[1].Target&&(d={ref:p[0]},p[1].Target.charAt(0)!="#"&&(m=ft(r,-1,dt(p[1].Target).replace(/#.*$/,""),it.HLINK),d["r:id"]="rId"+m),(h=p[1].Target.indexOf("#"))>-1&&(d.location=dt(p[1].Target.slice(h+1))),p[1].Tooltip&&(d.tooltip=dt(p[1].Tooltip)),i[i.length]=ve("hyperlink",null,d))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=jB(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=_n("ignoredErrors",ve("ignoredError",null,{numberStoredAsText:1,sqref:c}))),f.length>0&&(m=ft(r,-1,"../drawings/drawing"+(n+1)+".xml",it.DRAW),i[i.length]=ve("drawing",null,{"r:id":"rId"+m}),l["!drawing"]=f),l["!comments"].length>0&&(m=ft(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",it.VML),i[i.length]=ve("legacyDrawing",null,{"r:id":"rId"+m}),l["!legacy"]=m),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function qB(n,e){var t={},r=n.l+e;t.r=n.read_shift(4),n.l+=4;var i=n.read_shift(2);n.l+=1;var o=n.read_shift(1);return n.l=r,o&7&&(t.level=o&7),o&16&&(t.hidden=!0),o&32&&(t.hpt=i/20),t}function KB(n,e,t){var r=te(145),i=(t["!rows"]||[])[n]||{};r.write_shift(4,n),r.write_shift(4,0);var o=320;i.hpx?o=uh(i.hpx)*20:i.hpt&&(o=i.hpt*20),r.write_shift(2,o),r.write_shift(1,0);var s=0;i.level&&(s|=i.level),i.hidden&&(s|=16),(i.hpx||i.hpt)&&(s|=32),r.write_shift(1,s),r.write_shift(1,0);var a=0,l=r.l;r.l+=4;for(var c={r:n,c:0},u=0;u<16;++u)if(!(e.s.c>u+1<<10||e.e.c<u<<10)){for(var f=-1,h=-1,d=u<<10;d<u+1<<10;++d){c.c=d;var m=Array.isArray(t)?(t[c.r]||[])[c.c]:t[ht(c)];m&&(f<0&&(f=d),h=d)}f<0||(++a,r.write_shift(4,f),r.write_shift(4,h))}var p=r.l;return r.l=l,r.write_shift(4,a),r.l=p,r.length>r.l?r.slice(0,r.l):r}function YB(n,e,t,r){var i=KB(r,t,e);(i.length>17||(e["!rows"]||[])[r])&&le(n,0,i)}var XB=vs,ZB=Na;function QB(){}function JB(n,e){var t={},r=n[n.l];return++n.l,t.above=!(r&64),t.left=!(r&128),n.l+=18,t.name=c3(n,e-19),t}function e6(n,e,t){t==null&&(t=te(84+4*n.length));var r=192;e&&(e.above&&(r&=-65),e.left&&(r&=-129)),t.write_shift(1,r);for(var i=1;i<3;++i)t.write_shift(1,0);return sh({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),GC(n,t),t.slice(0,t.l)}function t6(n){var e=br(n);return[e]}function n6(n,e,t){return t==null&&(t=te(8)),ps(e,t)}function r6(n){var e=ms(n);return[e]}function i6(n,e,t){return t==null&&(t=te(4)),gs(e,t)}function o6(n){var e=br(n),t=n.read_shift(1);return[e,t,"b"]}function s6(n,e,t){return t==null&&(t=te(9)),ps(e,t),t.write_shift(1,n.v?1:0),t}function a6(n){var e=ms(n),t=n.read_shift(1);return[e,t,"b"]}function l6(n,e,t){return t==null&&(t=te(5)),gs(e,t),t.write_shift(1,n.v?1:0),t}function c6(n){var e=br(n),t=n.read_shift(1);return[e,t,"e"]}function u6(n,e,t){return t==null&&(t=te(9)),ps(e,t),t.write_shift(1,n.v),t}function f6(n){var e=ms(n),t=n.read_shift(1);return[e,t,"e"]}function d6(n,e,t){return t==null&&(t=te(8)),gs(e,t),t.write_shift(1,n.v),t.write_shift(2,0),t.write_shift(1,0),t}function h6(n){var e=br(n),t=n.read_shift(4);return[e,t,"s"]}function p6(n,e,t){return t==null&&(t=te(12)),ps(e,t),t.write_shift(4,e.v),t}function m6(n){var e=ms(n),t=n.read_shift(4);return[e,t,"s"]}function g6(n,e,t){return t==null&&(t=te(8)),gs(e,t),t.write_shift(4,e.v),t}function v6(n){var e=br(n),t=Ma(n);return[e,t,"n"]}function _6(n,e,t){return t==null&&(t=te(16)),ps(e,t),fs(n.v,t),t}function y6(n){var e=ms(n),t=Ma(n);return[e,t,"n"]}function x6(n,e,t){return t==null&&(t=te(12)),gs(e,t),fs(n.v,t),t}function E6(n){var e=br(n),t=$C(n);return[e,t,"n"]}function T6(n,e,t){return t==null&&(t=te(12)),ps(e,t),WC(n.v,t),t}function w6(n){var e=ms(n),t=$C(n);return[e,t,"n"]}function C6(n,e,t){return t==null&&(t=te(8)),gs(e,t),WC(n.v,t),t}function D6(n){var e=br(n),t=Vv(n);return[e,t,"is"]}function S6(n){var e=br(n),t=kn(n);return[e,t,"str"]}function b6(n,e,t){return t==null&&(t=te(12+4*n.v.length)),ps(e,t),dn(n.v,t),t.length>t.l?t.slice(0,t.l):t}function I6(n){var e=ms(n),t=kn(n);return[e,t,"str"]}function A6(n,e,t){return t==null&&(t=te(8+4*n.v.length)),gs(e,t),dn(n.v,t),t.length>t.l?t.slice(0,t.l):t}function F6(n,e,t){var r=n.l+e,i=br(n);i.r=t["!row"];var o=n.read_shift(1),s=[i,o,"b"];if(t.cellFormula){n.l+=2;var a=xh(n,r-n.l,t);s[3]=Ia(a,null,i,t.supbooks,t)}else n.l=r;return s}function k6(n,e,t){var r=n.l+e,i=br(n);i.r=t["!row"];var o=n.read_shift(1),s=[i,o,"e"];if(t.cellFormula){n.l+=2;var a=xh(n,r-n.l,t);s[3]=Ia(a,null,i,t.supbooks,t)}else n.l=r;return s}function N6(n,e,t){var r=n.l+e,i=br(n);i.r=t["!row"];var o=Ma(n),s=[i,o,"n"];if(t.cellFormula){n.l+=2;var a=xh(n,r-n.l,t);s[3]=Ia(a,null,i,t.supbooks,t)}else n.l=r;return s}function M6(n,e,t){var r=n.l+e,i=br(n);i.r=t["!row"];var o=kn(n),s=[i,o,"str"];if(t.cellFormula){n.l+=2;var a=xh(n,r-n.l,t);s[3]=Ia(a,null,i,t.supbooks,t)}else n.l=r;return s}var O6=vs,R6=Na;function P6(n,e){return e==null&&(e=te(4)),e.write_shift(4,n),e}function L6(n,e){var t=n.l+e,r=vs(n,16),i=Uv(n),o=kn(n),s=kn(n),a=kn(n);n.l=t;var l={rfx:r,relId:i,loc:o,display:a};return s&&(l.Tooltip=s),l}function B6(n,e){var t=te(50+4*(n[1].Target.length+(n[1].Tooltip||"").length));Na({s:fn(n[0]),e:fn(n[0])},t),jv("rId"+e,t);var r=n[1].Target.indexOf("#"),i=r==-1?"":n[1].Target.slice(r+1);return dn(i||"",t),dn(n[1].Tooltip||"",t),dn("",t),t.slice(0,t.l)}function V6(){}function U6(n,e,t){var r=n.l+e,i=zC(n,16),o=n.read_shift(1),s=[i];if(s[2]=o,t.cellFormula){var a=IB(n,r-n.l,t);s[1]=a}else n.l=r;return s}function j6(n,e,t){var r=n.l+e,i=vs(n,16),o=[i];if(t.cellFormula){var s=FB(n,r-n.l,t);o[1]=s,n.l=r}else n.l=r;return o}function H6(n,e,t){t==null&&(t=te(18));var r=Eh(n,e);t.write_shift(-4,n),t.write_shift(-4,n),t.write_shift(4,(r.width||10)*256),t.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof r.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),t.write_shift(2,i),t}var AD=["left","right","top","bottom","header","footer"];function G6(n){var e={};return AD.forEach(function(t){e[t]=Ma(n,8)}),e}function $6(n,e){return e==null&&(e=te(6*8)),bD(n),AD.forEach(function(t){fs(n[t],e)}),e}function W6(n){var e=n.read_shift(2);return n.l+=28,{RTL:e&32}}function z6(n,e,t){t==null&&(t=te(30));var r=924;return(((e||{}).Views||[])[0]||{}).RTL&&(r|=32),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function q6(n){var e=te(24);return e.write_shift(4,4),e.write_shift(4,1),Na(n,e),e}function K6(n,e){return e==null&&(e=te(16*4+2)),e.write_shift(2,n.password?uD(n.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,n[t[0]]!=null&&!n[t[0]]?1:0):e.write_shift(4,n[t[0]]!=null&&n[t[0]]?0:1)}),e}function Y6(){}function X6(){}function Z6(n,e,t,r,i,o,s){if(e.v===void 0)return!1;var a="";switch(e.t){case"b":a=e.v?"1":"0";break;case"d":e=qn(e),e.z=e.z||Bt[14],e.v=zn(Bn(e.v)),e.t="n";break;case"n":case"e":a=""+e.v;break;default:a=e.v;break}var l={r:t,c:r};switch(l.s=wo(i.cellXfs,e,i),e.l&&o["!links"].push([ht(l),e.l]),e.c&&o["!comments"].push([ht(l),e.c]),e.t){case"s":case"str":return i.bookSST?(a=qv(i.Strings,e.v,i.revStrings),l.t="s",l.v=a,s?le(n,18,g6(e,l)):le(n,7,p6(e,l))):(l.t="str",s?le(n,17,A6(e,l)):le(n,6,b6(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?s?le(n,13,C6(e,l)):le(n,2,T6(e,l)):s?le(n,16,x6(e,l)):le(n,5,_6(e,l)),!0;case"b":return l.t="b",s?le(n,15,l6(e,l)):le(n,4,s6(e,l)),!0;case"e":return l.t="e",s?le(n,14,d6(e,l)):le(n,3,u6(e,l)),!0}return s?le(n,12,i6(e,l)):le(n,1,n6(e,l)),!0}function Q6(n,e,t,r){var i=wt(e["!ref"]||"A1"),o,s="",a=[];le(n,145);var l=Array.isArray(e),c=i.e.r;e["!rows"]&&(c=Math.max(i.e.r,e["!rows"].length-1));for(var u=i.s.r;u<=c;++u){s=yn(u),YB(n,e,i,u);var f=!1;if(u<=i.e.r)for(var h=i.s.c;h<=i.e.c;++h){u===i.s.r&&(a[h]=Fn(h)),o=a[h]+s;var d=l?(e[u]||[])[h]:e[o];if(!d){f=!1;continue}f=Z6(n,d,u,h,r,e,f)}}le(n,146)}function J6(n,e){!e||!e["!merges"]||(le(n,177,P6(e["!merges"].length)),e["!merges"].forEach(function(t){le(n,176,R6(t))}),le(n,178))}function e5(n,e){!e||!e["!cols"]||(le(n,390),e["!cols"].forEach(function(t,r){t&&le(n,60,H6(r,t))}),le(n,391))}function t5(n,e){!e||!e["!ref"]||(le(n,648),le(n,649,q6(wt(e["!ref"]))),le(n,650))}function n5(n,e,t){e["!links"].forEach(function(r){if(r[1].Target){var i=ft(t,-1,r[1].Target.replace(/#.*$/,""),it.HLINK);le(n,494,B6(r,i))}}),delete e["!links"]}function r5(n,e,t,r){if(e["!comments"].length>0){var i=ft(r,-1,"../drawings/vmlDrawing"+(t+1)+".vml",it.VML);le(n,551,jv("rId"+i)),e["!legacy"]=i}}function i5(n,e,t,r){if(e["!autofilter"]){var i=e["!autofilter"],o=typeof i.ref=="string"?i.ref:qt(i.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,a=dr(o);a.s.r==a.e.r&&(a.e.r=dr(e["!ref"]).e.r,o=qt(a));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==r){c.Ref="'"+t.SheetNames[r]+"'!"+o;break}}l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+o}),le(n,161,Na(wt(o))),le(n,162)}}function o5(n,e,t){le(n,133),le(n,137,z6(e,t)),le(n,138),le(n,134)}function s5(n,e){e["!protect"]&&le(n,535,K6(e["!protect"]))}function a5(n,e,t,r){var i=Wn(),o=t.SheetNames[n],s=t.Sheets[o]||{},a=o;try{t&&t.Workbook&&(a=t.Workbook.Sheets[n].CodeName||a)}catch{}var l=wt(s["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],le(i,129),(t.vbaraw||s["!outline"])&&le(i,147,e6(a,s["!outline"])),le(i,148,ZB(l)),o5(i,s,t.Workbook),e5(i,s,n,e,t),Q6(i,s,n,e,t),s5(i,s),i5(i,s,t,n),J6(i,s),n5(i,s,r),s["!margins"]&&le(i,476,$6(s["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&t5(i,s),r5(i,s,n,r),le(i,130),i.end()}function l5(n,e){n.l+=10;var t=kn(n,e-10);return{name:t}}var c5=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function u5(n){return!n.Workbook||!n.Workbook.WBProps?"false":U4(n.Workbook.WBProps.date1904)?"true":"false"}var f5="][*?/\\".split("");function FD(n,e){if(n.length>31){if(e)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var t=!0;return f5.forEach(function(r){if(n.indexOf(r)!=-1){if(!e)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");t=!1}}),t}function d5(n,e,t){n.forEach(function(r,i){FD(r);for(var o=0;o<i;++o)if(r==n[o])throw new Error("Duplicate Sheet Name: "+r);if(t){var s=e&&e[i]&&e[i].CodeName||r;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function h5(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");var e=n.Workbook&&n.Workbook.Sheets||[];d5(n.SheetNames,e,!!n.vbaraw);for(var t=0;t<n.SheetNames.length;++t)RB(n.Sheets[n.SheetNames[t]],n.SheetNames[t],t)}function kD(n){var e=[Kt];e[e.length]=ve("workbook",null,{xmlns:Aa[0],"xmlns:r":un.r});var t=n.Workbook&&(n.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};n.Workbook&&n.Workbook.WBProps&&(c5.forEach(function(a){n.Workbook.WBProps[a[0]]!=null&&n.Workbook.WBProps[a[0]]!=a[1]&&(r[a[0]]=n.Workbook.WBProps[a[0]])}),n.Workbook.WBProps.CodeName&&(r.codeName=n.Workbook.WBProps.CodeName,delete r.CodeName)),e[e.length]=ve("workbookPr",null,r);var i=n.Workbook&&n.Workbook.Sheets||[],o=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",o=0;o!=n.SheetNames.length&&!(!i[o]||!i[o].Hidden);++o);o==n.SheetNames.length&&(o=0),e[e.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",o=0;o!=n.SheetNames.length;++o){var s={name:dt(n.SheetNames[o].slice(0,31))};if(s.sheetId=""+(o+1),s["r:id"]="rId"+(o+1),i[o])switch(i[o].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}e[e.length]=ve("sheet",null,s)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",n.Workbook&&n.Workbook.Names&&n.Workbook.Names.forEach(function(a){var l={name:a.Name};a.Comment&&(l.comment=a.Comment),a.Sheet!=null&&(l.localSheetId=""+a.Sheet),a.Hidden&&(l.hidden="1"),a.Ref&&(e[e.length]=ve("definedName",dt(a.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function p5(n,e){var t={};return t.Hidden=n.read_shift(4),t.iTabID=n.read_shift(4),t.strRelID=wv(n,e-8),t.name=kn(n),t}function m5(n,e){return e||(e=te(127)),e.write_shift(4,n.Hidden),e.write_shift(4,n.iTabID),jv(n.strRelID,e),dn(n.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function g5(n,e){var t={},r=n.read_shift(4);t.defaultThemeVersion=n.read_shift(4);var i=e>8?kn(n):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function v5(n,e){e||(e=te(72));var t=0;return n&&n.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),GC(n&&n.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function _5(n,e,t){var r=n.l+e;n.l+=4,n.l+=1;var i=n.read_shift(4),o=u3(n),s=AB(n,0,t),a=Uv(n);n.l=r;var l={Name:o,Ptg:s};return i<268435455&&(l.Sheet=i),a&&(l.Comment=a),l}function y5(n,e){le(n,143);for(var t=0;t!=e.SheetNames.length;++t){var r=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,i={Hidden:r,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};le(n,156,m5(i))}le(n,144)}function x5(n,e){e||(e=te(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return dn("SheetJS",e),dn(_c.version,e),dn(_c.version,e),dn("7262",e),e.length>e.l?e.slice(0,e.l):e}function E5(n,e){e||(e=te(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,n),e.write_shift(4,n);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function T5(n,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,r=0,i=-1,o=-1;r<t.length;++r)!t[r]||!t[r].Hidden&&i==-1?i=r:t[r].Hidden==1&&o==-1&&(o=r);o>i||(le(n,135),le(n,158,E5(i)),le(n,136))}}function w5(n,e){var t=Wn();return le(t,131),le(t,128,x5()),le(t,153,v5(n.Workbook&&n.Workbook.WBProps||null)),T5(t,n,e),y5(t,n,e),le(t,132),t.end()}function C5(n,e,t){return(e.slice(-4)===".bin"?w5:kD)(n,t)}function D5(n,e,t,r,i){return(e.slice(-4)===".bin"?a5:ID)(n,t,r,i)}function S5(n,e,t){return(e.slice(-4)===".bin"?$L:hD)(n,t)}function b5(n,e,t){return(e.slice(-4)===".bin"?vL:cD)(n,t)}function I5(n,e,t){return(e.slice(-4)===".bin"?s8:_D)(n,t)}function A5(n){return(n.slice(-4)===".bin"?QL:gD)()}function F5(n,e){var t=[];return n.Props&&t.push(S3(n.Props,e)),n.Custprops&&t.push(b3(n.Props,n.Custprops,e)),t.join("")}function k5(){return""}function N5(n,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(r,i){var o=[];o.push(ve("NumberFormat",null,{"ss:Format":dt(Bt[r.numFmtId])}));var s={"ss:ID":"s"+(21+i)};t.push(ve("Style",o.join(""),s))}),ve("Styles",t.join(""))}function ND(n){return ve("NamedRange",null,{"ss:Name":n.Name,"ss:RefersTo":"="+Wv(n.Ref,{r:0,c:0})})}function M5(n){if(!((n||{}).Workbook||{}).Names)return"";for(var e=n.Workbook.Names,t=[],r=0;r<e.length;++r){var i=e[r];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||t.push(ND(i)))}return ve("Names",t.join(""))}function O5(n,e,t,r){if(!n||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,o=[],s=0;s<i.length;++s){var a=i[s];a.Sheet==t&&(a.Name.match(/^_xlfn\./)||o.push(ND(a)))}return o.join("")}function R5(n,e,t,r){if(!n)return"";var i=[];if(n["!margins"]&&(i.push("<PageSetup>"),n["!margins"].header&&i.push(ve("Header",null,{"x:Margin":n["!margins"].header})),n["!margins"].footer&&i.push(ve("Footer",null,{"x:Margin":n["!margins"].footer})),i.push(ve("PageMargins",null,{"x:Bottom":n["!margins"].bottom||"0.75","x:Left":n["!margins"].left||"0.7","x:Right":n["!margins"].right||"0.7","x:Top":n["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t])if(r.Workbook.Sheets[t].Hidden)i.push(ve("Visible",r.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<t&&!(r.Workbook.Sheets[o]&&!r.Workbook.Sheets[o].Hidden);++o);o==t&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),n["!protect"]&&(i.push(_n("ProtectContents","True")),n["!protect"].objects&&i.push(_n("ProtectObjects","True")),n["!protect"].scenarios&&i.push(_n("ProtectScenarios","True")),n["!protect"].selectLockedCells!=null&&!n["!protect"].selectLockedCells?i.push(_n("EnableSelection","NoSelection")):n["!protect"].selectUnlockedCells!=null&&!n["!protect"].selectUnlockedCells&&i.push(_n("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){n["!protect"][s[0]]&&i.push("<"+s[1]+"/>")})),i.length==0?"":ve("WorksheetOptions",i.join(""),{xmlns:fr.x})}function P5(n){return n.map(function(e){var t=V4(e.t||""),r=ve("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return ve("Comment",r,{"ss:Author":e.a})}).join("")}function L5(n,e,t,r,i,o,s){if(!n||n.v==null&&n.f==null)return"";var a={};if(n.f&&(a["ss:Formula"]="="+dt(Wv(n.f,s))),n.F&&n.F.slice(0,e.length)==e){var l=fn(n.F.slice(e.length+1));a["ss:ArrayRange"]="RC:R"+(l.r==s.r?"":"["+(l.r-s.r)+"]")+"C"+(l.c==s.c?"":"["+(l.c-s.c)+"]")}if(n.l&&n.l.Target&&(a["ss:HRef"]=dt(n.l.Target),n.l.Tooltip&&(a["x:HRefScreenTip"]=dt(n.l.Tooltip))),t["!merges"])for(var c=t["!merges"],u=0;u!=c.length;++u)c[u].s.c!=s.c||c[u].s.r!=s.r||(c[u].e.c>c[u].s.c&&(a["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(a["ss:MergeDown"]=c[u].e.r-c[u].s.r));var f="",h="";switch(n.t){case"z":if(!r.sheetStubs)return"";break;case"n":f="Number",h=String(n.v);break;case"b":f="Boolean",h=n.v?"1":"0";break;case"e":f="Error",h=bc[n.v];break;case"d":f="DateTime",h=new Date(n.v).toISOString(),n.z==null&&(n.z=n.z||Bt[14]);break;case"s":f="String",h=B4(n.v||"");break}var d=wo(r.cellXfs,n,r);a["ss:StyleID"]="s"+(21+d),a["ss:Index"]=s.c+1;var m=n.v!=null?h:"",p=n.t=="z"?"":'<Data ss:Type="'+f+'">'+m+"</Data>";return(n.c||[]).length>0&&(p+=P5(n.c)),ve("Cell",p,a)}function B5(n,e){var t='<Row ss:Index="'+(n+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=dD(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function V5(n,e,t,r){if(!n["!ref"])return"";var i=wt(n["!ref"]),o=n["!merges"]||[],s=0,a=[];n["!cols"]&&n["!cols"].forEach(function(g,w){Gv(g);var y=!!g.width,S=Eh(w,g),B={"ss:Index":w+1};y&&(B["ss:Width"]=lh(S.width)),g.hidden&&(B["ss:Hidden"]="1"),a.push(ve("Column",null,B))});for(var l=Array.isArray(n),c=i.s.r;c<=i.e.r;++c){for(var u=[B5(c,(n["!rows"]||[])[c])],f=i.s.c;f<=i.e.c;++f){var h=!1;for(s=0;s!=o.length;++s)if(!(o[s].s.c>f)&&!(o[s].s.r>c)&&!(o[s].e.c<f)&&!(o[s].e.r<c)){(o[s].s.c!=f||o[s].s.r!=c)&&(h=!0);break}if(!h){var d={r:c,c:f},m=ht(d),p=l?(n[c]||[])[f]:n[m];u.push(L5(p,m,n,e,t,r,d))}}u.push("</Row>"),u.length>2&&a.push(u.join(""))}return a.join("")}function U5(n,e,t){var r=[],i=t.SheetNames[n],o=t.Sheets[i],s=o?O5(o,e,n,t):"";return s.length>0&&r.push("<Names>"+s+"</Names>"),s=o?V5(o,e,n,t):"",s.length>0&&r.push("<Table>"+s+"</Table>"),r.push(R5(o,e,n,t)),r.join("")}function j5(n,e){e||(e={}),n.SSF||(n.SSF=qn(Bt)),n.SSF&&(mh(),ph(n.SSF),e.revssf=gh(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF,e.cellXfs=[],wo(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(F5(n,e)),t.push(k5(n,e)),t.push(""),t.push("");for(var r=0;r<n.SheetNames.length;++r)t.push(ve("Worksheet",U5(r,e,n),{"ss:Name":dt(n.SheetNames[r])}));return t[2]=N5(n,e),t[3]=M5(n,e),Kt+ve("Workbook",t.join(""),{xmlns:fr.ss,"xmlns:o":fr.o,"xmlns:x":fr.x,"xmlns:ss":fr.ss,"xmlns:dt":fr.dt,"xmlns:html":fr.html})}var _v={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function H5(n,e){var t=[],r=[],i=[],o=0,s,a=Bw(Zw,"n"),l=Bw(Qw,"n");if(n.Props)for(s=xn(n.Props),o=0;o<s.length;++o)(Object.prototype.hasOwnProperty.call(a,s[o])?t:Object.prototype.hasOwnProperty.call(l,s[o])?r:i).push([s[o],n.Props[s[o]]]);if(n.Custprops)for(s=xn(n.Custprops),o=0;o<s.length;++o)Object.prototype.hasOwnProperty.call(n.Props||{},s[o])||(Object.prototype.hasOwnProperty.call(a,s[o])?t:Object.prototype.hasOwnProperty.call(l,s[o])?r:i).push([s[o],n.Custprops[s[o]]]);var c=[];for(o=0;o<i.length;++o)nD.indexOf(i[o][0])>-1||JC.indexOf(i[o][0])>-1||i[o][1]!=null&&c.push(i[o]);r.length&&gt.utils.cfb_add(e,"/SummaryInformation",rC(r,_v.SI,l,Qw)),(t.length||c.length)&&gt.utils.cfb_add(e,"/DocumentSummaryInformation",rC(t,_v.DSI,a,Zw,c.length?c:null,_v.UDI))}function G5(n,e){var t=e||{},r=gt.utils.cfb_new({root:"R"}),i="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":i="/Workbook",t.biff=8;break;case"biff5":i="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return gt.utils.cfb_add(r,i,MD(n,t)),t.biff==8&&(n.Props||n.Custprops)&&H5(n,r),t.biff==8&&n.vbaraw&&a8(r,gt.read(n.vbaraw,{type:typeof n.vbaraw=="string"?"binary":"buffer"})),r}var $5={0:{f:qB},1:{f:t6},2:{f:E6},3:{f:c6},4:{f:o6},5:{f:v6},6:{f:S6},7:{f:h6},8:{f:M6},9:{f:N6},10:{f:F6},11:{f:k6},12:{f:r6},13:{f:w6},14:{f:f6},15:{f:a6},16:{f:y6},17:{f:I6},18:{f:m6},19:{f:Vv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:_5},40:{},42:{},43:{f:SL},44:{f:CL},45:{f:AL},46:{f:kL},47:{f:FL},48:{},49:{f:r3},50:{},51:{f:qL},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:iL},62:{f:D6},63:{f:JL},64:{f:Y6},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:mi,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:W6},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:JB},148:{f:XB,p:16},151:{f:V6},152:{},153:{f:g5},154:{},155:{},156:{f:p5},157:{},158:{},159:{T:1,f:pL},160:{T:-1},161:{T:1,f:vs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:O6},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:WL},336:{T:-1},337:{f:XL,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:wv},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Q3},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:U6},427:{f:j6},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:G6},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:QB},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:L6},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:wv},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:i8},633:{T:1},634:{T:-1},635:{T:1,f:n8},636:{T:-1},637:{f:a3},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:l5},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:X6},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function _e(n,e,t,r){var i=e;if(!isNaN(i)){var o=r||(t||[]).length||0,s=n.next(4);s.write_shift(2,i),s.write_shift(2,o),o>0&&Pv(t)&&n.push(t)}}function W5(n,e,t,r){var i=r||(t||[]).length||0;if(i<=8224)return _e(n,e,t,i);var o=e;if(!isNaN(o)){for(var s=t.parts||[],a=0,l=0,c=0;c+(s[a]||8224)<=8224;)c+=s[a]||8224,a++;var u=n.next(4);for(u.write_shift(2,o),u.write_shift(2,c),n.push(t.slice(l,l+c)),l+=c;l<i;){for(u=n.next(4),u.write_shift(2,60),c=0;c+(s[a]||8224)<=8224;)c+=s[a]||8224,a++;u.write_shift(2,c),n.push(t.slice(l,l+c)),l+=c}}}function Ac(n,e,t){return n||(n=te(7)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,0),n.write_shift(1,0),n}function z5(n,e,t,r){var i=te(9);return Ac(i,n,e),iD(t,r||"b",i),i}function q5(n,e,t){var r=te(8+2*t.length);return Ac(r,n,e),r.write_shift(1,t.length),r.write_shift(t.length,t,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function K5(n,e,t,r){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?zn(Bn(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?_e(n,2,lL(t,r,i)):_e(n,3,aL(t,r,i));return;case"b":case"e":_e(n,5,z5(t,r,e.v,e.t));return;case"s":case"str":_e(n,4,q5(t,r,(e.v||"").slice(0,255)));return}_e(n,1,Ac(null,t,r))}function Y5(n,e,t,r){var i=Array.isArray(e),o=wt(e["!ref"]||"A1"),s,a="",l=[];if(o.e.c>255||o.e.r>16383){if(r.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),s=qt(o)}for(var c=o.s.r;c<=o.e.r;++c){a=yn(c);for(var u=o.s.c;u<=o.e.c;++u){c===o.s.r&&(l[u]=Fn(u)),s=l[u]+a;var f=i?(e[c]||[])[u]:e[s];f&&K5(n,f,c,u,r)}}}function X5(n,e){var t=e||{};pi!=null&&t.dense==null&&(t.dense=pi);for(var r=Wn(),i=0,o=0;o<n.SheetNames.length;++o)n.SheetNames[o]==t.sheet&&(i=o);if(i==0&&t.sheet&&n.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return _e(r,t.biff==4?1033:t.biff==3?521:9,Hv(n,16,t)),Y5(r,n.Sheets[n.SheetNames[i]],i,t,n),_e(r,10),r.end()}function Z5(n,e,t){_e(n,49,$3({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},t))}function Q5(n,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&_e(n,1054,q3(i,e[i],t))})}function J5(n,e){var t=te(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),_e(n,2151,t),t=te(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),aD(wt(e["!ref"]||"A1"),t),t.write_shift(4,4),_e(n,2152,t)}function eV(n,e){for(var t=0;t<16;++t)_e(n,224,oC({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(r){_e(n,224,oC(r,0,e))})}function tV(n,e){for(var t=0;t<e["!links"].length;++t){var r=e["!links"][t];_e(n,440,tL(r)),r[1].Tooltip&&_e(n,2048,nL(r))}delete e["!links"]}function nV(n,e){if(e){var t=0;e.forEach(function(r,i){++t<=256&&r&&_e(n,125,oL(Eh(i,r),i))})}}function rV(n,e,t,r,i){var o=16+wo(i.cellXfs,e,i);if(e.v==null&&!e.bf){_e(n,513,ds(t,r,o));return}if(e.bf)_e(n,6,bB(e,t,r,i,o));else switch(e.t){case"d":case"n":var s=e.t=="d"?zn(Bn(e.v)):e.v;_e(n,515,Z3(t,r,s,o,i));break;case"b":case"e":_e(n,517,X3(t,r,e.v,o,i,e.t));break;case"s":case"str":if(i.bookSST){var a=qv(i.Strings,e.v,i.revStrings);_e(n,253,W3(t,r,a,o,i))}else _e(n,516,z3(t,r,(e.v||"").slice(0,255),o,i));break;default:_e(n,513,ds(t,r,o))}}function iV(n,e,t){var r=Wn(),i=t.SheetNames[n],o=t.Sheets[i]||{},s=(t||{}).Workbook||{},a=(s.Sheets||[])[n]||{},l=Array.isArray(o),c=e.biff==8,u,f="",h=[],d=wt(o["!ref"]||"A1"),m=c?65536:16384;if(d.e.c>255||d.e.r>=m){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,m-1)}_e(r,2057,Hv(t,16,e)),_e(r,13,Sr(1)),_e(r,12,Sr(100)),_e(r,15,Ln(!0)),_e(r,17,Ln(!1)),_e(r,16,fs(.001)),_e(r,95,Ln(!0)),_e(r,42,Ln(!1)),_e(r,43,Ln(!1)),_e(r,130,Sr(1)),_e(r,128,Y3([0,0])),_e(r,131,Ln(!1)),_e(r,132,Ln(!1)),c&&nV(r,o["!cols"]),_e(r,512,K3(d,e)),c&&(o["!links"]=[]);for(var p=d.s.r;p<=d.e.r;++p){f=yn(p);for(var g=d.s.c;g<=d.e.c;++g){p===d.s.r&&(h[g]=Fn(g)),u=h[g]+f;var w=l?(o[p]||[])[g]:o[u];w&&(rV(r,w,p,g,e),c&&w.l&&o["!links"].push([u,w.l]))}}var y=a.CodeName||a.name||i;return c&&_e(r,574,G3((s.Views||[])[0])),c&&(o["!merges"]||[]).length&&_e(r,229,eL(o["!merges"])),c&&tV(r,o),_e(r,442,sD(y,e)),c&&J5(r,o),_e(r,10),r.end()}function oV(n,e,t){var r=Wn(),i=(n||{}).Workbook||{},o=i.Sheets||[],s=i.WBProps||{},a=t.biff==8,l=t.biff==5;if(_e(r,2057,Hv(n,5,t)),t.bookType=="xla"&&_e(r,135),_e(r,225,a?Sr(1200):null),_e(r,193,F3(2)),l&&_e(r,191),l&&_e(r,192),_e(r,226),_e(r,92,V3("SheetJS",t)),_e(r,66,Sr(a?1200:1252)),a&&_e(r,353,Sr(0)),a&&_e(r,448),_e(r,317,sL(n.SheetNames.length)),a&&n.vbaraw&&_e(r,211),a&&n.vbaraw){var c=s.CodeName||"ThisWorkbook";_e(r,442,sD(c,t))}_e(r,156,Sr(17)),_e(r,25,Ln(!1)),_e(r,18,Ln(!1)),_e(r,19,Sr(0)),a&&_e(r,431,Ln(!1)),a&&_e(r,444,Sr(0)),_e(r,61,H3(t)),_e(r,64,Ln(!1)),_e(r,141,Sr(0)),_e(r,34,Ln(u5(n)=="true")),_e(r,14,Ln(!0)),a&&_e(r,439,Ln(!1)),_e(r,218,Sr(0)),Z5(r,n,t),Q5(r,n.SSF,t),eV(r,t),a&&_e(r,352,Ln(!1));var u=r.end(),f=Wn();a&&_e(f,140,rL()),a&&t.Strings&&W5(f,252,j3(t.Strings,t)),_e(f,10);var h=f.end(),d=Wn(),m=0,p=0;for(p=0;p<n.SheetNames.length;++p)m+=(a?12:11)+(a?2:1)*n.SheetNames[p].length;var g=u.length+m+h.length;for(p=0;p<n.SheetNames.length;++p){var w=o[p]||{};_e(d,133,U3({pos:g,hs:w.Hidden||0,dt:0,name:n.SheetNames[p]},t)),g+=e[p].length}var y=d.end();if(m!=y.length)throw new Error("BS8 "+m+" != "+y.length);var S=[];return u.length&&S.push(u),y.length&&S.push(y),h.length&&S.push(h),vn(S)}function sV(n,e){var t=e||{},r=[];n&&!n.SSF&&(n.SSF=qn(Bt)),n&&n.SSF&&(mh(),ph(n.SSF),t.revssf=gh(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Kv(t),t.cellXfs=[],wo(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={});for(var i=0;i<n.SheetNames.length;++i)r[r.length]=iV(i,t,n);return r.unshift(oV(n,r,t)),vn(r)}function MD(n,e){for(var t=0;t<=n.SheetNames.length;++t){var r=n.Sheets[n.SheetNames[t]];if(!(!r||!r["!ref"])){var i=dr(r["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var o=e||{};switch(o.biff||2){case 8:case 5:return sV(n,e);case 4:case 3:case 2:return X5(n,e)}throw new Error("invalid type "+o.bookType+" for BIFF")}function aV(n,e,t,r){for(var i=n["!merges"]||[],o=[],s=e.s.c;s<=e.e.c;++s){for(var a=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>t||i[c].s.c>s)&&!(i[c].e.r<t||i[c].e.c<s)){if(i[c].s.r<t||i[c].s.c<s){a=-1;break}a=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(a<0)){var u=ht({r:t,c:s}),f=r.dense?(n[t]||[])[s]:n[u],h=f&&f.v!=null&&(f.h||L4(f.w||(Ui(f),f.w)||""))||"",d={};a>1&&(d.rowspan=a),l>1&&(d.colspan=l),r.editable?h='<span contenteditable="true">'+h+"</span>":f&&(d["data-t"]=f&&f.t||"z",f.v!=null&&(d["data-v"]=f.v),f.z!=null&&(d["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),d.id=(r.id||"sjs")+"-"+u,o.push(ve("td",h,d))}}var m="<tr>";return m+o.join("")+"</tr>"}var lV='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',cV="</body></html>";function uV(n,e,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function OD(n,e){var t=e||{},r=t.header!=null?t.header:lV,i=t.footer!=null?t.footer:cV,o=[r],s=dr(n["!ref"]);t.dense=Array.isArray(n),o.push(uV(n,s,t));for(var a=s.s.r;a<=s.e.r;++a)o.push(aV(n,s,a,t));return o.push("</table>"+i),o.join("")}function RD(n,e,t){var r=t||{};pi!=null&&(r.dense=pi);var i=0,o=0;if(r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var s=typeof r.origin=="string"?fn(r.origin):r.origin;i=s.r,o=s.c}var a=e.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,a.length),c={s:{r:0,c:0},e:{r:i,c:o}};if(n["!ref"]){var u=dr(n["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),i==-1&&(c.e.r=i=u.e.r+1)}var f=[],h=0,d=n["!rows"]||(n["!rows"]=[]),m=0,p=0,g=0,w=0,y=0,S=0;for(n["!cols"]||(n["!cols"]=[]);m<a.length&&p<l;++m){var B=a[m];if(dC(B)){if(r.display)continue;d[p]={hidden:!0}}var Z=B.children;for(g=w=0;g<Z.length;++g){var ce=Z[g];if(!(r.display&&dC(ce))){var O=ce.hasAttribute("data-v")?ce.getAttribute("data-v"):ce.hasAttribute("v")?ce.getAttribute("v"):j4(ce.innerHTML),L=ce.getAttribute("data-z")||ce.getAttribute("z");for(h=0;h<f.length;++h){var G=f[h];G.s.c==w+o&&G.s.r<p+i&&p+i<=G.e.r&&(w=G.e.c+1-o,h=-1)}S=+ce.getAttribute("colspan")||1,((y=+ce.getAttribute("rowspan")||1)>1||S>1)&&f.push({s:{r:p+i,c:w+o},e:{r:p+i+(y||1)-1,c:w+o+(S||1)-1}});var V={t:"s",v:O},K=ce.getAttribute("data-t")||ce.getAttribute("t")||"";O!=null&&(O.length==0?V.t=K||"z":r.raw||O.trim().length==0||K=="s"||(O==="TRUE"?V={t:"b",v:!0}:O==="FALSE"?V={t:"b",v:!1}:isNaN(Li(O))?isNaN(Ec(O).getDate())||(V={t:"d",v:Bn(O)},r.cellDates||(V={t:"n",v:zn(V.v)}),V.z=r.dateNF||Bt[14]):V={t:"n",v:Li(O)})),V.z===void 0&&L!=null&&(V.z=L);var W="",ue=ce.getElementsByTagName("A");if(ue&&ue.length)for(var Oe=0;Oe<ue.length&&!(ue[Oe].hasAttribute("href")&&(W=ue[Oe].getAttribute("href"),W.charAt(0)!="#"));++Oe);W&&W.charAt(0)!="#"&&(V.l={Target:W}),r.dense?(n[p+i]||(n[p+i]=[]),n[p+i][w+o]=V):n[ht({c:w+o,r:p+i})]=V,c.e.c<w+o&&(c.e.c=w+o),w+=S}}++p}return f.length&&(n["!merges"]=(n["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,p-1+i),n["!ref"]=qt(c),p>=l&&(n["!fullref"]=qt((c.e.r=a.length-m+p-1+i,c))),n}function PD(n,e){var t=e||{},r=t.dense?[]:{};return RD(r,n,e)}function fV(n,e){return hs(PD(n,e),e)}function dC(n){var e="",t=dV(n);return t&&(e=t(n).getPropertyValue("display")),e||(e=n.style&&n.style.display),e==="none"}function dV(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var hV=function(){var n=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Tc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+n+"</office:document-styles>";return function(){return Kt+e}}(),hC=function(){var n=function(o){return dt(o).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,r=function(o,s,a){var l=[];l.push('      <table:table table:name="'+dt(s.SheetNames[a])+`" table:style-name="ta1">
`);var c=0,u=0,f=dr(o["!ref"]||"A1"),h=o["!merges"]||[],d=0,m=Array.isArray(o);if(o["!cols"])for(u=0;u<=f.e.c;++u)l.push("        <table:table-column"+(o["!cols"][u]?' table:style-name="co'+o["!cols"][u].ods+'"':"")+`></table:table-column>
`);var p="",g=o["!rows"]||[];for(c=0;c<f.s.r;++c)p=g[c]?' table:style-name="ro'+g[c].ods+'"':"",l.push("        <table:table-row"+p+`></table:table-row>
`);for(;c<=f.e.r;++c){for(p=g[c]?' table:style-name="ro'+g[c].ods+'"':"",l.push("        <table:table-row"+p+`>
`),u=0;u<f.s.c;++u)l.push(e);for(;u<=f.e.c;++u){var w=!1,y={},S="";for(d=0;d!=h.length;++d)if(!(h[d].s.c>u)&&!(h[d].s.r>c)&&!(h[d].e.c<u)&&!(h[d].e.r<c)){(h[d].s.c!=u||h[d].s.r!=c)&&(w=!0),y["table:number-columns-spanned"]=h[d].e.c-h[d].s.c+1,y["table:number-rows-spanned"]=h[d].e.r-h[d].s.r+1;break}if(w){l.push(t);continue}var B=ht({r:c,c:u}),Z=m?(o[c]||[])[u]:o[B];if(Z&&Z.f&&(y["table:formula"]=dt(MB(Z.f)),Z.F&&Z.F.slice(0,B.length)==B)){var ce=dr(Z.F);y["table:number-matrix-columns-spanned"]=ce.e.c-ce.s.c+1,y["table:number-matrix-rows-spanned"]=ce.e.r-ce.s.r+1}if(!Z){l.push(e);continue}switch(Z.t){case"b":S=Z.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=Z.v?"true":"false";break;case"n":S=Z.w||String(Z.v||0),y["office:value-type"]="float",y["office:value"]=Z.v||0;break;case"s":case"str":S=Z.v==null?"":Z.v,y["office:value-type"]="string";break;case"d":S=Z.w||Bn(Z.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=Bn(Z.v).toISOString(),y["table:style-name"]="ce1";break;default:l.push(e);continue}var O=n(S);if(Z.l&&Z.l.Target){var L=Z.l.Target;L=L.charAt(0)=="#"?"#"+OB(L.slice(1)):L,L.charAt(0)!="#"&&!L.match(/^\w+:/)&&(L="../"+L),O=ve("text:a",O,{"xlink:href":L.replace(/&/g,"&amp;")})}l.push("          "+ve("table:table-cell",ve("text:p",O,{}),y)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(o,s){o.push(` <office:automatic-styles>
`),o.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),o.push(`   <number:month number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:day number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:year/>
`),o.push(`  </number:date-style>
`);var a=0;s.SheetNames.map(function(c){return s.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var f=c["!cols"][u];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Gv(f),f.ods=a;var h=c["!cols"][u].wpx+"px";o.push('  <style:style style:name="co'+a+`" style:family="table-column">
`),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),o.push(`  </style:style>
`),++a}}});var l=0;s.SheetNames.map(function(c){return s.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var f=c["!rows"][u].hpx+"px";o.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),o.push(`  </style:style>
`),++l}}}),o.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),o.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),o.push(`  </style:style>
`),o.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),o.push(` </office:automatic-styles>
`)};return function(s,a){var l=[Kt],c=Tc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Tc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});a.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(ZC().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,s),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var f=0;f!=s.SheetNames.length;++f)l.push(r(s.Sheets[s.SheetNames[f]],s,f,a));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),a.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function LD(n,e){if(e.bookType=="fods")return hC(n,e);var t=Iv(),r="",i=[],o=[];return r="mimetype",Ye(t,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",Ye(t,r,hC(n,e)),i.push([r,"text/xml"]),o.push([r,"ContentFile"]),r="styles.xml",Ye(t,r,hV(n,e)),i.push([r,"text/xml"]),o.push([r,"StylesFile"]),r="meta.xml",Ye(t,r,Kt+ZC()),i.push([r,"text/xml"]),o.push([r,"MetadataFile"]),r="manifest.rdf",Ye(t,r,D3(o)),i.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",Ye(t,r,w3(i)),t}function fh(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function pV(n){return typeof TextEncoder<"u"?new TextEncoder().encode(n):$r(Ri(n))}function mV(n,e){e:for(var t=0;t<=n.length-e.length;++t){for(var r=0;r<e.length;++r)if(n[t+r]!=e[r])continue e;return!0}return!1}function To(n){var e=n.reduce(function(i,o){return i+o.length},0),t=new Uint8Array(e),r=0;return n.forEach(function(i){t.set(i,r),r+=i.length}),t}function gV(n,e,t){var r=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,i=t/Math.pow(10,r-6176);n[e+15]|=r>>7,n[e+14]|=(r&127)<<1;for(var o=0;i>=1;++o,i/=256)n[e+o]=i&255;n[e+15]|=t>=0?0:128}function wc(n,e){var t=e?e[0]:0,r=n[t]&127;e:if(n[t++]>=128&&(r|=(n[t]&127)<<7,n[t++]<128||(r|=(n[t]&127)<<14,n[t++]<128)||(r|=(n[t]&127)<<21,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,28),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,35),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,42),++t,n[t++]<128)))break e;return e&&(e[0]=t),r}function ut(n){var e=new Uint8Array(7);e[0]=n&127;var t=1;e:if(n>127){if(e[t-1]|=128,e[t]=n>>7&127,++t,n<=16383||(e[t-1]|=128,e[t]=n>>14&127,++t,n<=2097151)||(e[t-1]|=128,e[t]=n>>21&127,++t,n<=268435455)||(e[t-1]|=128,e[t]=n/256>>>21&127,++t,n<=34359738367)||(e[t-1]|=128,e[t]=n/65536>>>21&127,++t,n<=4398046511103))break e;e[t-1]|=128,e[t]=n/16777216>>>21&127,++t}return e.slice(0,t)}function Sa(n){var e=0,t=n[e]&127;e:if(n[e++]>=128){if(t|=(n[e]&127)<<7,n[e++]<128||(t|=(n[e]&127)<<14,n[e++]<128)||(t|=(n[e]&127)<<21,n[e++]<128))break e;t|=(n[e]&127)<<28}return t}function tn(n){for(var e=[],t=[0];t[0]<n.length;){var r=t[0],i=wc(n,t),o=i&7;i=Math.floor(i/8);var s=0,a;if(i==0)break;switch(o){case 0:{for(var l=t[0];n[t[0]++]>=128;);a=n.slice(l,t[0])}break;case 5:s=4,a=n.slice(t[0],t[0]+s),t[0]+=s;break;case 1:s=8,a=n.slice(t[0],t[0]+s),t[0]+=s;break;case 2:s=wc(n,t),a=n.slice(t[0],t[0]+s),t[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(i," at offset ").concat(r))}var c={data:a,type:o};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function mn(n){var e=[];return n.forEach(function(t,r){t.forEach(function(i){i.data&&(e.push(ut(r*8+i.type)),i.type==2&&e.push(ut(i.data.length)),e.push(i.data))})}),To(e)}function Hr(n){for(var e,t=[],r=[0];r[0]<n.length;){var i=wc(n,r),o=tn(n.slice(r[0],r[0]+i));r[0]+=i;var s={id:Sa(o[1][0].data),messages:[]};o[2].forEach(function(a){var l=tn(a.data),c=Sa(l[3][0].data);s.messages.push({meta:l,data:n.slice(r[0],r[0]+c)}),r[0]+=c}),(e=o[3])!=null&&e[0]&&(s.merge=Sa(o[3][0].data)>>>0>0),t.push(s)}return t}function _a(n){var e=[];return n.forEach(function(t){var r=[];r[1]=[{data:ut(t.id),type:0}],r[2]=[],t.merge!=null&&(r[3]=[{data:ut(+!!t.merge),type:0}]);var i=[];t.messages.forEach(function(s){i.push(s.data),s.meta[3]=[{type:0,data:ut(s.data.length)}],r[2].push({data:mn(s.meta),type:2})});var o=mn(r);e.push(ut(o.length)),e.push(o),i.forEach(function(s){return e.push(s)})}),To(e)}function vV(n,e){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var t=[0],r=wc(e,t),i=[];t[0]<e.length;){var o=e[t[0]]&3;if(o==0){var s=e[t[0]++]>>2;if(s<60)++s;else{var a=s-59;s=e[t[0]],a>1&&(s|=e[t[0]+1]<<8),a>2&&(s|=e[t[0]+2]<<16),a>3&&(s|=e[t[0]+3]<<24),s>>>=0,s++,t[0]+=a}i.push(e.slice(t[0],t[0]+s)),t[0]+=s;continue}else{var l=0,c=0;if(o==1?(c=(e[t[0]]>>2&7)+4,l=(e[t[0]++]&224)<<3,l|=e[t[0]++]):(c=(e[t[0]++]>>2)+1,o==2?(l=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(l=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),i=[To(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var u=To(i);if(u.length!=r)throw new Error("Unexpected length: ".concat(u.length," != ").concat(r));return u}function Gr(n){for(var e=[],t=0;t<n.length;){var r=n[t++],i=n[t]|n[t+1]<<8|n[t+2]<<16;t+=3,e.push(vV(r,n.slice(t,t+i))),t+=i}if(t!==n.length)throw new Error("data is not a valid framed stream!");return To(e)}function ya(n){for(var e=[],t=0;t<n.length;){var r=Math.min(n.length-t,268435455),i=new Uint8Array(4);e.push(i);var o=ut(r),s=o.length;e.push(o),r<=60?(s++,e.push(new Uint8Array([r-1<<2]))):r<=256?(s+=2,e.push(new Uint8Array([240,r-1&255]))):r<=65536?(s+=3,e.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(s+=4,e.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(s+=5,e.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),e.push(n.slice(t,t+r)),s+=r,i[0]=0,i[1]=s&255,i[2]=s>>8&255,i[3]=s>>16&255,t+=r}return To(e)}function yv(n,e){var t=new Uint8Array(32),r=fh(t),i=12,o=0;switch(t[0]=5,n.t){case"n":t[1]=2,gV(t,i,n.v),o|=1,i+=16;break;case"b":t[1]=6,r.setFloat64(i,n.v?1:0,!0),o|=2,i+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[1]=3,r.setUint32(i,e.indexOf(n.v),!0),o|=8,i+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(8,o,!0),t.slice(0,i)}function xv(n,e){var t=new Uint8Array(32),r=fh(t),i=12,o=0;switch(t[0]=3,n.t){case"n":t[2]=2,r.setFloat64(i,n.v,!0),o|=32,i+=8;break;case"b":t[2]=6,r.setFloat64(i,n.v?1:0,!0),o|=32,i+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[2]=3,r.setUint32(i,e.indexOf(n.v),!0),o|=16,i+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(4,o,!0),t.slice(0,i)}function vo(n){var e=tn(n);return wc(e[1][0].data)}function _V(n,e,t){var r,i,o,s;if(!((r=n[6])!=null&&r[0])||!((i=n[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var a=((s=(o=n[8])==null?void 0:o[0])==null?void 0:s.data)&&Sa(n[8][0].data)>0||!1;if(a)throw"Math only works with normal offsets";for(var l=0,c=fh(n[7][0].data),u=0,f=[],h=fh(n[4][0].data),d=0,m=[],p=0;p<e.length;++p){if(e[p]==null){c.setUint16(p*2,65535,!0),h.setUint16(p*2,65535);continue}c.setUint16(p*2,u,!0),h.setUint16(p*2,d,!0);var g,w;switch(typeof e[p]){case"string":g=yv({t:"s",v:e[p]},t),w=xv({t:"s",v:e[p]},t);break;case"number":g=yv({t:"n",v:e[p]},t),w=xv({t:"n",v:e[p]},t);break;case"boolean":g=yv({t:"b",v:e[p]},t),w=xv({t:"b",v:e[p]},t);break;default:throw new Error("Unsupported value "+e[p])}f.push(g),u+=g.length,m.push(w),d+=w.length,++l}for(n[2][0].data=ut(l);p<n[7][0].data.length/2;++p)c.setUint16(p*2,65535,!0),h.setUint16(p*2,65535,!0);return n[6][0].data=To(f),n[3][0].data=To(m),l}function yV(n,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=n.Sheets[n.SheetNames[0]];n.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=dr(t["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(qt(r)));var o=dh(t,{range:r,header:1}),s=["~Sh33tJ5~"];o.forEach(function(M){return M.forEach(function(P){typeof P=="string"&&s.push(P)})});var a={},l=[],c=gt.read(e.numbers,{type:"base64"});c.FileIndex.map(function(M,P){return[M,c.FullPaths[P]]}).forEach(function(M){var P=M[0],se=M[1];if(P.type==2&&P.name.match(/\.iwa/)){var he=P.content,Q=Gr(he),j=Hr(Q);j.forEach(function(N){l.push(N.id),a[N.id]={deps:[],location:se,type:Sa(N.messages[0].meta[1][0].data)}})}}),l.sort(function(M,P){return M-P});var u=l.filter(function(M){return M>1}).map(function(M){return[M,ut(M)]});c.FileIndex.map(function(M,P){return[M,c.FullPaths[P]]}).forEach(function(M){var P=M[0],se=M[1];if(P.name.match(/\.iwa/)){var he=Hr(Gr(P.content));he.forEach(function(Q){Q.messages.forEach(function(j){u.forEach(function(N){Q.messages.some(function(oe){return Sa(oe.meta[1][0].data)!=11006&&mV(oe.data,N[1])})&&a[N[0]].deps.push(Q.id)})})})}});function f(){for(var M=927262;M<2e6;++M)if(!a[M])return M;throw new Error("Too many messages")}for(var h=gt.find(c,a[1].location),d=Hr(Gr(h.content)),m,p=0;p<d.length;++p){var g=d[p];g.id==1&&(m=g)}var w=vo(tn(m.messages[0].data)[1][0].data);for(h=gt.find(c,a[w].location),d=Hr(Gr(h.content)),p=0;p<d.length;++p)g=d[p],g.id==w&&(m=g);for(w=vo(tn(m.messages[0].data)[2][0].data),h=gt.find(c,a[w].location),d=Hr(Gr(h.content)),p=0;p<d.length;++p)g=d[p],g.id==w&&(m=g);for(w=vo(tn(m.messages[0].data)[2][0].data),h=gt.find(c,a[w].location),d=Hr(Gr(h.content)),p=0;p<d.length;++p)g=d[p],g.id==w&&(m=g);var y=tn(m.messages[0].data);{y[6][0].data=ut(r.e.r+1),y[7][0].data=ut(r.e.c+1);var S=vo(y[46][0].data),B=gt.find(c,a[S].location),Z=Hr(Gr(B.content));{for(var ce=0;ce<Z.length&&Z[ce].id!=S;++ce);if(Z[ce].id!=S)throw"Bad ColumnRowUIDMapArchive";var O=tn(Z[ce].messages[0].data);O[1]=[],O[2]=[],O[3]=[];for(var L=0;L<=r.e.c;++L){var G=[];G[1]=G[2]=[{type:0,data:ut(L+420690)}],O[1].push({type:2,data:mn(G)}),O[2].push({type:0,data:ut(L)}),O[3].push({type:0,data:ut(L)})}O[4]=[],O[5]=[],O[6]=[];for(var V=0;V<=r.e.r;++V)G=[],G[1]=G[2]=[{type:0,data:ut(V+726270)}],O[4].push({type:2,data:mn(G)}),O[5].push({type:0,data:ut(V)}),O[6].push({type:0,data:ut(V)});Z[ce].messages[0].data=mn(O)}B.content=ya(_a(Z)),B.size=B.content.length,delete y[46];var K=tn(y[4][0].data);{K[7][0].data=ut(r.e.r+1);var W=tn(K[1][0].data),ue=vo(W[2][0].data);B=gt.find(c,a[ue].location),Z=Hr(Gr(B.content));{if(Z[0].id!=ue)throw"Bad HeaderStorageBucket";var Oe=tn(Z[0].messages[0].data);for(V=0;V<o.length;++V){var Te=tn(Oe[2][0].data);Te[1][0].data=ut(V),Te[4][0].data=ut(o[V].length),Oe[2][V]={type:Oe[2][0].type,data:mn(Te)}}Z[0].messages[0].data=mn(Oe)}B.content=ya(_a(Z)),B.size=B.content.length;var ie=vo(K[2][0].data);B=gt.find(c,a[ie].location),Z=Hr(Gr(B.content));{if(Z[0].id!=ie)throw"Bad HeaderStorageBucket";for(Oe=tn(Z[0].messages[0].data),L=0;L<=r.e.c;++L)Te=tn(Oe[2][0].data),Te[1][0].data=ut(L),Te[4][0].data=ut(r.e.r+1),Oe[2][L]={type:Oe[2][0].type,data:mn(Te)};Z[0].messages[0].data=mn(Oe)}B.content=ya(_a(Z)),B.size=B.content.length;var ee=vo(K[4][0].data);(function(){for(var M=gt.find(c,a[ee].location),P=Hr(Gr(M.content)),se,he=0;he<P.length;++he){var Q=P[he];Q.id==ee&&(se=Q)}var j=tn(se.messages[0].data);{j[3]=[];var N=[];s.forEach(function(Fe,me){N[1]=[{type:0,data:ut(me)}],N[2]=[{type:0,data:ut(1)}],N[3]=[{type:2,data:pV(Fe)}],j[3].push({type:2,data:mn(N)})})}se.messages[0].data=mn(j);var oe=_a(P),ge=ya(oe);M.content=ge,M.size=M.content.length})();var k=tn(K[3][0].data);{var R=k[1][0];delete k[2];var pe=tn(R.data);{var De=vo(pe[2][0].data);(function(){for(var M=gt.find(c,a[De].location),P=Hr(Gr(M.content)),se,he=0;he<P.length;++he){var Q=P[he];Q.id==De&&(se=Q)}var j=tn(se.messages[0].data);{delete j[6],delete k[7];var N=new Uint8Array(j[5][0].data);j[5]=[];for(var oe=0,ge=0;ge<=r.e.r;++ge){var Fe=tn(N);oe+=_V(Fe,o[ge],s),Fe[1][0].data=ut(ge),j[5].push({data:mn(Fe),type:2})}j[1]=[{type:0,data:ut(r.e.c+1)}],j[2]=[{type:0,data:ut(r.e.r+1)}],j[3]=[{type:0,data:ut(oe)}],j[4]=[{type:0,data:ut(r.e.r+1)}]}se.messages[0].data=mn(j);var me=_a(P),Ne=ya(me);M.content=Ne,M.size=M.content.length})()}R.data=mn(pe)}K[3][0].data=mn(k)}y[4][0].data=mn(K)}m.messages[0].data=mn(y);var F=_a(d),U=ya(F);return h.content=U,h.size=h.content.length,c}function xV(n){return function(t){for(var r=0;r!=n.length;++r){var i=n[r];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function Kv(n){xV([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(n)}function EV(n,e){return e.bookType=="ods"?LD(n,e):e.bookType=="numbers"?yV(n,e):e.bookType=="xlsb"?TV(n,e):wV(n,e)}function TV(n,e){Ea=1024,n&&!n.SSF&&(n.SSF=qn(Bt)),n&&n.SSF&&(mh(),ph(n.SSF),e.revssf=gh(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,vc?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",r=yD.indexOf(e.bookType)>-1,i=KC();Kv(e=e||{});var o=Iv(),s="",a=0;if(e.cellXfs=[],wo(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),s="docProps/core.xml",Ye(o,s,QC(n.Props,e)),i.coreprops.push(s),ft(e.rels,2,s,it.CORE_PROPS),s="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var l=[],c=0;c<n.SheetNames.length;++c)(n.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(n.SheetNames[c]);n.Props.SheetNames=l}for(n.Props.Worksheets=n.Props.SheetNames.length,Ye(o,s,eD(n.Props,e)),i.extprops.push(s),ft(e.rels,3,s,it.EXT_PROPS),n.Custprops!==n.Props&&xn(n.Custprops||{}).length>0&&(s="docProps/custom.xml",Ye(o,s,tD(n.Custprops,e)),i.custprops.push(s),ft(e.rels,4,s,it.CUST_PROPS)),a=1;a<=n.SheetNames.length;++a){var u={"!id":{}},f=n.Sheets[n.SheetNames[a-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:s="xl/worksheets/sheet"+a+"."+t,Ye(o,s,D5(a-1,s,e,n,u)),i.sheets.push(s),ft(e.wbrels,-1,"worksheets/sheet"+a+"."+t,it.WS[0])}if(f){var d=f["!comments"],m=!1,p="";d&&d.length>0&&(p="xl/comments"+a+"."+t,Ye(o,p,I5(d,p,e)),i.comments.push(p),ft(u,-1,"../comments"+a+"."+t,it.CMNT),m=!0),f["!legacy"]&&m&&Ye(o,"xl/drawings/vmlDrawing"+a+".vml",vD(a,f["!comments"])),delete f["!comments"],delete f["!legacy"]}u["!id"].rId1&&Ye(o,XC(s),Ca(u))}return e.Strings!=null&&e.Strings.length>0&&(s="xl/sharedStrings."+t,Ye(o,s,b5(e.Strings,s,e)),i.strs.push(s),ft(e.wbrels,-1,"sharedStrings."+t,it.SST)),s="xl/workbook."+t,Ye(o,s,C5(n,s,e)),i.workbooks.push(s),ft(e.rels,1,s,it.WB),s="xl/theme/theme1.xml",Ye(o,s,mD(n.Themes,e)),i.themes.push(s),ft(e.wbrels,-1,"theme/theme1.xml",it.THEME),s="xl/styles."+t,Ye(o,s,S5(n,s,e)),i.styles.push(s),ft(e.wbrels,-1,"styles."+t,it.STY),n.vbaraw&&r&&(s="xl/vbaProject.bin",Ye(o,s,n.vbaraw),i.vba.push(s),ft(e.wbrels,-1,"vbaProject.bin",it.VBA)),s="xl/metadata."+t,Ye(o,s,A5(s)),i.metadata.push(s),ft(e.wbrels,-1,"metadata."+t,it.XLMETA),Ye(o,"[Content_Types].xml",YC(i,e)),Ye(o,"_rels/.rels",Ca(e.rels)),Ye(o,"xl/_rels/workbook."+t+".rels",Ca(e.wbrels)),delete e.revssf,delete e.ssf,o}function wV(n,e){Ea=1024,n&&!n.SSF&&(n.SSF=qn(Bt)),n&&n.SSF&&(mh(),ph(n.SSF),e.revssf=gh(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,vc?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",r=yD.indexOf(e.bookType)>-1,i=KC();Kv(e=e||{});var o=Iv(),s="",a=0;if(e.cellXfs=[],wo(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),s="docProps/core.xml",Ye(o,s,QC(n.Props,e)),i.coreprops.push(s),ft(e.rels,2,s,it.CORE_PROPS),s="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var l=[],c=0;c<n.SheetNames.length;++c)(n.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(n.SheetNames[c]);n.Props.SheetNames=l}n.Props.Worksheets=n.Props.SheetNames.length,Ye(o,s,eD(n.Props,e)),i.extprops.push(s),ft(e.rels,3,s,it.EXT_PROPS),n.Custprops!==n.Props&&xn(n.Custprops||{}).length>0&&(s="docProps/custom.xml",Ye(o,s,tD(n.Custprops,e)),i.custprops.push(s),ft(e.rels,4,s,it.CUST_PROPS));var u=["SheetJ5"];for(e.tcid=0,a=1;a<=n.SheetNames.length;++a){var f={"!id":{}},h=n.Sheets[n.SheetNames[a-1]],d=(h||{})["!type"]||"sheet";switch(d){case"chart":default:s="xl/worksheets/sheet"+a+"."+t,Ye(o,s,ID(a-1,e,n,f)),i.sheets.push(s),ft(e.wbrels,-1,"worksheets/sheet"+a+"."+t,it.WS[0])}if(h){var m=h["!comments"],p=!1,g="";if(m&&m.length>0){var w=!1;m.forEach(function(y){y[1].forEach(function(S){S.T==!0&&(w=!0)})}),w&&(g="xl/threadedComments/threadedComment"+a+"."+t,Ye(o,g,e8(m,u,e)),i.threadedcomments.push(g),ft(f,-1,"../threadedComments/threadedComment"+a+"."+t,it.TCMNT)),g="xl/comments"+a+"."+t,Ye(o,g,_D(m,e)),i.comments.push(g),ft(f,-1,"../comments"+a+"."+t,it.CMNT),p=!0}h["!legacy"]&&p&&Ye(o,"xl/drawings/vmlDrawing"+a+".vml",vD(a,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Ye(o,XC(s),Ca(f))}return e.Strings!=null&&e.Strings.length>0&&(s="xl/sharedStrings."+t,Ye(o,s,cD(e.Strings,e)),i.strs.push(s),ft(e.wbrels,-1,"sharedStrings."+t,it.SST)),s="xl/workbook."+t,Ye(o,s,kD(n,e)),i.workbooks.push(s),ft(e.rels,1,s,it.WB),s="xl/theme/theme1.xml",Ye(o,s,mD(n.Themes,e)),i.themes.push(s),ft(e.wbrels,-1,"theme/theme1.xml",it.THEME),s="xl/styles."+t,Ye(o,s,hD(n,e)),i.styles.push(s),ft(e.wbrels,-1,"styles."+t,it.STY),n.vbaraw&&r&&(s="xl/vbaProject.bin",Ye(o,s,n.vbaraw),i.vba.push(s),ft(e.wbrels,-1,"vbaProject.bin",it.VBA)),s="xl/metadata."+t,Ye(o,s,gD()),i.metadata.push(s),ft(e.wbrels,-1,"metadata."+t,it.XLMETA),u.length>1&&(s="xl/persons/person.xml",Ye(o,s,t8(u,e)),i.people.push(s),ft(e.wbrels,-1,"persons/person.xml",it.PEOPLE)),Ye(o,"[Content_Types].xml",YC(i,e)),Ye(o,"_rels/.rels",Ca(e.rels)),Ye(o,"xl/_rels/workbook."+t+".rels",Ca(e.wbrels)),delete e.revssf,delete e.ssf,o}function CV(n,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":t=Vi(n.slice(0,12));break;case"binary":t=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function BD(n,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Sc(e.file,gt.write(n,{type:st?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return gt.write(n,e)}function DV(n,e){var t=qn(e||{}),r=EV(n,t);return SV(r,t)}function SV(n,e){var t={},r=st?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=r;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=r;break;default:throw new Error("Unrecognized type "+e.type)}var i=n.FullPaths?gt.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):n.generate(t);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(hh(i))}return e.password&&typeof encrypt_agile<"u"?BD(encrypt_agile(i,e.password),e):e.type==="file"?Sc(e.file,i):e.type=="string"?hc(i):i}function bV(n,e){var t=e||{},r=G5(n,t);return BD(r,t)}function hi(n,e,t){t||(t="");var r=t+n;switch(e.type){case"base64":return xc(Ri(r));case"binary":return Ri(r);case"string":return n;case"file":return Sc(e.file,r,"utf8");case"buffer":return st?ji(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):hi(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function IV(n,e){switch(e.type){case"base64":return xc(n);case"binary":return n;case"string":return n;case"file":return Sc(e.file,n,"binary");case"buffer":return st?ji(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Jd(n,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",r=0;r<n.length;++r)t+=String.fromCharCode(n[r]);return e.type=="base64"?xc(t):e.type=="string"?hc(t):t;case"file":return Sc(e.file,n);case"buffer":return n;default:throw new Error("Unrecognized type "+e.type)}}function VD(n,e){e4(),h5(n);var t=qn(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var r=VD(n,t);return t.type="array",hh(r)}var i=0;if(t.sheet&&(typeof t.sheet=="number"?i=t.sheet:i=n.SheetNames.indexOf(t.sheet),!n.SheetNames[i]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return hi(j5(n,t),t);case"slk":case"sylk":return hi(uL.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"htm":case"html":return hi(OD(n.Sheets[n.SheetNames[i]],t),t);case"txt":return IV(jD(n.Sheets[n.SheetNames[i]],t),t);case"csv":return hi(Yv(n.Sheets[n.SheetNames[i]],t),t,"\uFEFF");case"dif":return hi(fL.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"dbf":return Jd(cL.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"prn":return hi(dL.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"rtf":return hi(yL.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"eth":return hi(lD.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"fods":return hi(LD(n,t),t);case"wk1":return Jd(sC.sheet_to_wk1(n.Sheets[n.SheetNames[i]],t),t);case"wk3":return Jd(sC.book_to_wk3(n,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Jd(MD(n,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),bV(n,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return DV(n,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function AV(n){if(!n.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=n.file.slice(n.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(n.bookType=t.slice(1)),n.bookType=e[n.bookType]||n.bookType}}function UD(n,e,t){var r=t||{};return r.type="file",r.file=e,AV(r),VD(n,r)}function FV(n,e,t,r,i,o,s,a){var l=yn(t),c=a.defval,u=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),f=!0,h=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:t,enumerable:!1})}catch{h.__rowNum__=t}else h.__rowNum__=t;if(!s||n[t])for(var d=e.s.c;d<=e.e.c;++d){var m=s?n[t][d]:n[r[d]+l];if(m===void 0||m.t===void 0){if(c===void 0)continue;o[d]!=null&&(h[o[d]]=c);continue}var p=m.v;switch(m.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(o[d]!=null){if(p==null)if(m.t=="e"&&p===null)h[o[d]]=null;else if(c!==void 0)h[o[d]]=c;else if(u&&p===null)h[o[d]]=null;else continue;else h[o[d]]=u&&(m.t!=="n"||m.t==="n"&&a.rawNumbers!==!1)?p:Ui(m,p,a);p!=null&&(f=!1)}}return{row:h,isempty:f}}function dh(n,e){if(n==null||n["!ref"]==null)return[];var t={t:"n",v:0},r=0,i=1,o=[],s=0,a="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},u=c.range!=null?c.range:n["!ref"];switch(c.header===1?r=1:c.header==="A"?r=2:Array.isArray(c.header)?r=3:c.header==null&&(r=0),typeof u){case"string":l=wt(u);break;case"number":l=wt(n["!ref"]),l.s.r=u;break;default:l=u}r>0&&(i=0);var f=yn(l.s.r),h=[],d=[],m=0,p=0,g=Array.isArray(n),w=l.s.r,y=0,S={};g&&!n[w]&&(n[w]=[]);var B=c.skipHidden&&n["!cols"]||[],Z=c.skipHidden&&n["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(B[y]||{}).hidden)switch(h[y]=Fn(y),t=g?n[w][y]:n[h[y]+f],r){case 1:o[y]=y-l.s.c;break;case 2:o[y]=h[y];break;case 3:o[y]=c.header[y-l.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),a=s=Ui(t,null,c),p=S[s]||0,!p)S[s]=1;else{do a=s+"_"+p++;while(S[a]);S[s]=p,S[a]=1}o[y]=a}for(w=l.s.r+i;w<=l.e.r;++w)if(!(Z[w]||{}).hidden){var ce=FV(n,l,w,h,r,o,g,c);(ce.isempty===!1||(r===1?c.blankrows!==!1:c.blankrows))&&(d[m++]=ce.row)}return d.length=m,d}var pC=/"/g;function kV(n,e,t,r,i,o,s,a){for(var l=!0,c=[],u="",f=yn(t),h=e.s.c;h<=e.e.c;++h)if(r[h]){var d=a.dense?(n[t]||[])[h]:n[r[h]+f];if(d==null)u="";else if(d.v!=null){l=!1,u=""+(a.rawNumbers&&d.t=="n"?d.v:Ui(d,null,a));for(var m=0,p=0;m!==u.length;++m)if((p=u.charCodeAt(m))===i||p===o||p===34||a.forceQuotes){u='"'+u.replace(pC,'""')+'"';break}u=="ID"&&(u='"ID"')}else d.f!=null&&!d.F?(l=!1,u="="+d.f,u.indexOf(",")>=0&&(u='"'+u.replace(pC,'""')+'"')):u="";c.push(u)}return a.blankrows===!1&&l?null:c.join(s)}function Yv(n,e){var t=[],r=e??{};if(n==null||n["!ref"]==null)return"";var i=wt(n["!ref"]),o=r.FS!==void 0?r.FS:",",s=o.charCodeAt(0),a=r.RS!==void 0?r.RS:`
`,l=a.charCodeAt(0),c=new RegExp((o=="|"?"\\|":o)+"+$"),u="",f=[];r.dense=Array.isArray(n);for(var h=r.skipHidden&&n["!cols"]||[],d=r.skipHidden&&n["!rows"]||[],m=i.s.c;m<=i.e.c;++m)(h[m]||{}).hidden||(f[m]=Fn(m));for(var p=0,g=i.s.r;g<=i.e.r;++g)(d[g]||{}).hidden||(u=kV(n,i,g,f,s,l,o,r),u!=null&&(r.strip&&(u=u.replace(c,"")),(u||r.blankrows!==!1)&&t.push((p++?a:"")+u)));return delete r.dense,t.join("")}function jD(n,e){e||(e={}),e.FS="	",e.RS=`
`;var t=Yv(n,e);if(typeof yt>"u"||e.type=="string")return t;var r=yt.utils.encode(1200,t,"str");return"\xFF\xFE"+r}function NV(n){var e="",t,r="";if(n==null||n["!ref"]==null)return[];var i=wt(n["!ref"]),o="",s=[],a,l=[],c=Array.isArray(n);for(a=i.s.c;a<=i.e.c;++a)s[a]=Fn(a);for(var u=i.s.r;u<=i.e.r;++u)for(o=yn(u),a=i.s.c;a<=i.e.c;++a)if(e=s[a]+o,t=c?(n[u]||[])[a]:n[e],r="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;r=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)r=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)r=""+t.v;else if(t.t=="b")r=t.v?"TRUE":"FALSE";else if(t.w!==void 0)r="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?r="'"+t.v:r=""+t.v}}l[l.length]=e+"="+r}return l}function HD(n,e,t){var r=t||{},i=+!r.skipHeader,o=n||{},s=0,a=0;if(o&&r.origin!=null)if(typeof r.origin=="number")s=r.origin;else{var l=typeof r.origin=="string"?fn(r.origin):r.origin;s=l.r,a=l.c}var c,u={s:{c:0,r:0},e:{c:a,r:s+e.length-1+i}};if(o["!ref"]){var f=wt(o["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),s==-1&&(s=f.e.r+1,u.e.r=s+e.length-1+i)}else s==-1&&(s=0,u.e.r=e.length-1+i);var h=r.header||[],d=0;e.forEach(function(p,g){xn(p).forEach(function(w){(d=h.indexOf(w))==-1&&(h[d=h.length]=w);var y=p[w],S="z",B="",Z=ht({c:a+d,r:s+g+i});c=Cc(o,Z),y&&typeof y=="object"&&!(y instanceof Date)?o[Z]=y:(typeof y=="number"?S="n":typeof y=="boolean"?S="b":typeof y=="string"?S="s":y instanceof Date?(S="d",r.cellDates||(S="n",y=zn(y)),B=r.dateNF||Bt[14]):y===null&&r.nullError&&(S="e",y=0),c?(c.t=S,c.v=y,delete c.w,delete c.R,B&&(c.z=B)):o[Z]=c={t:S,v:y},B&&(c.z=B))})}),u.e.c=Math.max(u.e.c,a+h.length-1);var m=yn(s);if(i)for(d=0;d<h.length;++d)o[Fn(d+a)+m]={t:"s",v:h[d]};return o["!ref"]=qt(u),o}function MV(n,e){return HD(null,n,e)}function Cc(n,e,t){if(typeof e=="string"){if(Array.isArray(n)){var r=fn(e);return n[r.r]||(n[r.r]=[]),n[r.r][r.c]||(n[r.r][r.c]={t:"z"})}return n[e]||(n[e]={t:"z"})}return typeof e!="number"?Cc(n,ht(e)):Cc(n,ht({r:e,c:t||0}))}function OV(n,e){if(typeof e=="number"){if(e>=0&&n.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=n.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function RV(){return{SheetNames:[],Sheets:{}}}function PV(n,e,t,r){var i=1;if(!t)for(;i<=65535&&n.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&n.SheetNames.indexOf(t)>=0){var o=t.match(/(^.*?)(\d+)$/);i=o&&+o[2]||0;var s=o&&o[1]||t;for(++i;i<=65535&&n.SheetNames.indexOf(t=s+i)!=-1;++i);}if(FD(t),n.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return n.SheetNames.push(t),n.Sheets[t]=e,t}function LV(n,e,t){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var r=OV(n,e);switch(n.Workbook.Sheets[r]||(n.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}n.Workbook.Sheets[r].Hidden=t}function BV(n,e){return n.z=e,n}function GD(n,e,t){return e?(n.l={Target:e},t&&(n.l.Tooltip=t)):delete n.l,n}function VV(n,e,t){return GD(n,"#"+e,t)}function UV(n,e,t){n.c||(n.c=[]),n.c.push({t:e,a:t||"SheetJS"})}function jV(n,e,t,r){for(var i=typeof e!="string"?e:wt(e),o=typeof e=="string"?e:qt(e),s=i.s.r;s<=i.e.r;++s)for(var a=i.s.c;a<=i.e.c;++a){var l=Cc(n,s,a);l.t="n",l.F=o,delete l.v,s==i.s.r&&a==i.s.c&&(l.f=t,r&&(l.D=!0))}return n}var $D={encode_col:Fn,encode_row:yn,encode_cell:ht,encode_range:qt,decode_col:Bv,decode_row:Lv,split_cell:n3,decode_cell:fn,decode_range:dr,format_cell:Ui,sheet_add_aoa:HC,sheet_add_json:HD,sheet_add_dom:RD,aoa_to_sheet:ka,json_to_sheet:MV,table_to_sheet:PD,table_to_book:fV,sheet_to_csv:Yv,sheet_to_txt:jD,sheet_to_json:dh,sheet_to_html:OD,sheet_to_formulae:NV,sheet_to_row_object_array:dh,sheet_get_cell:Cc,book_new:RV,book_append_sheet:PV,book_set_sheet_visibility:LV,cell_set_number_format:BV,cell_set_hyperlink:GD,cell_set_internal_link:VV,cell_add_comment:UV,sheet_set_array_formula:jV,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var zre=_c.version;function GV(n,e){if(n&1&&(E(0,"span"),C(1),_()),n&2){let t=re();A(),rt("(",t.shelfForm.value.orderFlow=="CROSS_DOCK"?"Cross Dock":"KeepStock",")")}}var Th=class n{constructor(e,t){this.fb=e;this.toastr=t}shelfForm;ngOnInit(){let e=new Date;this.shelfForm=this.fb.group({productData:[]})}exportToExcel(e,t){let i={Sheets:{"Refill Plan":$D.json_to_sheet(e)},SheetNames:["Refill Plan"]};UD(i,`${t}.xlsx`)}onSubmit(){}clearData(){}static \u0275fac=function(t){return new(t||n)(ae(an),ae(Cr))};static \u0275cmp=nt({type:n,selectors:[["app-create-shelf"]],decls:26,vars:5,consts:[[3,"ngSubmit","formGroup"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"mb-0"],[4,"ngIf"],[1,"mt-3"],["formControlName","productData",1,"form-control","textarea-flex"],[1,"mt-4"],["type","button",1,"btn","btn-primary","me-2",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"mt-5"]],template:function(t,r){if(t&1&&(E(0,"form",0),Ce("ngSubmit",function(){return r.onSubmit()}),E(1,"div",1)(2,"h1",2),C(3," Generate Payload Dispatch Order "),be(4,GV,2,1,"span",3),_()(),E(5,"p")(6,"b"),C(7,"Step1:"),_(),C(8," Go to mongodb collection "),E(9,"b"),C(10,"order.delivery_orders"),_(),C(11," then right click at your document and select copy > "),E(12,"b"),C(13,"Copy Value as Plain Text"),_()(),E(14,"p")(15,"b"),C(16,"Step2:"),_(),C(17," Paste your Delivery Order here"),_(),E(18,"div",4),J(19,"textarea",5),_(),E(20,"div",6)(21,"button",7),Ce("click",function(){return r.onSubmit()}),C(22),_(),E(23,"button",8),Ce("click",function(){return r.clearData()}),C(24,"Clear"),_()(),J(25,"hr",9),_()),t&2){let i,o;H("formGroup",r.shelfForm),A(4),H("ngIf",r.shelfForm.value.orderFlow),A(15),Ie("is-invalid",((i=r.shelfForm.get("productData"))==null?null:i.invalid)&&((i=r.shelfForm.get("productData"))==null?null:i.touched)),A(3),rt(" ",((o=r.shelfForm.get("orderFlow"))==null?null:o.value)=="KEEP_STOCK"?"Generate Payload":"Export CSV")}},dependencies:[mt,Pt,Wt,An,Gt,on,sn,$t,en],encapsulation:2})};function $V(n,e){if(n&1&&(E(0,"div",1)(1,"label",2),C(2,"Schedule Time:"),_(),J(3,"input",16),E(4,"small",17),C(5,"EX. 09:00,09:30 (\u0E44\u0E14\u0E49\u0E2B\u0E25\u0E32\u0E22\u0E23\u0E2D\u0E1A \u0E44\u0E21\u0E48\u0E15\u0E49\u0E2D\u0E07\u0E43\u0E2A\u0E48\u0E40\u0E27\u0E49\u0E19\u0E27\u0E23\u0E23\u0E04)"),_()()),n&2){let t,r=re();A(3),Ie("is-invalid",((t=r.refillForm.get("scheduleTime"))==null?null:t.invalid)&&((t=r.refillForm.get("scheduleTime"))==null?null:t.touched))}}function WV(n,e){if(n&1&&(E(0,"div")(1,"div",18)(2,"label",19),C(3,"Input Separator:"),_(),E(4,"label"),J(5,"input",20),C(6," New Line "),_(),E(7,"label"),J(8,"input",21),C(9," Comma "),_()(),E(10,"div",22)(11,"label"),C(12,"Enter Shlef Code:"),_(),J(13,"textarea",23),_()()),n&2){let t,r=re();A(13),Ie("is-invalid",((t=r.refillForm.get("shelfCode"))==null?null:t.invalid)&&((t=r.refillForm.get("shelfCode"))==null?null:t.touched))}}function zV(n,e){if(n&1&&(E(0,"pre",24),C(1),_()),n&2){let t=re();A(),Je(t.sqlStatement)}}var wh=class n{constructor(e,t){this.fb=e;this.toastr=t;this.refillForm=this.fb.group({inputSeparator:["NEW_LINE"],shelfCode:["",Se.required],storeCode:["",Se.required],scheduleTime:[""],refillType:["NORMAL",Se.required],scheduleTimeType:["ALL_DAY",Se.required]})}refillForm;sqlStatement="";refillTypes=[{id:"NORMAL",name:"Normal"},{id:"SPECIAL",name:"Special"}];scheduleTimeTypes=[{id:"ALL_DAY",name:"09:00 - 18:00",value:["09:00","09:30","10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30","17:00","17:30","18:00"]},{id:"MORNING",name:"09:00 - 12:30",value:["09:00","09:30","10:00","10:30","11:00","11:30","12:00","12:30"]},{id:"AFTERNOON",name:"13:00 - 18:00",value:["13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30","17:00","17:30","18:00"]},{id:"NIGHT",name:"18:30 - 23:30",value:["18:30","19:00","19:30","20:00","20:30","21:00","21:30","22:00","22:30","23:00","23:30"]},{id:"CUSTOM",name:"Custom"}];ngOnInit(){this.refillForm.get("refillType")?.valueChanges.subscribe(e=>{let t=this.refillForm.get("shelfCode");e==="NORMAL"?t?.setValidators([Se.required]):t?.clearValidators(),t?.updateValueAndValidity()}),this.refillForm.get("scheduleTimeType")?.valueChanges.subscribe(e=>{let t=this.refillForm.get("scheduleTime");e==="CUSTOM"?t?.setValidators([Se.required]):t?.clearValidators(),t?.updateValueAndValidity()})}createScriptRefillRecommendation(){if(this.refillForm.invalid||this.refillForm.invalid){this.refillForm.markAllAsTouched(),this.toastr.error("\u0E01\u0E23\u0E38\u0E13\u0E32\u0E01\u0E23\u0E2D\u0E01\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25","\u0E41\u0E08\u0E49\u0E07\u0E40\u0E15\u0E37\u0E2D\u0E19");return}let{inputSeparator:e,shelfCode:t,storeCode:r,scheduleTime:i,refillType:o,scheduleTimeType:s}=this.refillForm.value,a=t.replace(/["'\t ]+/g,""),l=e==="NEW_LINE"?a.split(`
`).filter(d=>d.trim()!==""):a.split(",").map(d=>d.trim()),c=s!="CUSTOM"?this.scheduleTimeTypes.find(d=>d.id===s)?.value:i.split(",").map(d=>d.trim()),u=this.getTodayDayName(),f=[];for(let d=0;d<c.length;d++){if(!this.isValidTimeFormat(c[d])){this.toastr.error(`\u0E23\u0E39\u0E1B\u0E41\u0E1A\u0E1A\u0E40\u0E27\u0E25\u0E32\u0E44\u0E21\u0E48\u0E16\u0E39\u0E01\u0E15\u0E49\u0E2D\u0E07 ${c[d]}`,"\u0E41\u0E08\u0E49\u0E07\u0E40\u0E15\u0E37\u0E2D\u0E19");return}if(o=="NORMAL")for(let m=0;m<l.length;m++)f.push({day:u,code:r,time:c[d],deadline:"23:30",shelfCode:l[m],refillType:o});else f.push({day:u,code:r,time:c[d],deadline:"23:30",shelfCode:"",refillType:o})}let h=this.generateShortId(8);this.sqlStatement=this.generateInsertSQL(h,f,r)}generateInsertSQL(e,t,r){let i=JSON.stringify(t).replace(/'/g,"''");return`
      INSERT INTO pos_mgr.outbox_events
      (aggregate_type, aggregate_id, "type", payload, doc_no, date_time)
      VALUES(
        'pos_mgr',
        '${e}-${r}',
        'refillRecommendationCalculate',
        '${i}'::jsonb,
        NULL,
        CURRENT_TIMESTAMP
      );`.trim()}clearFormatter(){this.refillForm.reset({inputSeparator:"NEW_LINE",shelfCode:"",storeCode:"",scheduleTime:"",refillType:"NORMAL",scheduleTimeType:"ALL_DAY"}),this.sqlStatement=""}generateShortId(e=8){return Math.random().toString(16).slice(2,2+e)}getTodayDayName(){return["SUN","MON","TUE","WED","THU","FRI","SAT"][new Date().getDay()]}isValidTimeFormat(e){return/^([01]\d|2[0-3]):[0-5]\d$/.test(e)}static \u0275fac=function(t){return new(t||n)(ae(an),ae(Cr))};static \u0275cmp=nt({type:n,selectors:[["app-create-refill-recommmendation"]],decls:27,vars:13,consts:[[3,"formGroup"],[1,"form-group"],["for","storeCode"],["type","text","id","storeCode","formControlName","storeCode","placeholder","Enter store code"],[1,"form-group","mb-3","mt-3"],["for","refillType"],["bindLabel","name","bindValue","id","placeholder","Select mode","formControlName","scheduleTimeType",1,"custom-ng-select",3,"items"],["class","form-group",4,"ngIf"],["bindLabel","name","bindValue","id","placeholder","Select mode","formControlName","refillType",1,"custom-ng-select",3,"items"],[4,"ngIf"],[1,"mt-2"],["type","button",1,"btn","btn-primary",2,"margin-right","10px",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[2,"margin-top","30px"],[3,"textToCopy"],["class","payload-content",4,"ngIf"],["type","text","id","scheduleTime","formControlName","scheduleTime","placeholder","Enter schedule time"],[1,"mx-2"],[1,"radio-group"],[2,"margin-right","13px"],["type","radio","formControlName","inputSeparator","value","NEW_LINE"],["type","radio","formControlName","inputSeparator","value","COMMA"],[1,"textarea-content",2,"margin-top","20px"],["formControlName","shelfCode",2,"margin-top","10px"],[1,"payload-content"]],template:function(t,r){if(t&1&&(E(0,"form",0)(1,"h1"),C(2,"Create Refill Recommendation"),_(),E(3,"div",1)(4,"label",2),C(5,"Store Code:"),_(),J(6,"input",3),_(),E(7,"div",4)(8,"label",5),C(9,"Schedule Time Type :"),_(),J(10,"ng-select",6),_(),be(11,$V,6,2,"div",7),E(12,"div",4)(13,"label",5),C(14,"Refill Type :"),_(),J(15,"ng-select",8),_(),be(16,WV,14,2,"div",9),E(17,"div",10)(18,"button",11),Ce("click",function(){return r.createScriptRefillRecommendation()}),C(19,"Processing"),_(),E(20,"button",12),Ce("click",function(){return r.clearFormatter()}),C(21,"Clear"),_()(),J(22,"hr",13),E(23,"h2"),C(24,"Script Create Refill Recommendation: "),J(25,"app-copy-button",14),_(),be(26,zV,2,1,"pre",15),_()),t&2){let i,o,s;H("formGroup",r.refillForm),A(6),Ie("is-invalid",((i=r.refillForm.get("storeCode"))==null?null:i.invalid)&&((i=r.refillForm.get("storeCode"))==null?null:i.touched)),A(4),Ie("is-invalid",((o=r.refillForm.get("scheduleTimeType"))==null?null:o.invalid)&&((o=r.refillForm.get("scheduleTimeType"))==null?null:o.touched)),H("items",r.scheduleTimeTypes),A(),H("ngIf",r.refillForm.value.scheduleTimeType=="CUSTOM"),A(4),Ie("is-invalid",((s=r.refillForm.get("refillType"))==null?null:s.invalid)&&((s=r.refillForm.get("refillType"))==null?null:s.touched)),H("items",r.refillTypes),A(),H("ngIf",r.refillForm.value.refillType=="NORMAL"),A(9),H("textToCopy",r.sqlStatement),A(),H("ngIf",r.sqlStatement)}},dependencies:[mt,Pt,Wt,An,Gt,lr,on,sn,$t,en,ln,po],encapsulation:2})};function qV(n,e){if(n&1&&(E(0,"span"),C(1),_()),n&2){let t=re();A(),rt("(",t.dispatchForm.value.orderFlow=="CROSS_DOCK"?"Cross Dock":"KeepStock",")")}}function KV(n,e){if(n&1){let t=_t();E(0,"button",35),Ce("click",function(){qe(t);let i=re().index,o=re();return Ke(o.removeDeliveryOrder(i))}),C(1,"\u2013"),_()}}function YV(n,e){if(n&1){let t=_t();E(0,"div",32)(1,"textarea",33),Ce("input",function(){let i=qe(t).index,o=re();return Ke(o.onChangedInputDelivery(i))}),_(),be(2,KV,2,0,"button",34),_()}if(n&2){let t,r=e.$implicit,i=e.index,o=re();H("formGroupName",i),A(),Ie("is-invalid",((t=r.get("value"))==null?null:t.invalid)&&((t=r.get("value"))==null?null:t.touched)),A(),H("ngIf",o.deliveryOrders.length>1)}}function XV(n,e){n&1&&(E(0,"div",36)(1,"label"),C(2,"Price Date Source:"),_(),E(3,"label"),J(4,"input",37),C(5," Manual "),_(),E(6,"label"),J(7,"input",38),C(8," Query Database "),_()())}function ZV(n,e){if(n&1&&(E(0,"div",39)(1,"p")(2,"b"),C(3,"Step3:"),_(),C(4," Copy the Mongo query below to retrieve the price date in collection "),E(5,"b"),C(6,"stock.external_prices"),_(),C(7," > "),E(8,"b"),C(9,"Copy Value as Plain Text"),_()(),J(10,"app-code-box",40),E(11,"p",39)(12,"b"),C(13,"Step4:"),_(),C(14," Paste your result of external prices here"),_(),J(15,"textarea",41),_()),n&2){let t,r=re();A(10),H("codeText",r.queryExternalPriceString),A(5),Ie("is-invalid",((t=r.dispatchForm.get("externalPrice"))==null?null:t.invalid)&&((t=r.dispatchForm.get("externalPrice"))==null?null:t.touched))}}function QV(n,e){if(n&1&&(E(0,"div")(1,"div",15)(2,"label",42),C(3,"ToteId:"),_(),J(4,"input",43),E(5,"small",44),C(6,"\u0E40\u0E0A\u0E48\u0E19 TB990001"),_()()()),n&2){let t,r=re();A(4),Ie("is-invalid",((t=r.dispatchForm.get("toteId"))==null?null:t.invalid)&&((t=r.dispatchForm.get("toteId"))==null?null:t.touched))}}function JV(n,e){if(n&1&&(E(0,"div",15)(1,"label",51),C(2,"Prefix Tote Code:"),_(),J(3,"input",52),E(4,"small",48),C(5,"\u0E40\u0E0A\u0E48\u0E19 TDS,TLS,TMS,TSS"),_()()),n&2){let t,r=re(2);A(3),Ie("is-invalid",((t=r.dispatchForm.get("specifyToteCode"))==null?null:t.invalid)&&((t=r.dispatchForm.get("specifyToteCode"))==null?null:t.touched))}}function e7(n,e){if(n&1&&(E(0,"div"),J(1,"h3"),be(2,JV,6,2,"div",45),E(3,"div",15)(4,"label",46),C(5,"Subfix Tote Code:"),_(),J(6,"input",47),E(7,"small",48),C(8,"\u0E40\u0E25\u0E02\u0E01\u0E48\u0E2D\u0E19 running number \u0E08\u0E30\u0E43\u0E2A\u0E48\u0E2B\u0E23\u0E37\u0E2D\u0E44\u0E21\u0E48\u0E43\u0E2A\u0E48\u0E01\u0E47\u0E44\u0E14\u0E49 \u0E40\u0E0A\u0E48\u0E19 9999 -> TB9999xxxx (xxxx \u0E04\u0E37\u0E2D running number)"),_()(),E(9,"div",15)(10,"label",49),C(11,"Start Running Number:"),_(),J(12,"input",50),E(13,"small",48),C(14,"\u0E40\u0E0A\u0E48\u0E19 1 \u0E08\u0E30\u0E44\u0E14\u0E49 0001 , 0002 ... n \u0E08\u0E30 generate tote Id \u0E15\u0E31\u0E49\u0E07\u0E41\u0E15\u0E48 1 - n (\u0E15\u0E32\u0E21\u0E08\u0E33\u0E19\u0E27\u0E19 items \u0E43\u0E19 do)"),_()()()),n&2){let t,r,i=re();A(2),H("ngIf",i.dispatchForm.value.mode==="SPECIFY_TOTE"),A(4),Ie("is-invalid",((t=i.dispatchForm.get("subfixToteCode"))==null?null:t.invalid)&&((t=i.dispatchForm.get("subfixToteCode"))==null?null:t.touched)),A(6),Ie("is-invalid",((r=i.dispatchForm.get("startRunningNumber"))==null?null:r.invalid)&&((r=i.dispatchForm.get("startRunningNumber"))==null?null:r.touched))}}function t7(n,e){if(n&1){let t=_t();E(0,"button",62),Ce("click",function(){qe(t);let i=re(2);return Ke(i.onPreviewToteDetail())}),C(1,"Re-Generate"),_()}}function n7(n,e){n&1&&(E(0,"th",58),C(1,"Price Date"),_())}function r7(n,e){if(n&1&&(E(0,"td",58),J(1,"input",70),_()),n&2){let t,r=re().$implicit;A(),Ie("is-invalid",((t=r.get("priceDate"))==null?null:t.invalid)&&((t=r.get("priceDate"))==null?null:t.touched))}}function i7(n,e){if(n&1){let t=_t();E(0,"div",79)(1,"button",80),Ce("click",function(){qe(t);let i=re().index,o=re().index,s=re(2);return Ke(s.removeDetail(o,i))}),C(2,"\u2013"),_()()}}function o7(n,e){if(n&1&&(E(0,"tr",71)(1,"td",68)(2,"div",72)(3,"div",73),J(4,"input",74),_(),E(5,"div",75),J(6,"input",76)(7,"app-copy-button",77),_(),be(8,i7,3,0,"div",78),_()()()),n&2){let t,r,i,o=e.$implicit,s=e.index,a=re().index,l=re(2);H("formGroupName",s),A(4),Ie("is-invalid",((t=o.get("pickQty"))==null?null:t.invalid)&&((t=o.get("pickQty"))==null?null:t.touched)),A(2),Ie("is-invalid",((r=o.get("toteId"))==null?null:r.invalid)&&((r=o.get("toteId"))==null?null:r.touched)),A(),H("textToCopy",(i=o.get("toteId"))==null?null:i.value)("showIconOnly",!0),A(),H("ngIf",l.getDetails(a).length>1)}}function s7(n,e){if(n&1){let t=_t();E(0,"tr",63)(1,"td"),C(2),_(),E(3,"td"),C(4),_(),E(5,"td",64),C(6),J(7,"app-copy-button",65),_(),E(8,"td",58)(9,"strong"),C(10),_(),C(11),_(),E(12,"td",58),C(13),_(),be(14,r7,2,2,"td",59),E(15,"td")(16,"table",66),be(17,o7,9,8,"tr",67),E(18,"tr")(19,"td",68)(20,"button",69),Ce("click",function(){let i=qe(t).index,o=re(2);return Ke(o.addDetail(i))}),C(21," + Split Tote "),_()()()()()()}if(n&2){let t,r,i,o,s,a,l,c=e.$implicit,u=e.index,f=re(2);H("formGroupName",u),A(2),Je((t=c.get("doNo"))==null?null:t.value),A(2),Je((r=c.get("productName"))==null?null:r.value),A(2),rt(" ",(i=c.get("barcode"))==null?null:i.value," "),A(),H("textToCopy",(o=c.get("barcode"))==null?null:o.value)("showIconOnly",!0),A(3),Je((s=c.get("assignedQty"))==null?null:s.value),A(),rt(" (",((a=c.get("assignedQty"))==null?null:a.value)*((a=c.get("unitFactor"))==null?null:a.value)," PC) "),A(2),Je((l=c.get("unit"))==null?null:l.value),A(),H("ngIf",f.dispatchForm.value.orderFlow=="CROSS_DOCK"),A(3),H("ngForOf",f.getDetails(u).controls)}}function a7(n,e){if(n&1&&(E(0,"div")(1,"div",53)(2,"h3",54),C(3,"Tote Details"),_(),be(4,t7,2,0,"button",55),_(),E(5,"form",56)(6,"table",57)(7,"thead")(8,"tr")(9,"th",58),C(10,"Delivery Order No."),_(),E(11,"th",58),C(12,"Product Name"),_(),E(13,"th",58),C(14,"Barcode"),_(),E(15,"th",58),C(16,"Assigned Qty"),_(),E(17,"th",58),C(18,"Unit"),_(),be(19,n7,2,0,"th",59),E(20,"th",58),C(21,"Pick Details"),_()()(),E(22,"tbody",60),be(23,s7,22,11,"tr",61),_()()()()),n&2){let t=re();A(4),H("ngIf",t.dispatchForm.value.mode==="RANDOM_TOTE"||t.dispatchForm.value.mode==="SPECIFY_TOTE"),A(),H("formGroup",t.toteForm),A(14),H("ngIf",t.dispatchForm.value.orderFlow=="CROSS_DOCK"),A(4),H("ngForOf",t.items.controls)}}function l7(n,e){if(n&1&&(E(0,"div")(1,"h3"),C(2,"Payload Confirm Tote Output:"),_(),J(3,"app-code-box",40),_()),n&2){let t=re();A(3),H("codeText",t.confirmToteData)}}function c7(n,e){if(n&1&&(E(0,"div",39)(1,"h3"),C(2,"Payload Confirm Shipment Output:"),_(),J(3,"app-code-box",40),_()),n&2){let t=re();A(3),H("codeText",t.confirmShipmentData)}}function u7(n,e){if(n&1&&(E(0,"tr")(1,"td"),C(2),_(),E(3,"td"),C(4),_()()),n&2){let t=e.$implicit;A(2),Je(t.code),A(2),Je(t.nameTh)}}var Ch=class n{constructor(e,t){this.fb=e;this.toastr=t}dispatchForm;toteForm;dateUtils=new pa;toteIdList=[];modal;confirmToteData;confirmShipmentData;barcodList=[];priceDateList=[];queryExternalPriceString="";modes=[{id:"CUSTOM_TOTE",name:"Custom Tote"},{id:"RANDOM_TOTE",name:"Random Tote"},{id:"SINGLE_TOTE",name:"Single Tote"},{id:"SPECIFY_TOTE",name:"Specify Tote"}];orderFlows=[{id:"KEEP_STOCK",name:"Keep Stock"},{id:"CROSS_DOCK",name:"Cross Dock"}];prefixToteList=[{code:"TLG",nameTh:"\u0E25\u0E31\u0E07\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E02\u0E35\u0E22\u0E27",toteGroup:"TG"},{code:"TB",nameTh:"\u0E15\u0E30\u0E01\u0E23\u0E49\u0E32\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E19\u0E49\u0E33\u0E40\u0E07\u0E34\u0E19",toteGroup:"TB"},{code:"TX",nameTh:"\u0E25\u0E31\u0E07\u0E01\u0E23\u0E30\u0E14\u0E32\u0E29\u0E04\u0E32\u0E14\u0E2A\u0E35",toteGroup:"TX"},{code:"TS",nameTh:"\u0E25\u0E31\u0E07\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E17\u0E32",toteGroup:"TS"},{code:"TG",nameTh:"\u0E25\u0E31\u0E07\u0E1E\u0E25\u0E32\u0E2A\u0E15\u0E34\u0E01\u0E2A\u0E35\u0E40\u0E02\u0E35\u0E22\u0E27",toteGroup:"TG"}];ngOnInit(){this.prefixToteList=this.prefixToteList.slice().sort((t,r)=>+t.toteGroup-+r.toteGroup);let e=new Date;this.dispatchForm=this.fb.group({deliveryOrders:this.fb.array([this.fb.group({value:["",Se.required]})]),mode:[null,Se.required],orderFlow:[null,Se.required],subfixToteCode:[""],startRunningNumber:[""],specifyToteCode:[""],toteId:[""],platNo:["Truck@Galaxy",Se.required],driverName:["Dominic Toretto",Se.required],externalPrice:[null],priceDateSource:["MANUAL"]}),this.toteForm=this.fb.group({items:this.fb.array([])}),this.dispatchForm.get("mode")?.valueChanges.subscribe(t=>{let r=this.dispatchForm.get("toteId"),i=this.dispatchForm.get("subfixToteCode"),o=this.dispatchForm.get("startRunningNumber"),s=this.dispatchForm.get("specifyToteCode");t==="SINGLE_TOTE"?(r?.setValidators([Se.required]),i?.clearValidators(),o?.clearValidators()):t==="RANDOM_TOTE"?(i?.setValidators([Se.required]),o?.setValidators([Se.required,Se.min(1)]),r?.clearValidators()):t==="SPECIFY_TOTE"?(s?.setValidators([Se.required]),i?.setValidators([Se.required]),o?.setValidators([Se.required,Se.min(1)]),r?.clearValidators()):(s?.clearValidators(),r?.clearValidators(),i?.clearValidators(),o?.clearValidators()),s?.updateValueAndValidity(),r?.updateValueAndValidity(),i?.updateValueAndValidity(),o?.updateValueAndValidity()}),this.dispatchForm.get("orderFlow")?.valueChanges.subscribe(t=>{this.setAndClearValidateExternalPrice(),this.onPreviewToteDetail()}),ol([this.dispatchForm.get("subfixToteCode").valueChanges,this.dispatchForm.get("startRunningNumber").valueChanges]).subscribe(([t,r])=>{t&&r&&this.onPreviewToteDetail()}),this.dispatchForm.get("toteId")?.valueChanges.subscribe(t=>{this.onPreviewToteDetail()}),this.dispatchForm.get("externalPrice")?.valueChanges.subscribe(t=>{this.onPreviewToteDetail()}),this.dispatchForm.get("priceDateSource")?.valueChanges.subscribe(t=>{this.setAndClearValidateExternalPrice(),this.generateExternalPriceQuery(),this.onPreviewToteDetail()})}ngAfterViewInit(){let e=document.getElementById("totePreviewTDModal");e&&(this.modal=new bootstrap.Modal(e))}get deliveryOrders(){return this.dispatchForm.get("deliveryOrders")}get items(){return this.toteForm.get("items")}openModal(){this.modal?.show()}addDeliveryOrder(){this.deliveryOrders.push(this.fb.group({value:["",Se.required]}))}setAndClearValidateExternalPrice(){let e=this.dispatchForm.get("externalPrice"),t=this.dispatchForm.get("orderFlow")?.value,r=this.dispatchForm.get("priceDateSource")?.value;t==="CROSS_DOCK"&&r==="QUERY"?e?.setValidators([Se.required]):(e?.clearValidators(),e?.updateValueAndValidity())}removeDeliveryOrder(e){this.deliveryOrders.removeAt(e),this.onPreviewToteDetail()}getInputDeliveryOrderList(){return this.dispatchForm.get("deliveryOrders").controls.map(e=>{let t=e.get("value")?.value??"";try{return JSON.parse(t)}catch{return console.error("Invalid JSON:",t),null}}).filter(e=>e!==null)}onChangedInputDelivery(e){this.generateExternalPriceQuery(),this.onPreviewToteDetail()}onChangedOrderFlow(){this.deliveryOrders.clear(),this.deliveryOrders.push(this.fb.group({value:["",Se.required]}))}generateExternalPriceQuery(){this.queryExternalPriceString="";let e=this.dispatchForm.get("orderFlow")?.value,t=this.dispatchForm.get("priceDateSource")?.value;if(e=="CROSS_DOCK"&&t=="QUERY"&&this.dispatchForm.get("deliveryOrders")?.value.length>0){let r=[];this.getInputDeliveryOrderList().forEach(s=>{s.items.length>0&&s.items.forEach(a=>{r.push(a.barcode)})});let o=r.map(s=>`"${s}"`).join(", ");this.queryExternalPriceString=`db.external_prices.aggregate([{"$match":{"barcode":{"$in":[${o}]}}},{"$sort":{"createdDate":-1}},{"$group":{"_id":"$barcode","latest":{"$first":"$$ROOT"}}},{"$replaceRoot":{"newRoot":"$latest"}},{"$project":{"_id":0,"articleNo":1,"barcode":1,"createdDate":1}}])`}}createItem(e,t,r,i,o,s,a,l,c,u,f,h,d,m){let p=new Date;return this.fb.group({productName:[e],articleNo:[t],barcode:[r],assignedQty:[i],unit:[o],unitFactor:[a],doNo:[l],deliveryDate:[c],pickDate:[u],poNo:[f],shipmentNo:[h],orderType:[d],priceDate:[m,Se.required],details:this.fb.array([this.createDetail(i,s)])})}createDetail(e,t){return this.fb.group({pickQty:[e,Se.required],toteId:[t,Se.required]})}get f(){return this.dispatchForm.controls}onChangedMode(){this.items.clear(),this.onPreviewToteDetail()}onPreviewToteDetail(){let e=this.dispatchForm.get("mode")?.value??"",t=this.dispatchForm.get("orderFlow")?.value??"",r=this.dispatchForm.get("priceDateSource")?.value??"",i=this.getInputDeliveryOrderList(),o=this.getTotalSizeFromDeliveryOrders();this.items.clear();let s=this.dispatchForm.get("specifyToteCode")?.value,a=this.dispatchForm.get("subfixToteCode")?.value,l=this.dispatchForm.get("startRunningNumber")?.value,c=this.dispatchForm.get("toteId")?.value;o==0||e=="SPECIFY_TOTE"&&(!a||!l||!s)||e=="RANDOM_TOTE"&&(!a||!l)||e=="SIGNLE_TOTE"&&!c||i.forEach(u=>{if(u&&Array.isArray(u.items)){if(t=="KEEP_STOCK"&&u.orderFlow!="KEEP_STOCK"||t=="CROSS_DOCK"&&u.orderFlow!="CROSS_DOCK"){this.toastr.error("Invalid delivery order structure: mismatched order flow type","\u0E41\u0E08\u0E49\u0E07\u0E40\u0E15\u0E37\u0E2D\u0E19");return}let f=u.items,h=u.doNo,d=this.dateUtils.generateDateTimeTDSC(new Date(u.po.cutOffDeliveryDate)),m=this.dateUtils.generateDateTimeTDSC(new Date(u.po.pickDate)),p=t=="KEEP_STOCK";if(e=="RANDOM_TOTE"?this.generateToteIdList(o):e=="SPECIFY_TOTE"&&this.generateSpecifyToteIdList(o),f&&Array.isArray(f)){let g=p||r=="MANUAL"?{}:this.getBarcodeCreatedDateMap(),w=new Date().toISOString().slice(0,10);f.forEach((y,S)=>{let B=e=="RANDOM_TOTE"||e=="SPECIFY_TOTE"?this.toteIdList[S]:e=="SINGLE_TOTE"?this.dispatchForm.get("toteId")?.value:"";this.items.push(this.createItem(y.productName??"",y.articleNo??"",y.barcode??"",p?y.qty:y.assignedQty,p?y.unit:y.crossDock?.unit,B,y.unitFactor??0,h,d,m,p?u.po.poNo:"",p?u.shipment.shipmentNo:"",p?u.po.orderType:"",p||r=="MANUAL"?w:g.get(y.barcode)??""))})}}else console.warn("Invalid delivery order or items missing")})}getBarcodeCreatedDateMap(){let e=this.dispatchForm.get("priceDateSource")?.value,t=JSON.parse(this.dispatchForm.get("externalPrice")?.value);return e=="MANUAL"?{}:(t&&!Array.isArray(t)&&(t=[t]),t?new Map((t??[]).map(r=>{let i=new Date(r.createdDate).toISOString().slice(0,10);return[r.barcode,i]})):(console.warn("externalPrices is null or undefined"),new Map))}getDetails(e){return this.items.at(e).get("details")}addDetail(e){this.getDetails(e).push(this.createDetail())}removeDetail(e,t){let r=this.getDetails(e);r.length>1?r.removeAt(t):this.toastr.warning("\u0E15\u0E49\u0E2D\u0E07\u0E21\u0E35 Pick Detail \u0E2D\u0E22\u0E48\u0E32\u0E07\u0E19\u0E49\u0E2D\u0E22 1 \u0E23\u0E32\u0E22\u0E01\u0E32\u0E23","\u0E41\u0E08\u0E49\u0E07\u0E40\u0E15\u0E37\u0E2D\u0E19")}validateForm(){return this.dispatchForm.invalid||this.toteForm.invalid?(this.dispatchForm.markAllAsTouched(),this.dispatchForm.get("mode")?.value=="CUSTOM_TOTE"&&this.toteForm.markAllAsTouched(),this.toastr.error("Invalid form","\u0E41\u0E08\u0E49\u0E07\u0E40\u0E15\u0E37\u0E2D\u0E19"),!0):!1}onSubmit(){if(this.validateForm())return;let e=this.dispatchForm.value,t=e.orderFlow,r=e.platNo,i=e.driverName;if(this.getTotalSizeFromDeliveryOrders()==0){this.toastr.error("Invalid deliveryOrder structure: missing items array","\u0E41\u0E08\u0E49\u0E07\u0E40\u0E15\u0E37\u0E2D\u0E19");return}t=="CROSS_DOCK"?this.generateDispatchCrossDock(i,r):this.generateDispatcKeepStock()}mapRowCsv(e,t,r,i,o,s,a,l,c,u,f,h,d){return["01",e,t,r,Number(i??0).toFixed(2),o??"",s,a,l,"","",c,u,"",`LD${this.dateUtils.generateCompactDateTime(new Date)}`,f===null||f===""?"YYYY-MM-DD":f,h,d,d,`LTEST-${t.split("-").slice(1).join("-")}`]}getTotalSizeFromDeliveryOrders(){let e=0,t=this.getInputDeliveryOrderList();for(let r=0;r<t.length;r++)e+=t[r].items.length;return e}buildCSVData(e,t){let r=[],i=this.items.value,o=i.length,a=this.dispatchForm.value.mode,l=this.getInputDeliveryOrderList(),u=new Date().toISOString().split("T")[0],f=new Date(new Date().setFullYear(new Date().getFullYear()+1)).toISOString().split("T")[0],h=l[0]?.po?.storeCode,m=`SO-${l[0]?.doNo}`;if(o>0)for(let p=0;p<o;p++){let g=i[p];if(g.details)for(let w=0;w<g.details.length;w++){let y=g.details[w];r.push(this.mapRowCsv(m,g.doNo,g.barcode,y.pickQty,g.unit,y.toteId,g.deliveryDate,g.pickDate,e,t,g.priceDate,f,u))}}return r}generateDispatchCrossDock(e,t){let r=["01","shipmentNo","doNo","barcode","pickedQty","uom","toteId","deliverydate","pickupdate","couriercode","couriername","drivername","truckId","plateno","loadingNo","priceDate","expDate","mfgDate","recDate","lotNo"],i=[];i.push(...this.buildCSVData(e,t));let s=[r,...i].map(h=>{for(;h.length>1&&h[h.length-1]==="";)h.pop();return h.join("|")}).join(`
`),a="\uFEFF",l=this.getInputDeliveryOrderList()[0],c=new Blob([a+s],{type:"text/csv;charset=utf-8;"}),u=URL.createObjectURL(c),f=document.createElement("a");f.href=u,f.download=`shipment_${l.po.storeCode}_${this.dateUtils.generateCompactDateTime(new Date)}.csv`,f.click()}generateDispatcKeepStock(){let e=[],t=[],r=[],i=[],o=this.getInputDeliveryOrderList(),s=this.dispatchForm.value,a=s.platNo,l=s.driverName,c=new Date,u=s.mode,f=this.dateUtils.generateDateTime(c),h=this.items.value,d=this.getTotalSizeFromDeliveryOrders();if(u=="CUSTOM_TOTE"||h.length>0)h.forEach((m,p)=>{if(m.details){for(let y=0;y<m.details.length;y++){let S=m.details[y];t.push(this.createConfirmToteDetail(m.doNo,m.articleNo,S.toteId,S.pickQty,m.unitFactor)),e.push(this.createConfirmShipmentDetail(m.doNo,p+1,m.articleNo,S.pickQty,m.unitFactor,this.dateUtils.generateDate(c)))}let g=r.some(y=>y.docNo===m.doNo),w=r.some(y=>y.docNo===m.doNo);g||r.push(this.buildConfirmShipmentData(m.orderType,m.doNo,m.poNo,m.shipmentNo,f,a,l,e)),w||i.push(this.buildConfirmToteData(m.orderType,m.doNo,m.poNo,m.shipmentNo,t))}});else if(u=="RANDOM_TOTE"||u=="SPECIFY_TOTE")u=="RANDOM_TOTE"?this.generateToteIdList(d):u=="SPECIFY_TOTE"&&this.generateSpecifyToteIdList(d),d>0&&(this.items.clear(),o.forEach(m=>{let p=this.dateUtils.generateDateTimeTDSC(new Date(m.po.cutOffDeliveryDate)),g=this.dateUtils.generateDateTimeTDSC(new Date(m.po.pickDate));m.items.forEach((w,y)=>{let S=this.toteIdList[y];this.items.push(this.createItem(w.productName??"",w.articleNo??"",w.barcode??"",w.qty??0,w.unit??"",S,w.unitFactor??0,m.doNo,p,g,m.po.poNo,m.shipment.shipmentNo,m.po.orderType)),t.push(this.createConfirmToteDetail(m.doNo,w.articleNo,S,w.qty,w.unitFactor)),e.push(this.createConfirmShipmentDetail(m.doNo,y+1,w.articleNo,w.qty,w.unitFactor,this.dateUtils.generateDate(c)))}),r.push(this.buildConfirmShipmentData(m.po.orderType,m.doNo,m.po.poNo,m.shipment.shipmentNo,f,a,l,e)),i.push(this.buildConfirmToteData(m.po.orderType,m.doNo,m.po.poNo,m.shipment.shipmentNo,t))}));else{let m=s.toteId;d>0&&(this.items.clear(),o.forEach(p=>{let g=this.dateUtils.generateDateTimeTDSC(new Date(p.po.cutOffDeliveryDate)),w=this.dateUtils.generateDateTimeTDSC(new Date(p.po.pickDate));p.items.forEach((y,S)=>{this.items.push(this.createItem(y.productName??"",y.articleNo??"",y.barcode??"",y.qty??0,y.unit??"",m,y.unitFactor??0,p.doNo,g,w,p.po.poNo,p.shipment.shipmentNo,p.po.orderType)),t.push(this.createConfirmToteDetail(p.doNo,y.articleNo,m,y.qty,y.unitFactor)),e.push(this.createConfirmShipmentDetail(p.doNo,S+1,y.articleNo,y.qty,y.unitFactor,this.dateUtils.generateDate(c)))}),r.push(this.buildConfirmShipmentData(p.po.orderType,p.doNo,p.po.poNo,p.shipment.shipmentNo,f,a,l,e)),i.push(this.buildConfirmToteData(p.po.orderType,p.doNo,p.po.poNo,p.shipment.shipmentNo,t))}))}this.confirmShipmentData={xmldata:{data:{orderinfo:r}}},this.confirmToteData={xmldata:{data:{orderinfo:i}}}}buildConfirmShipmentData(e,t,r,i,o,s,a,l){return{warehouseId:"TDNE-01",orderType:e,customerId:"TD001",docNo:t,soReferenceA:r,soReferenceB:i,deliveryNo:t,carrierId:"210000263",shippedTime:o,userDefine1:s,userDefine2:a,details:l}}buildConfirmToteData(e,t,r,i,o){return{_comment:"this file has to change 'warehouseId, orderType, docNo, soReferenceA, soReferenceB, referenceNo, sku. toteId'",warehouseId:"TDNE-01",orderType:e,customerId:"TD001",docNo:t,soReferenceA:r,soReferenceB:i,details:o}}createConfirmToteDetail(e,t,r,i,o){return{referenceNo:e,sku:t,toteId:r,qtyOrdered:i*o}}createConfirmShipmentDetail(e,t,r,i,o,s){return{referenceNo:e,lineNo:t,sku:r,qtyShipped:i*o,lotAtt01:"",lotAtt02:"",lotAtt03:s,lotAtt05:"CJ",lotAtt06:"CJ",lotAtt08:"N"}}generateToteIdList(e){let t=this.dispatchForm.get("subfixToteCode")?.value,r=this.dispatchForm.get("startRunningNumber")?.value;this.toteIdList=[];for(let i=0;i<e;i++){let o=Math.floor(Math.random()*this.prefixToteList.length),s=`${this.prefixToteList[o].code}${t}${String(r+i).padStart(4,"0")}`;this.toteIdList.push(s)}}generateSpecifyToteIdList(e){let t=this.dispatchForm.get("specifyToteCode")?.value,r=this.dispatchForm.get("subfixToteCode")?.value,i=this.dispatchForm.get("startRunningNumber")?.value;this.toteIdList=[];let o=t.split(",").map(a=>a.trim()),s=o.length;for(let a=0;a<e;a++){let l=a<s?a:Math.floor(Math.random()*s),c=o[l],u=c=="PL"?c:`${c}${r}${String(i+a).padStart(4,"0")}`;this.toteIdList.push(u)}}clearData(){this.items.clear(),this.toteIdList=[],this.dispatchForm.reset(),this.toteForm.reset(),this.deliveryOrders.clear(),this.deliveryOrders.push(this.fb.group({value:["",Se.required]})),this.confirmShipmentData=null,this.confirmToteData=null}copyToClipboard(e,t){let r=document.createRange();r.selectNode(e);let i=window.getSelection();i&&(i.removeAllRanges(),i.addRange(r),document.execCommand("copy"),i.removeAllRanges()),t.innerHTML='<i class="fa-solid fa-check"></i> Copied!',t.disabled=!0,setTimeout(()=>{t.innerHTML='<i class="fa-regular fa-copy"></i> Copy',t.disabled=!1},2e3)}static \u0275fac=function(t){return new(t||n)(ae(an),ae(Cr))};static \u0275cmp=nt({type:n,selectors:[["app-td-dispatch-order"]],decls:71,vars:22,consts:[[3,"ngSubmit","formGroup"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"mb-0"],[4,"ngIf"],["type","button",1,"btn","btn-outline-primary",3,"click"],[1,"form-group","mb-3","mt-3"],["for","orderFlow",1,"text-red","text-xl",2,"font-size","25px"],["bindLabel","name","bindValue","id","placeholder","Select mode","formControlName","orderFlow",1,"custom-ng-select",3,"change","items"],["for","mode",1,"text-red","text-xl",2,"font-size","25px"],["bindLabel","name","bindValue","id","placeholder","Select mode","formControlName","mode",1,"custom-ng-select",3,"change","items"],["formArrayName","deliveryOrders"],["class","textarea-row",3,"formGroupName",4,"ngFor","ngForOf"],["class","radio-group",4,"ngIf"],["class","mt-3",4,"ngIf"],[1,"mt-4"],[1,"form-group"],["for","platNo"],["type","text","id","platNo","formControlName","platNo","placeholder","Enter PlatNo"],["for","driverName"],["type","text","id","driverName","formControlName","driverName","placeholder","Enter DriverName"],["type","button",1,"btn","btn-primary","me-2",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"mt-5"],["id","totePreviewTDModal","tabindex","-1","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","\u0E1B\u0E34\u0E14",1,"btn-close"],[1,"modal-body"],[1,"table","table-bordered","table-striped"],[4,"ngFor","ngForOf"],[1,"textarea-row",3,"formGroupName"],["formControlName","value",1,"form-control","textarea-flex",3,"input"],["type","button","class","btn btn-danger btn-sm ms-2",3,"click",4,"ngIf"],["type","button",1,"btn","btn-danger","btn-sm","ms-2",3,"click"],[1,"radio-group"],["type","radio","formControlName","priceDateSource","value","MANUAL"],["type","radio","formControlName","priceDateSource","value","QUERY"],[1,"mt-3"],[3,"codeText"],["formControlName","externalPrice",1,"form-control","textarea-flex"],["for","toteId"],["type","text","id","toteId","formControlName","toteId","placeholder","Enter ToteId"],[1,"form-text","text-muted","ms-2"],["class","form-group",4,"ngIf"],["for","subfixToteCode"],["type","text","id","subfixToteCode","formControlName","subfixToteCode","placeholder","Enter Tote Code"],[1,"form-text","text-muted",2,"margin-left","10px"],["for","startRunningNumber"],["type","number","id","startRunningNumber","formControlName","startRunningNumber","placeholder","Enter Start Running Number"],["for","specifyToteCode"],["type","text","id","specifyToteCode","formControlName","specifyToteCode","placeholder","Enter Tote Code"],[2,"display","flex","align-items","center"],[2,"margin","0"],["type","button","class","btn btn-secondary btn-sm mx-2",3,"click",4,"ngIf"],[3,"formGroup"],[1,"table","table-bordered"],[1,"text-center"],["class","text-center",4,"ngIf"],["formArrayName","items"],[3,"formGroupName",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-secondary","btn-sm","mx-2",3,"click"],[3,"formGroupName"],[2,"white-space","nowrap"],[3,"textToCopy","showIconOnly"],["formArrayName","details",1,"table","table-sm","table-borderless"],["class","pick-detail-row",3,"formGroupName",4,"ngFor","ngForOf"],["colspan","3"],["type","button",1,"btn","btn-primary","btn-sm",2,"border","1px solid #0d6efd !important","padding","0.25rem 0.75rem",3,"click"],["type","text","formControlName","priceDate","placeholder","Price Date",1,"form-control"],[1,"pick-detail-row",3,"formGroupName"],[1,"row"],[1,"col-4"],["type","text","formControlName","pickQty","placeholder","Pick Qty",1,"form-control"],[1,"col-7","d-flex","align-items-center"],["type","text","formControlName","toteId","placeholder","Tote ID",1,"form-control"],[1,"ms-2",3,"textToCopy","showIconOnly"],["class","col-1",4,"ngIf"],[1,"col-1"],["type","button",1,"btn","btn-danger","btn-sm",3,"click"]],template:function(t,r){if(t&1&&(E(0,"form",0),Ce("ngSubmit",function(){return r.onSubmit()}),E(1,"div",1)(2,"h1",2),C(3," Generate Payload Dispatch Order "),be(4,qV,2,1,"span",3),_(),E(5,"button",4),Ce("click",function(){return r.openModal()}),C(6,"Show Tote Codes"),_()(),E(7,"div",5)(8,"label",6),C(9,"Order Flow :"),_(),E(10,"ng-select",7),Ce("change",function(){return r.onChangedOrderFlow()}),_()(),E(11,"div",5)(12,"label",8),C(13,"Mode :"),_(),E(14,"ng-select",9),Ce("change",function(){return r.onChangedMode()}),_()(),E(15,"p")(16,"b"),C(17,"Step1:"),_(),C(18," Go to mongodb collection "),E(19,"b"),C(20,"order.delivery_orders"),_(),C(21," then right click at your document and select copy > "),E(22,"b"),C(23,"Copy Value as Plain Text"),_()(),E(24,"p")(25,"b"),C(26,"Step2:"),_(),C(27," Paste your Delivery Order here"),_(),E(28,"div",10),be(29,YV,3,4,"div",11),_(),be(30,XV,9,0,"div",12)(31,ZV,16,3,"div",13),J(32,"hr",14),be(33,QV,7,2,"div",3)(34,e7,15,5,"div",3)(35,a7,24,4,"div",3),E(36,"h3"),C(37,"Fill in Shipment information"),_(),E(38,"div",15)(39,"label",16),C(40,"Plat No:"),_(),J(41,"input",17),_(),E(42,"div",15)(43,"label",18),C(44,"Driver Name:"),_(),J(45,"input",19),_(),E(46,"div",14)(47,"button",20),Ce("click",function(){return r.onSubmit()}),C(48),_(),E(49,"button",21),Ce("click",function(){return r.clearData()}),C(50,"Clear"),_()(),J(51,"hr",22),_(),be(52,l7,4,1,"div",3)(53,c7,4,1,"div",13),E(54,"div",23)(55,"div",24)(56,"div",25)(57,"div",26)(58,"h5",27),C(59,"\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23 Tote"),_(),J(60,"button",28),_(),E(61,"div",29)(62,"table",30)(63,"thead")(64,"tr")(65,"th"),C(66,"Tote Code"),_(),E(67,"th"),C(68,"Tote Name"),_()()(),E(69,"tbody"),be(70,u7,5,2,"tr",31),_()()()()()()),t&2){let i,o,s,a,l;H("formGroup",r.dispatchForm),A(4),H("ngIf",r.dispatchForm.value.orderFlow),A(6),Ie("is-invalid",((i=r.dispatchForm.get("orderFlow"))==null?null:i.invalid)&&((i=r.dispatchForm.get("orderFlow"))==null?null:i.touched)),H("items",r.orderFlows),A(4),Ie("is-invalid",((o=r.dispatchForm.get("mode"))==null?null:o.invalid)&&((o=r.dispatchForm.get("mode"))==null?null:o.touched)),H("items",r.modes),A(15),H("ngForOf",r.deliveryOrders.controls),A(),H("ngIf",r.dispatchForm.value.orderFlow==="CROSS_DOCK"),A(),H("ngIf",r.dispatchForm.value.orderFlow=="CROSS_DOCK"&&r.dispatchForm.value.priceDateSource==="QUERY"),A(2),H("ngIf",r.dispatchForm.value.mode==="SINGLE_TOTE"),A(),H("ngIf",r.dispatchForm.value.mode==="RANDOM_TOTE"||r.dispatchForm.value.mode==="SPECIFY_TOTE"),A(),H("ngIf",r.items.value.length>0),A(6),Ie("is-invalid",((s=r.dispatchForm.get("platNo"))==null?null:s.invalid)&&((s=r.dispatchForm.get("platNo"))==null?null:s.touched)),A(4),Ie("is-invalid",((a=r.dispatchForm.get("driverName"))==null?null:a.invalid)&&((a=r.dispatchForm.get("driverName"))==null?null:a.touched)),A(3),rt(" ",((l=r.dispatchForm.get("orderFlow"))==null?null:l.value)=="KEEP_STOCK"?"Generate Payload":"Export CSV"),A(4),H("ngIf",r.confirmToteData),A(),H("ngIf",r.confirmShipmentData),A(17),H("ngForOf",r.prefixToteList)}},dependencies:[mt,uo,Pt,Wt,An,Gt,oc,lr,on,sn,$t,en,da,ha,po,ln,mo],encapsulation:2})};var WS=f2($S());function i9(n,e){if(n&1&&(E(0,"div",9)(1,"label",11),C(2,"Article No:"),_(),J(3,"input",12),_()),n&2){let t,r=re();A(3),Ie("is-invalid",((t=r.productTagForm.get("articleNo"))==null?null:t.invalid)&&((t=r.productTagForm.get("articleNo"))==null?null:t.touched))}}function o9(n,e){if(n&1&&(E(0,"div",9)(1,"label",13),C(2,"Barcode:"),_(),J(3,"input",14),_()),n&2){let t,r=re();A(3),Ie("is-invalid",((t=r.productTagForm.get("barcode"))==null?null:t.invalid)&&((t=r.productTagForm.get("barcode"))==null?null:t.touched))}}function s9(n,e){if(n&1&&(E(0,"div",9)(1,"label",15),C(2,"Shelf No:"),_(),J(3,"input",16),E(4,"span",17),C(5,"If the shelfCode is 0001-00095, the shelfNo is 0001"),_()()),n&2){let t,r=re();A(3),Ie("is-invalid",((t=r.productTagForm.get("shelfNo"))==null?null:t.invalid)&&((t=r.productTagForm.get("shelfNo"))==null?null:t.touched))}}function a9(n,e){if(n&1&&(E(0,"div",9)(1,"label",18),C(2,"Master Id:"),_(),J(3,"input",19),E(4,"span",17),C(5,"Lookup this field in "),E(6,"b"),C(7,"pos_mgr.price_tag_master >> id"),_()()()),n&2){let t,r=re();A(3),Ie("is-invalid",((t=r.productTagForm.get("masterId"))==null?null:t.invalid)&&((t=r.productTagForm.get("masterId"))==null?null:t.touched))}}function l9(n,e){if(n&1&&(E(0,"div",9)(1,"label",20),C(2,"Version:"),_(),J(3,"input",21),E(4,"span",17),C(5,"Lookup this field in "),E(6,"b"),C(7,"pos_mgr.price_tag_master >> master_version"),_()()()),n&2){let t,r=re();A(3),Ie("is-invalid",((t=r.productTagForm.get("version"))==null?null:t.invalid)&&((t=r.productTagForm.get("version"))==null?null:t.touched))}}function c9(n,e){if(n&1&&(E(0,"div",9)(1,"label",22),C(2,"Bay No:"),_(),J(3,"input",23),E(4,"span",17),C(5,"Lookup this field in Nest > Store Assortment"),_()()),n&2){let t,r=re();A(3),Ie("is-invalid",((t=r.productTagForm.get("bayNo"))==null?null:t.invalid)&&((t=r.productTagForm.get("bayNo"))==null?null:t.touched))}}function u9(n,e){if(n&1&&(E(0,"div",9)(1,"label",24),C(2,"Bay Level:"),_(),J(3,"input",25),E(4,"span",17),C(5,"Lookup this field in Nest > Store Assortment"),_()()),n&2){let t,r=re();A(3),Ie("is-invalid",((t=r.productTagForm.get("bayLevel"))==null?null:t.invalid)&&((t=r.productTagForm.get("bayLevel"))==null?null:t.touched))}}function f9(n,e){if(n&1&&(E(0,"div",9)(1,"label",26),C(2,"location Id:"),_(),J(3,"input",27),E(4,"span",17),C(5,"Lookup this field in Nest > Store Assortment"),_()()),n&2){let t,r=re();A(3),Ie("is-invalid",((t=r.productTagForm.get("locationId"))==null?null:t.invalid)&&((t=r.productTagForm.get("locationId"))==null?null:t.touched))}}function d9(n,e){if(n&1&&(E(0,"div",9)(1,"label",28),C(2),_(),J(3,"input",29),_()),n&2){let t,r=re();A(2),Je(r.productTagForm.value.type==="PROMOTION"?"Promotion No":"RTC Unique Code"),A(),Ie("is-invalid",((t=r.productTagForm.get("docRefNo"))==null?null:t.invalid)&&((t=r.productTagForm.get("docRefNo"))==null?null:t.touched)),H("placeholder",r.productTagForm.value.type==="PROMOTION"?"Enter Promotion No":r.productTagForm.value.type==="RTC"?"Enter RTC Unique Code":"Enter Doc Ref No")}}function h9(n,e){if(n&1&&(E(0,"div",9)(1,"label",30),C(2,"Expire Date:"),_(),J(3,"input",31),E(4,"span",32),C(5," sample data : 2025-01-25 23:59:59.999 +0700"),_()()),n&2){let t,r=re();A(3),Ie("is-invalid",((t=r.productTagForm.get("expireDate"))==null?null:t.invalid)&&((t=r.productTagForm.get("expireDate"))==null?null:t.touched))}}function p9(n,e){if(n&1&&(E(0,"div")(1,"span",33)(2,"div",34),C(3),_(),J(4,"app-copy-button",35),_()()),n&2){let t=re();A(3),Je(t.qrText),A(),H("textToCopy",t.qrText)("showIconOnly",!0)}}function m9(n,e){if(n&1&&(E(0,"div")(1,"h5",8),C(2,"Result"),_(),J(3,"app-code-box",36),_()),n&2){let t=re();A(3),H("codeText",t.phraseResult)}}var Ph=class n{constructor(e,t){this.fb=e;this.toastr=t}productTagForm;qrText="";phraseResult="";types=[{id:"REGULAR",name:"Regular"},{id:"PROMOTION",name:"Promotion"},{id:"RTC",name:"RTC"}];ngOnInit(){let e=new Date;this.productTagForm=this.fb.group({type:[null,Se.required],articleNo:["",Se.required],barcode:["",Se.required],shelfNo:[""],masterId:["",Se.required],version:["",Se.required],bayNo:[""],bayLevel:[""],locationId:[""],docRefNo:[""],expireDate:[""],productTagData:[""]}),this.productTagForm.get("type")?.valueChanges.subscribe(t=>{let r=this.productTagForm.get("articleNo"),i=this.productTagForm.get("barcode"),o=this.productTagForm.get("masterId"),s=this.productTagForm.get("version"),a=this.productTagForm.get("docRefNo"),l=this.productTagForm.get("expireDate"),c=this.productTagForm.get("shelfNo");t==="REGULAR"?(r?.setValidators([Se.required]),i?.setValidators([Se.required]),o?.setValidators([Se.required]),s?.setValidators([Se.required]),a?.clearValidators(),l?.clearValidators(),c?.clearValidators()):t==="PROMOTION"?(i?.setValidators([Se.required]),a?.setValidators([Se.required]),c?.setValidators([Se.required]),r?.clearValidators(),o?.clearValidators(),s?.clearValidators(),l?.clearValidators()):t==="RTC"&&(a?.setValidators([Se.required]),l?.setValidators([Se.required]),r?.clearValidators(),i?.clearValidators(),c?.clearValidators(),o?.clearValidators(),s?.clearValidators());let u=document.getElementById("qrContainer");u&&(this.qrText="",u.innerHTML=""),r?.updateValueAndValidity(),i?.updateValueAndValidity(),c?.updateValueAndValidity(),o?.updateValueAndValidity(),s?.updateValueAndValidity(),a?.updateValueAndValidity(),l?.updateValueAndValidity()})}appendText(e,t,r){r!=null&&e.push(`${t}${String(r).length.toString().padStart(2,"0")}${r}`)}buildBayInfo(e,t,r){return!e||!t||r==null?null:`${e},${t},${r}`}generateRegularTag(e){let t=[];return this.appendText(t,"01","01"),this.appendText(t,"03",e.articleNo),this.appendText(t,"04",e.barcode),this.appendText(t,"12",e.shelfNo),this.appendText(t,"13",e.masterId.toString()),this.appendText(t,"14",e.version.toString()),this.appendText(t,"17",this.buildBayInfo(e.bayNo,e.bayLevel,e.locationId)),t.join("")}generatePromotionTag(e){let t=[];return this.appendText(t,"01","02"),this.appendText(t,"04",e.barcode),this.appendText(t,"07",e.docRefNo),this.appendText(t,"12",e.shelfNo),this.appendText(t,"17",this.buildBayInfo(e.bayNo,e.bayLevel,e.locationId)),t.join("")}generateReduceToClearTag(e){let t=[];return this.appendText(t,"01","03"),this.appendText(t,"07",e.docRefNo),this.appendText(t,"11",this.transformDate(e.expireDate)),t.join("")}async generateTagQRCode(){if(this.validateForm())return;let e=this.productTagForm.value,t=document.getElementById("qrContainer");if(e.type==="REGULAR")this.qrText=this.generateRegularTag(e);else if(e.type==="PROMOTION")this.qrText=this.generatePromotionTag(e);else if(e.type==="RTC")this.qrText=this.generateReduceToClearTag(e);else{this.qrText="",t&&(t.innerHTML="");return}let r=await g9(this.qrText);if(t){t.innerHTML="";let i=document.createElement("img");i.src=r,t.appendChild(i)}}validateForm(){return this.productTagForm.invalid||this.productTagForm.invalid?(this.productTagForm.markAllAsTouched(),this.toastr.error("Invalid form","\u0E41\u0E08\u0E49\u0E07\u0E40\u0E15\u0E37\u0E2D\u0E19"),!0):!1}transformDate(e){let t=e.replace(/\.\d+|\s\+\d{4}/g,""),[r,i]=t.split(" "),[o,s,a]=r.split("-"),[l,c,u]=i.split(":");return`${a}${s}${o}${l}${c}${u}`}phraseProductTag(){let e=this.productTagForm.value,t=new x1;this.phraseResult=t.validateBarcode(e.productTagData),Object.entries({type:"type",articleNo:"articleNo",barcode:"barcode",masterId:"masterId",version:"version",bayNo:"bayNo",bayLevel:"bayLevel",locationId:"locationId",shelfNo:"shelfNo",promotionNo:"docRefNo",rtcUniqueCode:"docRefNo"}).forEach(([i,o])=>{let s=this.phraseResult?.[i];i==="type"&&(s=this.mapType(s)),this.productTagForm.get(o)?.setValue(s)}),this.productTagForm.get("expireDate")?.setValue(this.convertExpireDate(this.phraseResult?.expireDate))}mapType(e){return e?e==="REDUCE_TO_CLEAR"?"RTC":e:null}convertExpireDate(e){if(!e||e.length!==14)return null;let t=e.substring(0,2),r=e.substring(2,4),i=e.substring(4,8),o=e.substring(8,10),s=e.substring(10,12),a=e.substring(12,14);return`${i}-${r}-${t} ${o}:${s}:${a}.999 +0700`}static \u0275fac=function(t){return new(t||n)(ae(an),ae(Cr))};static \u0275cmp=nt({type:n,selectors:[["app-product-tag"]],decls:29,vars:18,consts:[[3,"formGroup"],[1,"form-group","mb-3","mt-3"],["for","type",1,"text-red","text-xl",2,"font-size","25px"],["bindLabel","name","bindValue","id","placeholder","Select type","formControlName","type",1,"custom-ng-select",3,"items"],["class","form-group",4,"ngIf"],["type","button",1,"btn","btn-primary","me-2",3,"click"],["id","qrContainer"],[4,"ngIf"],[1,"mt-3"],[1,"form-group"],["type","text","id","productTagData","formControlName","productTagData","placeholder","Enter Product Tag Data",2,"width","40em"],["for","articleNo"],["type","text","id","articleNo","formControlName","articleNo","placeholder","Enter Article No"],["for","barcode"],["type","text","id","barcode","formControlName","barcode","placeholder","Enter Barcode"],["for","shelfNo"],["type","text","id","shelfNo","formControlName","shelfNo","placeholder","Enter shelfNo"],[1,"ms-2","d-inline-block"],["for","masterId"],["type","text","id","masterId","formControlName","masterId","placeholder","Enter MasterId"],["for","version"],["type","text","id","version","formControlName","version","placeholder","Enter Version"],["for","bayNo"],["type","text","id","bayNo","formControlName","bayNo","placeholder","Enter Bay No"],["for","bayLevel"],["type","text","id","bayLevel","formControlName","bayLevel","placeholder","Enter Bay Level"],["for","locationId"],["type","text","id","locationId","formControlName","locationId","placeholder","Enter Location Id"],["for","docRefNo"],["type","text","id","docRefNo","formControlName","docRefNo",3,"placeholder"],["for","expireDate"],["type","text","id","expireDate","formControlName","expireDate","placeholder","Enter Expire Date"],[1,"ms-2"],[2,"display","flex","align-items","center","gap","8px"],["id","qrText"],[3,"textToCopy","showIconOnly"],[3,"codeText"]],template:function(t,r){if(t&1&&(E(0,"form",0)(1,"h3"),C(2,"Generate Tag QR Code"),_(),E(3,"div",1)(4,"label",2),C(5,"Type :"),_(),J(6,"ng-select",3),_(),be(7,i9,4,2,"div",4)(8,o9,4,2,"div",4)(9,s9,6,2,"div",4)(10,a9,8,2,"div",4)(11,l9,8,2,"div",4)(12,c9,6,2,"div",4)(13,u9,6,2,"div",4)(14,f9,6,2,"div",4)(15,d9,4,4,"div",4)(16,h9,6,2,"div",4),E(17,"button",5),Ce("click",function(){return r.generateTagQRCode()}),C(18,"Generate QR Code"),_(),J(19,"div",6),be(20,p9,5,3,"div",7),J(21,"hr",8),E(22,"h3"),C(23,"Phrase Product Tag Data"),_(),E(24,"div",9),J(25,"input",10),_(),E(26,"button",5),Ce("click",function(){return r.phraseProductTag()}),C(27,"Phrase"),_(),be(28,m9,4,1,"div",7),_()),t&2){let i,o;H("formGroup",r.productTagForm),A(6),Ie("is-invalid",((i=r.productTagForm.get("type"))==null?null:i.invalid)&&((i=r.productTagForm.get("type"))==null?null:i.touched)),H("items",r.types),A(),H("ngIf",r.productTagForm.value.type==="REGULAR"),A(),H("ngIf",r.productTagForm.value.type==="REGULAR"||r.productTagForm.value.type==="PROMOTION"),A(),H("ngIf",r.productTagForm.value.type==="REGULAR"||r.productTagForm.value.type==="PROMOTION"),A(),H("ngIf",r.productTagForm.value.type==="REGULAR"),A(),H("ngIf",r.productTagForm.value.type==="REGULAR"),A(),H("ngIf",r.productTagForm.value.type==="REGULAR"||r.productTagForm.value.type==="PROMOTION"),A(),H("ngIf",r.productTagForm.value.type==="REGULAR"||r.productTagForm.value.type==="PROMOTION"),A(),H("ngIf",r.productTagForm.value.type==="REGULAR"||r.productTagForm.value.type==="PROMOTION"),A(),H("ngIf",r.productTagForm.value.type==="PROMOTION"||r.productTagForm.value.type==="RTC"),A(),H("ngIf",r.productTagForm.value.type==="RTC"),A(4),H("ngIf",r.qrText),A(5),Ie("is-invalid",((o=r.productTagForm.get("productTagData"))==null?null:o.invalid)&&((o=r.productTagForm.get("productTagData"))==null?null:o.touched)),A(3),H("ngIf",r.phraseResult&&r.productTagForm.value.productTagData)}},dependencies:[mt,Pt,Wt,An,Gt,on,sn,$t,en,po,ln,mo],encapsulation:2})};async function g9(n){try{return await WS.default.toDataURL(n,{errorCorrectionLevel:"H",type:"image/png",margin:2,width:300})}catch(e){throw console.error("Failed to generate QR code:",e),e}}var y1={REGULAR:{tagCode:"01"},PROMOTION:{tagCode:"02"},REDUCE_TO_CLEAR:{tagCode:"03"}},x1=class{validateBarcode(e){let t=this.splitTextInputIntoField(e);return this.validateInputType(t,e)}validateInputType(e,t){let r=e.success?e.value:null,i=r?.["01"]||null,o=r?.["17"]||"",[s,a,l]=o?o.split(","):["","",""];return i===y1.REGULAR.tagCode?{type:"REGULAR",articleNo:r?.["03"]||"",barcode:r?.["04"]||"",unit:r?.["05"]||"",retailPrice:this.parseRetailPrice(r?.["06"]||""),shelfNo:r?.["12"]||null,masterId:r?.["13"]||"",version:r?.["14"]||"",shelfLabel:r?.["15"]||"",bayNo:s||"",bayLevel:a||"",locationId:l||""}:i===y1.PROMOTION.tagCode?{type:"PROMOTION",barcode:r?.["04"]||"",promotionNo:r?.["07"]||"",shelfNo:r?.["12"]||null,shelfLabel:r?.["15"]||"",bayNo:s||"",bayLevel:a||"",locationId:l||""}:i===y1.REDUCE_TO_CLEAR.tagCode?{type:"REDUCE_TO_CLEAR",rtcUniqueCode:r?.["07"]||"",expireDate:r?.["11"]||""}:t.endsWith(".00")?{type:"REDUCE_TO_CLEAR",rtcUniqueCode:t}:{type:"Normal",plainText:t}}splitTextInputIntoField(e){let t=0;try{let r={};for(;t<e.length;){let i=e.substring(t,t+2);t+=2;let o=parseInt(e.substring(t,t+2),10);t+=2;let s=e.substring(t,t+o);t+=o,r[i]=s}return{success:!0,value:r}}catch(r){return{success:!1,error:r}}}parseRetailPrice(e){if(!e||e.length===0)return 0;let t=e.slice(0,-2)+"."+e.slice(-2);return parseFloat(parseFloat(t).toFixed(2))}};function v9(n,e){if(n&1){let t=_t();E(0,"div",7),Ce("click",function(){let i=qe(t).$implicit,o=re();return Ke(o.openTab(i.id))}),C(1),_()}if(n&2){let t=e.$implicit,r=re();Ie("active",r.activeTab===t.id),A(),rt(" ",t.label," ")}}function _9(n,e){n&1&&J(0,"app-dispatch-order")}function y9(n,e){n&1&&J(0,"app-td-dispatch-order")}function x9(n,e){n&1&&J(0,"app-thai-locale-compare")}function E9(n,e){n&1&&J(0,"app-array-formatter")}function T9(n,e){n&1&&J(0,"app-unicode-converter")}function w9(n,e){n&1&&J(0,"app-create-stock-count-request")}function C9(n,e){n&1&&J(0,"app-create-stock-count-group")}function D9(n,e){n&1&&J(0,"app-create-shelf")}function S9(n,e){n&1&&J(0,"app-create-refill-recommmendation")}function b9(n,e){n&1&&J(0,"app-product-tag")}var Lh=class n{activeTab="dispatchOrder";tabs=[{id:"dispatchOrder",label:"CJX Dispatch Order"},{id:"tdDispatchOrder",label:"TD Dispatch Order"},{id:"createStockCountRequest",label:"Stock Count Request"},{id:"productTag",label:"Check Product Tag"},{id:"thaiLocaleCompare",label:"Thai Locale Compare"},{id:"unicodeConverter",label:"Unicode Converter"},{id:"arrayFormatter",label:"Array Formatter"}];openTab(e){this.activeTab=e}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=nt({type:n,selectors:[["app-root"]],decls:16,vars:12,consts:[[1,"p-4"],[1,"tabs"],["class","tab",3,"active","click",4,"ngFor","ngForOf"],[1,"tab-content","active"],["id","content-area"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"tab",3,"click"]],template:function(t,r){t&1&&(E(0,"div",0)(1,"div",1),be(2,v9,2,3,"div",2),_(),E(3,"div",3)(4,"div",4),oi(5,5),be(6,_9,1,0,"app-dispatch-order",6)(7,y9,1,0,"app-td-dispatch-order",6)(8,x9,1,0,"app-thai-locale-compare",6)(9,E9,1,0,"app-array-formatter",6)(10,T9,1,0,"app-unicode-converter",6)(11,w9,1,0,"app-create-stock-count-request",6)(12,C9,1,0,"app-create-stock-count-group",6)(13,D9,1,0,"app-create-shelf",6)(14,S9,1,0,"app-create-refill-recommmendation",6)(15,b9,1,0,"app-product-tag",6),si(),_()()()),t&2&&(A(2),H("ngForOf",r.tabs),A(3),H("ngSwitch",r.activeTab),A(),H("ngSwitchCase","dispatchOrder"),A(),H("ngSwitchCase","tdDispatchOrder"),A(),H("ngSwitchCase","thaiLocaleCompare"),A(),H("ngSwitchCase","arrayFormatter"),A(),H("ngSwitchCase","unicodeConverter"),A(),H("ngSwitchCase","createStockCountRequest"),A(),H("ngSwitchCase","createStockCountGroup"),A(),H("ngSwitchCase","createShelf"),A(),H("ngSwitchCase","createRefillRecommmendation"),A(),H("ngSwitchCase","productTag"))},dependencies:[Vd,mt,uo,hd,Pg,Ud,jd,Hd,Gd,$d,Th,wh,Ch,Ph],encapsulation:2})};function zS(n){return new Ee(3e3,!1)}function I9(){return new Ee(3100,!1)}function A9(){return new Ee(3101,!1)}function F9(n){return new Ee(3001,!1)}function k9(n){return new Ee(3003,!1)}function N9(n){return new Ee(3004,!1)}function KS(n,e){return new Ee(3005,!1)}function YS(){return new Ee(3006,!1)}function XS(){return new Ee(3007,!1)}function ZS(n,e){return new Ee(3008,!1)}function QS(n){return new Ee(3002,!1)}function JS(n,e,t,r,i){return new Ee(3010,!1)}function eb(){return new Ee(3011,!1)}function tb(){return new Ee(3012,!1)}function nb(){return new Ee(3200,!1)}function rb(){return new Ee(3202,!1)}function ib(){return new Ee(3013,!1)}function ob(n){return new Ee(3014,!1)}function sb(n){return new Ee(3015,!1)}function ab(n){return new Ee(3016,!1)}function lb(n,e){return new Ee(3404,!1)}function M9(n){return new Ee(3502,!1)}function cb(n){return new Ee(3503,!1)}function ub(){return new Ee(3300,!1)}function fb(n){return new Ee(3504,!1)}function db(n){return new Ee(3301,!1)}function hb(n,e){return new Ee(3302,!1)}function pb(n){return new Ee(3303,!1)}function mb(n,e){return new Ee(3400,!1)}function gb(n){return new Ee(3401,!1)}function vb(n){return new Ee(3402,!1)}function _b(n,e){return new Ee(3505,!1)}function Gi(n){switch(n.length){case 0:return new fi;case 1:return n[0];default:return new ss(n)}}function C1(n,e,t=new Map,r=new Map){let i=[],o=[],s=-1,a=null;if(e.forEach(l=>{let c=l.get("offset"),u=c==s,f=u&&a||new Map;l.forEach((h,d)=>{let m=d,p=h;if(d!=="offset")switch(m=n.normalizePropertyName(m,i),p){case ma:p=t.get(d);break;case wr:p=r.get(d);break;default:p=n.normalizeStyleValue(d,m,p,i);break}f.set(m,p)}),u||o.push(f),a=f,s=c}),i.length)throw M9(i);return o}function Bh(n,e,t,r){switch(e){case"start":n.onStart(()=>r(t&&E1(t,"start",n)));break;case"done":n.onDone(()=>r(t&&E1(t,"done",n)));break;case"destroy":n.onDestroy(()=>r(t&&E1(t,"destroy",n)));break}}function E1(n,e,t){let r=t.totalTime,i=!!t.disabled,o=Vh(n.element,n.triggerName,n.fromState,n.toState,e||n.phaseName,r??n.totalTime,i),s=n._data;return s!=null&&(o._data=s),o}function Vh(n,e,t,r,i="",o=0,s){return{element:n,triggerName:e,fromState:t,toState:r,phaseName:i,totalTime:o,disabled:!!s}}function Kn(n,e,t){let r=n.get(e);return r||n.set(e,r=t),r}function D1(n){let e=n.indexOf(":"),t=n.substring(1,e),r=n.slice(e+1);return[t,r]}var O9=typeof document>"u"?null:document.documentElement;function Uh(n){let e=n.parentNode||n.host||null;return e===O9?null:e}function R9(n){return n.substring(1,6)=="ebkit"}var Ts=null,qS=!1;function yb(n){Ts||(Ts=P9()||{},qS=Ts.style?"WebkitAppearance"in Ts.style:!1);let e=!0;return Ts.style&&!R9(n)&&(e=n in Ts.style,!e&&qS&&(e="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in Ts.style)),e}function P9(){return typeof document<"u"?document.body:null}function S1(n,e){for(;e;){if(e===n)return!0;e=Uh(e)}return!1}function b1(n,e,t){if(t)return Array.from(n.querySelectorAll(e));let r=n.querySelector(e);return r?[r]:[]}var L9=1e3,I1="{{",B9="}}",A1="ng-enter",jh="ng-leave",Bc="ng-trigger",Vc=".ng-trigger",F1="ng-animating",Hh=".ng-animating";function gi(n){if(typeof n=="number")return n;let e=n.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:T1(parseFloat(e[1]),e[2])}function T1(n,e){switch(e){case"s":return n*L9;default:return n}}function Uc(n,e,t){return n.hasOwnProperty("duration")?n:V9(n,e,t)}function V9(n,e,t){let r=/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i,i,o=0,s="";if(typeof n=="string"){let a=n.match(r);if(a===null)return e.push(zS(n)),{duration:0,delay:0,easing:""};i=T1(parseFloat(a[1]),a[2]);let l=a[3];l!=null&&(o=T1(parseFloat(l),a[4]));let c=a[5];c&&(s=c)}else i=n;if(!t){let a=!1,l=e.length;i<0&&(e.push(I9()),a=!0),o<0&&(e.push(A9()),a=!0),a&&e.splice(l,0,zS(n))}return{duration:i,delay:o,easing:s}}function xb(n){return n.length?n[0]instanceof Map?n:n.map(e=>new Map(Object.entries(e))):[]}function qr(n,e,t){e.forEach((r,i)=>{let o=Gh(i);t&&!t.has(i)&&t.set(i,n.style[o]),n.style[o]=r})}function Io(n,e){e.forEach((t,r)=>{let i=Gh(r);n.style[i]=""})}function Va(n){return Array.isArray(n)?n.length==1?n[0]:Cw(n):n}function Eb(n,e,t){let r=e.params||{},i=k1(n);i.length&&i.forEach(o=>{r.hasOwnProperty(o)||t.push(F9(o))})}var w1=new RegExp(`${I1}\\s*(.+?)\\s*${B9}`,"g");function k1(n){let e=[];if(typeof n=="string"){let t;for(;t=w1.exec(n);)e.push(t[1]);w1.lastIndex=0}return e}function Ua(n,e,t){let r=`${n}`,i=r.replace(w1,(o,s)=>{let a=e[s];return a==null&&(t.push(k9(s)),a=""),a.toString()});return i==r?n:i}var U9=/-+([a-z0-9])/g;function Gh(n){return n.replace(U9,(...e)=>e[1].toUpperCase())}function Tb(n,e){return n===0||e===0}function wb(n,e,t){if(t.size&&e.length){let r=e[0],i=[];if(t.forEach((o,s)=>{r.has(s)||i.push(s),r.set(s,o)}),i.length)for(let o=1;o<e.length;o++){let s=e[o];i.forEach(a=>s.set(a,$h(n,a)))}}return e}function Yn(n,e,t){switch(e.type){case $e.Trigger:return n.visitTrigger(e,t);case $e.State:return n.visitState(e,t);case $e.Transition:return n.visitTransition(e,t);case $e.Sequence:return n.visitSequence(e,t);case $e.Group:return n.visitGroup(e,t);case $e.Animate:return n.visitAnimate(e,t);case $e.Keyframes:return n.visitKeyframes(e,t);case $e.Style:return n.visitStyle(e,t);case $e.Reference:return n.visitReference(e,t);case $e.AnimateChild:return n.visitAnimateChild(e,t);case $e.AnimateRef:return n.visitAnimateRef(e,t);case $e.Query:return n.visitQuery(e,t);case $e.Stagger:return n.visitStagger(e,t);default:throw N9(e.type)}}function $h(n,e){return window.getComputedStyle(n)[e]}var K1=(()=>{class n{validateStyleProperty(t){return yb(t)}containsElement(t,r){return S1(t,r)}getParentElement(t){return Uh(t)}query(t,r,i){return b1(t,r,i)}computeStyle(t,r,i){return i||""}animate(t,r,i,o,s,a=[],l){return new fi(i,o)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ge({token:n,factory:n.\u0275fac})}return n})(),Cs=class{static NOOP=new K1},Ds=class{};var j9=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]),Yh=class extends Ds{normalizePropertyName(e,t){return Gh(e)}normalizeStyleValue(e,t,r,i){let o="",s=r.toString().trim();if(j9.has(t)&&r!==0&&r!=="0")if(typeof r=="number")o="px";else{let a=r.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&a[1].length==0&&i.push(KS(e,r))}return s+o}};var Xh="*";function H9(n,e){let t=[];return typeof n=="string"?n.split(/\s*,\s*/).forEach(r=>G9(r,t,e)):t.push(n),t}function G9(n,e,t){if(n[0]==":"){let l=$9(n,t);if(typeof l=="function"){e.push(l);return}n=l}let r=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(r==null||r.length<4)return t.push(sb(n)),e;let i=r[1],o=r[2],s=r[3];e.push(Cb(i,s));let a=i==Xh&&s==Xh;o[0]=="<"&&!a&&e.push(Cb(s,i))}function $9(n,e){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,r)=>parseFloat(r)>parseFloat(t);case":decrement":return(t,r)=>parseFloat(r)<parseFloat(t);default:return e.push(ab(n)),"* => *"}}var Wh=new Set(["true","1"]),zh=new Set(["false","0"]);function Cb(n,e){let t=Wh.has(n)||zh.has(n),r=Wh.has(e)||zh.has(e);return(i,o)=>{let s=n==Xh||n==i,a=e==Xh||e==o;return!s&&t&&typeof i=="boolean"&&(s=i?Wh.has(n):zh.has(n)),!a&&r&&typeof o=="boolean"&&(a=o?Wh.has(e):zh.has(e)),s&&a}}var Ob=":self",W9=new RegExp(`s*${Ob}s*,?`,"g");function Rb(n,e,t,r){return new L1(n).build(e,t,r)}var Db="",L1=class{_driver;constructor(e){this._driver=e}build(e,t,r){let i=new B1(t);return this._resetContextStyleTimingState(i),Yn(this,Va(e),i)}_resetContextStyleTimingState(e){e.currentQuerySelector=Db,e.collectedStyles=new Map,e.collectedStyles.set(Db,new Map),e.currentTime=0}visitTrigger(e,t){let r=t.queryCount=0,i=t.depCount=0,o=[],s=[];return e.name.charAt(0)=="@"&&t.errors.push(YS()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),a.type==$e.State){let l=a,c=l.name;c.toString().split(/\s*,\s*/).forEach(u=>{l.name=u,o.push(this.visitState(l,t))}),l.name=c}else if(a.type==$e.Transition){let l=this.visitTransition(a,t);r+=l.queryCount,i+=l.depCount,s.push(l)}else t.errors.push(XS())}),{type:$e.Trigger,name:e.name,states:o,transitions:s,queryCount:r,depCount:i,options:null}}visitState(e,t){let r=this.visitStyle(e.styles,t),i=e.options&&e.options.params||null;if(r.containsDynamicStyles){let o=new Set,s=i||{};r.styles.forEach(a=>{a instanceof Map&&a.forEach(l=>{k1(l).forEach(c=>{s.hasOwnProperty(c)||o.add(c)})})}),o.size&&t.errors.push(ZS(e.name,[...o.values()]))}return{type:$e.State,name:e.name,style:r,options:i?{params:i}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;let r=Yn(this,Va(e.animation),t),i=H9(e.expr,t.errors);return{type:$e.Transition,matchers:i,animation:r,queryCount:t.queryCount,depCount:t.depCount,options:ws(e.options)}}visitSequence(e,t){return{type:$e.Sequence,steps:e.steps.map(r=>Yn(this,r,t)),options:ws(e.options)}}visitGroup(e,t){let r=t.currentTime,i=0,o=e.steps.map(s=>{t.currentTime=r;let a=Yn(this,s,t);return i=Math.max(i,t.currentTime),a});return t.currentTime=i,{type:$e.Group,steps:o,options:ws(e.options)}}visitAnimate(e,t){let r=Y9(e.timings,t.errors);t.currentAnimateTimings=r;let i,o=e.styles?e.styles:go({});if(o.type==$e.Keyframes)i=this.visitKeyframes(o,t);else{let s=e.styles,a=!1;if(!s){a=!0;let c={};r.easing&&(c.easing=r.easing),s=go(c)}t.currentTime+=r.duration+r.delay;let l=this.visitStyle(s,t);l.isEmptyStep=a,i=l}return t.currentAnimateTimings=null,{type:$e.Animate,timings:r,style:i,options:null}}visitStyle(e,t){let r=this._makeStyleAst(e,t);return this._validateStyleAst(r,t),r}_makeStyleAst(e,t){let r=[],i=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of i)typeof a=="string"?a===wr?r.push(a):t.errors.push(QS(a)):r.push(new Map(Object.entries(a)));let o=!1,s=null;return r.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(s=a.get("easing"),a.delete("easing")),!o)){for(let l of a.values())if(l.toString().indexOf(I1)>=0){o=!0;break}}}),{type:$e.Style,styles:r,easing:s,offset:e.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(e,t){let r=t.currentAnimateTimings,i=t.currentTime,o=t.currentTime;r&&o>0&&(o-=r.duration+r.delay),e.styles.forEach(s=>{typeof s!="string"&&s.forEach((a,l)=>{let c=t.collectedStyles.get(t.currentQuerySelector),u=c.get(l),f=!0;u&&(o!=i&&o>=u.startTime&&i<=u.endTime&&(t.errors.push(JS(l,u.startTime,u.endTime,o,i)),f=!1),o=u.startTime),f&&c.set(l,{startTime:o,endTime:i}),t.options&&Eb(a,t.options,t.errors)})})}visitKeyframes(e,t){let r={type:$e.Keyframes,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(eb()),r;let i=1,o=0,s=[],a=!1,l=!1,c=0,u=e.steps.map(w=>{let y=this._makeStyleAst(w,t),S=y.offset!=null?y.offset:K9(y.styles),B=0;return S!=null&&(o++,B=y.offset=S),l=l||B<0||B>1,a=a||B<c,c=B,s.push(B),y});l&&t.errors.push(tb()),a&&t.errors.push(nb());let f=e.steps.length,h=0;o>0&&o<f?t.errors.push(rb()):o==0&&(h=i/(f-1));let d=f-1,m=t.currentTime,p=t.currentAnimateTimings,g=p.duration;return u.forEach((w,y)=>{let S=h>0?y==d?1:h*y:s[y],B=S*g;t.currentTime=m+p.delay+B,p.duration=B,this._validateStyleAst(w,t),w.offset=S,r.styles.push(w)}),r}visitReference(e,t){return{type:$e.Reference,animation:Yn(this,Va(e.animation),t),options:ws(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:$e.AnimateChild,options:ws(e.options)}}visitAnimateRef(e,t){return{type:$e.AnimateRef,animation:this.visitReference(e.animation,t),options:ws(e.options)}}visitQuery(e,t){let r=t.currentQuerySelector,i=e.options||{};t.queryCount++,t.currentQuery=e;let[o,s]=z9(e.selector);t.currentQuerySelector=r.length?r+" "+o:o,Kn(t.collectedStyles,t.currentQuerySelector,new Map);let a=Yn(this,Va(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=r,{type:$e.Query,selector:o,limit:i.limit||0,optional:!!i.optional,includeSelf:s,animation:a,originalSelector:e.selector,options:ws(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(ib());let r=e.timings==="full"?{duration:0,delay:0,easing:"full"}:Uc(e.timings,t.errors,!0);return{type:$e.Stagger,animation:Yn(this,Va(e.animation),t),timings:r,options:null}}};function z9(n){let e=!!n.split(/\s*,\s*/).find(t=>t==Ob);return e&&(n=n.replace(W9,"")),n=n.replace(/@\*/g,Vc).replace(/@\w+/g,t=>Vc+"-"+t.slice(1)).replace(/:animating/g,Hh),[n,e]}function q9(n){return n?Me({},n):null}var B1=class{errors;queryCount=0;depCount=0;currentTransition=null;currentQuery=null;currentQuerySelector=null;currentAnimateTimings=null;currentTime=0;collectedStyles=new Map;options=null;unsupportedCSSPropertiesFound=new Set;constructor(e){this.errors=e}};function K9(n){if(typeof n=="string")return null;let e=null;if(Array.isArray(n))n.forEach(t=>{if(t instanceof Map&&t.has("offset")){let r=t;e=parseFloat(r.get("offset")),r.delete("offset")}});else if(n instanceof Map&&n.has("offset")){let t=n;e=parseFloat(t.get("offset")),t.delete("offset")}return e}function Y9(n,e){if(n.hasOwnProperty("duration"))return n;if(typeof n=="number"){let o=Uc(n,e).duration;return N1(o,0,"")}let t=n;if(t.split(/\s+/).some(o=>o.charAt(0)=="{"&&o.charAt(1)=="{")){let o=N1(0,0,"");return o.dynamic=!0,o.strValue=t,o}let i=Uc(t,e);return N1(i.duration,i.delay,i.easing)}function ws(n){return n?(n=Me({},n),n.params&&(n.params=q9(n.params))):n={},n}function N1(n,e,t){return{duration:n,delay:e,easing:t}}function Y1(n,e,t,r,i,o,s=null,a=!1){return{type:1,element:n,keyframes:e,preStyleProps:t,postStyleProps:r,duration:i,delay:o,totalTime:i+o,easing:s,subTimeline:a}}var Hc=class{_map=new Map;get(e){return this._map.get(e)||[]}append(e,t){let r=this._map.get(e);r||this._map.set(e,r=[]),r.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}},X9=1,Z9=":enter",Q9=new RegExp(Z9,"g"),J9=":leave",eU=new RegExp(J9,"g");function Pb(n,e,t,r,i,o=new Map,s=new Map,a,l,c=[]){return new V1().buildKeyframes(n,e,t,r,i,o,s,a,l,c)}var V1=class{buildKeyframes(e,t,r,i,o,s,a,l,c,u=[]){c=c||new Hc;let f=new U1(e,t,c,i,o,u,[]);f.options=l;let h=l.delay?gi(l.delay):0;f.currentTimeline.delayNextStep(h),f.currentTimeline.setStyles([s],null,f.errors,l),Yn(this,r,f);let d=f.timelines.filter(m=>m.containsAnimation());if(d.length&&a.size){let m;for(let p=d.length-1;p>=0;p--){let g=d[p];if(g.element===t){m=g;break}}m&&!m.allowOnlyTimelineStyles()&&m.setStyles([a],null,f.errors,l)}return d.length?d.map(m=>m.buildKeyframes()):[Y1(t,[],[],[],0,h,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){let r=t.subInstructions.get(t.element);if(r){let i=t.createSubContext(e.options),o=t.currentTimeline.currentTime,s=this._visitSubInstructions(r,i,i.options);o!=s&&t.transformIntoNewTimeline(s)}t.previousNode=e}visitAnimateRef(e,t){let r=t.createSubContext(e.options);r.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,r),this.visitReference(e.animation,r),t.transformIntoNewTimeline(r.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,r){for(let i of e){let o=i?.delay;if(o){let s=typeof o=="number"?o:gi(Ua(o,i?.params??{},t.errors));r.delayNextStep(s)}}}_visitSubInstructions(e,t,r){let o=t.currentTimeline.currentTime,s=r.duration!=null?gi(r.duration):null,a=r.delay!=null?gi(r.delay):null;return s!==0&&e.forEach(l=>{let c=t.appendInstructionToTimeline(l,s,a);o=Math.max(o,c.duration+c.delay)}),o}visitReference(e,t){t.updateOptions(e.options,!0),Yn(this,e.animation,t),t.previousNode=e}visitSequence(e,t){let r=t.subContextCount,i=t,o=e.options;if(o&&(o.params||o.delay)&&(i=t.createSubContext(o),i.transformIntoNewTimeline(),o.delay!=null)){i.previousNode.type==$e.Style&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=Zh);let s=gi(o.delay);i.delayNextStep(s)}e.steps.length&&(e.steps.forEach(s=>Yn(this,s,i)),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>r&&i.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){let r=[],i=t.currentTimeline.currentTime,o=e.options&&e.options.delay?gi(e.options.delay):0;e.steps.forEach(s=>{let a=t.createSubContext(e.options);o&&a.delayNextStep(o),Yn(this,s,a),i=Math.max(i,a.currentTimeline.currentTime),r.push(a.currentTimeline)}),r.forEach(s=>t.currentTimeline.mergeTimelineCollectedStyles(s)),t.transformIntoNewTimeline(i),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){let r=e.strValue,i=t.params?Ua(r,t.params,t.errors):r;return Uc(i,t.errors)}else return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){let r=t.currentAnimateTimings=this._visitTiming(e.timings,t),i=t.currentTimeline;r.delay&&(t.incrementTime(r.delay),i.snapshotCurrentStyles());let o=e.style;o.type==$e.Keyframes?this.visitKeyframes(o,t):(t.incrementTime(r.duration),this.visitStyle(o,t),i.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){let r=t.currentTimeline,i=t.currentAnimateTimings;!i&&r.hasCurrentStyleProperties()&&r.forwardFrame();let o=i&&i.easing||e.easing;e.isEmptyStep?r.applyEmptyStep(o):r.setStyles(e.styles,o,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){let r=t.currentAnimateTimings,i=t.currentTimeline.duration,o=r.duration,a=t.createSubContext().currentTimeline;a.easing=r.easing,e.styles.forEach(l=>{let c=l.offset||0;a.forwardTime(c*o),a.setStyles(l.styles,l.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(i+o),t.previousNode=e}visitQuery(e,t){let r=t.currentTimeline.currentTime,i=e.options||{},o=i.delay?gi(i.delay):0;o&&(t.previousNode.type===$e.Style||r==0&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=Zh);let s=r,a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,t.errors);t.currentQueryTotal=a.length;let l=null;a.forEach((c,u)=>{t.currentQueryIndex=u;let f=t.createSubContext(e.options,c);o&&f.delayNextStep(o),c===t.element&&(l=f.currentTimeline),Yn(this,e.animation,f),f.currentTimeline.applyStylesToKeyframe();let h=f.currentTimeline.currentTime;s=Math.max(s,h)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(s),l&&(t.currentTimeline.mergeTimelineCollectedStyles(l),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){let r=t.parentContext,i=t.currentTimeline,o=e.timings,s=Math.abs(o.duration),a=s*(t.currentQueryTotal-1),l=s*t.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":l=a-l;break;case"full":l=r.currentStaggerTime;break}let u=t.currentTimeline;l&&u.delayNextStep(l);let f=u.currentTime;Yn(this,e.animation,t),t.previousNode=e,r.currentStaggerTime=i.currentTime-f+(i.startTime-r.currentTimeline.startTime)}},Zh={},U1=class n{_driver;element;subInstructions;_enterClassName;_leaveClassName;errors;timelines;parentContext=null;currentTimeline;currentAnimateTimings=null;previousNode=Zh;subContextCount=0;options={};currentQueryIndex=0;currentQueryTotal=0;currentStaggerTime=0;constructor(e,t,r,i,o,s,a,l){this._driver=e,this.element=t,this.subInstructions=r,this._enterClassName=i,this._leaveClassName=o,this.errors=s,this.timelines=a,this.currentTimeline=l||new Qh(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;let r=e,i=this.options;r.duration!=null&&(i.duration=gi(r.duration)),r.delay!=null&&(i.delay=gi(r.delay));let o=r.params;if(o){let s=i.params;s||(s=this.options.params={}),Object.keys(o).forEach(a=>{(!t||!s.hasOwnProperty(a))&&(s[a]=Ua(o[a],s,this.errors))})}}_copyOptions(){let e={};if(this.options){let t=this.options.params;if(t){let r=e.params={};Object.keys(t).forEach(i=>{r[i]=t[i]})}}return e}createSubContext(e=null,t,r){let i=t||this.element,o=new n(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,r||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(e),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(e){return this.previousNode=Zh,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,r){let i={duration:t??e.duration,delay:this.currentTimeline.currentTime+(r??0)+e.delay,easing:""},o=new j1(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,i,e.stretchStartingKeyframe);return this.timelines.push(o),i}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,r,i,o,s){let a=[];if(i&&a.push(this.element),e.length>0){e=e.replace(Q9,"."+this._enterClassName),e=e.replace(eU,"."+this._leaveClassName);let l=r!=1,c=this._driver.query(this.element,e,l);r!==0&&(c=r<0?c.slice(c.length+r,c.length):c.slice(0,r)),a.push(...c)}return!o&&a.length==0&&s.push(ob(t)),a}},Qh=class n{_driver;element;startTime;_elementTimelineStylesLookup;duration=0;easing=null;_previousKeyframe=new Map;_currentKeyframe=new Map;_keyframes=new Map;_styleSummary=new Map;_localTimelineStyles=new Map;_globalTimelineStyles;_pendingStyles=new Map;_backFill=new Map;_currentEmptyStepKeyframe=null;constructor(e,t,r,i){this._driver=e,this.element=t,this.startTime=r,this._elementTimelineStylesLookup=i,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){let t=this._keyframes.size===1&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new n(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=X9,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,r]of this._globalTimelineStyles)this._backFill.set(t,r||wr),this._currentKeyframe.set(t,wr);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,r,i){t&&this._previousKeyframe.set("easing",t);let o=i&&i.params||{},s=tU(e,this._globalTimelineStyles);for(let[a,l]of s){let c=Ua(l,o,r);this._pendingStyles.set(a,c),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??wr),this._updateStyle(a,c)}}applyStylesToKeyframe(){this._pendingStyles.size!=0&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){let e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,r)=>{let i=this._styleSummary.get(r);(!i||t.time>i.time)&&this._updateStyle(r,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();let e=new Set,t=new Set,r=this._keyframes.size===1&&this.duration===0,i=[];this._keyframes.forEach((a,l)=>{let c=new Map([...this._backFill,...a]);c.forEach((u,f)=>{u===ma?e.add(f):u===wr&&t.add(f)}),r||c.set("offset",l/this.duration),i.push(c)});let o=[...e.values()],s=[...t.values()];if(r){let a=i[0],l=new Map(a);a.set("offset",0),l.set("offset",1),i=[a,l]}return Y1(this.element,i,o,s,this.duration,this.startTime,this.easing,!1)}},j1=class extends Qh{keyframes;preStyleProps;postStyleProps;_stretchStartingKeyframe;timings;constructor(e,t,r,i,o,s,a=!1){super(e,t,s.delay),this.keyframes=r,this.preStyleProps=i,this.postStyleProps=o,this._stretchStartingKeyframe=a,this.timings={duration:s.duration,delay:s.delay,easing:s.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:r,easing:i}=this.timings;if(this._stretchStartingKeyframe&&t){let o=[],s=r+t,a=t/s,l=new Map(e[0]);l.set("offset",0),o.push(l);let c=new Map(e[0]);c.set("offset",Sb(a)),o.push(c);let u=e.length-1;for(let f=1;f<=u;f++){let h=new Map(e[f]),d=h.get("offset"),m=t+d*r;h.set("offset",Sb(m/s)),o.push(h)}r=s,t=0,i="",e=o}return Y1(this.element,e,this.preStyleProps,this.postStyleProps,r,t,i,!0)}};function Sb(n,e=3){let t=Math.pow(10,e-1);return Math.round(n*t)/t}function tU(n,e){let t=new Map,r;return n.forEach(i=>{if(i==="*"){r??=e.keys();for(let o of r)t.set(o,wr)}else for(let[o,s]of i)t.set(o,s)}),t}function bb(n,e,t,r,i,o,s,a,l,c,u,f,h){return{type:0,element:n,triggerName:e,isRemovalTransition:i,fromState:t,fromStyles:o,toState:r,toStyles:s,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:u,totalTime:f,errors:h}}var M1={},Jh=class{_triggerName;ast;_stateStyles;constructor(e,t,r){this._triggerName=e,this.ast=t,this._stateStyles=r}match(e,t,r,i){return nU(this.ast.matchers,e,t,r,i)}buildStyles(e,t,r){let i=this._stateStyles.get("*");return e!==void 0&&(i=this._stateStyles.get(e?.toString())||i),i?i.buildStyles(t,r):new Map}build(e,t,r,i,o,s,a,l,c,u){let f=[],h=this.ast.options&&this.ast.options.params||M1,d=a&&a.params||M1,m=this.buildStyles(r,d,f),p=l&&l.params||M1,g=this.buildStyles(i,p,f),w=new Set,y=new Map,S=new Map,B=i==="void",Z={params:Lb(p,h),delay:this.ast.options?.delay},ce=u?[]:Pb(e,t,this.ast.animation,o,s,m,g,Z,c,f),O=0;return ce.forEach(L=>{O=Math.max(L.duration+L.delay,O)}),f.length?bb(t,this._triggerName,r,i,B,m,g,[],[],y,S,O,f):(ce.forEach(L=>{let G=L.element,V=Kn(y,G,new Set);L.preStyleProps.forEach(W=>V.add(W));let K=Kn(S,G,new Set);L.postStyleProps.forEach(W=>K.add(W)),G!==t&&w.add(G)}),bb(t,this._triggerName,r,i,B,m,g,ce,[...w.values()],y,S,O))}};function nU(n,e,t,r,i){return n.some(o=>o(e,t,r,i))}function Lb(n,e){let t=Me({},e);return Object.entries(n).forEach(([r,i])=>{i!=null&&(t[r]=i)}),t}var H1=class{styles;defaultParams;normalizer;constructor(e,t,r){this.styles=e,this.defaultParams=t,this.normalizer=r}buildStyles(e,t){let r=new Map,i=Lb(e,this.defaultParams);return this.styles.styles.forEach(o=>{typeof o!="string"&&o.forEach((s,a)=>{s&&(s=Ua(s,i,t));let l=this.normalizer.normalizePropertyName(a,t);s=this.normalizer.normalizeStyleValue(a,l,s,t),r.set(a,s)})}),r}};function rU(n,e,t){return new G1(n,e,t)}var G1=class{name;ast;_normalizer;transitionFactories=[];fallbackTransition;states=new Map;constructor(e,t,r){this.name=e,this.ast=t,this._normalizer=r,t.states.forEach(i=>{let o=i.options&&i.options.params||{};this.states.set(i.name,new H1(i.style,o,r))}),Ib(this.states,"true","1"),Ib(this.states,"false","0"),t.transitions.forEach(i=>{this.transitionFactories.push(new Jh(e,i,this.states))}),this.fallbackTransition=iU(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,r,i){return this.transitionFactories.find(s=>s.match(e,t,r,i))||null}matchStyles(e,t,r){return this.fallbackTransition.buildStyles(e,t,r)}};function iU(n,e,t){let r=[(s,a)=>!0],i={type:$e.Sequence,steps:[],options:null},o={type:$e.Transition,animation:i,matchers:r,options:null,queryCount:0,depCount:0};return new Jh(n,o,e)}function Ib(n,e,t){n.has(e)?n.has(t)||n.set(t,n.get(e)):n.has(t)&&n.set(e,n.get(t))}var oU=new Hc,$1=class{bodyNode;_driver;_normalizer;_animations=new Map;_playersById=new Map;players=[];constructor(e,t,r){this.bodyNode=e,this._driver=t,this._normalizer=r}register(e,t){let r=[],i=[],o=Rb(this._driver,t,r,i);if(r.length)throw cb(r);this._animations.set(e,o)}_buildPlayer(e,t,r){let i=e.element,o=C1(this._normalizer,e.keyframes,t,r);return this._driver.animate(i,o,e.duration,e.delay,e.easing,[],!0)}create(e,t,r={}){let i=[],o=this._animations.get(e),s,a=new Map;if(o?(s=Pb(this._driver,t,o,A1,jh,new Map,new Map,r,oU,i),s.forEach(u=>{let f=Kn(a,u.element,new Map);u.postStyleProps.forEach(h=>f.set(h,null))})):(i.push(ub()),s=[]),i.length)throw fb(i);a.forEach((u,f)=>{u.forEach((h,d)=>{u.set(d,this._driver.computeStyle(f,d,wr))})});let l=s.map(u=>{let f=a.get(u.element);return this._buildPlayer(u,new Map,f)}),c=Gi(l);return this._playersById.set(e,c),c.onDestroy(()=>this.destroy(e)),this.players.push(c),c}destroy(e){let t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);let r=this.players.indexOf(t);r>=0&&this.players.splice(r,1)}_getPlayer(e){let t=this._playersById.get(e);if(!t)throw db(e);return t}listen(e,t,r,i){let o=Vh(t,"","","");return Bh(this._getPlayer(e),r,o,i),()=>{}}command(e,t,r,i){if(r=="register"){this.register(e,i[0]);return}if(r=="create"){let s=i[0]||{};this.create(e,t,s);return}let o=this._getPlayer(e);switch(r){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(e);break}}},Ab="ng-animate-queued",sU=".ng-animate-queued",O1="ng-animate-disabled",aU=".ng-animate-disabled",lU="ng-star-inserted",cU=".ng-star-inserted",uU=[],Bb={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},fU={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Kr="__ng_removed",Gc=class{namespaceId;value;options;get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;let r=e&&e.hasOwnProperty("value"),i=r?e.value:e;if(this.value=hU(i),r){let o=e,{value:s}=o,a=t_(o,["value"]);this.options=a}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){let t=e.params;if(t){let r=this.options.params;Object.keys(t).forEach(i=>{r[i]==null&&(r[i]=t[i])})}}},jc="void",R1=new Gc(jc),W1=class{id;hostElement;_engine;players=[];_triggers=new Map;_queue=[];_elementListeners=new Map;_hostClassName;constructor(e,t,r){this.id=e,this.hostElement=t,this._engine=r,this._hostClassName="ng-tns-"+e,Ar(t,this._hostClassName)}listen(e,t,r,i){if(!this._triggers.has(t))throw hb(r,t);if(r==null||r.length==0)throw pb(t);if(!pU(r))throw mb(r,t);let o=Kn(this._elementListeners,e,[]),s={name:t,phase:r,callback:i};o.push(s);let a=Kn(this._engine.statesByElement,e,new Map);return a.has(t)||(Ar(e,Bc),Ar(e,Bc+"-"+t),a.set(t,R1)),()=>{this._engine.afterFlush(()=>{let l=o.indexOf(s);l>=0&&o.splice(l,1),this._triggers.has(t)||a.delete(t)})}}register(e,t){return this._triggers.has(e)?!1:(this._triggers.set(e,t),!0)}_getTrigger(e){let t=this._triggers.get(e);if(!t)throw gb(e);return t}trigger(e,t,r,i=!0){let o=this._getTrigger(t),s=new $c(this.id,t,e),a=this._engine.statesByElement.get(e);a||(Ar(e,Bc),Ar(e,Bc+"-"+t),this._engine.statesByElement.set(e,a=new Map));let l=a.get(t),c=new Gc(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&l&&c.absorbOptions(l.options),a.set(t,c),l||(l=R1),!(c.value===jc)&&l.value===c.value){if(!vU(l.params,c.params)){let p=[],g=o.matchStyles(l.value,l.params,p),w=o.matchStyles(c.value,c.params,p);p.length?this._engine.reportError(p):this._engine.afterFlush(()=>{Io(e,g),qr(e,w)})}return}let h=Kn(this._engine.playersByElement,e,[]);h.forEach(p=>{p.namespaceId==this.id&&p.triggerName==t&&p.queued&&p.destroy()});let d=o.matchTransition(l.value,c.value,e,c.params),m=!1;if(!d){if(!i)return;d=o.fallbackTransition,m=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:d,fromState:l,toState:c,player:s,isFallbackTransition:m}),m||(Ar(e,Ab),s.onStart(()=>{ja(e,Ab)})),s.onDone(()=>{let p=this.players.indexOf(s);p>=0&&this.players.splice(p,1);let g=this._engine.playersByElement.get(e);if(g){let w=g.indexOf(s);w>=0&&g.splice(w,1)}}),this.players.push(s),h.push(s),s}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,r)=>{this._elementListeners.set(r,t.filter(i=>i.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);let t=this._engine.playersByElement.get(e);t&&(t.forEach(r=>r.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){let r=this._engine.driver.query(e,Vc,!0);r.forEach(i=>{if(i[Kr])return;let o=this._engine.fetchNamespacesByElement(i);o.size?o.forEach(s=>s.triggerLeaveAnimation(i,t,!1,!0)):this.clearElementCache(i)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(i=>this.clearElementCache(i)))}triggerLeaveAnimation(e,t,r,i){let o=this._engine.statesByElement.get(e),s=new Map;if(o){let a=[];if(o.forEach((l,c)=>{if(s.set(c,l.value),this._triggers.has(c)){let u=this.trigger(e,c,jc,i);u&&a.push(u)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,s),r&&Gi(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){let t=this._elementListeners.get(e),r=this._engine.statesByElement.get(e);if(t&&r){let i=new Set;t.forEach(o=>{let s=o.name;if(i.has(s))return;i.add(s);let l=this._triggers.get(s).fallbackTransition,c=r.get(s)||R1,u=new Gc(jc),f=new $c(this.id,s,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:s,transition:l,fromState:c,toState:u,player:f,isFallbackTransition:!0})})}}removeNode(e,t){let r=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let i=!1;if(r.totalAnimations){let o=r.players.length?r.playersByQueriedElement.get(e):[];if(o&&o.length)i=!0;else{let s=e;for(;s=s.parentNode;)if(r.statesByElement.get(s)){i=!0;break}}}if(this.prepareLeaveAnimationListeners(e),i)r.markElementAsRemoved(this.id,e,!1,t);else{let o=e[Kr];(!o||o===Bb)&&(r.afterFlush(()=>this.clearElementCache(e)),r.destroyInnerAnimations(e),r._onRemovalComplete(e,t))}}insertNode(e,t){Ar(e,this._hostClassName)}drainQueuedTransitions(e){let t=[];return this._queue.forEach(r=>{let i=r.player;if(i.destroyed)return;let o=r.element,s=this._elementListeners.get(o);s&&s.forEach(a=>{if(a.name==r.triggerName){let l=Vh(o,r.triggerName,r.fromState.value,r.toState.value);l._data=e,Bh(r.player,a.phase,l,a.callback)}}),i.markedForDestroy?this._engine.afterFlush(()=>{i.destroy()}):t.push(r)}),this._queue=[],t.sort((r,i)=>{let o=r.transition.ast.depCount,s=i.transition.ast.depCount;return o==0||s==0?o-s:this._engine.driver.containsElement(r.element,i.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}},z1=class{bodyNode;driver;_normalizer;players=[];newHostElements=new Map;playersByElement=new Map;playersByQueriedElement=new Map;statesByElement=new Map;disabledNodes=new Set;totalAnimations=0;totalQueuedPlayers=0;_namespaceLookup={};_namespaceList=[];_flushFns=[];_whenQuietFns=[];namespacesByHostElement=new Map;collectedEnterElements=[];collectedLeaveElements=[];onRemovalComplete=(e,t)=>{};_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,r){this.bodyNode=e,this.driver=t,this._normalizer=r}get queuedPlayers(){let e=[];return this._namespaceList.forEach(t=>{t.players.forEach(r=>{r.queued&&e.push(r)})}),e}createNamespace(e,t){let r=new W1(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(r,t):(this.newHostElements.set(t,r),this.collectEnterElement(t)),this._namespaceLookup[e]=r}_balanceNamespaceList(e,t){let r=this._namespaceList,i=this.namespacesByHostElement;if(r.length-1>=0){let s=!1,a=this.driver.getParentElement(t);for(;a;){let l=i.get(a);if(l){let c=r.indexOf(l);r.splice(c+1,0,e),s=!0;break}a=this.driver.getParentElement(a)}s||r.unshift(e)}else r.push(e);return i.set(t,e),e}register(e,t){let r=this._namespaceLookup[e];return r||(r=this.createNamespace(e,t)),r}registerTrigger(e,t,r){let i=this._namespaceLookup[e];i&&i.register(t,r)&&this.totalAnimations++}destroy(e,t){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{let r=this._fetchNamespace(e);this.namespacesByHostElement.delete(r.hostElement);let i=this._namespaceList.indexOf(r);i>=0&&this._namespaceList.splice(i,1),r.destroy(t),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){let t=new Set,r=this.statesByElement.get(e);if(r){for(let i of r.values())if(i.namespaceId){let o=this._fetchNamespace(i.namespaceId);o&&t.add(o)}}return t}trigger(e,t,r,i){if(qh(t)){let o=this._fetchNamespace(e);if(o)return o.trigger(t,r,i),!0}return!1}insertNode(e,t,r,i){if(!qh(t))return;let o=t[Kr];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;let s=this.collectedLeaveElements.indexOf(t);s>=0&&this.collectedLeaveElements.splice(s,1)}if(e){let s=this._fetchNamespace(e);s&&s.insertNode(t,r)}i&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),Ar(e,O1)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),ja(e,O1))}removeNode(e,t,r){if(qh(t)){let i=e?this._fetchNamespace(e):null;i?i.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r);let o=this.namespacesByHostElement.get(t);o&&o.id!==e&&o.removeNode(t,r)}else this._onRemovalComplete(t,r)}markElementAsRemoved(e,t,r,i,o){this.collectedLeaveElements.push(t),t[Kr]={namespaceId:e,setForRemoval:i,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:o}}listen(e,t,r,i,o){return qh(t)?this._fetchNamespace(e).listen(t,r,i,o):()=>{}}_buildInstruction(e,t,r,i,o){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,r,i,e.fromState.options,e.toState.options,t,o)}destroyInnerAnimations(e){let t=this.driver.query(e,Vc,!0);t.forEach(r=>this.destroyActiveAnimationsForElement(r)),this.playersByQueriedElement.size!=0&&(t=this.driver.query(e,Hh,!0),t.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(e){let t=this.playersByElement.get(e);t&&t.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(e){let t=this.playersByQueriedElement.get(e);t&&t.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return Gi(this.players).onDone(()=>e());e()})}processLeaveNode(e){let t=e[Kr];if(t&&t.setForRemoval){if(e[Kr]=Bb,t.namespaceId){this.destroyInnerAnimations(e);let r=this._fetchNamespace(t.namespaceId);r&&r.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(O1)&&this.markElementAsDisabled(e,!1),this.driver.query(e,aU,!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,i)=>this._balanceNamespaceList(r,i)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++){let i=this.collectedEnterElements[r];Ar(i,lU)}if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){let r=[];try{t=this._flushAnimations(r,e)}finally{for(let i=0;i<r.length;i++)r[i]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++){let i=this.collectedLeaveElements[r];this.processLeaveNode(i)}if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){let r=this._whenQuietFns;this._whenQuietFns=[],t.length?Gi(t).onDone(()=>{r.forEach(i=>i())}):r.forEach(i=>i())}}reportError(e){throw vb(e)}_flushAnimations(e,t){let r=new Hc,i=[],o=new Map,s=[],a=new Map,l=new Map,c=new Map,u=new Set;this.disabledNodes.forEach(ie=>{u.add(ie);let ee=this.driver.query(ie,sU,!0);for(let k=0;k<ee.length;k++)u.add(ee[k])});let f=this.bodyNode,h=Array.from(this.statesByElement.keys()),d=Nb(h,this.collectedEnterElements),m=new Map,p=0;d.forEach((ie,ee)=>{let k=A1+p++;m.set(ee,k),ie.forEach(R=>Ar(R,k))});let g=[],w=new Set,y=new Set;for(let ie=0;ie<this.collectedLeaveElements.length;ie++){let ee=this.collectedLeaveElements[ie],k=ee[Kr];k&&k.setForRemoval&&(g.push(ee),w.add(ee),k.hasAnimation?this.driver.query(ee,cU,!0).forEach(R=>w.add(R)):y.add(ee))}let S=new Map,B=Nb(h,Array.from(w));B.forEach((ie,ee)=>{let k=jh+p++;S.set(ee,k),ie.forEach(R=>Ar(R,k))}),e.push(()=>{d.forEach((ie,ee)=>{let k=m.get(ee);ie.forEach(R=>ja(R,k))}),B.forEach((ie,ee)=>{let k=S.get(ee);ie.forEach(R=>ja(R,k))}),g.forEach(ie=>{this.processLeaveNode(ie)})});let Z=[],ce=[];for(let ie=this._namespaceList.length-1;ie>=0;ie--)this._namespaceList[ie].drainQueuedTransitions(t).forEach(k=>{let R=k.player,pe=k.element;if(Z.push(R),this.collectedEnterElements.length){let he=pe[Kr];if(he&&he.setForMove){if(he.previousTriggersValues&&he.previousTriggersValues.has(k.triggerName)){let Q=he.previousTriggersValues.get(k.triggerName),j=this.statesByElement.get(k.element);if(j&&j.has(k.triggerName)){let N=j.get(k.triggerName);N.value=Q,j.set(k.triggerName,N)}}R.destroy();return}}let De=!f||!this.driver.containsElement(f,pe),F=S.get(pe),U=m.get(pe),M=this._buildInstruction(k,r,U,F,De);if(M.errors&&M.errors.length){ce.push(M);return}if(De){R.onStart(()=>Io(pe,M.fromStyles)),R.onDestroy(()=>qr(pe,M.toStyles)),i.push(R);return}if(k.isFallbackTransition){R.onStart(()=>Io(pe,M.fromStyles)),R.onDestroy(()=>qr(pe,M.toStyles)),i.push(R);return}let P=[];M.timelines.forEach(he=>{he.stretchStartingKeyframe=!0,this.disabledNodes.has(he.element)||P.push(he)}),M.timelines=P,r.append(pe,M.timelines);let se={instruction:M,player:R,element:pe};s.push(se),M.queriedElements.forEach(he=>Kn(a,he,[]).push(R)),M.preStyleProps.forEach((he,Q)=>{if(he.size){let j=l.get(Q);j||l.set(Q,j=new Set),he.forEach((N,oe)=>j.add(oe))}}),M.postStyleProps.forEach((he,Q)=>{let j=c.get(Q);j||c.set(Q,j=new Set),he.forEach((N,oe)=>j.add(oe))})});if(ce.length){let ie=[];ce.forEach(ee=>{ie.push(_b(ee.triggerName,ee.errors))}),Z.forEach(ee=>ee.destroy()),this.reportError(ie)}let O=new Map,L=new Map;s.forEach(ie=>{let ee=ie.element;r.has(ee)&&(L.set(ee,ee),this._beforeAnimationBuild(ie.player.namespaceId,ie.instruction,O))}),i.forEach(ie=>{let ee=ie.element;this._getPreviousPlayers(ee,!1,ie.namespaceId,ie.triggerName,null).forEach(R=>{Kn(O,ee,[]).push(R),R.destroy()})});let G=g.filter(ie=>Mb(ie,l,c)),V=new Map;kb(V,this.driver,y,c,wr).forEach(ie=>{Mb(ie,l,c)&&G.push(ie)});let W=new Map;d.forEach((ie,ee)=>{kb(W,this.driver,new Set(ie),l,ma)}),G.forEach(ie=>{let ee=V.get(ie),k=W.get(ie);V.set(ie,new Map([...ee?.entries()??[],...k?.entries()??[]]))});let ue=[],Oe=[],Te={};s.forEach(ie=>{let{element:ee,player:k,instruction:R}=ie;if(r.has(ee)){if(u.has(ee)){k.onDestroy(()=>qr(ee,R.toStyles)),k.disabled=!0,k.overrideTotalTime(R.totalTime),i.push(k);return}let pe=Te;if(L.size>1){let F=ee,U=[];for(;F=F.parentNode;){let M=L.get(F);if(M){pe=M;break}U.push(F)}U.forEach(M=>L.set(M,pe))}let De=this._buildAnimation(k.namespaceId,R,O,o,W,V);if(k.setRealPlayer(De),pe===Te)ue.push(k);else{let F=this.playersByElement.get(pe);F&&F.length&&(k.parentPlayer=Gi(F)),i.push(k)}}else Io(ee,R.fromStyles),k.onDestroy(()=>qr(ee,R.toStyles)),Oe.push(k),u.has(ee)&&i.push(k)}),Oe.forEach(ie=>{let ee=o.get(ie.element);if(ee&&ee.length){let k=Gi(ee);ie.setRealPlayer(k)}}),i.forEach(ie=>{ie.parentPlayer?ie.syncPlayerEvents(ie.parentPlayer):ie.destroy()});for(let ie=0;ie<g.length;ie++){let ee=g[ie],k=ee[Kr];if(ja(ee,jh),k&&k.hasAnimation)continue;let R=[];if(a.size){let De=a.get(ee);De&&De.length&&R.push(...De);let F=this.driver.query(ee,Hh,!0);for(let U=0;U<F.length;U++){let M=a.get(F[U]);M&&M.length&&R.push(...M)}}let pe=R.filter(De=>!De.destroyed);pe.length?mU(this,ee,pe):this.processLeaveNode(ee)}return g.length=0,ue.forEach(ie=>{this.players.push(ie),ie.onDone(()=>{ie.destroy();let ee=this.players.indexOf(ie);this.players.splice(ee,1)}),ie.play()}),ue}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,r,i,o){let s=[];if(t){let a=this.playersByQueriedElement.get(e);a&&(s=a)}else{let a=this.playersByElement.get(e);if(a){let l=!o||o==jc;a.forEach(c=>{c.queued||!l&&c.triggerName!=i||s.push(c)})}}return(r||i)&&(s=s.filter(a=>!(r&&r!=a.namespaceId||i&&i!=a.triggerName))),s}_beforeAnimationBuild(e,t,r){let i=t.triggerName,o=t.element,s=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:i;for(let l of t.timelines){let c=l.element,u=c!==o,f=Kn(r,c,[]);this._getPreviousPlayers(c,u,s,a,t.toState).forEach(d=>{let m=d.getRealPlayer();m.beforeDestroy&&m.beforeDestroy(),d.destroy(),f.push(d)})}Io(o,t.fromStyles)}_buildAnimation(e,t,r,i,o,s){let a=t.triggerName,l=t.element,c=[],u=new Set,f=new Set,h=t.timelines.map(m=>{let p=m.element;u.add(p);let g=p[Kr];if(g&&g.removedBeforeQueried)return new fi(m.duration,m.delay);let w=p!==l,y=gU((r.get(p)||uU).map(O=>O.getRealPlayer())).filter(O=>{let L=O;return L.element?L.element===p:!1}),S=o.get(p),B=s.get(p),Z=C1(this._normalizer,m.keyframes,S,B),ce=this._buildPlayer(m,Z,y);if(m.subTimeline&&i&&f.add(p),w){let O=new $c(e,a,p);O.setRealPlayer(ce),c.push(O)}return ce});c.forEach(m=>{Kn(this.playersByQueriedElement,m.element,[]).push(m),m.onDone(()=>dU(this.playersByQueriedElement,m.element,m))}),u.forEach(m=>Ar(m,F1));let d=Gi(h);return d.onDestroy(()=>{u.forEach(m=>ja(m,F1)),qr(l,t.toStyles)}),f.forEach(m=>{Kn(i,m,[]).push(d)}),d}_buildPlayer(e,t,r){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,r):new fi(e.duration,e.delay)}},$c=class{namespaceId;triggerName;element;_player=new fi;_containsRealPlayer=!1;_queuedCallbacks=new Map;destroyed=!1;parentPlayer=null;markedForDestroy=!1;disabled=!1;queued=!0;totalTime=0;constructor(e,t,r){this.namespaceId=e,this.triggerName=t,this.element=r}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,r)=>{t.forEach(i=>Bh(e,r,void 0,i))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){let t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){Kn(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return this.queued?!1:this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){let t=this._player;t.triggerCallback&&t.triggerCallback(e)}};function dU(n,e,t){let r=n.get(e);if(r){if(r.length){let i=r.indexOf(t);r.splice(i,1)}r.length==0&&n.delete(e)}return r}function hU(n){return n??null}function qh(n){return n&&n.nodeType===1}function pU(n){return n=="start"||n=="done"}function Fb(n,e){let t=n.style.display;return n.style.display=e??"none",t}function kb(n,e,t,r,i){let o=[];t.forEach(l=>o.push(Fb(l)));let s=[];r.forEach((l,c)=>{let u=new Map;l.forEach(f=>{let h=e.computeStyle(c,f,i);u.set(f,h),(!h||h.length==0)&&(c[Kr]=fU,s.push(c))}),n.set(c,u)});let a=0;return t.forEach(l=>Fb(l,o[a++])),s}function Nb(n,e){let t=new Map;if(n.forEach(a=>t.set(a,[])),e.length==0)return t;let r=1,i=new Set(e),o=new Map;function s(a){if(!a)return r;let l=o.get(a);if(l)return l;let c=a.parentNode;return t.has(c)?l=c:i.has(c)?l=r:l=s(c),o.set(a,l),l}return e.forEach(a=>{let l=s(a);l!==r&&t.get(l).push(a)}),t}function Ar(n,e){n.classList?.add(e)}function ja(n,e){n.classList?.remove(e)}function mU(n,e,t){Gi(t).onDone(()=>n.processLeaveNode(e))}function gU(n){let e=[];return Vb(n,e),e}function Vb(n,e){for(let t=0;t<n.length;t++){let r=n[t];r instanceof ss?Vb(r.players,e):e.push(r)}}function vU(n,e){let t=Object.keys(n),r=Object.keys(e);if(t.length!=r.length)return!1;for(let i=0;i<t.length;i++){let o=t[i];if(!e.hasOwnProperty(o)||n[o]!==e[o])return!1}return!0}function Mb(n,e,t){let r=t.get(n);if(!r)return!1;let i=e.get(n);return i?r.forEach(o=>i.add(o)):e.set(n,r),t.delete(n),!0}var Ha=class{_driver;_normalizer;_transitionEngine;_timelineEngine;_triggerCache={};onRemovalComplete=(e,t)=>{};constructor(e,t,r){this._driver=t,this._normalizer=r,this._transitionEngine=new z1(e.body,t,r),this._timelineEngine=new $1(e.body,t,r),this._transitionEngine.onRemovalComplete=(i,o)=>this.onRemovalComplete(i,o)}registerTrigger(e,t,r,i,o){let s=e+"-"+i,a=this._triggerCache[s];if(!a){let l=[],c=[],u=Rb(this._driver,o,l,c);if(l.length)throw lb(i,l);a=rU(i,u,this._normalizer),this._triggerCache[s]=a}this._transitionEngine.registerTrigger(t,i,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,r,i){this._transitionEngine.insertNode(e,t,r,i)}onRemove(e,t,r){this._transitionEngine.removeNode(e,t,r)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,r,i){if(r.charAt(0)=="@"){let[o,s]=D1(r),a=i;this._timelineEngine.command(o,t,s,a)}else this._transitionEngine.trigger(e,t,r,i)}listen(e,t,r,i,o){if(r.charAt(0)=="@"){let[s,a]=D1(r);return this._timelineEngine.listen(s,t,a,o)}return this._transitionEngine.listen(e,t,r,i,o)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}};function _U(n,e){let t=null,r=null;return Array.isArray(e)&&e.length?(t=P1(e[0]),e.length>1&&(r=P1(e[e.length-1]))):e instanceof Map&&(t=P1(e)),t||r?new yU(n,t,r):null}var yU=(()=>{class n{_element;_startStyles;_endStyles;static initialStylesByElement=new WeakMap;_state=0;_initialStyles;constructor(t,r,i){this._element=t,this._startStyles=r,this._endStyles=i;let o=n.initialStylesByElement.get(t);o||n.initialStylesByElement.set(t,o=new Map),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&qr(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(qr(this._element,this._initialStyles),this._endStyles&&(qr(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(Io(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Io(this._element,this._endStyles),this._endStyles=null),qr(this._element,this._initialStyles),this._state=3)}}return n})();function P1(n){let e=null;return n.forEach((t,r)=>{xU(r)&&(e=e||new Map,e.set(r,t))}),e}function xU(n){return n==="display"||n==="position"}var e0=class{element;keyframes;options;_specialStyles;_onDoneFns=[];_onStartFns=[];_onDestroyFns=[];_duration;_delay;_initialized=!1;_finished=!1;_started=!1;_destroyed=!1;_finalKeyframe;_originalOnDoneFns=[];_originalOnStartFns=[];domPlayer;time=0;parentPlayer=null;currentSnapshot=new Map;constructor(e,t,r,i){this.element=e,this.keyframes=t,this.options=r,this._specialStyles=i,this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;let e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map;let t=()=>this._onFinish();this.domPlayer.addEventListener("finish",t),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",t)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){let t=[];return e.forEach(r=>{t.push(Object.fromEntries(r))}),t}_triggerWebAnimation(e,t,r){return e.animate(this._convertKeyframesToObject(t),r)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){this.domPlayer===void 0&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){let e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((r,i)=>{i!=="offset"&&e.set(i,this._finished?r:$h(this.element,i))}),this.currentSnapshot=e}triggerCallback(e){let t=e==="start"?this._onStartFns:this._onDoneFns;t.forEach(r=>r()),t.length=0}},t0=class{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}containsElement(e,t){return S1(e,t)}getParentElement(e){return Uh(e)}query(e,t,r){return b1(e,t,r)}computeStyle(e,t,r){return $h(e,t)}animate(e,t,r,i,o,s=[]){let a=i==0?"both":"forwards",l={duration:r,delay:i,fill:a};o&&(l.easing=o);let c=new Map,u=s.filter(d=>d instanceof e0);Tb(r,i)&&u.forEach(d=>{d.currentSnapshot.forEach((m,p)=>c.set(p,m))});let f=xb(t).map(d=>new Map(d));f=wb(e,f,c);let h=_U(e,f);return new e0(e,f,l,h)}};var Kh="@",Ub="@.disabled",n0=class{namespaceId;delegate;engine;_onDestroy;\u0275type=0;constructor(e,t,r,i){this.namespaceId=e,this.delegate=t,this.engine=r,this._onDestroy=i}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,r,i=!0){this.delegate.insertBefore(e,t,r),this.engine.onInsert(this.namespaceId,t,e,i)}removeChild(e,t,r){this.parentNode(t)&&this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,r,i){this.delegate.setAttribute(e,t,r,i)}removeAttribute(e,t,r){this.delegate.removeAttribute(e,t,r)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,r,i){this.delegate.setStyle(e,t,r,i)}removeStyle(e,t,r){this.delegate.removeStyle(e,t,r)}setProperty(e,t,r){t.charAt(0)==Kh&&t==Ub?this.disableAnimations(e,!!r):this.delegate.setProperty(e,t,r)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,r,i){return this.delegate.listen(e,t,r,i)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}},q1=class extends n0{factory;constructor(e,t,r,i,o){super(t,r,i,o),this.factory=e,this.namespaceId=t}setProperty(e,t,r){t.charAt(0)==Kh?t.charAt(1)=="."&&t==Ub?(r=r===void 0?!0:!!r,this.disableAnimations(e,r)):this.engine.process(this.namespaceId,e,t.slice(1),r):this.delegate.setProperty(e,t,r)}listen(e,t,r,i){if(t.charAt(0)==Kh){let o=EU(e),s=t.slice(1),a="";return s.charAt(0)!=Kh&&([s,a]=TU(s)),this.engine.listen(this.namespaceId,o,s,a,l=>{let c=l._data||-1;this.factory.scheduleListenerCallback(c,r,l)})}return this.delegate.listen(e,t,r,i)}};function EU(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}function TU(n){let e=n.indexOf("."),t=n.substring(0,e),r=n.slice(e+1);return[t,r]}var r0=class{delegate;engine;_zone;_currentId=0;_microtaskId=1;_animationCallbacksBuffer=[];_rendererCache=new Map;_cdRecurDepth=0;constructor(e,t,r){this.delegate=e,this.engine=t,this._zone=r,t.onRemovalComplete=(i,o)=>{o?.removeChild(null,i)}}createRenderer(e,t){let r="",i=this.delegate.createRenderer(e,t);if(!e||!t?.data?.animation){let c=this._rendererCache,u=c.get(i);if(!u){let f=()=>c.delete(i);u=new n0(r,i,this.engine,f),c.set(i,u)}return u}let o=t.id,s=t.id+"-"+this._currentId;this._currentId++,this.engine.register(s,e);let a=c=>{Array.isArray(c)?c.forEach(a):this.engine.registerTrigger(o,s,e,c.name,c)};return t.data.animation.forEach(a),new q1(this,s,i,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(e,t,r){if(e>=0&&e<this._microtaskId){this._zone.run(()=>t(r));return}let i=this._animationCallbacksBuffer;i.length==0&&queueMicrotask(()=>{this._zone.run(()=>{i.forEach(o=>{let[s,a]=o;s(a)}),this._animationCallbacksBuffer=[]})}),i.push([t,r])}end(){this._cdRecurDepth--,this._cdRecurDepth==0&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}componentReplaced(e){this.engine.flush(),this.delegate.componentReplaced?.(e)}};var CU=(()=>{class n extends Ha{constructor(t,r,i){super(t,r,i)}ngOnDestroy(){this.flush()}static \u0275fac=function(r){return new(r||n)(We(Mt),We(Cs),We(Ds))};static \u0275prov=Ge({token:n,factory:n.\u0275fac})}return n})();function DU(){return new Yh}function SU(n,e,t){return new r0(n,e,t)}var jb=[{provide:Ds,useFactory:DU},{provide:Ha,useClass:CU},{provide:Fi,useFactory:SU,deps:[Ql,Ha,xt]}],Ioe=[{provide:Cs,useClass:K1},{provide:Vf,useValue:"NoopAnimations"},...jb],bU=[{provide:Cs,useFactory:()=>new t0},{provide:Vf,useFactory:()=>"BrowserAnimations"},...jb];function Hb(){return lo("NgEagerAnimations"),[...bU]}$g(Lh,{providers:[Hb(),Iw({positionClass:"toast-top-right"})]}).catch(n=>console.error(n));
